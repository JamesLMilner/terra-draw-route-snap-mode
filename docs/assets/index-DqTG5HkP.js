function Xu(i,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in i)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var Ji,rt,ih,nh,Zi,Is,rh,Un={},oh=[],Uu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ye(i,t){for(var n in t)i[n]=t[n];return i}function sh(i){var t=i.parentNode;t&&t.removeChild(i)}function oi(i,t,n){var r,s,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?s=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?Ji.call(arguments,2):n),typeof i=="function"&&i.defaultProps!=null)for(a in i.defaultProps)l[a]===void 0&&(l[a]=i.defaultProps[a]);return Yi(i,l,r,s,null)}function Yi(i,t,n,r,s){var a={type:i,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++ih};return s==null&&rt.vnode!=null&&rt.vnode(a),a}function ju(){return{current:null}}function Ki(i){return i.children}function ii(i,t){this.props=i,this.context=t}function Vi(i,t){if(t==null)return i.__?Vi(i.__,i.__.__k.indexOf(i)+1):null;for(var n;t<i.__k.length;t++)if((n=i.__k[t])!=null&&n.__e!=null)return n.__e;return typeof i.type=="function"?Vi(i):null}function ah(i){var t,n;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,t=0;t<i.__k.length;t++)if((n=i.__k[t])!=null&&n.__e!=null){i.__e=i.__c.base=n.__e;break}return ah(i)}}function Kr(i){(!i.__d&&(i.__d=!0)&&Zi.push(i)&&!jn.__r++||Is!==rt.debounceRendering)&&((Is=rt.debounceRendering)||setTimeout)(jn)}function jn(){for(var i;jn.__r=Zi.length;)i=Zi.sort(function(t,n){return t.__v.__b-n.__v.__b}),Zi=[],i.some(function(t){var n,r,s,a,l,u;t.__d&&(l=(a=(n=t).__v).__e,(u=n.__P)&&(r=[],(s=ye({},a)).__v=a.__v+1,fo(u,a,s,n.__n,u.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Vi(a),a.__h),ch(r,a),a.__e!=l&&ah(a)))})}function hh(i,t,n,r,s,a,l,u,c,d){var p,m,v,b,P,C,z,I=r&&r.__k||oh,g=I.length;for(n.__k=[],p=0;p<t.length;p++)if((b=n.__k[p]=(b=t[p])==null||typeof b=="boolean"?null:typeof b=="string"||typeof b=="number"||typeof b=="bigint"?Yi(null,b,null,null,b):Array.isArray(b)?Yi(Ki,{children:b},null,null,null):b.__b>0?Yi(b.type,b.props,b.key,b.ref?b.ref:null,b.__v):b)!=null){if(b.__=n,b.__b=n.__b+1,(v=I[p])===null||v&&b.key==v.key&&b.type===v.type)I[p]=void 0;else for(m=0;m<g;m++){if((v=I[m])&&b.key==v.key&&b.type===v.type){I[m]=void 0;break}v=null}fo(i,b,v=v||Un,s,a,l,u,c,d),P=b.__e,(m=b.ref)&&v.ref!=m&&(z||(z=[]),v.ref&&z.push(v.ref,null,b),z.push(m,b.__c||P,b)),P!=null?(C==null&&(C=P),typeof b.type=="function"&&b.__k===v.__k?b.__d=c=lh(b,c,i):c=uh(i,b,v,I,P,c),typeof n.type=="function"&&(n.__d=c)):c&&v.__e==c&&c.parentNode!=i&&(c=Vi(v))}for(n.__e=C,p=g;p--;)I[p]!=null&&dh(I[p],I[p]);if(z)for(p=0;p<z.length;p++)fh(z[p],z[++p],z[++p])}function lh(i,t,n){for(var r,s=i.__k,a=0;s&&a<s.length;a++)(r=s[a])&&(r.__=i,t=typeof r.type=="function"?lh(r,t,n):uh(n,r,r,s,r.__e,t));return t}function Wn(i,t){return t=t||[],i==null||typeof i=="boolean"||(Array.isArray(i)?i.some(function(n){Wn(n,t)}):t.push(i)),t}function uh(i,t,n,r,s,a){var l,u,c;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(n==null||s!=a||s.parentNode==null)t:if(a==null||a.parentNode!==i)i.appendChild(s),l=null;else{for(u=a,c=0;(u=u.nextSibling)&&c<r.length;c+=1)if(u==s)break t;i.insertBefore(s,a),l=a}return l!==void 0?l:s.nextSibling}function Wu(i,t,n,r,s){var a;for(a in n)a==="children"||a==="key"||a in t||Vn(i,a,null,n[a],r);for(a in t)s&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||Vn(i,a,t[a],n[a],r)}function Os(i,t,n){t[0]==="-"?i.setProperty(t,n):i[t]=n==null?"":typeof n!="number"||Uu.test(t)?n:n+"px"}function Vn(i,t,n,r,s){var a;t:if(t==="style")if(typeof n=="string")i.style.cssText=n;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(t in r)n&&t in n||Os(i.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Os(i.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in i?t.toLowerCase().slice(2):t.slice(2),i.l||(i.l={}),i.l[t+a]=n,n?r||i.addEventListener(t,a?Bs:zs,a):i.removeEventListener(t,a?Bs:zs,a);else if(t!=="dangerouslySetInnerHTML"){if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in i)try{i[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t.indexOf("-")==-1?i.removeAttribute(t):i.setAttribute(t,n))}}function zs(i){this.l[i.type+!1](rt.event?rt.event(i):i)}function Bs(i){this.l[i.type+!0](rt.event?rt.event(i):i)}function fo(i,t,n,r,s,a,l,u,c){var d,p,m,v,b,P,C,z,I,g,w,y,S,E,T,k=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,u=t.__e=n.__e,t.__h=null,a=[u]),(d=rt.__b)&&d(t);try{t:if(typeof k=="function"){if(z=t.props,I=(d=k.contextType)&&r[d.__c],g=d?I?I.props.value:d.__:r,n.__c?C=(p=t.__c=n.__c).__=p.__E:("prototype"in k&&k.prototype.render?t.__c=p=new k(z,g):(t.__c=p=new ii(z,g),p.constructor=k,p.render=Hu),I&&I.sub(p),p.props=z,p.state||(p.state={}),p.context=g,p.__n=r,m=p.__d=!0,p.__h=[],p._sb=[]),p.__s==null&&(p.__s=p.state),k.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=ye({},p.__s)),ye(p.__s,k.getDerivedStateFromProps(z,p.__s))),v=p.props,b=p.state,m)k.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(k.getDerivedStateFromProps==null&&z!==v&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(z,g),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(z,p.__s,g)===!1||t.__v===n.__v){for(p.props=z,p.state=p.__s,t.__v!==n.__v&&(p.__d=!1),p.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(B){B&&(B.__=t)}),w=0;w<p._sb.length;w++)p.__h.push(p._sb[w]);p._sb=[],p.__h.length&&l.push(p);break t}p.componentWillUpdate!=null&&p.componentWillUpdate(z,p.__s,g),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(v,b,P)})}if(p.context=g,p.props=z,p.__v=t,p.__P=i,y=rt.__r,S=0,"prototype"in k&&k.prototype.render){for(p.state=p.__s,p.__d=!1,y&&y(t),d=p.render(p.props,p.state,p.context),E=0;E<p._sb.length;E++)p.__h.push(p._sb[E]);p._sb=[]}else do p.__d=!1,y&&y(t),d=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++S<25);p.state=p.__s,p.getChildContext!=null&&(r=ye(ye({},r),p.getChildContext())),m||p.getSnapshotBeforeUpdate==null||(P=p.getSnapshotBeforeUpdate(v,b)),T=d!=null&&d.type===Ki&&d.key==null?d.props.children:d,hh(i,Array.isArray(T)?T:[T],t,n,r,s,a,l,u,c),p.base=t.__e,t.__h=null,p.__h.length&&l.push(p),C&&(p.__E=p.__=null),p.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Vu(n.__e,t,n,r,s,a,l,c);(d=rt.diffed)&&d(t)}catch(B){t.__v=null,(c||a!=null)&&(t.__e=u,t.__h=!!c,a[a.indexOf(u)]=null),rt.__e(B,t,n)}}function ch(i,t){rt.__c&&rt.__c(t,i),i.some(function(n){try{i=n.__h,n.__h=[],i.some(function(r){r.call(n)})}catch(r){rt.__e(r,n.__v)}})}function Vu(i,t,n,r,s,a,l,u){var c,d,p,m=n.props,v=t.props,b=t.type,P=0;if(b==="svg"&&(s=!0),a!=null){for(;P<a.length;P++)if((c=a[P])&&"setAttribute"in c==!!b&&(b?c.localName===b:c.nodeType===3)){i=c,a[P]=null;break}}if(i==null){if(b===null)return document.createTextNode(v);i=s?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,v.is&&v),a=null,u=!1}if(b===null)m===v||u&&i.data===v||(i.data=v);else{if(a=a&&Ji.call(i.childNodes),d=(m=n.props||Un).dangerouslySetInnerHTML,p=v.dangerouslySetInnerHTML,!u){if(a!=null)for(m={},P=0;P<i.attributes.length;P++)m[i.attributes[P].name]=i.attributes[P].value;(p||d)&&(p&&(d&&p.__html==d.__html||p.__html===i.innerHTML)||(i.innerHTML=p&&p.__html||""))}if(Wu(i,v,m,s,u),p)t.__k=[];else if(P=t.props.children,hh(i,Array.isArray(P)?P:[P],t,n,r,s&&b!=="foreignObject",a,l,a?a[0]:n.__k&&Vi(n,0),u),a!=null)for(P=a.length;P--;)a[P]!=null&&sh(a[P]);u||("value"in v&&(P=v.value)!==void 0&&(P!==i.value||b==="progress"&&!P||b==="option"&&P!==m.value)&&Vn(i,"value",P,m.value,!1),"checked"in v&&(P=v.checked)!==void 0&&P!==i.checked&&Vn(i,"checked",P,m.checked,!1))}return i}function fh(i,t,n){try{typeof i=="function"?i(t):i.current=t}catch(r){rt.__e(r,n)}}function dh(i,t,n){var r,s;if(rt.unmount&&rt.unmount(i),(r=i.ref)&&(r.current&&r.current!==i.__e||fh(r,null,t)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){rt.__e(a,t)}r.base=r.__P=null,i.__c=void 0}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&dh(r[s],t,n||typeof i.type!="function");n||i.__e==null||sh(i.__e),i.__=i.__e=i.__d=void 0}function Hu(i,t,n){return this.constructor(i,n)}function po(i,t,n){var r,s,a;rt.__&&rt.__(i,t),s=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],fo(t,i=(!r&&n||t).__k=oi(Ki,null,[i]),s||Un,Un,t.ownerSVGElement!==void 0,!r&&n?[n]:s?null:t.firstChild?Ji.call(t.childNodes):null,a,!r&&n?n:s?s.__e:t.firstChild,r),ch(a,i)}function mo(i,t){po(i,t,mo)}function ph(i,t,n){var r,s,a,l=ye({},i.props);for(a in t)a=="key"?r=t[a]:a=="ref"?s=t[a]:l[a]=t[a];return arguments.length>2&&(l.children=arguments.length>3?Ji.call(arguments,2):n),Yi(i.type,l,r||i.key,s||i.ref,null)}function _o(i,t){var n={__c:t="__cC"+rh++,__:i,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,a;return this.getChildContext||(s=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&s.some(Kr)},this.sub=function(l){s.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){s.splice(s.indexOf(l),1),u&&u.call(l)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Ji=oh.slice,rt={__e:function(i,t,n,r){for(var s,a,l;t=t.__;)if((s=t.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(i)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),l=s.__d),l)return s.__E=s}catch(u){i=u}throw i}},ih=0,nh=function(i){return i!=null&&i.constructor===void 0},ii.prototype.setState=function(i,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ye({},this.state),typeof i=="function"&&(i=i(ye({},n),this.props)),i&&ye(n,i),i!=null&&this.__v&&(t&&this._sb.push(t),Kr(this))},ii.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Kr(this))},ii.prototype.render=Ki,Zi=[],jn.__r=0,rh=0;const Gu=Object.freeze(Object.defineProperty({__proto__:null,Component:ii,Fragment:Ki,cloneElement:ph,createContext:_o,createElement:oi,createRef:ju,h:oi,hydrate:mo,get isValidElement(){return nh},get options(){return rt},render:po,toChildArray:Wn},Symbol.toStringTag,{value:"Module"}));var $u=0;function et(i,t,n,r,s){var a,l,u={};for(l in t)l=="ref"?a=t[l]:u[l]=t[l];var c={type:i,props:u,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--$u,__source:s,__self:r};if(typeof i=="function"&&(a=i.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return rt.vnode&&rt.vnode(c),c}function mh(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function go(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var t=i.default;if(typeof t=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),n}var Me={};const qu=go(Gu);var Ju={};function _h(i,t){for(var n in t)i[n]=t[n];return i}function vo(i,t,n){var r=/(?:\?([^#]*))?(#.*)?$/,s=i.match(r),a={},l;if(s&&s[1])for(var u=s[1].split("&"),c=0;c<u.length;c++){var d=u[c].split("=");a[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}i=Qr(i.replace(r,"")),t=Qr(t||"");for(var p=Math.max(i.length,t.length),m=0;m<p;m++)if(t[m]&&t[m].charAt(0)===":"){var v=t[m].replace(/(^:|[+*?]+$)/g,""),b=(t[m].match(/[+*?]+$/)||Ju)[0]||"",P=~b.indexOf("+"),C=~b.indexOf("*"),z=i[m]||"";if(!z&&!C&&(b.indexOf("?")<0||P)){l=!1;break}if(a[v]=decodeURIComponent(z),P||C){a[v]=i.slice(m).map(decodeURIComponent).join("/");break}}else if(t[m]!==i[m]){l=!1;break}return n.default!==!0&&l===!1?!1:a}function Ku(i,t){return i.rank<t.rank?1:i.rank>t.rank?-1:i.index-t.index}function Qu(i,t){return i.index=t,i.rank=ic(i),i.props}function Qr(i){return i.replace(/(^\/+|\/+$)/g,"").split("/")}function tc(i){return i.charAt(0)==":"?1+"*+?".indexOf(i.charAt(i.length-1))||4:5}function ec(i){return Qr(i).map(tc).join("")}function ic(i){return i.props.default?0:ec(i.props.path)}var Zt=null,Be=[],Hn=[],nc={};function rc(i,t){t===void 0&&(t="push"),Zt&&Zt[t]?Zt[t](i):typeof history<"u"&&history[t+"State"]&&history[t+"State"](null,null,i)}function er(){var i;return Zt&&Zt.location?i=Zt.location:Zt&&Zt.getCurrentLocation?i=Zt.getCurrentLocation():i=typeof location<"u"?location:nc,""+(i.pathname||"")+(i.search||"")}function yo(i,t){return t===void 0&&(t=!1),typeof i!="string"&&i.url&&(t=i.replace,i=i.url),oc(i)&&rc(i,t?"replace":"push"),gh(i)}function oc(i){for(var t=Be.length;t--;)if(Be[t].canRoute(i))return!0;return!1}function gh(i){for(var t=!1,n=0;n<Be.length;n++)Be[n].routeTo(i)===!0&&(t=!0);for(var r=Hn.length;r--;)Hn[r](i);return t}function vh(i){if(!(!i||!i.getAttribute)){var t=i.getAttribute("href"),n=i.getAttribute("target");if(!(!t||!t.match(/^\//g)||n&&!n.match(/^_?self$/i)))return yo(t)}}function sc(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0))return vh(i.currentTarget||i.target||this),yh(i)}function yh(i){return i&&(i.stopImmediatePropagation&&i.stopImmediatePropagation(),i.stopPropagation&&i.stopPropagation(),i.preventDefault()),!1}function ac(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0)){var t=i.target;do if(String(t.nodeName).toUpperCase()==="A"&&t.getAttribute("href")){if(t.hasAttribute("native"))return;if(vh(t))return yh(i)}while(t=t.parentNode)}}var Ns=!1;function hc(){Ns||(typeof addEventListener=="function"&&(Zt||addEventListener("popstate",function(){gh(er())}),addEventListener("click",ac)),Ns=!0)}var ue=(function(i){function t(n){i.call(this,n),n.history&&(Zt=n.history),this.state={url:n.url||er()},hc()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.shouldComponentUpdate=function(r){return r.static!==!0?!0:r.url!==this.props.url||r.onChange!==this.props.onChange},t.prototype.canRoute=function(r){var s=Wn(this.props.children);return this.getMatchingChildren(s,r,!1).length>0},t.prototype.routeTo=function(r){this.setState({url:r});var s=this.canRoute(r);return this.updating||this.forceUpdate(),s},t.prototype.componentWillMount=function(){Be.push(this),this.updating=!0},t.prototype.componentDidMount=function(){var r=this;Zt&&(this.unlisten=Zt.listen(function(s){r.routeTo(""+(s.pathname||"")+(s.search||""))})),this.updating=!1},t.prototype.componentWillUnmount=function(){typeof this.unlisten=="function"&&this.unlisten(),Be.splice(Be.indexOf(this),1)},t.prototype.componentWillUpdate=function(){this.updating=!0},t.prototype.componentDidUpdate=function(){this.updating=!1},t.prototype.getMatchingChildren=function(r,s,a){return r.filter(Qu).sort(Ku).map(function(l){var u=vo(s,l.props.path,l.props);if(u){if(a!==!1){var c={url:s,matches:u};return _h(c,u),delete c.ref,delete c.key,ph(l,c)}return l}}).filter(Boolean)},t.prototype.render=function(r,s){var a=r.children,l=r.onChange,u=s.url,c=this.getMatchingChildren(Wn(a),u,!0),d=c[0]||null,p=this.previousUrl;return u!==p&&(this.previousUrl=u,typeof l=="function"&&l({router:this,url:u,previous:p,active:c,current:d})),d},t})(ii),wh=function(i){return oi("a",_h({onClick:sc},i))},xh=function(i){return oi(i.component,i)};ue.subscribers=Hn;ue.getCurrentUrl=er;ue.route=yo;ue.Router=ue;ue.Route=xh;ue.Link=wh;ue.exec=vo;const lc=Object.freeze(Object.defineProperty({__proto__:null,Link:wh,Route:xh,Router:ue,default:ue,exec:vo,getCurrentUrl:er,route:yo,subscribers:Hn},Symbol.toStringTag,{value:"Module"})),uc=go(lc);var Fs;function cc(){if(Fs)return Me;Fs=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.Link=Me.Match=void 0;var i=Object.assign||function(d){for(var p=1;p<arguments.length;p++){var m=arguments[p];for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&(d[v]=m[v])}return d},t=qu,n=uc;function r(d,p){var m={};for(var v in d)p.indexOf(v)>=0||Object.prototype.hasOwnProperty.call(d,v)&&(m[v]=d[v]);return m}function s(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function a(d,p){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:d}function l(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(d,p):d.__proto__=p)}var u=Me.Match=(function(d){l(p,d);function p(){var m,v,b;s(this,p);for(var P=arguments.length,C=Array(P),z=0;z<P;z++)C[z]=arguments[z];return b=(m=(v=a(this,d.call.apply(d,[this].concat(C))),v),v.update=function(I){v.nextUrl=I,v.setState({})},m),a(v,b)}return p.prototype.componentDidMount=function(){n.subscribers.push(this.update)},p.prototype.componentWillUnmount=function(){n.subscribers.splice(n.subscribers.indexOf(this.update)>>>0,1)},p.prototype.render=function(v){var b=this.nextUrl||(0,n.getCurrentUrl)(),P=b.replace(/\?.+$/,"");return this.nextUrl=null,v.children({url:b,path:P,matches:(0,n.exec)(P,v.path,{})!==!1})},p})(t.Component),c=function(p){var m=p.activeClassName,v=p.path,b=r(p,["activeClassName","path"]);return(0,t.h)(u,{path:v||b.href},function(P){var C=P.matches;return(0,t.h)(n.Link,i({},b,{class:[b.class||b.className,C&&m].filter(Boolean).join(" ")}))})};return Me.Link=c,Me.default=u,u.Link=c,Me}var fc=cc();const dc="_header_19max_1",pc="_nav_19max_14",mc="_github_19max_19",_c="_logo_19max_26",gc="_active_19max_66",bi={header:dc,nav:pc,github:mc,logo:_c,active:gc},vc=""+new URL("logo-DQvm3LRv.png",import.meta.url).href,yc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",wc=()=>et("header",{class:bi.header,children:[et("div",{class:bi.nav,children:[et("img",{class:bi.logo,src:vc}),et("nav",{children:et(fc.Link,{activeClassName:bi.active,href:"/",children:"Home"})})]}),et("div",{class:bi.github,children:et("a",{href:"https://www.github.com/JamesLMilner/terra-draw",children:et("img",{src:yc})})})]}),xc="_home_tzwl9_1",bc="_map_tzwl9_7",Mc="_helpOverlay_tzwl9_14",Pc="_helpHeader_tzwl9_27",Lc="_helpTitle_tzwl9_35",Sc="_helpClose_tzwl9_40",Ec="_helpBody_tzwl9_55",Cc="_helpHint_tzwl9_74",kc="_loading_tzwl9_131",me={home:xc,map:bc,helpOverlay:Mc,helpHeader:Pc,helpTitle:Lc,helpClose:Sc,helpBody:Ec,helpHint:Cc,loading:kc};var Qi,wt,Ar,Rs,Hi=0,bh=[],Bn=[],Zs=rt.__b,Ys=rt.__r,Xs=rt.diffed,Us=rt.__c,js=rt.unmount;function ir(i,t){rt.__h&&rt.__h(wt,i,Hi||t),Hi=0;var n=wt.__H||(wt.__H={__:[],__h:[]});return i>=n.__.length&&n.__.push({__V:Bn}),n.__[i]}function _e(i){return Hi=1,Mh(Ph,i)}function Mh(i,t,n){var r=ir(Qi++,2);if(r.t=i,!r.__c&&(r.__=[Ph(void 0,t),function(a){var l=r.__N?r.__N[0]:r.__[0],u=r.t(l,a);l!==u&&(r.__N=[u,r.__[1]],r.__c.setState({}))}],r.__c=wt,!wt.u)){wt.u=!0;var s=wt.shouldComponentUpdate;wt.shouldComponentUpdate=function(a,l,u){if(!r.__c.__H)return!0;var c=r.__c.__H.__.filter(function(p){return p.__c});if(c.every(function(p){return!p.__N}))return!s||s.call(this,a,l,u);var d=!1;return c.forEach(function(p){if(p.__N){var m=p.__[0];p.__=p.__N,p.__N=void 0,m!==p.__[0]&&(d=!0)}}),!(!d&&r.__c.props===a)&&(!s||s.call(this,a,l,u))}}return r.__N||r.__}function Ws(i,t){var n=ir(Qi++,3);!rt.__s&&wo(n.__H,t)&&(n.__=i,n.i=t,wt.__H.__h.push(n))}function Tc(i,t){var n=ir(Qi++,4);!rt.__s&&wo(n.__H,t)&&(n.__=i,n.i=t,wt.__h.push(n))}function Dc(i){return Hi=5,Gi(function(){return{current:i}},[])}function Gi(i,t){var n=ir(Qi++,7);return wo(n.__H,t)?(n.__V=i(),n.i=t,n.__h=i,n.__V):n.__}function Ir(i,t){return Hi=8,Gi(function(){return i},t)}function Ac(){for(var i;i=bh.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(Nn),i.__H.__h.forEach(to),i.__H.__h=[]}catch(t){i.__H.__h=[],rt.__e(t,i.__v)}}rt.__b=function(i){wt=null,Zs&&Zs(i)},rt.__r=function(i){Ys&&Ys(i),Qi=0;var t=(wt=i.__c).__H;t&&(Ar===wt?(t.__h=[],wt.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=Bn,n.__N=n.i=void 0})):(t.__h.forEach(Nn),t.__h.forEach(to),t.__h=[])),Ar=wt},rt.diffed=function(i){Xs&&Xs(i);var t=i.__c;t&&t.__H&&(t.__H.__h.length&&(bh.push(t)!==1&&Rs===rt.requestAnimationFrame||((Rs=rt.requestAnimationFrame)||Ic)(Ac)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==Bn&&(n.__=n.__V),n.i=void 0,n.__V=Bn})),Ar=wt=null},rt.__c=function(i,t){t.some(function(n){try{n.__h.forEach(Nn),n.__h=n.__h.filter(function(r){return!r.__||to(r)})}catch(r){t.some(function(s){s.__h&&(s.__h=[])}),t=[],rt.__e(r,n.__v)}}),Us&&Us(i,t)},rt.unmount=function(i){js&&js(i);var t,n=i.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Nn(r)}catch(s){t=s}}),n.__H=void 0,t&&rt.__e(t,n.__v))};var Vs=typeof requestAnimationFrame=="function";function Ic(i){var t,n=function(){clearTimeout(r),Vs&&cancelAnimationFrame(t),setTimeout(i)},r=setTimeout(n,100);Vs&&(t=requestAnimationFrame(n))}function Nn(i){var t=wt,n=i.__c;typeof n=="function"&&(i.__c=void 0,n()),wt=t}function to(i){var t=wt;i.__c=i.__(),wt=t}function wo(i,t){return!i||i.length!==t.length||t.some(function(n,r){return n!==i[r]})}function Ph(i,t){return typeof t=="function"?t(i):t}function le(){return le=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},le.apply(null,arguments)}var eo;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(eo||(eo={}));const ge={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT_FEATURE_ID:"selectionPointFeatureId",SELECTION_POINT:"selectionPoint"},oe={MODE:"mode",CURRENTLY_DRAWING:"currentlyDrawing",EDITED:"edited",CLOSING_POINT:"closingPoint",SNAPPING_POINT:"snappingPoint",COORDINATE_POINT:"coordinatePoint",COORDINATE_POINT_FEATURE_ID:"coordinatePointFeatureId",COORDINATE_POINT_IDS:"coordinatePointIds",PROVISIONAL_COORDINATE_COUNT:"provisionalCoordinateCount",COMMITTED_COORDINATE_COUNT:"committedCoordinateCount",MARKER:"marker"};function Or(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function Hs(i){return!!(i&&typeof i=="object"&&"properties"in i&&typeof i.properties=="object"&&i.properties!==null&&"mode"in i.properties)}function Gs(i){return!!(function(t){return typeof t=="number"&&!isNaN(new Date(t).valueOf())})(i)}const Oc="Feature mode property does not match the mode being added to";var si;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(si||(si={}));const zc={rightClick:!0,contextMenu:!1,leftClick:!0,onDragStart:!0,onDrag:!0,onDragEnd:!0};let Lh=class{get state(){return this._state}set state(t){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(t){if(typeof t!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=t}registerBehaviors(t){}constructor(t,n=!1){this._state="unregistered",this._styles={},this.pointerEvents=zc,this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.isInitialUpdate=!1,this.type=si.Drawing,this.mode="base",n?this.isInitialUpdate=!0:this.updateOptions(le({},t))}updateOptions(t){t!=null&&t.styles&&(this.styles=le({},this._styles,t.styles)),t!=null&&t.pointerDistance&&(this.pointerDistance=t.pointerDistance),t!=null&&t.validation&&(this.validate=t&&t.validation),t!=null&&t.projection&&(this.projection=t.projection),t?.pointerEvents!==void 0&&(this.pointerEvents=t.pointerEvents),t!=null&&t.modeName&&this.isInitialUpdate===!0&&(this.mode=t.modeName),this.isInitialUpdate=!1}allowPointerEvent(t,n){return typeof t=="boolean"?t:typeof t!="function"||t(n)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(t){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=t.store,this.store.registerOnChange(t.onChange),this.setDoubleClickToZoom=t.setDoubleClickToZoom,this.project=t.project,this.unproject=t.unproject,this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.setCursor=t.setCursor,this.onStyleChange=t.onChange,this.onFinish=t.onFinish,this.coordinatePrecision=t.coordinatePrecision,this.registerBehaviors({mode:t.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:t.coordinatePrecision,projection:this.projection})}validateFeature(t){return this.performFeatureValidation(t)}afterFeatureAdded(t){}afterFeatureUpdated(t){}performFeatureValidation(t){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=(function(r,s){let a;if(Or(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(Or(r.geometry))if(Or(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}})(t,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(t,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:eo.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(t,n){const r=this.performFeatureValidation(t);return r.valid?t.properties.mode!==this.mode?{valid:!1,reason:Oc}:n(t):{valid:!1,reason:r.reason}}onFinish(t,n){}onDeselect(t){}onSelect(t){}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){}onClick(t){}onDragStart(t,n){}onDrag(t,n){}onDragEnd(t,n){}getHexColorStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getNumericStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getUrlStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getStylingValue(t,n,r){return t===void 0?n:typeof t=="function"?t(r):t}};function Bc(i,t){const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3}function Gn(i,t=9){const n=Math.pow(10,t);return Math.round(i*n)/n}const $s=57.29577951308232,qs=.017453292519943295,$n=6378137,xo=(i,t)=>({x:i===0?0:i*qs*$n,y:t===0?0:Math.log(Math.tan(Math.PI/4+t*qs/2))*$n}),io=(i,t)=>({lng:i===0?0:$s*(i/$n),lat:t===0?0:(2*Math.atan(Math.exp(t/$n))-Math.PI/2)*$s});function bo(i,t){return Js(i[0])<=t&&Js(i[1])<=t}function Mo(i){return i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"&&i[0]!==1/0&&i[1]!==1/0&&(n=i[0])>=-180&&n<=180&&(t=i[1])>=-90&&t<=90;var t,n}function Js(i){let t=1,n=0;for(;Math.round(i*t)/t!==i;)t*=10,n++;return n}const Nc="Feature has holes",Fc="Feature has less than 4 coordinates",Rc="Feature has invalid coordinates",Zc="Feature coordinates are not closed";function Yc(i,t){if(i.geometry.type!=="Polygon")return{valid:!1,reason:"Feature is not a Polygon"};if(i.geometry.coordinates.length!==1)return{valid:!1,reason:Nc};if(i.geometry.coordinates[0].length<4)return{valid:!1,reason:Fc};for(let s=0;s<i.geometry.coordinates[0].length;s++){if(!Mo(i.geometry.coordinates[0][s]))return{valid:!1,reason:Rc};if(!bo(i.geometry.coordinates[0][s],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return(n=i.geometry.coordinates[0][0])[0]!==(r=i.geometry.coordinates[0][i.geometry.coordinates[0].length-1])[0]||n[1]!==r[1]?{valid:!1,reason:Zc}:{valid:!0};var n,r}const no=(i,t)=>{const{x:n,y:r}=i,{x:s,y:a}=t,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};function Xc({unproject:i,point:t,pointerDistance:n}){const r=n/2,{x:s,y:a}=t;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[i(s-r,a-r),i(s+r,a-r),i(s+r,a+r),i(s-r,a+r),i(s-r,a-r)].map(l=>[l.lng,l.lat])]}}}function Uc(i,t){if(i.geometry.type!=="LineString")return{valid:!1,reason:"Feature is not a LineString"};if(i.geometry.coordinates.length<2)return{valid:!1,reason:"Feature has less than 2 coordinates"};for(let n=0;n<i.geometry.coordinates.length;n++){if(!Mo(i.geometry.coordinates[n]))return{valid:!1,reason:"Feature has invalid coordinates"};if(!bo(i.geometry.coordinates[n],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return{valid:!0}}const jc="Feature is not a Point",Wc="Feature has invalid coordinates",Vc="Feature has coordinates with excessive precision";function Hc(i,t){return i.geometry.type!=="Point"?{valid:!1,reason:jc}:Mo(i.geometry.coordinates)?bo(i.geometry.coordinates,t)?{valid:!0}:{valid:!1,reason:Vc}:{valid:!1,reason:Wc}}class Gc extends Lh{constructor(t){if(!t.modeName)throw new Error("Mode name is required for TerraDrawRenderMode");super(t,!0),this.type=si.Render,this.mode="render",this.updateOptions(t)}updateOptions(t){super.updateOptions(t)}registerBehaviors(t){this.mode=t.mode}start(){this.setStarted()}stop(){this.setStopped()}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(t){return{pointColor:this.getHexColorStylingValue(this.styles.pointColor,"#3f97e0",t),pointWidth:this.getNumericStylingValue(this.styles.pointWidth,6,t),pointOutlineColor:this.getHexColorStylingValue(this.styles.pointOutlineColor,"#ffffff",t),pointOutlineWidth:this.getNumericStylingValue(this.styles.pointOutlineWidth,0,t),polygonFillColor:this.getHexColorStylingValue(this.styles.polygonFillColor,"#3f97e0",t),polygonFillOpacity:this.getNumericStylingValue(this.styles.polygonFillOpacity,.3,t),polygonOutlineColor:this.getHexColorStylingValue(this.styles.polygonOutlineColor,"#3f97e0",t),polygonOutlineWidth:this.getNumericStylingValue(this.styles.polygonOutlineWidth,4,t),lineStringWidth:this.getNumericStylingValue(this.styles.lineStringWidth,4,t),lineStringColor:this.getHexColorStylingValue(this.styles.lineStringColor,"#3f97e0",t),zIndex:this.getNumericStylingValue(this.styles.zIndex,0,t)}}validateFeature(t){const n=super.validateFeature(t);if(n.valid){const r=t,s=Hc(r,this.coordinatePrecision).valid||Yc(r,this.coordinatePrecision).valid||Uc(r,this.coordinatePrecision).valid;return s?{valid:!0}:{valid:s,reason:"Feature is not a valid Point, Polygon or LineString feature"}}return n}}function $c(i,t){let n=!1;for(let l=0,u=t.length;l<u;l++){const c=t[l];for(let d=0,p=c.length,m=p-1;d<p;m=d++)(s=c[d])[1]>(r=i)[1]!=(a=c[m])[1]>r[1]&&r[0]<(a[0]-s[0])*(r[1]-s[1])/(a[1]-s[1])+s[0]&&(n=!n)}var r,s,a;return n}const Ks=(i,t,n)=>{const r=a=>a*a,s=(a,l)=>r(a.x-l.x)+r(a.y-l.y);return Math.sqrt(((a,l,u)=>{const c=s(l,u);if(c===0)return s(a,l);let d=((a.x-l.x)*(u.x-l.x)+(a.y-l.y)*(u.y-l.y))/c;return d=Math.max(0,Math.min(1,d)),s(a,{x:l.x+d*(u.x-l.x),y:l.y+d*(u.y-l.y)})})(i,t,n))},qc=(i,t)=>{if(t===0||t===360||t===-360)return i;const n=.017453292519943295*t,r=(i.geometry.type==="Polygon"?i.geometry.coordinates[0]:i.geometry.coordinates).map(([l,u])=>xo(l,u)),s=r.reduce((l,u)=>({x:l.x+u.x,y:l.y+u.y}),{x:0,y:0});s.x/=r.length,s.y/=r.length;const a=r.map(l=>({x:s.x+(l.x-s.x)*Math.cos(n)-(l.y-s.y)*Math.sin(n),y:s.y+(l.x-s.x)*Math.sin(n)+(l.y-s.y)*Math.cos(n)})).map(({x:l,y:u})=>[io(l,u).lng,io(l,u).lat]);return i.geometry.type==="Polygon"?i.geometry.coordinates[0]=a:i.geometry.coordinates=a,i};function Jc({coordinates:i,originX:t,originY:n,xScale:r,yScale:s}){r===1&&s===1||i.forEach(a=>{const{x:l,y:u}=xo(a[0],a[1]),c=t+(l-t)*r,d=n+(u-n)*s,{lng:p,lat:m}=io(c,d);a[0]=p,a[1]=m})}let Kc=class extends Lh{constructor(...t){super(...t),this.type=si.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return le({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0,markerUrl:void 0,markerHeight:void 0,markerWidth:void 0})}};function Sh(i,t,n,r,s){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,p=Math.log(c),m=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*m*(c-m)/c)*(d-c/2<0?-1:1);Sh(i,t,Math.max(n,Math.floor(t-d*m/c+v)),Math.min(r,Math.floor(t+(c-d)*m/c+v)),s)}const a=i[t];let l=n,u=r;for(Mi(i,n,t),s(i[r],a)>0&&Mi(i,n,r);l<u;){for(Mi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?Mi(i,n,u):(u++,Mi(i,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}function Mi(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}function He(i,t){Ii(i,0,i.children.length,t,i)}function Ii(i,t,n,r,s){s||(s=Qe([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<n;a++){const l=i.children[a];Oi(s,i.leaf?r(l):l)}return s}function Oi(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Qc(i,t){return i.minX-t.minX}function tf(i,t){return i.minY-t.minY}function zr(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Ln(i){return i.maxX-i.minX+(i.maxY-i.minY)}function ef(i,t){const n=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function Br(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Sn(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function Qe(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Qs(i,t,n,r,s){const a=[t,n];for(;a.length;){if((n=a.pop())-(t=a.pop())<=r)continue;const l=t+Math.ceil((n-t)/r/2)*r;Sh(i,l,t,n,s),a.push(t,l,l,n)}}class nf{constructor(t){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(t){let n=this.data;const r=[];if(!Sn(t,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],c=n.leaf?s(u):u;Sn(t,c)&&(n.leaf?r.push(u):Br(t,c)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(t){let n=this.data;if(Sn(t,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(Sn(t,l)){if(n.leaf||Br(t,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(t){if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(t){this._insert(t,this.data.height-1)}clear(){this.data=Qe([])}remove(t){let n=this.data;const r=this.toBBox(t),s=[],a=[];let l,u,c=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),c=!0),n.leaf){const d=n.children.indexOf(t);d!==-1&&(n.children.splice(d,1),s.push(n),this._condense(s))}c||n.leaf||!Br(n,r)?u?(l++,n=u.children[l],c=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=Qe(t.slice(n,r+1)),He(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=Qe([]),l.leaf=!1,l.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));Qs(t,n,r,d,this.compareMinX);for(let p=n;p<=r;p+=d){const m=Math.min(p+d-1,r);Qs(t,p,m,c,this.compareMinY);for(let v=p;v<=m;v+=c){const b=Math.min(v+c-1,m);l.children.push(this._build(t,v,b,s-1))}}return He(l,this.toBBox),l}_chooseSubtree(t,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,c=1/0,d=1/0;for(let p=0;p<n.children.length;p++){const m=n.children[p],v=zr(m),b=(a=t,l=m,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-v);b<d?(d=b,c=v<c?v:c,u=m):b===d&&v<c&&(c=v,u=m)}n=u||n.children[0]}var a,l;return n}_insert(t,n,r){const s=r?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(t),Oi(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(t,n){const r=t[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=Qe(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,He(r,this.toBBox),He(u,this.toBBox),n?t[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(t,n){this.data=Qe([t,n]),this.data.height=t.height+1,this.data.leaf=!1,He(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const c=Ii(t,0,u,this.toBBox),d=Ii(t,u,r,this.toBBox),p=ef(c,d),m=zr(c)+zr(d);p<a?(a=p,s=u,l=m<l?m:l):p===a&&m<l&&(l=m,s=u)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:Qc,a=t.leaf?this.compareMinY:tf;this._allDistMargin(t,n,r,s)<this._allDistMargin(t,n,r,a)&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const a=this.toBBox,l=Ii(t,0,n,a),u=Ii(t,r-n,r,a);let c=Ln(l)+Ln(u);for(let d=n;d<r-n;d++){const p=t.children[d];Oi(l,t.leaf?a(p):p),c+=Ln(l)}for(let d=r-n-1;d>=n;d--){const p=t.children[d];Oi(u,t.leaf?a(p):p),c+=Ln(u)}return c}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Oi(n[s],t)}_condense(t){for(let n,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(n=t[r-1].children,n.splice(n.indexOf(t[r]),1)):this.clear():He(t[r],this.toBBox)}}class rf{constructor(t){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new nf(t&&t.maxEntries?t.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(t,n){this.idToNode.set(t.id,n),this.nodeToId.set(n,t.id)}toBBox(t){const n=[],r=[];let s;if(t.geometry.type==="Polygon")s=t.geometry.coordinates[0];else if(t.geometry.type==="LineString")s=t.geometry.coordinates;else{if(t.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[t.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(t){if(this.idToNode.get(String(t.id)))throw new Error("Feature already exists");const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}load(t){const n=[],r=new Set;t.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(t){this.remove(t.id);const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}remove(t){const n=this.idToNode.get(t);if(!n)throw new Error(`${t} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(t){return this.tree.search(this.toBBox(t)).map(n=>this.nodeToId.get(n))}collides(t){return this.tree.collides(this.toBBox(t))}}const of={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=16*Math.random()|0;return(i=="x"?t:3&t|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36},ta={target:"geometry"},ea={target:"properties"};let sf=class{constructor(t){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new rf,this.tracked=!t||t.tracked!==!1,this.idStrategy=t&&t.idStrategy?t.idStrategy:of}clone(t){return JSON.parse(JSON.stringify(t))}getId(){return this.idStrategy.getId()}has(t){return!!this.store[t]}load(t,n,r,s){if(t.length===0)return[];let a=this.clone(t);const l=[],u=[];a=a.filter(d=>{d.id==null&&(d.id=this.idStrategy.getId());const p=d.id;if(n){const m=n(d);if(!m.valid)return l.push({id:p,valid:!1,reason:m.reason}),!1}if(this.tracked){if(d.properties.createdAt){if(!Gs(d.properties.createdAt))return l.push({id:d.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else d.properties.createdAt=+new Date;if(d.properties.updatedAt){if(!Gs(d.properties.updatedAt))return l.push({id:d.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else d.properties.updatedAt=+new Date}return this.has(p)?(l.push({id:p,valid:!1,reason:`Feature already exists with this id: ${p}`}),!1):(this.store[p]=d,u.push(d),l.push({id:p,valid:!0}),!0)}),this.spatialIndex.load(a);const c=u.map(({id:d})=>d);return c.length>0&&(this._onChange(c,"create",s),r&&u.forEach(d=>{r(d)})),l}search(t,n){const r=this.spatialIndex.search(t).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(t){this._onChange=(n,r,s)=>{t(n,r,s)}}getGeometryCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get properties copy`);return this.clone(n.properties)}updateProperty(t,n){const r=new Set;t.forEach(({id:s,property:a,value:l})=>{const u=this.store[s];if(!u)throw new Error(`No feature with this (${s}), can not update geometry`);u.properties[a]!==l&&(r.add(s),l===void 0?delete u.properties[a]:u.properties[a]=l,this.tracked&&(u.properties.updatedAt=+new Date))}),this._onChange&&r.size>0&&this._onChange(Array.from(r),"update",n?le({},n,ea):ea)}updateGeometry(t,n){const r=new Set;t.forEach(({id:s,geometry:a})=>{r.add(s);const l=this.store[s];if(!l)throw new Error(`No feature with this (${s}), can not update geometry`);l.geometry=this.clone(a),this.spatialIndex.update(l),this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&r.size>0&&this._onChange(Array.from(r),"update",n?le({},n,ta):ta)}create(t,n){const r=[];return t.forEach(({geometry:s,properties:a})=>{let l,u=le({},a);this.tracked&&(l=+new Date,a?(u.createdAt=typeof a.createdAt=="number"?a.createdAt:l,u.updatedAt=typeof a.updatedAt=="number"?a.updatedAt:l):u={createdAt:l,updatedAt:l});const c=this.getId(),d={id:c,type:"Feature",geometry:s,properties:u};this.store[c]=d,this.spatialIndex.insert(d),r.push(c)}),this._onChange&&this._onChange([...r],"create",n),r}delete(t,n){t.forEach(r=>{if(!this.store[r])throw new Error(`No feature with id ${r}, can not delete`);delete this.store[r],this.spatialIndex.remove(r)}),this._onChange&&this._onChange([...t],"delete",n)}copy(t){return this.clone(this.store[t])}copyAll(){return this.clone(Object.keys(this.store).map(t=>this.store[t]))}copyAllWhere(t){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&t(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}};class Ge{constructor({name:t,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=t,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}}var af={__proto__:null,TerraDrawBaseAdapter:class{constructor(i){this._nextKeyUpIsContextMenu=!1,this._lastPointerDownEventTarget=void 0,this._ignoreMismatchedPointerEvents=!1,this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._ignoreMismatchedPointerEvents=typeof i.ignoreMismatchedPointerEvents=="boolean"&&i.ignoreMismatchedPointerEvents,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const t=this.getMapEventElement(i.type),{left:n,top:r}=t.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i,t=!1){const n=this.getLngLatFromEvent(i);if(!n)return null;const{lng:r,lat:s}=n,{containerX:a,containerY:l}=this.getMapElementXYPosition(i),u=this.getButton(i),c=Array.from(this._heldKeys);return{lng:Gn(r,this._coordinatePrecision),lat:Gn(s,this._coordinatePrecision),containerX:a,containerY:l,button:u,heldKeys:c,isContextMenu:t}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(t=>{t.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new Ge({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t,this._lastPointerDownEventTarget=i.target?i.target:void 0)},register:i=>{this.getMapEventElement("pointerdown").addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement("pointerdown").removeEventListener("pointerdown",i)}}),new Ge({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const t=this.getDrawEventFromEvent(i);if(t)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:t.containerX,y:t.containerY},s=this._currentModeCallbacks.getState(),a=no(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._nextKeyUpIsContextMenu=!1,this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(t,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement("pointermove").addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement("pointermove").removeEventListener("pointermove",i)}}),new Ge({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&(i.preventDefault(),this._nextKeyUpIsContextMenu=!0)},register:i=>{this.getMapEventElement("contextmenu").addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement("contextmenu").removeEventListener("contextmenu",i)}}),new Ge({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement("pointerup")||this._ignoreMismatchedPointerEvents&&this._lastPointerDownEventTarget!==i.target||(this._lastPointerDownEventTarget=void 0,!i.isPrimary))return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(t,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||(this._nextKeyUpIsContextMenu&&(t.isContextMenu=!0,this._nextKeyUpIsContextMenu=!1),this._currentModeCallbacks.onClick(t)),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement("pointerup").addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement("pointerup").removeEventListener("pointerup",i)}}),new Ge({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement("keyup").addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement("keyup").removeEventListener("keyup",i)}}),new Ge({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement("keydown").addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement("keydown").removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear(),this._currentModeCallbacks=void 0,this._lastDrawEvent=void 0,this._lastPointerDownEventTarget=void 0,this._nextKeyUpIsContextMenu=!1}}};function ro(i){if(i===null||typeof i=="boolean"||typeof i=="string")return!0;if(i===void 0)return!1;if(typeof i=="number")return Number.isFinite(i);if(typeof i=="bigint"||typeof i=="symbol"||typeof i=="function"||i instanceof RegExp||i instanceof Map||i instanceof Set||i instanceof Date)return!1;if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const t=Object.getPrototypeOf(i);if(t!==Object.prototype&&t!==null)return!1}if(ArrayBuffer.isView(i)&&!(i instanceof DataView))return!1;if(Array.isArray(i)){for(const t of i)if(!ro(t))return!1}return typeof i=="object"&&Object.keys(i).every(t=>typeof t=="string"&&ro(i[t]))}class hf{constructor(t){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=t.adapter,this._mode=new Kc;const n=new Set,r=t.modes.reduce((p,m)=>{if(n.has(m.mode))throw new Error(`There is already a ${m.mode} mode provided`);return n.add(m.mode),p[m.mode]=m,p},{}),s=Object.keys(r);if(s.length===0)throw new Error("No modes provided");s.forEach(p=>{if(r[p].type===si.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=p}}),this._modes=le({},r,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new sf({tracked:!!t.tracked,idStrategy:t.idStrategy?t.idStrategy:void 0});const a=p=>{const m=[],v=this._store.copyAll().filter(b=>!p.includes(b.id)||(m.push(b),!1));return{changed:m,unchanged:v}},l=(p,m)=>{this._enabled&&this._eventListeners.finish.forEach(v=>{v(p,m)})},u=(p,m,v)=>{if(!this._enabled)return;this._eventListeners.change.forEach(C=>{C(p,m,v)});const{changed:b,unchanged:P}=a(p);m==="create"?this._adapter.render({created:b,deletedIds:[],unchanged:P,updated:[]},this.getModeStyles()):m==="update"?this._adapter.render({created:[],deletedIds:[],unchanged:P,updated:b},this.getModeStyles()):m==="delete"?this._adapter.render({created:[],deletedIds:p,unchanged:P,updated:[]},this.getModeStyles()):m==="styling"&&this._adapter.render({created:[],deletedIds:[],unchanged:P,updated:[]},this.getModeStyles())},c=p=>{if(!this._enabled)return;this._eventListeners.select.forEach(b=>{b(p)});const{changed:m,unchanged:v}=a([p]);this._adapter.render({created:[],deletedIds:[],unchanged:v,updated:m},this.getModeStyles())},d=p=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(b=>{b()});const{changed:m,unchanged:v}=a([p]);m&&this._adapter.render({created:[],deletedIds:[],unchanged:v,updated:m},this.getModeStyles())};Object.keys(this._modes).forEach(p=>{this._modes[p].register({mode:p,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:u,onSelect:c,onDeselect:d,onFinish:l,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const t={};return Object.keys(this._modes).forEach(n=>{t[n]=r=>this._instanceSelectMode&&r.properties[ge.SELECTED]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(r):this._modes[n].styleFeature.bind(this._modes[n])(r)}),t}featuresAtLocation({lng:t,lat:n},r){const s=r&&r.pointerDistance!==void 0?r.pointerDistance:30,a=!r||r.ignoreSelectFeatures===void 0||r.ignoreSelectFeatures,l=!(!r||r.ignoreCoordinatePoints===void 0)&&r.ignoreCoordinatePoints,u=!(!r||r.ignoreCurrentlyDrawing===void 0)&&r.ignoreCurrentlyDrawing,c=!(!r||r.ignoreClosingPoints===void 0)&&r.ignoreClosingPoints,d=!(!r||r.ignoreSnappingPoints===void 0)&&r.ignoreSnappingPoints,p=this._adapter.unproject.bind(this._adapter),m=this._adapter.project.bind(this._adapter),v=m(t,n),b=Xc({unproject:p,point:v,pointerDistance:s});return this._store.search(b).filter(P=>{if(a&&(P.properties[ge.MID_POINT]||P.properties[ge.SELECTION_POINT])||l&&P.properties[oe.COORDINATE_POINT]||c&&P.properties[oe.CLOSING_POINT]||u&&P.properties[oe.CURRENTLY_DRAWING]||d&&P.properties[oe.SNAPPING_POINT])return!1;if(P.geometry.type==="Point"){const C=P.geometry.coordinates,z=m(C[0],C[1]);return no(v,z)<s}if(P.geometry.type==="LineString"){const C=P.geometry.coordinates;for(let z=0;z<C.length-1;z++){const I=C[z],g=C[z+1];if(Ks(v,m(I[0],I[1]),m(g[0],g[1]))<s)return!0}return!1}if($c([t,n],P.geometry.coordinates))return!0;if(r!=null&&r.includePolygonsWithinPointerDistance){const C=P.geometry.coordinates;for(const z of C)for(let I=0;I<z.length-1;I++){const g=z[I],w=z[I+1],y=m(g[0],g[1]),S=m(w[0],w[1]);if(Ks(v,y,S)<s)return!0}}return!1}).map(P=>{if(r==null||!r.addClosestCoordinateInfoToProperties)return P;let C;if(P.geometry.type==="Polygon")C=P.geometry.coordinates[0].slice(0,-1);else{if(P.geometry.type!=="LineString")return P;C=P.geometry.coordinates}let z,I=-1,g=1/0;for(let w=0;w<C.length;w++){const y=C[w],S=no(m(y[0],y[1]),v);S<g&&(I=w,g=S,z=y)}return P.properties.closestCoordinateIndexToEvent=I,P.properties.closestCoordinatePixelDistanceToEvent=g,P.properties.closestCoordinateDistanceKmToEvent=Bc(z,[t,n]),P})}getSelectModeOrThrow(){const t=this.getSelectMode({switchToSelectMode:!0});if(!t)throw new Error("No select mode defined in instance");return t}getSelectMode({switchToSelectMode:t}){if(this.checkEnabled(),!this._instanceSelectMode)return null;const n=this.getMode();return t&&n!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}isGuidanceFeature(t){return!!(t.properties[ge.MID_POINT]||t.properties[ge.SELECTION_POINT]||t.properties[oe.COORDINATE_POINT]||t.properties[oe.SNAPPING_POINT])}setModeStyles(t,n){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._modes[t].styles=n}updateModeOptions(t,n){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._modes[t].updateOptions(n)}getSnapshot(){return this._store.copyAll()}getSnapshotFeature(t){if(this._store.has(t))return this._store.copy(t)}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(t){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}getModeState(){return this._mode.state}setMode(t){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[t],this._mode.start()}removeFeatures(t){this.checkEnabled();const n=[],r=[];let s;t.forEach(a=>{if(!this._store.has(a))throw new Error(`No feature with id ${a}, can not delete`);const l=this._store.getPropertiesCopy(a);l[ge.SELECTED]&&this.deselectFeature(a),l[oe.CURRENTLY_DRAWING]&&this._modes[l.mode]?s=l.mode:(l[oe.COORDINATE_POINT_IDS]&&n.push(...l[oe.COORDINATE_POINT_IDS]),r.push(a))}),this._store.delete([...r,...n],{origin:"api"}),s&&this._modes[s]&&this._modes[s].cleanUp()&&this._modes[s].cleanUp()}selectFeature(t){this.getSelectModeOrThrow().selectFeature(t)}deselectFeature(t){this.getSelectModeOrThrow().deselectFeature(t)}getFeatureId(){return this._store.getId()}hasFeature(t){return this._store.has(t)}checkIsReservedProperty(t){return![...Object.values(ge),...Object.values(oe)].includes(t)}updateFeatureProperties(t,n){if(!this._store.has(t))throw new Error(`No feature with id ${t} present in store`);const r=this._store.copy(t);if(this.isGuidanceFeature(r))throw new Error("Guidance features are not allowed to be updated directly.");const s=r.properties.mode;if(!this._modes[s])throw new Error(`No mode with name ${s} present in instance`);const a=Object.entries(n);a.forEach(([l,u])=>{if(!this.checkIsReservedProperty(l))throw new Error(`You are trying to update a reserved property name: ${l}. Please choose another name.`);if(u!==void 0&&!ro(u))throw new Error(`Invalid JSON value provided for property ${l}`)}),this._store.updateProperty(a.map(([l,u])=>({id:r.id,property:l,value:u})),{origin:"api"})}updateFeatureGeometry(t,n){if(!this._store.has(t))throw new Error(`No feature with id ${t} present in store`);const r=this._store.copy(t);if(this.isGuidanceFeature(r))throw new Error("Guidance features are not allowed to be updated directly.");if(!(r&&n&&n.type&&n.coordinates))throw new Error("Invalid geometry provided");if(n.type!==r.geometry.type)throw new Error(`Geometry type mismatch: expected ${r.geometry.type}, got ${n.type}`);const s=r.properties.mode,a=this._modes[s];if(!a)throw new Error(`No mode with name ${s} present in instance`);const l=le({},r,{geometry:n}),u=a.validateFeature(l);if(!u.valid)throw new Error(`Feature validation failed: ${u.reason||"Unknown reason"}`);if(this._store.updateGeometry([{id:r.id,geometry:n}],{origin:"api"}),a.afterFeatureUpdated){a.afterFeatureUpdated(l);const c=l.properties[ge.SELECTED],d=this.getSelectMode({switchToSelectMode:!1});d&&c&&d.afterFeatureUpdated(l)}}transformFeatureGeometry(t,n){if(!this._store.has(t))throw new Error(`No feature with id ${t} present in store`);let r=this._store.copy(t);if(this.isGuidanceFeature(r))throw new Error("Guidance features are not allowed to be updated directly.");const s=r.properties.mode,a=this._modes[s];if(!a)throw new Error(`No mode with name ${s} present in instance`);let l;if(r.geometry.type==="Polygon")l=r.geometry.coordinates[0];else{if(r.geometry.type!=="LineString")throw new Error(`Feature geometry type ${r.geometry.type} is not supported for transformation`);l=r.geometry.coordinates}if(n.projection!="web-mercator")throw new Error(`Projection ${n.projection} is not currently supported for transformation`);if(n.type==="scale"){const{x:u,y:c}=xo(n.origin[0],n.origin[1]);Jc({coordinates:l,originX:u,originY:c,xScale:n.options.xScale||1,yScale:n.options.yScale||1})}else n.type==="rotate"&&(r=qc(r,n.options.angle||0),l=r.geometry.type==="Polygon"?r.geometry.coordinates[0]:r.geometry.coordinates);if(l=l.map(u=>[Gn(u[0],this._adapter.getCoordinatePrecision()),Gn(u[1],this._adapter.getCoordinatePrecision())]),r.geometry.coordinates=r.geometry.type==="Polygon"?[l]:l,this._store.updateGeometry([{id:r.id,geometry:r.geometry}],{origin:"api"}),a.afterFeatureUpdated){a.afterFeatureUpdated(r);const u=r.properties[ge.SELECTED],c=this.getSelectMode({switchToSelectMode:!1});c&&u&&c.afterFeatureUpdated(r)}}addFeatures(t){return this.checkEnabled(),t.length===0?[]:this._store.load(t,n=>{if(Hs(n)){const r=n.properties.mode,s=this._modes[r];if(!s)return{id:n.id,valid:!1,reason:`${r} mode is not in the list of instantiated modes`};const a=s.validateFeature.bind(s)(n);return{id:n.id,valid:a.valid,reason:a.reason?a.reason:a.valid?void 0:"Feature is invalid"}}return{id:n.id,valid:!1,reason:"Mode property does not exist"}},n=>{if(Hs(n)){const r=this._modes[n.properties.mode];r&&r.afterFeatureAdded&&r.afterFeatureAdded(n)}},{origin:"api"})}start(){this._enabled||(this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(t=>{t()})},getState:()=>this._mode.state,onClick:t=>{this._mode.onClick(t)},onMouseMove:t=>{this._mode.onMouseMove(t)},onKeyDown:t=>{this._mode.onKeyDown(t)},onKeyUp:t=>{this._mode.onKeyUp(t)},onDragStart:(t,n)=>{this._mode.onDragStart(t,n)},onDrag:(t,n)=>{this._mode.onDrag(t,n)},onDragEnd:(t,n)=>{this._mode.onDragEnd(t,n)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}}))}getFeaturesAtLngLat(t,n){const{lng:r,lat:s}=t;return this.featuresAtLocation({lng:r,lat:s},n)}getFeaturesAtPointerEvent(t,n){const r=this._adapter.getLngLatFromEvent.bind(this._adapter)(t);return r===null?[]:this.featuresAtLocation(r,n)}stop(){this._enabled&&(this._enabled=!1,this._adapter.unregister())}on(t,n){const r=this._eventListeners[t];r.includes(n)||r.push(n)}off(t,n){const r=this._eventListeners[t];r.includes(n)&&r.splice(r.indexOf(n),1)}}let lf=class extends af.TerraDrawBaseAdapter{constructor(t){super(t),this._lib=void 0,this._map=void 0,this._panes={},this._container=void 0,this._layers={},this._lib=t.lib,this._map=t.map,this._container=this._map.getContainer()}createPaneStyleSheet(t,n){const r=document.createElement("style");return r.innerHTML=`.leaflet-${t}-pane {z-index: ${n+600}`,document.getElementsByTagName("head")[0].appendChild(r),this._map.createPane(t),r}clearPanes(){Object.values(this._panes).forEach(t=>{t&&t.remove()}),this._panes={}}clearLayers(){Object.values(this._layers).forEach(t=>{this._map.removeLayer(t)}),this._layers={}}styleGeoJSONLayer(t){return{pointToLayer:(n,r)=>{if(!n.properties)throw new Error("Feature has no properties");if(typeof n.properties.mode!="string")throw new Error("Feature mode is not a string");const s=(0,t[n.properties.mode])(n),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),this._lib.circleMarker(r,{radius:s.pointWidth,stroke:s.pointOutlineWidth||!1,color:s.pointOutlineColor,weight:s.pointOutlineWidth,fillOpacity:.8,fillColor:s.pointColor,pane:a,interactive:!1})},style:n=>{if(!n||!n.properties)return{};const r=n,s=(0,t[r.properties.mode])(r),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),r.geometry.type==="LineString"?{interactive:!1,color:s.lineStringColor,weight:s.lineStringWidth,pane:a}:r.geometry.type==="Polygon"?{interactive:!1,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,weight:s.polygonOutlineWidth,stroke:!0,color:s.polygonOutlineColor,pane:a}:{}}}}getLngLatFromEvent(t){const{containerX:n,containerY:r}=this.getMapElementXYPosition(t),s=this._map.containerPointToLatLng({x:n,y:r});return s.lng===null||isNaN(s.lng)||s.lat===null||isNaN(s.lat)?null:{lng:s.lng,lat:s.lat}}getMapEventElement(){return this._container}setDraggability(t){t?this._map.dragging.enable():this._map.dragging.disable()}project(t,n){const{x:r,y:s}=this._map.latLngToContainerPoint({lng:t,lat:n});return{x:r,y:s}}unproject(t,n){const{lng:r,lat:s}=this._map.containerPointToLatLng({x:t,y:n});return{lng:r,lat:s}}setCursor(t){t==="unset"?this.getMapEventElement().style.removeProperty("cursor"):this.getMapEventElement().style.cursor=t}setDoubleClickToZoom(t){t?this._map.doubleClickZoom.enable():this._map.doubleClickZoom.disable()}render(t,n){if(t.created.forEach(r=>{r.id&&(this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),t.deletedIds.forEach(r=>{this._layers[r]&&(this._map.removeLayer(this._layers[r]),delete this._layers[r])}),t.updated.forEach(r=>{r.id&&(this._layers[r.id]&&this._map.removeLayer(this._layers[r.id]),this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),t.created.length===0&&t.updated.length===0&&t.deletedIds.length===0){const r=[];Object.keys(this._layers).forEach(s=>{r.push(()=>{const a=this._layers[s],l=a.toGeoJSON();this._map.removeLayer(a);const u=this._lib.geoJSON(l,this.styleGeoJSONLayer(n));this._layers[s]=u,u.addTo(this._map),this._map.addLayer(this._layers[s])})}),setTimeout(()=>{r.forEach(s=>s())})}}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers(),this.clearPanes())}register(t){var n;super.register(t),(n=this._currentModeCallbacks)!=null&&n.onReady&&this._currentModeCallbacks.onReady()}getCoordinatePrecision(){return super.getCoordinatePrecision()}unregister(){return super.unregister()}};function qn(){return qn=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},qn.apply(null,arguments)}var oo;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(oo||(oo={}));const uf={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT:"selectionPoint"};function Nr(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function ia(i){return!!(function(t){return typeof t=="number"&&!isNaN(new Date(t).valueOf())})(i)}const cf="Feature mode property does not match the mode being added to";var Jn;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(Jn||(Jn={}));let Eh=class{get state(){return this._state}set state(t){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(t){if(typeof t!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=t}registerBehaviors(t){}constructor(t,n=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=Jn.Drawing,this.mode="base",n||this.updateOptions(t)}updateOptions(t){t!=null&&t.styles&&(this.styles=qn({},this._styles,t.styles)),t!=null&&t.pointerDistance&&(this.pointerDistance=t.pointerDistance),t!=null&&t.validation&&(this.validate=t&&t.validation),t!=null&&t.projection&&(this.projection=t.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(t){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=t.store,this.store.registerOnChange(t.onChange),this.setDoubleClickToZoom=t.setDoubleClickToZoom,this.project=t.project,this.unproject=t.unproject,this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.setCursor=t.setCursor,this.onStyleChange=t.onChange,this.onFinish=t.onFinish,this.coordinatePrecision=t.coordinatePrecision,this.registerBehaviors({mode:t.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:t.coordinatePrecision,projection:this.projection})}validateFeature(t){return this.performFeatureValidation(t)}afterFeatureAdded(t){}performFeatureValidation(t){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=(function(r,s){let a;if(Nr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(Nr(r.geometry))if(Nr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}})(t,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(t,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:oo.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(t,n){const r=this.performFeatureValidation(t);return r.valid?t.properties.mode!==this.mode?{valid:!1,reason:cf}:n(t):{valid:!1,reason:r.reason}}onFinish(t,n){}onDeselect(t){}onSelect(t){}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){}onClick(t){}onDragStart(t,n){}onDrag(t,n){}onDragEnd(t,n){}getHexColorStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getNumericStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getStylingValue(t,n,r){return t===void 0?n:typeof t=="function"?t(r):t}},ff=class extends Eh{constructor(...t){super(...t),this.type=Jn.Select}};function na(i,t=9){const n=Math.pow(10,t);return Math.round(i*n)/n}const df=(i,t)=>{const{x:n,y:r}=i,{x:s,y:a}=t,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};function Ch(i,t,n,r,s){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,p=Math.log(c),m=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*m*(c-m)/c)*(d-c/2<0?-1:1);Ch(i,t,Math.max(n,Math.floor(t-d*m/c+v)),Math.min(r,Math.floor(t+(c-d)*m/c+v)),s)}const a=i[t];let l=n,u=r;for(Pi(i,n,t),s(i[r],a)>0&&Pi(i,n,r);l<u;){for(Pi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?Pi(i,n,u):(u++,Pi(i,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}function Pi(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}function $e(i,t){zi(i,0,i.children.length,t,i)}function zi(i,t,n,r,s){s||(s=ti([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<n;a++){const l=i.children[a];Bi(s,i.leaf?r(l):l)}return s}function Bi(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function pf(i,t){return i.minX-t.minX}function mf(i,t){return i.minY-t.minY}function Fr(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function En(i){return i.maxX-i.minX+(i.maxY-i.minY)}function _f(i,t){const n=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function Rr(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Cn(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function ti(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ra(i,t,n,r,s){const a=[t,n];for(;a.length;){if((n=a.pop())-(t=a.pop())<=r)continue;const l=t+Math.ceil((n-t)/r/2)*r;Ch(i,l,t,n,s),a.push(t,l,l,n)}}class gf{constructor(t){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(t){let n=this.data;const r=[];if(!Cn(t,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],c=n.leaf?s(u):u;Cn(t,c)&&(n.leaf?r.push(u):Rr(t,c)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(t){let n=this.data;if(Cn(t,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(Cn(t,l)){if(n.leaf||Rr(t,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(t){if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(t){this._insert(t,this.data.height-1)}clear(){this.data=ti([])}remove(t){let n=this.data;const r=this.toBBox(t),s=[],a=[];let l,u,c=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),c=!0),n.leaf){const d=n.children.indexOf(t);d!==-1&&(n.children.splice(d,1),s.push(n),this._condense(s))}c||n.leaf||!Rr(n,r)?u?(l++,n=u.children[l],c=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=ti(t.slice(n,r+1)),$e(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=ti([]),l.leaf=!1,l.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));ra(t,n,r,d,this.compareMinX);for(let p=n;p<=r;p+=d){const m=Math.min(p+d-1,r);ra(t,p,m,c,this.compareMinY);for(let v=p;v<=m;v+=c){const b=Math.min(v+c-1,m);l.children.push(this._build(t,v,b,s-1))}}return $e(l,this.toBBox),l}_chooseSubtree(t,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,c=1/0,d=1/0;for(let p=0;p<n.children.length;p++){const m=n.children[p],v=Fr(m),b=(a=t,l=m,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-v);b<d?(d=b,c=v<c?v:c,u=m):b===d&&v<c&&(c=v,u=m)}n=u||n.children[0]}var a,l;return n}_insert(t,n,r){const s=r?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(t),Bi(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(t,n){const r=t[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=ti(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,$e(r,this.toBBox),$e(u,this.toBBox),n?t[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(t,n){this.data=ti([t,n]),this.data.height=t.height+1,this.data.leaf=!1,$e(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const c=zi(t,0,u,this.toBBox),d=zi(t,u,r,this.toBBox),p=_f(c,d),m=Fr(c)+Fr(d);p<a?(a=p,s=u,l=m<l?m:l):p===a&&m<l&&(l=m,s=u)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:pf,a=t.leaf?this.compareMinY:mf;this._allDistMargin(t,n,r,s)<this._allDistMargin(t,n,r,a)&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const a=this.toBBox,l=zi(t,0,n,a),u=zi(t,r-n,r,a);let c=En(l)+En(u);for(let d=n;d<r-n;d++){const p=t.children[d];Bi(l,t.leaf?a(p):p),c+=En(l)}for(let d=r-n-1;d>=n;d--){const p=t.children[d];Bi(u,t.leaf?a(p):p),c+=En(u)}return c}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Bi(n[s],t)}_condense(t){for(let n,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(n=t[r-1].children,n.splice(n.indexOf(t[r]),1)):this.clear():$e(t[r],this.toBBox)}}class vf{constructor(t){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new gf(t&&t.maxEntries?t.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(t,n){this.idToNode.set(t.id,n),this.nodeToId.set(n,t.id)}toBBox(t){const n=[],r=[];let s;if(t.geometry.type==="Polygon")s=t.geometry.coordinates[0];else if(t.geometry.type==="LineString")s=t.geometry.coordinates;else{if(t.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[t.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(t){if(this.idToNode.get(String(t.id)))throw new Error("Feature already exists");const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}load(t){const n=[],r=new Set;t.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(t){this.remove(t.id);const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}remove(t){const n=this.idToNode.get(t);if(!n)throw new Error(`${t} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(t){return this.tree.search(this.toBBox(t)).map(n=>this.nodeToId.get(n))}collides(t){return this.tree.collides(this.toBBox(t))}}const yf={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=16*Math.random()|0;return(i=="x"?t:3&t|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36};class wf{constructor(t){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new vf,this.tracked=!t||t.tracked!==!1,this.idStrategy=t&&t.idStrategy?t.idStrategy:yf}clone(t){return JSON.parse(JSON.stringify(t))}getId(){return this.idStrategy.getId()}has(t){return!!this.store[t]}load(t,n,r){if(t.length===0)return[];let s=this.clone(t);const a=[],l=[];return s=s.filter(u=>{u.id==null&&(u.id=this.idStrategy.getId());const c=u.id;if(n){const d=n(u);if(!d.valid)return l.push({id:c,valid:!1,reason:d.reason}),!1}if(this.tracked){if(u.properties.createdAt){if(!ia(u.properties.createdAt))return l.push({id:u.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else u.properties.createdAt=+new Date;if(u.properties.updatedAt){if(!ia(u.properties.updatedAt))return l.push({id:u.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else u.properties.updatedAt=+new Date}return this.has(c)?(l.push({id:c,valid:!1,reason:`Feature already exists with this id: ${c}`}),!1):(this.store[c]=u,a.push(c),r&&r(u),l.push({id:c,valid:!0}),!0)}),this.spatialIndex.load(s),this._onChange(a,"create"),l}search(t,n){const r=this.spatialIndex.search(t).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(t){this._onChange=(n,r)=>{t(n,r)}}getGeometryCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get properties copy`);return this.clone(n.properties)}updateProperty(t){const n=[];t.forEach(({id:r,property:s,value:a})=>{const l=this.store[r];if(!l)throw new Error(`No feature with this (${r}), can not update geometry`);n.push(r),l.properties[s]=a,this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}updateGeometry(t){const n=[];t.forEach(({id:r,geometry:s})=>{n.push(r);const a=this.store[r];if(!a)throw new Error(`No feature with this (${r}), can not update geometry`);a.geometry=this.clone(s),this.spatialIndex.update(a),this.tracked&&(a.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}create(t){const n=[];return t.forEach(({geometry:r,properties:s})=>{let a,l=qn({},s);this.tracked&&(a=+new Date,s?(l.createdAt=typeof s.createdAt=="number"?s.createdAt:a,l.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:a):l={createdAt:a,updatedAt:a});const u=this.getId(),c={id:u,type:"Feature",geometry:r,properties:l};this.store[u]=c,this.spatialIndex.insert(c),n.push(u)}),this._onChange&&this._onChange([...n],"create"),n}delete(t){t.forEach(n=>{if(!this.store[n])throw new Error(`No feature with id ${n}, can not delete`);delete this.store[n],this.spatialIndex.remove(n)}),this._onChange&&this._onChange([...t],"delete")}copy(t){return this.clone(this.store[t])}copyAll(){return this.clone(Object.keys(this.store).map(t=>this.store[t]))}copyAllWhere(t){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&t(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class qe{constructor({name:t,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=t,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}}var kh={__proto__:null,GeoJSONStore:wf,TerraDrawBaseDrawMode:Eh,TerraDrawBaseSelectMode:ff,TerraDrawBaseAdapter:class{constructor(i){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const t=this.getMapEventElement(),{left:n,top:r}=t.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i){const t=this.getLngLatFromEvent(i);if(!t)return null;const{lng:n,lat:r}=t,{containerX:s,containerY:a}=this.getMapElementXYPosition(i),l=this.getButton(i),u=Array.from(this._heldKeys);return{lng:na(n,this._coordinatePrecision),lat:na(r,this._coordinatePrecision),containerX:s,containerY:a,button:l,heldKeys:u}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(t=>{t.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new qe({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t)},register:i=>{this.getMapEventElement().addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerdown",i)}}),new qe({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const t=this.getDrawEventFromEvent(i);if(t)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:t.containerX,y:t.containerY},s=this._currentModeCallbacks.getState(),a=df(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(t,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement().addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointermove",i)}}),new qe({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&i.preventDefault()},register:i=>{this.getMapEventElement().addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement().removeEventListener("contextmenu",i)}}),new qe({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement()||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(t,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(t),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement().addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerup",i)}}),new qe({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keyup",i)}}),new qe({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear()}},getDefaultStyling:()=>({polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0}),SELECT_PROPERTIES:uf};const xf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],bf=1,Li=8;class Mf{constructor(t,n=64,r=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=t,this.nodeSize=Math.min(Math.max(n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=xf.indexOf(this.ArrayType),l=t*2*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,Li,t),this.coords=new this.ArrayType(this.data,Li+u+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Li+l+u+c),this.ids=new this.IndexArrayType(this.data,Li,t),this.coords=new this.ArrayType(this.data,Li+u+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(bf<<4)+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return so(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function so(i,t,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;Th(i,t,l,r,s,a),so(i,t,n,r,l-1,1-a),so(i,t,n,l+1,s,1-a)}function Th(i,t,n,r,s,a){for(;s>r;){if(s-r>600){const d=s-r+1,p=n-r+1,m=Math.log(d),v=.5*Math.exp(2*m/3),b=.5*Math.sqrt(m*v*(d-v)/d)*(p-d/2<0?-1:1),P=Math.max(r,Math.floor(n-p*v/d+b)),C=Math.min(s,Math.floor(n+(d-p)*v/d+b));Th(i,t,n,P,C,a)}const l=t[2*n+a];let u=r,c=s;for(Si(i,t,r,n),t[2*s+a]>l&&Si(i,t,r,s);u<c;){for(Si(i,t,u,c),u++,c--;t[2*u+a]<l;)u++;for(;t[2*c+a]>l;)c--}t[2*r+a]===l?Si(i,t,r,c):(c++,Si(i,t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function Si(i,t,n,r){Zr(i,n,r),Zr(t,2*n,2*r),Zr(t,2*n+1,2*r+1)}function Zr(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}let Pf=class{constructor(t=[],n=(r,s)=>r<s?-1:r>s?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=(t<<1)+1;const u=l+1;if(u<this.length&&r(n[u],n[l])<0&&(l=u),r(n[l],a)>=0)break;n[t]=n[l],t=l}n[t]=a}};const Lf=6371,he=Math.PI/180;function Sf(i,t,n,r=1/0,s=1/0){let a=1;const l=[];r===void 0&&(r=1/0),s!==void 0&&(a=Oe(s/Lf));const u=new Pf([],Ef);let c={left:0,right:i.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const d=Math.cos(n*he);for(;c;){const p=c.right,m=c.left;if(p-m<=i.nodeSize)for(let v=m;v<=p;v++){const b=i.ids[v],P=sa(t,n,i.coords[2*v],i.coords[2*v+1],d);u.push({id:b,dist:P})}else{const v=m+p>>1,b=i.coords[2*v],P=i.coords[2*v+1],C=i.ids[v],z=sa(t,n,b,P,d);u.push({id:C,dist:z});const I=(c.axis+1)%2,g={left:m,right:v-1,axis:I,minLng:c.minLng,minLat:c.minLat,maxLng:c.axis===0?b:c.maxLng,maxLat:c.axis===1?P:c.maxLat,dist:0},w={left:v+1,right:p,axis:I,minLng:c.axis===0?b:c.minLng,minLat:c.axis===1?P:c.minLat,maxLng:c.maxLng,maxLat:c.maxLat,dist:0};g.dist=oa(t,n,d,g),w.dist=oa(t,n,d,w),u.push(g),u.push(w)}for(;u.length&&u.peek().id!=null;){const v=u.pop();if(v.dist>a||(l.push(v.id),l.length===r))return l}c=u.pop()}return l}function oa(i,t,n,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(i>=s&&i<=a)return t<l?Oe((t-l)*he):t>u?Oe((t-u)*he):0;const c=Math.min(Oe((i-s)*he),Oe((i-a)*he)),d=Cf(t,c);return d>l&&d<u?Fn(c,n,t,d):Math.min(Fn(c,n,t,l),Fn(c,n,t,u))}function Ef(i,t){return i.dist-t.dist}function Oe(i){const t=Math.sin(i/2);return t*t}function Fn(i,t,n,r){return t*Math.cos(r*he)*i+Oe((n-r)*he)}function sa(i,t,n,r,s){const a=Oe((i-n)*he);return Fn(a,s,t,r)}function Cf(i,t){const n=1-2*t;return n<=0?i>0?90:-90:Math.atan(Math.tan(i*he)/n)/he}class kf{constructor(t){this.useCache=!0,this.points=[],this.routeCache={},this.useCache=t.useCache!==void 0?t.useCache:!0,this.network=this.clone(t.network),this.routeFinder=t.routeFinder,this.initialise()}initialise(){this.network.features.forEach(t=>{t.geometry.coordinates.forEach(n=>{this.points.push(n)})}),this.indexedNetworkPoints=new Mf(this.points.length),this.points.forEach(t=>{this.indexedNetworkPoints.add(t[0],t[1])}),this.indexedNetworkPoints.finish(),this.routeCache={}}getClosestNetworkCoordinate(t){const n=Sf(this.indexedNetworkPoints,t[0],t[1],1),r=this.points[n[0]];return r||null}setRouteFinder(t){this.routeFinder=t}setNetwork(t){this.network=this.clone(t),this.routeFinder.setNetwork(t),this.initialise()}expandRouteNetwork(t){const n=this.clone(t);this.routeFinder.expandNetwork(n);const r={type:"FeatureCollection",features:[...n.features,...this.network.features]};this.network=r,this.initialise()}getRoute(t,n){if(this.useCache){const l=`${t}-${n}`;if(l in this.routeCache)return this.routeCache[l]}const r={type:"Feature",geometry:{type:"Point",coordinates:t},properties:{}},s={type:"Feature",geometry:{type:"Point",coordinates:n},properties:{}},a=this.routeFinder.getRoute(r,s);if(this.useCache){const l=`${t}-${n}`;return this.routeCache[l]=a,a}return a}clone(t){return JSON.parse(JSON.stringify(t))}}const Tf={cancel:"Escape",finish:"Enter"},Df={draw:"crosshair",close:"pointer"},{TerraDrawBaseDrawMode:Af}=kh;class If extends Af{constructor(t){super(t,!0),this.mode="routesnap",this.currentCoordinate=0,this.keyEvents=Tf,this.cursors=Df,this.maxPoints=2,this.currentPointIds=[],this.routeId=0,this.latestMouseMoveEvent=null,this.fallbackToStraightLine=!1,this.snapHysteresisEnterPx=10,this.snapHysteresisExitPx=3,this.snapNearPx=5,this.isPreviewSnappedToNetwork=!0,this.didIncrementRouteIdForCurrentRoute=!1,this.pixelDistance=(n,r)=>{const{x:s,y:a}=n,{x:l,y:u}=r,c=l-s,d=u-a;return Math.sqrt(c*c+d*d)},this.updateOptions(t)}updateOptions(t){if(super.updateOptions(t),t?.routing&&t.routing!==this.routing&&(this.cleanUp(),this.routing=t.routing),t?.maxPoints!==void 0&&t.maxPoints!==this.maxPoints&&t.maxPoints>=2&&(this.maxPoints=t.maxPoints),t?.cursors&&(this.cursors={...this.cursors,...t.cursors}),t?.keyEvents===null?this.keyEvents={cancel:null,finish:null}:t?.keyEvents&&(this.keyEvents={...this.keyEvents,...t.keyEvents}),t?.snappingConfig?.fallbackToStraightLine!==void 0){const n=t.snappingConfig.fallbackToStraightLine;this.fallbackToStraightLine=!!n,n&&typeof n=="object"&&(n.snapTolerance&&typeof n.snapTolerance=="object"&&(n.snapTolerance.enterPx!==void 0&&(this.snapHysteresisEnterPx=n.snapTolerance.enterPx),n.snapTolerance.exitPx!==void 0&&(this.snapHysteresisExitPx=n.snapTolerance.exitPx)),n.nearPx!==void 0&&(this.snapNearPx=n.nearPx))}}createStraightLineRoute(t,n){return{type:"Feature",geometry:{type:"LineString",coordinates:[t,n]},properties:{}}}measure(t,n){const{x:r,y:s}=this.project(n[0],n[1]);return this.pixelDistance({x:r,y:s},{x:t.containerX,y:t.containerY})}shouldAllowSnapToNetworkCoordinate(t,n,r){if(!this.fallbackToStraightLine)return!0;const s=this.measure(t,r),l=this.measure(t,n)-s;return s<this.snapNearPx?!0:this.isPreviewSnappedToNetwork?l>=-this.snapHysteresisExitPx:l>=this.snapHysteresisEnterPx}close(){this.currentId&&(this.currentCoordinate=0,this.currentId=void 0,this.currentPointIds=[],this.isPreviewSnappedToNetwork=!0,this.state==="drawing"&&this.setStarted())}finish(){if(!this.currentId)return;this.didIncrementRouteIdForCurrentRoute=!1;const t=[this.moveLineId,...this.currentPointIds].filter(n=>!!n&&this.store.has(n));t.length&&this.store.delete(t),this.close()}getFeatureProperties(){return{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}createRoutePoint(t){const[n]=this.store.create([{geometry:{type:"Point",coordinates:t},properties:this.getFeatureProperties()}]);return n}syncIntermediateRoutePoints(t){if(this.currentPointIds.length>this.currentCoordinate){const r=this.currentPointIds.slice(this.currentCoordinate).filter(s=>this.store.has(s));r.length&&this.store.delete(r),this.currentPointIds=this.currentPointIds.slice(0,this.currentCoordinate)}for(let n=1;n<t.length;n++){const r=this.createRoutePoint(t[n]);this.currentPointIds.push(r)}}clearIntermediateRoutePoints(){if(this.currentPointIds.length<=this.currentCoordinate)return;const n=this.currentPointIds.slice(this.currentCoordinate).filter(r=>this.store.has(r));n.length&&this.store.delete(n),this.currentPointIds=this.currentPointIds.slice(0,this.currentCoordinate)}processCursorMove(t){if(this.setCursor(this.cursors.draw),this.moveLineId&&!this.store.has(this.moveLineId)&&(this.moveLineId=void 0),!this.currentId||this.currentCoordinate===0)return;const n=this.store.getGeometryCopy(this.currentId);if(!n)return;const r=n.coordinates,s=r.length-1,a=r[s];if(this.measure(t,a)<this.pointerDistance){if(this.setCursor(this.cursors.close),!this.moveLineId)return;this.store.has(this.moveLineId)&&this.store.delete([this.moveLineId]),this.moveLineId=void 0,this.clearIntermediateRoutePoints(),this.isPreviewSnappedToNetwork=!0;return}const u=[t.lng,t.lat],c=this.routing.getClosestNetworkCoordinate(u);if(!c)return;const p=this.shouldAllowSnapToNetworkCoordinate(t,a,c)?this.routing.getRoute(a,c):null;if(!p&&this.fallbackToStraightLine){const m=this.createStraightLineRoute(a,u);if(this.isPreviewSnappedToNetwork=!1,this.clearIntermediateRoutePoints(),this.moveLineId)this.store.updateGeometry([{id:this.moveLineId,geometry:m.geometry}]);else{const[v]=this.store.create([{geometry:m.geometry,properties:this.getFeatureProperties()}]);this.moveLineId=v}return}if(!p){this.clearIntermediateRoutePoints();return}if(this.isPreviewSnappedToNetwork=!0,this.clearIntermediateRoutePoints(),this.moveLineId)this.store.updateGeometry([{id:this.moveLineId,geometry:p.geometry}]);else{const[m]=this.store.create([{geometry:p.geometry,properties:this.getFeatureProperties()}]);this.moveLineId=m}}registerBehaviors(t){}start(){this.setStarted(),this.setCursor(this.cursors.draw)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(t){this.latestMouseMoveEvent=t,requestAnimationFrame(()=>{const n=this.latestMouseMoveEvent;n&&(this.processCursorMove(n),this.latestMouseMoveEvent=null)})}onClick(t){if(t.button==="right")return;const n=[t.lng,t.lat];if(this.currentId&&!this.store.has(this.currentId)&&(this.currentId=void 0,this.currentCoordinate=0,this.currentPointIds=[]),this.currentId){const a=this.store.getGeometryCopy(this.currentId).coordinates,l=a[a.length-1];if(this.measure(t,l)<this.pointerDistance){this.finish();return}}else this.routeId++,this.didIncrementRouteIdForCurrentRoute=!0;const r=this.routing.getClosestNetworkCoordinate(n);if(this.currentCoordinate===0&&r){const[s,a]=this.store.create([{geometry:{type:"LineString",coordinates:[r]},properties:this.getFeatureProperties()},{geometry:{type:"Point",coordinates:r},properties:this.getFeatureProperties()}]);this.currentId=s,this.currentPointIds.push(a),this.currentCoordinate++,this.state==="started"&&this.setDrawing()}else if(this.currentCoordinate===1&&this.currentId&&r){const a=this.store.getGeometryCopy(this.currentId).coordinates[0],u=this.shouldAllowSnapToNetworkCoordinate(t,a,r)?this.routing.getRoute(a,r):null;if(u||this.fallbackToStraightLine){const c=u||this.createStraightLineRoute(a,n);!u&&this.fallbackToStraightLine&&this.syncIntermediateRoutePoints(c.geometry.coordinates),this.store.updateGeometry([{id:this.currentId,geometry:c.geometry}]);const d=this.createRoutePoint(u?r:n);this.currentCoordinate=2,this.currentPointIds.push(d),this.currentCoordinate>=this.maxPoints&&this.finish()}}else if(this.currentCoordinate>1&&this.currentId&&r&&this.currentCoordinate<this.maxPoints){const s=this.store.getGeometryCopy(this.currentId),a=s.coordinates.length-1,l=s.coordinates[a],c=this.shouldAllowSnapToNetworkCoordinate(t,l,r)?this.routing.getRoute(l,r):null,d=c||(this.fallbackToStraightLine?this.createStraightLineRoute(l,n):null);if(d){!c&&this.fallbackToStraightLine&&this.syncIntermediateRoutePoints(d.geometry.coordinates);const p={...s,coordinates:[...s.coordinates,...d.geometry.coordinates.slice(1)]};if(this.store.updateGeometry([{id:this.currentId,geometry:p}]),this.currentCoordinate+1>this.maxPoints)this.finish();else{const m=this.createRoutePoint(c?r:n);this.currentCoordinate++,this.currentPointIds.push(m),this.currentCoordinate===this.maxPoints&&this.finish()}}}}onKeyDown(){}onKeyUp(t){t.key===this.keyEvents.cancel&&this.cleanUp(),t.key===this.keyEvents.finish&&this.finish()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){if(!this.store)return;const t=[this.currentId,this.moveLineId,...this.currentPointIds].filter(n=>n&&this.store.has(n));this.store.delete(t),this.currentId=void 0,this.moveLineId=void 0,this.currentPointIds=[],this.currentCoordinate=0,this.isPreviewSnappedToNetwork=!0,this.didIncrementRouteIdForCurrentRoute&&(this.routeId=Math.max(0,this.routeId-1),this.didIncrementRouteIdForCurrentRoute=!1),this.state==="drawing"&&this.setStarted()}styleFeature(t){const n=kh.getDefaultStyling();return t.type==="Feature"&&t.geometry.type==="LineString"&&t.properties.mode===this.mode?(n.lineStringColor=this.getHexColorStylingValue(this.styles.lineStringColor,"#B90E0A",t),n.lineStringWidth=this.getNumericStylingValue(this.styles.lineStringWidth,4,t),n.zIndex=10,n):(t.type==="Feature"&&t.geometry.type==="Point"&&t.properties.mode===this.mode&&(n.pointColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",t),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.routePointOutlineColor,"#B90E0A",t),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.routePointOutlineWidth,1,t)),n)}validateFeature(t){return super.validateFeature(t)}afterFeatureAdded(t){}}function aa(){const i=[[30,60],[190,250],[260,290]],[t,n]=i[Math.floor(Math.random()*i.length)],r=Math.floor(Math.random()*(n-t+1))+t,s=60+Math.random()*20,a=50+Math.random()*10;return Of(r,s,a)}function Of(i,t,n){t/=100,n/=100;const r=l=>(l+i/30)%12,s=t*Math.min(n,1-n),a=l=>Math.round(255*(n-s*Math.max(-1,Math.min(r(l)-3,Math.min(9-r(l),1)))));return`#${[a(0),a(8),a(4)].map(l=>l.toString(16).padStart(2,"0")).join("")}`}function zf(i,t,n,r){const s={},a=r?.fallbackToStraightLineEnabled??!1,l=r?.snapToleranceEnterPx??20,u=r?.nearPx??5;return new hf({adapter:new lf({lib:t,map:i,coordinatePrecision:9}),modes:[new Gc({modeName:"networkOutline",styles:{polygonOutlineColor:"#d1cfcf",polygonFillColor:"#eeeeee",polygonFillOpacity:.19,polygonOutlineWidth:2}}),new If({routing:n,maxPoints:5,snappingConfig:{fallbackToStraightLine:a?{snapTolerance:{enterPx:l,exitPx:10},nearPx:u}:void 0},styles:{lineStringColor:d=>{const p=d.properties.routeId;return p||(s[p]=aa()),s[p]},routePointColor:d=>{const p=d.properties.routeId;return s[p]||(s[p]=aa()),s[p]}}})]})}var Bf=Object.create,nr=Object.defineProperty,Nf=Object.getOwnPropertyDescriptor,Ff=Object.getOwnPropertyNames,ha=Object.getOwnPropertySymbols,Rf=Object.getPrototypeOf,Dh=Object.prototype.hasOwnProperty,Zf=Object.prototype.propertyIsEnumerable,la=(i,t,n)=>t in i?nr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,Yf=(i,t)=>{for(var n in t||(t={}))Dh.call(t,n)&&la(i,n,t[n]);if(ha)for(var n of ha(t))Zf.call(t,n)&&la(i,n,t[n]);return i},Xf=i=>nr(i,"__esModule",{value:!0}),te=(i,t)=>function(){return t||(0,i[Object.keys(i)[0]])((t={exports:{}}).exports,t),t.exports},Uf=(i,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ff(t))!Dh.call(i,r)&&r!=="default"&&nr(i,r,{get:()=>t[r],enumerable:!(n=Nf(t,r))||n.enumerable});return i},Xt=i=>Uf(Xf(nr(i!=null?Bf(Rf(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),ai=(i,t,n)=>new Promise((r,s)=>{var a=c=>{try{u(n.next(c))}catch(d){s(d)}},l=c=>{try{u(n.throw(c))}catch(d){s(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((n=n.apply(i,t)).next())}),we=te({"node_modules/@mapbox/point-geometry/index.js"(i,t){t.exports=n;function n(r,s){this.x=r,this.y=s}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,a=r.y-this.y;return s*s+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=s,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),a=Math.sin(r),l=s*this.x-a*this.y,u=a*this.x+s*this.y;return this.x=l,this.y=u,this},_rotateAround:function(r,s){var a=Math.cos(r),l=Math.sin(r),u=s.x+a*(this.x-s.x)-l*(this.y-s.y),c=s.y+l*(this.x-s.x)+a*(this.y-s.y);return this.x=u,this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(r){return r instanceof n?r:Array.isArray(r)?new n(r[0],r[1]):r}}}),Ah=te({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(i,t){var n=we();t.exports=r;function r(c,d,p,m,v){this.properties={},this.extent=p,this.type=0,this._pbf=c,this._geometry=-1,this._keys=m,this._values=v,c.readFields(s,this,d)}function s(c,d,p){c==1?d.id=p.readVarint():c==2?a(p,d):c==3?d.type=p.readVarint():c==4&&(d._geometry=p.pos)}function a(c,d){for(var p=c.readVarint()+c.pos;c.pos<p;){var m=d._keys[c.readVarint()],v=d._values[c.readVarint()];d.properties[m]=v}}r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,m=0,v=0,b=0,P=[],C;c.pos<d;){if(m<=0){var z=c.readVarint();p=z&7,m=z>>3}if(m--,p===1||p===2)v+=c.readSVarint(),b+=c.readSVarint(),p===1&&(C&&P.push(C),C=[]),C.push(new n(v,b));else if(p===7)C&&C.push(C[0].clone());else throw new Error("unknown command "+p)}return C&&P.push(C),P},r.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,m=0,v=0,b=0,P=1/0,C=-1/0,z=1/0,I=-1/0;c.pos<d;){if(m<=0){var g=c.readVarint();p=g&7,m=g>>3}if(m--,p===1||p===2)v+=c.readSVarint(),b+=c.readSVarint(),v<P&&(P=v),v>C&&(C=v),b<z&&(z=b),b>I&&(I=b);else if(p!==7)throw new Error("unknown command "+p)}return[P,z,C,I]},r.prototype.toGeoJSON=function(c,d,p){var m=this.extent*Math.pow(2,p),v=this.extent*c,b=this.extent*d,P=this.loadGeometry(),C=r.types[this.type],z,I;function g(S){for(var E=0;E<S.length;E++){var T=S[E],k=180-(T.y+b)*360/m;S[E]=[(T.x+v)*360/m-180,360/Math.PI*Math.atan(Math.exp(k*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(z=0;z<P.length;z++)w[z]=P[z][0];P=w,g(P);break;case 2:for(z=0;z<P.length;z++)g(P[z]);break;case 3:for(P=l(P),z=0;z<P.length;z++)for(I=0;I<P[z].length;I++)g(P[z][I]);break}P.length===1?P=P[0]:C="Multi"+C;var y={type:"Feature",geometry:{type:C,coordinates:P},properties:this.properties};return"id"in this&&(y.id=this.id),y};function l(c){var d=c.length;if(d<=1)return[c];for(var p=[],m,v,b=0;b<d;b++){var P=u(c[b]);P!==0&&(v===void 0&&(v=P<0),v===P<0?(m&&p.push(m),m=[c[b]]):m.push(c[b]))}return m&&p.push(m),p}function u(c){for(var d=0,p=0,m=c.length,v=m-1,b,P;p<m;v=p++)b=c[p],P=c[v],d+=(P.x-b.x)*(b.y+P.y);return d}}}),Ih=te({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(i,t){var n=Ah();t.exports=r;function r(l,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,u),this.length=this._features.length}function s(l,u,c){l===15?u.version=c.readVarint():l===1?u.name=c.readString():l===5?u.extent=c.readVarint():l===2?u._features.push(c.pos):l===3?u._keys.push(c.readString()):l===4&&u._values.push(a(c))}function a(l){for(var u=null,c=l.readVarint()+l.pos;l.pos<c;){var d=l.readVarint()>>3;u=d===1?l.readString():d===2?l.readFloat():d===3?l.readDouble():d===4?l.readVarint64():d===5?l.readVarint():d===6?l.readSVarint():d===7?l.readBoolean():null}return u}r.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var u=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,u,this.extent,this._keys,this._values)}}}),jf=te({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(i,t){var n=Ih();t.exports=r;function r(a,l){this.layers=a.readFields(s,{},l)}function s(a,l,u){if(a===3){var c=new n(u,u.readVarint()+u.pos);c.length&&(l[c.name]=c)}}}}),Wf=te({"node_modules/@mapbox/vector-tile/index.js"(i,t){t.exports.VectorTile=jf(),t.exports.VectorTileFeature=Ah(),t.exports.VectorTileLayer=Ih()}}),Vf=te({"node_modules/ieee754/index.js"(i){i.read=function(t,n,r,s,a){var l,u,c=a*8-s-1,d=(1<<c)-1,p=d>>1,m=-7,v=r?a-1:0,b=r?-1:1,P=t[n+v];for(v+=b,l=P&(1<<-m)-1,P>>=-m,m+=c;m>0;l=l*256+t[n+v],v+=b,m-=8);for(u=l&(1<<-m)-1,l>>=-m,m+=s;m>0;u=u*256+t[n+v],v+=b,m-=8);if(l===0)l=1-p;else{if(l===d)return u?NaN:(P?-1:1)*(1/0);u=u+Math.pow(2,s),l=l-p}return(P?-1:1)*u*Math.pow(2,l-s)},i.write=function(t,n,r,s,a,l){var u,c,d,p=l*8-a-1,m=(1<<p)-1,v=m>>1,b=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=s?0:l-1,C=s?1:-1,z=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(c=isNaN(n)?1:0,u=m):(u=Math.floor(Math.log(n)/Math.LN2),n*(d=Math.pow(2,-u))<1&&(u--,d*=2),u+v>=1?n+=b/d:n+=b*Math.pow(2,1-v),n*d>=2&&(u++,d/=2),u+v>=m?(c=0,u=m):u+v>=1?(c=(n*d-1)*Math.pow(2,a),u=u+v):(c=n*Math.pow(2,v-1)*Math.pow(2,a),u=0));a>=8;t[r+P]=c&255,P+=C,c/=256,a-=8);for(u=u<<a|c,p+=a;p>0;t[r+P]=u&255,P+=C,u/=256,p-=8);t[r+P-C]|=z*128}}}),Hf=te({"node_modules/pbf/index.js"(i,t){t.exports=r;var n=Vf();function r(x){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(x)?x:new Uint8Array(x||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=65536*65536,a=1/s,l=12,u=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(x,D,O){for(O=O||this.length;this.pos<O;){var W=this.readVarint(),X=W>>3,$=this.pos;this.type=W&7,x(X,D,this),this.pos===$&&this.skip(W)}return D},readMessage:function(x,D){return this.readFields(x,D,this.readVarint()+this.pos)},readFixed32:function(){var x=k(this.buf,this.pos);return this.pos+=4,x},readSFixed32:function(){var x=N(this.buf,this.pos);return this.pos+=4,x},readFixed64:function(){var x=k(this.buf,this.pos)+k(this.buf,this.pos+4)*s;return this.pos+=8,x},readSFixed64:function(){var x=k(this.buf,this.pos)+N(this.buf,this.pos+4)*s;return this.pos+=8,x},readFloat:function(){var x=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,x},readDouble:function(){var x=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,x},readVarint:function(x){var D=this.buf,O,W;return W=D[this.pos++],O=W&127,W<128||(W=D[this.pos++],O|=(W&127)<<7,W<128)||(W=D[this.pos++],O|=(W&127)<<14,W<128)||(W=D[this.pos++],O|=(W&127)<<21,W<128)?O:(W=D[this.pos],O|=(W&15)<<28,c(O,x,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var x=this.readVarint();return x%2===1?(x+1)/-2:x/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var x=this.readVarint()+this.pos,D=this.pos;return this.pos=x,x-D>=l&&u?j(this.buf,D,x):Z(this.buf,D,x)},readBytes:function(){var x=this.readVarint()+this.pos,D=this.buf.subarray(this.pos,x);return this.pos=x,D},readPackedVarint:function(x,D){if(this.type!==r.Bytes)return x.push(this.readVarint(D));var O=d(this);for(x=x||[];this.pos<O;)x.push(this.readVarint(D));return x},readPackedSVarint:function(x){if(this.type!==r.Bytes)return x.push(this.readSVarint());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readSVarint());return x},readPackedBoolean:function(x){if(this.type!==r.Bytes)return x.push(this.readBoolean());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readBoolean());return x},readPackedFloat:function(x){if(this.type!==r.Bytes)return x.push(this.readFloat());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readFloat());return x},readPackedDouble:function(x){if(this.type!==r.Bytes)return x.push(this.readDouble());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readDouble());return x},readPackedFixed32:function(x){if(this.type!==r.Bytes)return x.push(this.readFixed32());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readFixed32());return x},readPackedSFixed32:function(x){if(this.type!==r.Bytes)return x.push(this.readSFixed32());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readSFixed32());return x},readPackedFixed64:function(x){if(this.type!==r.Bytes)return x.push(this.readFixed64());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readFixed64());return x},readPackedSFixed64:function(x){if(this.type!==r.Bytes)return x.push(this.readSFixed64());var D=d(this);for(x=x||[];this.pos<D;)x.push(this.readSFixed64());return x},skip:function(x){var D=x&7;if(D===r.Varint)for(;this.buf[this.pos++]>127;);else if(D===r.Bytes)this.pos=this.readVarint()+this.pos;else if(D===r.Fixed32)this.pos+=4;else if(D===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+D)},writeTag:function(x,D){this.writeVarint(x<<3|D)},realloc:function(x){for(var D=this.length||16;D<this.pos+x;)D*=2;if(D!==this.length){var O=new Uint8Array(D);O.set(this.buf),this.buf=O,this.length=D}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(x){this.realloc(4),B(this.buf,x,this.pos),this.pos+=4},writeSFixed32:function(x){this.realloc(4),B(this.buf,x,this.pos),this.pos+=4},writeFixed64:function(x){this.realloc(8),B(this.buf,x&-1,this.pos),B(this.buf,Math.floor(x*a),this.pos+4),this.pos+=8},writeSFixed64:function(x){this.realloc(8),B(this.buf,x&-1,this.pos),B(this.buf,Math.floor(x*a),this.pos+4),this.pos+=8},writeVarint:function(x){if(x=+x||0,x>268435455||x<0){m(x,this);return}this.realloc(4),this.buf[this.pos++]=x&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=(x>>>=7)&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=(x>>>=7)&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=x>>>7&127)))},writeSVarint:function(x){this.writeVarint(x<0?-x*2-1:x*2)},writeBoolean:function(x){this.writeVarint(!!x)},writeString:function(x){x=String(x),this.realloc(x.length*4),this.pos++;var D=this.pos;this.pos=U(this.buf,x,this.pos);var O=this.pos-D;O>=128&&P(D,O,this),this.pos=D-1,this.writeVarint(O),this.pos+=O},writeFloat:function(x){this.realloc(4),n.write(this.buf,x,this.pos,!0,23,4),this.pos+=4},writeDouble:function(x){this.realloc(8),n.write(this.buf,x,this.pos,!0,52,8),this.pos+=8},writeBytes:function(x){var D=x.length;this.writeVarint(D),this.realloc(D);for(var O=0;O<D;O++)this.buf[this.pos++]=x[O]},writeRawMessage:function(x,D){this.pos++;var O=this.pos;x(D,this);var W=this.pos-O;W>=128&&P(O,W,this),this.pos=O-1,this.writeVarint(W),this.pos+=W},writeMessage:function(x,D,O){this.writeTag(x,r.Bytes),this.writeRawMessage(D,O)},writePackedVarint:function(x,D){D.length&&this.writeMessage(x,C,D)},writePackedSVarint:function(x,D){D.length&&this.writeMessage(x,z,D)},writePackedBoolean:function(x,D){D.length&&this.writeMessage(x,w,D)},writePackedFloat:function(x,D){D.length&&this.writeMessage(x,I,D)},writePackedDouble:function(x,D){D.length&&this.writeMessage(x,g,D)},writePackedFixed32:function(x,D){D.length&&this.writeMessage(x,y,D)},writePackedSFixed32:function(x,D){D.length&&this.writeMessage(x,S,D)},writePackedFixed64:function(x,D){D.length&&this.writeMessage(x,E,D)},writePackedSFixed64:function(x,D){D.length&&this.writeMessage(x,T,D)},writeBytesField:function(x,D){this.writeTag(x,r.Bytes),this.writeBytes(D)},writeFixed32Field:function(x,D){this.writeTag(x,r.Fixed32),this.writeFixed32(D)},writeSFixed32Field:function(x,D){this.writeTag(x,r.Fixed32),this.writeSFixed32(D)},writeFixed64Field:function(x,D){this.writeTag(x,r.Fixed64),this.writeFixed64(D)},writeSFixed64Field:function(x,D){this.writeTag(x,r.Fixed64),this.writeSFixed64(D)},writeVarintField:function(x,D){this.writeTag(x,r.Varint),this.writeVarint(D)},writeSVarintField:function(x,D){this.writeTag(x,r.Varint),this.writeSVarint(D)},writeStringField:function(x,D){this.writeTag(x,r.Bytes),this.writeString(D)},writeFloatField:function(x,D){this.writeTag(x,r.Fixed32),this.writeFloat(D)},writeDoubleField:function(x,D){this.writeTag(x,r.Fixed64),this.writeDouble(D)},writeBooleanField:function(x,D){this.writeVarintField(x,!!D)}};function c(x,D,O){var W=O.buf,X,$;if($=W[O.pos++],X=($&112)>>4,$<128||($=W[O.pos++],X|=($&127)<<3,$<128)||($=W[O.pos++],X|=($&127)<<10,$<128)||($=W[O.pos++],X|=($&127)<<17,$<128)||($=W[O.pos++],X|=($&127)<<24,$<128)||($=W[O.pos++],X|=($&1)<<31,$<128))return p(x,X,D);throw new Error("Expected varint not more than 10 bytes")}function d(x){return x.type===r.Bytes?x.readVarint()+x.pos:x.pos+1}function p(x,D,O){return O?D*4294967296+(x>>>0):(D>>>0)*4294967296+(x>>>0)}function m(x,D){var O,W;if(x>=0?(O=x%4294967296|0,W=x/4294967296|0):(O=~(-x%4294967296),W=~(-x/4294967296),O^4294967295?O=O+1|0:(O=0,W=W+1|0)),x>=18446744073709552e3||x<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");D.realloc(10),v(O,W,D),b(W,D)}function v(x,D,O){O.buf[O.pos++]=x&127|128,x>>>=7,O.buf[O.pos++]=x&127|128,x>>>=7,O.buf[O.pos++]=x&127|128,x>>>=7,O.buf[O.pos++]=x&127|128,x>>>=7,O.buf[O.pos]=x&127}function b(x,D){var O=(x&7)<<4;D.buf[D.pos++]|=O|((x>>>=3)?128:0),x&&(D.buf[D.pos++]=x&127|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=x&127|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=x&127|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=x&127|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=x&127)))))}function P(x,D,O){var W=D<=16383?1:D<=2097151?2:D<=268435455?3:Math.floor(Math.log(D)/(Math.LN2*7));O.realloc(W);for(var X=O.pos-1;X>=x;X--)O.buf[X+W]=O.buf[X]}function C(x,D){for(var O=0;O<x.length;O++)D.writeVarint(x[O])}function z(x,D){for(var O=0;O<x.length;O++)D.writeSVarint(x[O])}function I(x,D){for(var O=0;O<x.length;O++)D.writeFloat(x[O])}function g(x,D){for(var O=0;O<x.length;O++)D.writeDouble(x[O])}function w(x,D){for(var O=0;O<x.length;O++)D.writeBoolean(x[O])}function y(x,D){for(var O=0;O<x.length;O++)D.writeFixed32(x[O])}function S(x,D){for(var O=0;O<x.length;O++)D.writeSFixed32(x[O])}function E(x,D){for(var O=0;O<x.length;O++)D.writeFixed64(x[O])}function T(x,D){for(var O=0;O<x.length;O++)D.writeSFixed64(x[O])}function k(x,D){return(x[D]|x[D+1]<<8|x[D+2]<<16)+x[D+3]*16777216}function B(x,D,O){x[O]=D,x[O+1]=D>>>8,x[O+2]=D>>>16,x[O+3]=D>>>24}function N(x,D){return(x[D]|x[D+1]<<8|x[D+2]<<16)+(x[D+3]<<24)}function Z(x,D,O){for(var W="",X=D;X<O;){var $=x[X],R=null,G=$>239?4:$>223?3:$>191?2:1;if(X+G>O)break;var H,it,Q;G===1?$<128&&(R=$):G===2?(H=x[X+1],(H&192)===128&&(R=($&31)<<6|H&63,R<=127&&(R=null))):G===3?(H=x[X+1],it=x[X+2],(H&192)===128&&(it&192)===128&&(R=($&15)<<12|(H&63)<<6|it&63,(R<=2047||R>=55296&&R<=57343)&&(R=null))):G===4&&(H=x[X+1],it=x[X+2],Q=x[X+3],(H&192)===128&&(it&192)===128&&(Q&192)===128&&(R=($&15)<<18|(H&63)<<12|(it&63)<<6|Q&63,(R<=65535||R>=1114112)&&(R=null))),R===null?(R=65533,G=1):R>65535&&(R-=65536,W+=String.fromCharCode(R>>>10&1023|55296),R=56320|R&1023),W+=String.fromCharCode(R),X+=G}return W}function j(x,D,O){return u.decode(x.subarray(D,O))}function U(x,D,O){for(var W=0,X,$;W<D.length;W++){if(X=D.charCodeAt(W),X>55295&&X<57344)if($)if(X<56320){x[O++]=239,x[O++]=191,x[O++]=189,$=X;continue}else X=$-55296<<10|X-56320|65536,$=null;else{X>56319||W+1===D.length?(x[O++]=239,x[O++]=191,x[O++]=189):$=X;continue}else $&&(x[O++]=239,x[O++]=191,x[O++]=189,$=null);X<128?x[O++]=X:(X<2048?x[O++]=X>>6|192:(X<65536?x[O++]=X>>12|224:(x[O++]=X>>18|240,x[O++]=X>>12&63|128),x[O++]=X>>6&63|128),x[O++]=X&63|128)}return O}}}),Gf=te({"node_modules/rbush/rbush.min.js"(i,t){(function(n,r){typeof i=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self).RBush=r()})(i,function(){function n(g,w,y,S,E){(function T(k,B,N,Z,j){for(;Z>N;){if(Z-N>600){var U=Z-N+1,x=B-N+1,D=Math.log(U),O=.5*Math.exp(2*D/3),W=.5*Math.sqrt(D*O*(U-O)/U)*(x-U/2<0?-1:1),X=Math.max(N,Math.floor(B-x*O/U+W)),$=Math.min(Z,Math.floor(B+(U-x)*O/U+W));T(k,B,X,$,j)}var R=k[B],G=N,H=Z;for(r(k,N,B),j(k[Z],R)>0&&r(k,N,Z);G<H;){for(r(k,G,H),G++,H--;j(k[G],R)<0;)G++;for(;j(k[H],R)>0;)H--}j(k[N],R)===0?r(k,N,H):r(k,++H,Z),H<=B&&(N=H+1),B<=H&&(Z=H-1)}})(g,w,y||0,S||g.length-1,E||s)}function r(g,w,y){var S=g[w];g[w]=g[y],g[y]=S}function s(g,w){return g<w?-1:g>w?1:0}var a=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(g,w,y){if(!y)return w.indexOf(g);for(var S=0;S<w.length;S++)if(y(g,w[S]))return S;return-1}function u(g,w){c(g,0,g.children.length,w,g)}function c(g,w,y,S,E){E||(E=z(null)),E.minX=1/0,E.minY=1/0,E.maxX=-1/0,E.maxY=-1/0;for(var T=w;T<y;T++){var k=g.children[T];d(E,g.leaf?S(k):k)}return E}function d(g,w){return g.minX=Math.min(g.minX,w.minX),g.minY=Math.min(g.minY,w.minY),g.maxX=Math.max(g.maxX,w.maxX),g.maxY=Math.max(g.maxY,w.maxY),g}function p(g,w){return g.minX-w.minX}function m(g,w){return g.minY-w.minY}function v(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function b(g){return g.maxX-g.minX+(g.maxY-g.minY)}function P(g,w){return g.minX<=w.minX&&g.minY<=w.minY&&w.maxX<=g.maxX&&w.maxY<=g.maxY}function C(g,w){return w.minX<=g.maxX&&w.minY<=g.maxY&&w.maxX>=g.minX&&w.maxY>=g.minY}function z(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function I(g,w,y,S,E){for(var T=[w,y];T.length;)if(!((y=T.pop())-(w=T.pop())<=S)){var k=w+Math.ceil((y-w)/S/2)*S;n(g,k,w,y,E),T.push(w,k,k,y)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(g){var w=this.data,y=[];if(!C(g,w))return y;for(var S=this.toBBox,E=[];w;){for(var T=0;T<w.children.length;T++){var k=w.children[T],B=w.leaf?S(k):k;C(g,B)&&(w.leaf?y.push(k):P(g,B)?this._all(k,y):E.push(k))}w=E.pop()}return y},a.prototype.collides=function(g){var w=this.data;if(!C(g,w))return!1;for(var y=[];w;){for(var S=0;S<w.children.length;S++){var E=w.children[S],T=w.leaf?this.toBBox(E):E;if(C(g,T)){if(w.leaf||P(g,T))return!0;y.push(E)}}w=y.pop()}return!1},a.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var w=0;w<g.length;w++)this.insert(g[w]);return this}var y=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===y.height)this._splitRoot(this.data,y);else{if(this.data.height<y.height){var S=this.data;this.data=y,y=S}this._insert(y,this.data.height-y.height-1,!0)}else this.data=y;return this},a.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},a.prototype.clear=function(){return this.data=z([]),this},a.prototype.remove=function(g,w){if(!g)return this;for(var y,S,E,T=this.data,k=this.toBBox(g),B=[],N=[];T||B.length;){if(T||(T=B.pop(),S=B[B.length-1],y=N.pop(),E=!0),T.leaf){var Z=l(g,T.children,w);if(Z!==-1)return T.children.splice(Z,1),B.push(T),this._condense(B),this}E||T.leaf||!P(T,k)?S?(y++,T=S.children[y],E=!1):T=null:(B.push(T),N.push(y),y=0,S=T,T=T.children[0])}return this},a.prototype.toBBox=function(g){return g},a.prototype.compareMinX=function(g,w){return g.minX-w.minX},a.prototype.compareMinY=function(g,w){return g.minY-w.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(g){return this.data=g,this},a.prototype._all=function(g,w){for(var y=[];g;)g.leaf?w.push.apply(w,g.children):y.push.apply(y,g.children),g=y.pop();return w},a.prototype._build=function(g,w,y,S){var E,T=y-w+1,k=this._maxEntries;if(T<=k)return u(E=z(g.slice(w,y+1)),this.toBBox),E;S||(S=Math.ceil(Math.log(T)/Math.log(k)),k=Math.ceil(T/Math.pow(k,S-1))),(E=z([])).leaf=!1,E.height=S;var B=Math.ceil(T/k),N=B*Math.ceil(Math.sqrt(k));I(g,w,y,N,this.compareMinX);for(var Z=w;Z<=y;Z+=N){var j=Math.min(Z+N-1,y);I(g,Z,j,B,this.compareMinY);for(var U=Z;U<=j;U+=B){var x=Math.min(U+B-1,j);E.children.push(this._build(g,U,x,S-1))}}return u(E,this.toBBox),E},a.prototype._chooseSubtree=function(g,w,y,S){for(;S.push(w),!w.leaf&&S.length-1!==y;){for(var E=1/0,T=1/0,k=void 0,B=0;B<w.children.length;B++){var N=w.children[B],Z=v(N),j=(U=g,x=N,(Math.max(x.maxX,U.maxX)-Math.min(x.minX,U.minX))*(Math.max(x.maxY,U.maxY)-Math.min(x.minY,U.minY))-Z);j<T?(T=j,E=Z<E?Z:E,k=N):j===T&&Z<E&&(E=Z,k=N)}w=k||w.children[0]}var U,x;return w},a.prototype._insert=function(g,w,y){var S=y?g:this.toBBox(g),E=[],T=this._chooseSubtree(S,this.data,w,E);for(T.children.push(g),d(T,S);w>=0&&E[w].children.length>this._maxEntries;)this._split(E,w),w--;this._adjustParentBBoxes(S,E,w)},a.prototype._split=function(g,w){var y=g[w],S=y.children.length,E=this._minEntries;this._chooseSplitAxis(y,E,S);var T=this._chooseSplitIndex(y,E,S),k=z(y.children.splice(T,y.children.length-T));k.height=y.height,k.leaf=y.leaf,u(y,this.toBBox),u(k,this.toBBox),w?g[w-1].children.push(k):this._splitRoot(y,k)},a.prototype._splitRoot=function(g,w){this.data=z([g,w]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(g,w,y){for(var S,E,T,k,B,N,Z,j=1/0,U=1/0,x=w;x<=y-w;x++){var D=c(g,0,x,this.toBBox),O=c(g,x,y,this.toBBox),W=(E=D,T=O,k=void 0,B=void 0,N=void 0,Z=void 0,k=Math.max(E.minX,T.minX),B=Math.max(E.minY,T.minY),N=Math.min(E.maxX,T.maxX),Z=Math.min(E.maxY,T.maxY),Math.max(0,N-k)*Math.max(0,Z-B)),X=v(D)+v(O);W<j?(j=W,S=x,U=X<U?X:U):W===j&&X<U&&(U=X,S=x)}return S||y-w},a.prototype._chooseSplitAxis=function(g,w,y){var S=g.leaf?this.compareMinX:p,E=g.leaf?this.compareMinY:m;this._allDistMargin(g,w,y,S)<this._allDistMargin(g,w,y,E)&&g.children.sort(S)},a.prototype._allDistMargin=function(g,w,y,S){g.children.sort(S);for(var E=this.toBBox,T=c(g,0,w,E),k=c(g,y-w,y,E),B=b(T)+b(k),N=w;N<y-w;N++){var Z=g.children[N];d(T,g.leaf?E(Z):Z),B+=b(T)}for(var j=y-w-1;j>=w;j--){var U=g.children[j];d(k,g.leaf?E(U):U),B+=b(k)}return B},a.prototype._adjustParentBBoxes=function(g,w,y){for(var S=y;S>=0;S--)d(w[S],g)},a.prototype._condense=function(g){for(var w=g.length-1,y=void 0;w>=0;w--)g[w].children.length===0?w>0?(y=g[w-1].children).splice(y.indexOf(g[w]),1):this.clear():u(g[w],this.toBBox)},a})}}),$f=te({"src/types/unitbezier.d.ts"(){}}),qf=te({"node_modules/tinyqueue/tinyqueue.js"(i,t){(function(n,r){typeof i=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self,n.TinyQueue=r())})(i,function(){var n=function(a,l){if(a===void 0&&(a=[]),l===void 0&&(l=r),this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};n.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var a=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),a}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(a){for(var l=this,u=l.data,c=l.compare,d=u[a];a>0;){var p=a-1>>1,m=u[p];if(c(d,m)>=0)break;u[a]=m,a=p}u[a]=d},n.prototype._down=function(a){for(var l=this,u=l.data,c=l.compare,d=this.length>>1,p=u[a];a<d;){var m=(a<<1)+1,v=u[m],b=m+1;if(b<this.length&&c(u[b],v)<0&&(m=b,v=u[b]),c(v,p)>=0)break;u[a]=v,a=m}u[a]=p};function r(s,a){return s<a?-1:s>a?1:0}return n})}}),Jf=te({"node_modules/polylabel/polylabel.js"(i,t){var n=qf();n.default&&(n=n.default),t.exports=r,t.exports.default=r;function r(d,p,m){p=p||1;for(var v,b,P,C,z=0;z<d[0].length;z++){var I=d[0][z];(!z||I[0]<v)&&(v=I[0]),(!z||I[1]<b)&&(b=I[1]),(!z||I[0]>P)&&(P=I[0]),(!z||I[1]>C)&&(C=I[1])}var g=P-v,w=C-b,y=Math.min(g,w),S=y/2;if(y===0){var E=[v,b];return E.distance=0,E}for(var T=new n(void 0,s),k=v;k<P;k+=y)for(var B=b;B<C;B+=y)T.push(new a(k+S,B+S,S,d));var N=u(d),Z=new a(v+g/2,b+w/2,0,d);Z.d>N.d&&(N=Z);for(var j=T.length;T.length;){var U=T.pop();U.d>N.d&&(N=U,m&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,j)),!(U.max-N.d<=p)&&(S=U.h/2,T.push(new a(U.x-S,U.y-S,S,d)),T.push(new a(U.x+S,U.y-S,S,d)),T.push(new a(U.x-S,U.y+S,S,d)),T.push(new a(U.x+S,U.y+S,S,d)),j+=4)}m&&(console.log("num probes: "+j),console.log("best distance: "+N.d));var x=[N.x,N.y];return x.distance=N.d,x}function s(d,p){return p.max-d.max}function a(d,p,m,v){this.x=d,this.y=p,this.h=m,this.d=l(d,p,v),this.max=this.d+this.h*Math.SQRT2}function l(d,p,m){for(var v=!1,b=1/0,P=0;P<m.length;P++)for(var C=m[P],z=0,I=C.length,g=I-1;z<I;g=z++){var w=C[z],y=C[g];w[1]>p!=y[1]>p&&d<(y[0]-w[0])*(p-w[1])/(y[1]-w[1])+w[0]&&(v=!v),b=Math.min(b,c(d,p,w,y))}return b===0?0:(v?1:-1)*Math.sqrt(b)}function u(d){for(var p=0,m=0,v=0,b=d[0],P=0,C=b.length,z=C-1;P<C;z=P++){var I=b[P],g=b[z],w=I[0]*g[1]-g[0]*I[1];m+=(I[0]+g[0])*w,v+=(I[1]+g[1])*w,p+=w*3}return p===0?new a(b[0][0],b[0][1],0,d):new a(m/p,v/p,0,d)}function c(d,p,m,v){var b=m[0],P=m[1],C=v[0]-b,z=v[1]-P;if(C!==0||z!==0){var I=((d-b)*C+(p-P)*z)/(C*C+z*z);I>1?(b=v[0],P=v[1]):I>0&&(b+=C*I,P+=z*I)}return C=d-b,z=p-P,C*C+z*z}}});Xt(we());var Je=Xt(we()),$i=Xt(we()),Kf=Xt(Wf()),Qf=Xt(Hf()),At=(i,t,n)=>new Promise((r,s)=>{var a=c=>{try{u(n.next(c))}catch(d){s(d)}},l=c=>{try{u(n.throw(c))}catch(d){s(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((n=n.apply(i,t)).next())}),Yt=Uint8Array,ni=Uint16Array,Oh=Uint32Array,zh=new Yt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Bh=new Yt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),td=new Yt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nh=function(i,t){for(var n=new ni(31),r=0;r<31;++r)n[r]=t+=1<<i[r-1];for(var s=new Oh(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)s[a]=a-n[r]<<5|r;return[n,s]},Fh=Nh(zh,2),Rh=Fh[0],ed=Fh[1];Rh[28]=258,ed[258]=28;var id=Nh(Bh,0),nd=id[0],Zh=new ni(32768);for(ft=0;ft<32768;++ft)ve=(ft&43690)>>>1|(ft&21845)<<1,ve=(ve&52428)>>>2|(ve&13107)<<2,ve=(ve&61680)>>>4|(ve&3855)<<4,Zh[ft]=((ve&65280)>>>8|(ve&255)<<8)>>>1;var ve,ft,Xi=function(i,t,n){for(var r=i.length,s=0,a=new ni(t);s<r;++s)i[s]&&++a[i[s]-1];var l=new ni(t);for(s=0;s<t;++s)l[s]=l[s-1]+a[s-1]<<1;var u;{u=new ni(1<<t);var c=15-t;for(s=0;s<r;++s)if(i[s])for(var d=s<<4|i[s],p=t-i[s],m=l[i[s]-1]++<<p,v=m|(1<<p)-1;m<=v;++m)u[Zh[m]>>>c]=d}return u},tn=new Yt(288);for(ft=0;ft<144;++ft)tn[ft]=8;var ft;for(ft=144;ft<256;++ft)tn[ft]=9;var ft;for(ft=256;ft<280;++ft)tn[ft]=7;var ft;for(ft=280;ft<288;++ft)tn[ft]=8;var ft,Yh=new Yt(32);for(ft=0;ft<32;++ft)Yh[ft]=5;var ft,rd=Xi(tn,9),od=Xi(Yh,5),Yr=function(i){for(var t=i[0],n=1;n<i.length;++n)i[n]>t&&(t=i[n]);return t},$t=function(i,t,n){var r=t/8|0;return(i[r]|i[r+1]<<8)>>(t&7)&n},Xr=function(i,t){var n=t/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(t&7)},sd=function(i){return(i+7)/8|0},ad=function(i,t,n){(n==null||n>i.length)&&(n=i.length);var r=new(i.BYTES_PER_ELEMENT==2?ni:i.BYTES_PER_ELEMENT==4?Oh:Yt)(n-t);return r.set(i.subarray(t,n)),r},hd=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Jt=function(i,t,n){var r=new Error(t||hd[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,Jt),!n)throw r;return r},Po=function(i,t,n){var r=i.length;if(!r||n&&n.f&&!n.l)return t||new Yt(0);var s=!t||n,a=!n||n.i;n||(n={}),t||(t=new Yt(r*3));var l=function(q){var ot=t.length;if(q>ot){var ut=new Yt(Math.max(ot*2,q));ut.set(t),t=ut}},u=n.f||0,c=n.p||0,d=n.b||0,p=n.l,m=n.d,v=n.m,b=n.n,P=r*8;do{if(!p){u=$t(i,c,1);var C=$t(i,c+1,3);if(c+=3,C)if(C==1)p=rd,m=od,v=9,b=5;else if(C==2){var w=$t(i,c,31)+257,y=$t(i,c+10,15)+4,S=w+$t(i,c+5,31)+1;c+=14;for(var E=new Yt(S),T=new Yt(19),k=0;k<y;++k)T[td[k]]=$t(i,c+k*3,7);c+=y*3;for(var B=Yr(T),N=(1<<B)-1,Z=Xi(T,B),k=0;k<S;){var j=Z[$t(i,c,N)];c+=j&15;var z=j>>>4;if(z<16)E[k++]=z;else{var U=0,x=0;for(z==16?(x=3+$t(i,c,3),c+=2,U=E[k-1]):z==17?(x=3+$t(i,c,7),c+=3):z==18&&(x=11+$t(i,c,127),c+=7);x--;)E[k++]=U}}var D=E.subarray(0,w),O=E.subarray(w);v=Yr(D),b=Yr(O),p=Xi(D,v),m=Xi(O,b)}else Jt(1);else{var z=sd(c)+4,I=i[z-4]|i[z-3]<<8,g=z+I;if(g>r){a&&Jt(0);break}s&&l(d+I),t.set(i.subarray(z,g),d),n.b=d+=I,n.p=c=g*8,n.f=u;continue}if(c>P){a&&Jt(0);break}}s&&l(d+131072);for(var W=(1<<v)-1,X=(1<<b)-1,$=c;;$=c){var U=p[Xr(i,c)&W],R=U>>>4;if(c+=U&15,c>P){a&&Jt(0);break}if(U||Jt(2),R<256)t[d++]=R;else if(R==256){$=c,p=null;break}else{var G=R-254;if(R>264){var k=R-257,H=zh[k];G=$t(i,c,(1<<H)-1)+Rh[k],c+=H}var it=m[Xr(i,c)&X],Q=it>>>4;it||Jt(3),c+=it&15;var O=nd[Q];if(Q>3){var H=Bh[Q];O+=Xr(i,c)&(1<<H)-1,c+=H}if(c>P){a&&Jt(0);break}s&&l(d+131072);for(var K=d+G;d<K;d+=4)t[d]=t[d-O],t[d+1]=t[d+1-O],t[d+2]=t[d+2-O],t[d+3]=t[d+3-O];d=K}}n.l=p,n.p=$,n.b=d,n.f=u,p&&(u=1,n.m=v,n.d=m,n.n=b)}while(!u);return d==t.length?t:ad(t,0,d)},ld=new Yt(0),ud=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&Jt(6,"invalid gzip data");var t=i[3],n=10;t&4&&(n+=i[10]|(i[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!i[n++]);return n+(t&2)},cd=function(i){var t=i.length;return(i[t-4]|i[t-3]<<8|i[t-2]<<16|i[t-1]<<24)>>>0},fd=function(i){((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)&&Jt(6,"invalid zlib data"),i[1]&32&&Jt(6,"invalid zlib data: preset dictionaries not supported")};function dd(i,t){return Po(i,t)}function pd(i,t){return Po(i.subarray(ud(i),-8),new Yt(cd(i)))}function md(i,t){return Po((fd(i),i.subarray(2,-4)),t)}function ao(i,t){return i[0]==31&&i[1]==139&&i[2]==8?pd(i):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?dd(i,t):md(i,t)}var _d=typeof TextDecoder<"u"&&new TextDecoder,gd=0;try{_d.decode(ld,{stream:!0}),gd=1}catch{}var Xh=(i,t)=>i*Math.pow(2,t),Ei=(i,t)=>Math.floor(i/Math.pow(2,t)),Kn=(i,t)=>Xh(i.getUint16(t+1,!0),8)+i.getUint8(t),Uh=(i,t)=>Xh(i.getUint32(t+2,!0),16)+i.getUint16(t,!0),vd=(i,t,n,r,s)=>{if(i!=r.getUint8(s))return i-r.getUint8(s);const a=Kn(r,s+1);if(t!=a)return t-a;const l=Kn(r,s+4);return n!=l?n-l:0},yd=(i,t,n,r)=>{const s=jh(i,t|128,n,r);return s?{z:t,x:n,y:r,offset:s[0],length:s[1],is_dir:!0}:null},ua=(i,t,n,r)=>{const s=jh(i,t,n,r);return s?{z:t,x:n,y:r,offset:s[0],length:s[1],is_dir:!1}:null},jh=(i,t,n,r)=>{let s=0,a=i.byteLength/17-1;for(;s<=a;){const l=a+s>>1,u=vd(t,n,r,i,l*17);if(u>0)s=l+1;else if(u<0)a=l-1;else return[Uh(i,l*17+7),i.getUint32(l*17+13,!0)]}return null},wd=(i,t)=>i.is_dir&&!t.is_dir?1:!i.is_dir&&t.is_dir?-1:i.z!==t.z?i.z-t.z:i.x!==t.x?i.x-t.x:i.y-t.y,Wh=(i,t)=>{const n=i.getUint8(t*17);return{z:n&127,x:Kn(i,t*17+1),y:Kn(i,t*17+4),offset:Uh(i,t*17+7),length:i.getUint32(t*17+13,!0),is_dir:n>>7===1}},ca=i=>{const t=[],n=new DataView(i);for(let r=0;r<n.byteLength/17;r++)t.push(Wh(n,r));return xd(t)},xd=i=>{i.sort(wd);const t=new ArrayBuffer(17*i.length),n=new Uint8Array(t);for(let r=0;r<i.length;r++){const s=i[r];let a=s.z;s.is_dir&&(a=a|128),n[r*17]=a,n[r*17+1]=s.x&255,n[r*17+2]=s.x>>8&255,n[r*17+3]=s.x>>16&255,n[r*17+4]=s.y&255,n[r*17+5]=s.y>>8&255,n[r*17+6]=s.y>>16&255,n[r*17+7]=s.offset&255,n[r*17+8]=Ei(s.offset,8)&255,n[r*17+9]=Ei(s.offset,16)&255,n[r*17+10]=Ei(s.offset,24)&255,n[r*17+11]=Ei(s.offset,32)&255,n[r*17+12]=Ei(s.offset,48)&255,n[r*17+13]=s.length&255,n[r*17+14]=s.length>>8&255,n[r*17+15]=s.length>>16&255,n[r*17+16]=s.length>>24&255}return t},bd=(i,t)=>{if(i.byteLength<17)return null;const n=i.byteLength/17,r=Wh(i,n-1);if(r.is_dir){const s=r.z,a=t.z-s,l=Math.trunc(t.x/(1<<a)),u=Math.trunc(t.y/(1<<a));return{z:s,x:l,y:u}}return null};function Md(i){return At(this,null,function*(){const t=yield i.getBytes(0,512e3),n=new DataView(t.data),r=n.getUint32(4,!0),s=n.getUint16(8,!0),a=new TextDecoder("utf-8"),l=JSON.parse(a.decode(new DataView(t.data,10,r)));let u=0;l.compression==="gzip"&&(u=2);let c=0;"minzoom"in l&&(c=+l.minzoom);let d=0;"maxzoom"in l&&(d=+l.maxzoom);let p=0,m=0,v=0,b=-180,P=-85,C=180,z=85;if(l.bounds){const g=l.bounds.split(",");b=+g[0],P=+g[1],C=+g[2],z=+g[3]}if(l.center){const g=l.center.split(",");p=+g[0],m=+g[1],v=+g[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:c,maxZoom:d,minLon:b,minLat:P,maxLon:C,maxLat:z,centerZoom:v,centerLon:p,centerLat:m,etag:t.etag}})}function Pd(i,t,n,r,s,a,l){return At(this,null,function*(){let u=yield n.getArrayBuffer(t,i.rootDirectoryOffset,i.rootDirectoryLength,i);i.specVersion===1&&(u=ca(u));const c=ua(new DataView(u),r,s,a);if(c){let m=(yield t.getBytes(c.offset,c.length,l)).data;const v=new DataView(m);return v.getUint8(0)==31&&v.getUint8(1)==139&&(m=ao(new Uint8Array(m))),{data:m}}const d=bd(new DataView(u),{z:r,x:s,y:a});if(d){const p=yd(new DataView(u),d.z,d.x,d.y);if(p){let m=yield n.getArrayBuffer(t,p.offset,p.length,i);i.specVersion===1&&(m=ca(m));const v=ua(new DataView(m),r,s,a);if(v){let P=(yield t.getBytes(v.offset,v.length,l)).data;const C=new DataView(P);return C.getUint8(0)==31&&C.getUint8(1)==139&&(P=ao(new Uint8Array(P))),{data:P}}}}})}var Vh={getHeader:Md,getZxy:Pd};function Ke(i,t){return(t>>>0)*4294967296+(i>>>0)}function Ld(i,t){const n=t.buf;let r,s;if(s=n[t.pos++],r=(s&112)>>4,s<128||(s=n[t.pos++],r|=(s&127)<<3,s<128)||(s=n[t.pos++],r|=(s&127)<<10,s<128)||(s=n[t.pos++],r|=(s&127)<<17,s<128)||(s=n[t.pos++],r|=(s&127)<<24,s<128)||(s=n[t.pos++],r|=(s&1)<<31,s<128))return Ke(i,r);throw new Error("Expected varint not more than 10 bytes")}function Ci(i){const t=i.buf;let n,r;return r=t[i.pos++],n=r&127,r<128||(r=t[i.pos++],n|=(r&127)<<7,r<128)||(r=t[i.pos++],n|=(r&127)<<14,r<128)||(r=t[i.pos++],n|=(r&127)<<21,r<128)?n:(r=t[i.pos],n|=(r&15)<<28,Ld(n,i))}function Sd(i,t,n,r){if(r==0){n==1&&(t[0]=i-1-t[0],t[1]=i-1-t[1]);const s=t[0];t[0]=t[1],t[1]=s}}function Ed(i,t,n){if(i>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Math.pow(2,i)-1||n>Math.pow(2,i)-1)throw Error("tile x/y outside zoom level bounds");let r=0,s=0;for(;s<i;)r+=Math.pow(2,s)*Math.pow(2,s),s++;const a=Math.pow(2,i);let l=0,u=0,c=0;const d=[t,n];let p=a/2;for(;p>0;)l=(d[0]&p)>0?1:0,u=(d[1]&p)>0?1:0,c+=p*p*(3*l^u),Sd(p,d,l,u),p=p/2;return r+c}function Hh(i,t){return At(this,null,function*(){if(t===1||t===0)return i;if(t===2)return ao(new Uint8Array(i));throw Error("Compression method not supported")})}var Cd=127;function kd(i,t){let n=0,r=i.length-1;for(;n<=r;){const s=r+n>>1,a=t-i[s].tileId;if(a>0)n=s+1;else if(a<0)r=s-1;else return i[s]}return r>=0&&(i[r].runLength===0||t-i[r].tileId<i[r].runLength)?i[r]:null}var Td=class{constructor(i){this.url=i}getKey(){return this.url}getBytes(i,t,n){return At(this,null,function*(){let r;n||(r=new AbortController,n=r.signal);let s=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+i+"-"+(i+t-1)}});if(s.status===416&&i===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const c=+u.substr(8);s=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(c-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const a=s.headers.get("Content-Length");if(s.status===200&&(!a||+a>t))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function qt(i,t){const n=i.getUint32(t+4,!0),r=i.getUint32(t+0,!0);return n*Math.pow(2,32)+r}function Dd(i,t){const n=new DataView(i),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:qt(n,8),rootDirectoryLength:qt(n,16),jsonMetadataOffset:qt(n,24),jsonMetadataLength:qt(n,32),leafDirectoryOffset:qt(n,40),leafDirectoryLength:qt(n,48),tileDataOffset:qt(n,56),tileDataLength:qt(n,64),numAddressedTiles:qt(n,72),numTileEntries:qt(n,80),numTileContents:qt(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:t}}function Gh(i){const t={buf:new Uint8Array(i),pos:0},n=Ci(t),r=[];let s=0;for(let a=0;a<n;a++){const l=Ci(t);r.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let a=0;a<n;a++)r[a].runLength=Ci(t);for(let a=0;a<n;a++)r[a].length=Ci(t);for(let a=0;a<n;a++){const l=Ci(t);l===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=l-1}return r}function Ad(i){const t=new DataView(i);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ei=class extends Error{};function Id(i,t,n,r){return At(this,null,function*(){const s=yield i.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ad(s.data)<3)return[yield Vh.getHeader(i)];const l=s.data.slice(0,Cd);let u=s.etag;r&&s.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+i.getKey()),u=void 0);const c=Dd(l,u);if(n){const d=s.data.slice(c.rootDirectoryOffset,c.rootDirectoryOffset+c.rootDirectoryLength),p=i.getKey()+"|"+(c.etag||"")+"|"+c.rootDirectoryOffset+"|"+c.rootDirectoryLength,m=Gh(yield t(d,c.internalCompression));return[c,[p,m.length,m]]}return[c,void 0]})}function Od(i,t,n,r,s){return At(this,null,function*(){const a=yield i.getBytes(n,r);if(s.etag&&s.etag!==a.etag)throw new ei(a.etag);const l=yield t(a.data,s.internalCompression),u=Gh(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var zd=class{constructor(i=100,t=!0,n=Hh){this.cache=new Map,this.maxCacheEntries=i,this.counter=1,this.prefetch=t,this.decompress=n}getHeader(i,t){return At(this,null,function*(){const n=i.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const r=new Promise((s,a)=>{Id(i,this.decompress,this.prefetch,t).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{a(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:r}),r})}getDirectory(i,t,n,r){return At(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{Od(i,this.decompress,t,n,r).then(c=>{l(c),this.prune()}).catch(c=>{u(c)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}getArrayBuffer(i,t,n,r){return At(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{i.getBytes(t,n).then(c=>{if(r.etag&&r.etag!==c.etag)throw new ei(c.etag);l(c.data),this.cache.has(s),this.prune()}).catch(c=>{u(c)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let i=1/0,t;this.cache.forEach((n,r)=>{n.lastUsed<i&&(i=n.lastUsed,t=r)}),t&&this.cache.delete(t)}}invalidate(i,t){return At(this,null,function*(){this.cache.delete(i.getKey()),yield this.getHeader(i,t)})}},Bd=class{constructor(i,t,n){typeof i=="string"?this.source=new Td(i):this.source=i,n?this.decompress=n:this.decompress=Hh,t?this.cache=t:this.cache=new zd}getHeader(){return At(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(i,t,n,r){return At(this,null,function*(){const s=Ed(i,t,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return Vh.getZxy(a,this.source,this.cache,i,t,n,r);if(i<a.minZoom||i>a.maxZoom)return;let l=a.rootDirectoryOffset,u=a.rootDirectoryLength;for(let c=0;c<=3;c++){const d=yield this.cache.getDirectory(this.source,l,u,a),p=kd(d,s);if(p)if(p.runLength>0){const m=yield this.source.getBytes(a.tileDataOffset+p.offset,p.length,r);if(a.etag&&a.etag!==m.etag)throw new ei(m.etag);return{data:yield this.decompress(m.data,a.tileCompression),cacheControl:m.cacheControl,expires:m.expires}}else l=a.leafDirectoryOffset+p.offset,u=p.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(i,t,n,r){return At(this,null,function*(){try{return yield this.getZxyAttempt(i,t,n,r)}catch(s){if(s instanceof ei)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(i,t,n,r);throw s}})}getMetadataAttempt(){return At(this,null,function*(){const i=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(i.jsonMetadataOffset,i.jsonMetadataLength);if(i.etag&&i.etag!==t.etag)throw new ei(t.etag);const n=yield this.decompress(t.data,i.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return At(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(i){if(i instanceof ei)return this.cache.invalidate(this.source,i.message),yield this.getMetadataAttempt();throw i}})}},ri;(function(i){i[i.Point=1]="Point",i[i.Line=2]="Line",i[i.Polygon=3]="Polygon"})(ri||(ri={}));function Ne(i){return i.x+":"+i.y+":"+i.z}var Nd=(i,t,n)=>{i.pos=t;for(var r=i.readVarint()+i.pos,s=1,a=0,l=0,u=0,c=1/0,d=-1/0,p=1/0,m=-1/0,v=[],b=[];i.pos<r;){if(a<=0){var P=i.readVarint();s=P&7,a=P>>3}if(a--,s===1||s===2)l+=i.readSVarint()*n,u+=i.readSVarint()*n,l<c&&(c=l),l>d&&(d=l),u<p&&(p=u),u>m&&(m=u),s===1&&(b.length>0&&v.push(b),b=[]),b.push(new $i.default(l,u));else if(s===7)b&&b.push(b[0].clone());else throw new Error("unknown command "+s)}return b&&v.push(b),{geom:v,bbox:{minX:c,minY:p,maxX:d,maxY:m}}};function $h(i,t){let n=new Kf.VectorTile(new Qf.default(i)),r=new Map;for(let[s,a]of Object.entries(n.layers)){let l=[],u=a;for(let c=0;c<u.length;c++){let d=Nd(u.feature(c)._pbf,u.feature(c)._geometry,t/u.extent),p=0;for(let m of d.geom)p+=m.length;l.push({id:u.feature(c).id,geomType:u.feature(c).type,geom:d.geom,numVertices:p,bbox:d.bbox,props:u.feature(c).properties})}r.set(s,l)}return r}var fa=class{constructor(i,t){typeof i=="string"?this.p=new Bd(i):this.p=i,this.controllers=[],this.shouldCancelZooms=t}get(i,t){return ai(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));const n=new AbortController;this.controllers.push([i.z,n]);const r=n.signal;let s=yield this.p.getZxy(i.z,i.x,i.y,r);return s?$h(s.data,t):new Map})}},Fd=class{constructor(i,t){this.url=i,this.controllers=[],this.shouldCancelZooms=t}get(i,t){return ai(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));let n=this.url.replace("{z}",i.z.toString()).replace("{x}",i.x.toString()).replace("{y}",i.y.toString());const r=new AbortController;this.controllers.push([i.z,r]);const s=r.signal;return new Promise((a,l)=>{fetch(n,{signal:s}).then(u=>u.arrayBuffer()).then(u=>{let c=$h(u,t);a(c)}).catch(u=>{l(u)})})})}},ho=6378137,da=85.0511287798,kn=ho*Math.PI,Rd=i=>{let t=Math.PI/180,n=Math.max(Math.min(da,i[0]),-da),r=Math.sin(n*t);return new $i.default(ho*i[1]*t,ho*Math.log((1+r)/(1-r))/2)};function pa(i){return i*i}function Rn(i,t){return pa(i.x-t.x)+pa(i.y-t.y)}function Zd(i,t,n){var r=Rn(t,n);if(r===0)return Rn(i,t);var s=((i.x-t.x)*(n.x-t.x)+(i.y-t.y)*(n.y-t.y))/r;return s=Math.max(0,Math.min(1,s)),Rn(i,new $i.default(t.x+s*(n.x-t.x),t.y+s*(n.y-t.y)))}function ma(i,t){for(var n=!1,r=0,s=t.length-1;r<t.length;s=r++){var a=t[r].x,l=t[r].y,u=t[s].x,c=t[s].y,d=l>i.y!=c>i.y&&i.x<(u-a)*(i.y-l)/(c-l)+a;d&&(n=!n)}return n}function Yd(i){for(var t=0,n=0;n<i.length;n++){let r=(n+1)%i.length;t+=i[n].x*i[r].y,t-=i[r].x*i[n].y}return t<0}function Xd(i,t){var n=!1;for(let r of t)if(Yd(r))ma(i,r)&&(n=!1);else{if(n)return!0;ma(i,r)&&(n=!0)}return n}function Ud(i,t){let n=1/0;for(let r of t){let s=Math.sqrt(Rn(i,r[0]));s<n&&(n=s)}return n}function jd(i,t){let n=1/0;for(let s of t)for(var r=0;r<s.length-1;r++){let a=Math.sqrt(Zd(i,s[r],s[r+1]));a<n&&(n=a)}return n}var Wd=class{constructor(i,t){this.source=i,this.cache=new Map,this.inflight=new Map,this.tileSize=t}queryFeatures(i,t,n,r){let s=Rd([t,i]);var a=new $i.default((s.x+kn)/(kn*2),1-(s.y+kn)/(kn*2));a.x>1&&(a.x=a.x-Math.floor(a.x));let l=a.mult(1<<n),u=Math.floor(l.x),c=Math.floor(l.y);const d=Ne({z:n,x:u,y:c});let p=[],m=this.cache.get(d);if(m){const v=new $i.default((l.x-u)*this.tileSize,(l.y-c)*this.tileSize);for(let[b,P]of m.data.entries())for(let C of P)C.geomType==1?Ud(v,C.geom)<r&&p.push({feature:C,layerName:b}):C.geomType==2?jd(v,C.geom)<r&&p.push({feature:C,layerName:b}):Xd(v,C.geom)&&p.push({feature:C,layerName:b})}return p}get(i){return ai(this,null,function*(){const t=Ne(i);return new Promise((n,r)=>{let s=this.cache.get(t);if(s)s.used=performance.now(),n(s.data);else{let a=this.inflight.get(t);a?a.push([n,r]):(this.inflight.set(t,[]),this.source.get(i,this.tileSize).then(l=>{this.cache.set(t,{used:performance.now(),data:l});let u=this.inflight.get(t);if(u&&u.forEach(c=>c[0](l)),this.inflight.delete(t),n(l),this.cache.size>=64){let c=1/0,d;this.cache.forEach((p,m)=>{p.used<c&&(c=p.used,d=m)}),d&&this.cache.delete(d)}}).catch(l=>{let u=this.inflight.get(t);u&&u.forEach(c=>c[1](l)),this.inflight.delete(t),r(l)}))}})})}},qh=(i,t,n)=>{let r=[];for(let s of i){let a=[];for(let l of s)a.push(l.clone().mult(t).add(n));r.push(a)}return r},Tn=(i,t)=>{let n=1<<t;return i<0&&(i=n+i),i>=n&&(i=i%n),i},Vd=class{constructor(i,t,n){this.tileCache=i,this.maxDataLevel=t,this.levelDiff=n}dataTilesForBounds(i,t){let n=Math.pow(2,i)/Math.pow(2,Math.ceil(i)),r=[];var s=1,a=this.tileCache.tileSize;if(i<this.levelDiff)s=1/(1<<this.levelDiff-i)*n,r.push({data_tile:{z:0,x:0,y:0},origin:new Je.default(0,0),scale:s,dim:a*s});else if(i<=this.levelDiff+this.maxDataLevel){let c=1<<this.levelDiff,d=256*n,p=Math.ceil(i)-this.levelDiff,m=Math.floor(t.minX/c/d),v=Math.floor(t.minY/c/d),b=Math.floor(t.maxX/c/d),P=Math.floor(t.maxY/c/d);for(var l=m;l<=b;l++)for(var u=v;u<=P;u++){let C=new Je.default(l*c*d,u*c*d);r.push({data_tile:{z:p,x:Tn(l,p),y:Tn(u,p)},origin:C,scale:n,dim:a*n})}}else{let c=1<<this.levelDiff;s=(1<<Math.ceil(i)-this.maxDataLevel-this.levelDiff)*n;let d=Math.floor(t.minX/c/256/s),p=Math.floor(t.minY/c/256/s),m=Math.floor(t.maxX/c/256/s),v=Math.floor(t.maxY/c/256/s);for(var l=d;l<=m;l++)for(var u=p;u<=v;u++){let C=new Je.default(l*c*256*s,u*c*256*s);r.push({data_tile:{z:this.maxDataLevel,x:Tn(l,this.maxDataLevel),y:Tn(u,this.maxDataLevel)},origin:C,scale:s,dim:a*s})}}return r}dataTileForDisplayTile(i){var t,n=1,r=this.tileCache.tileSize,s;if(i.z<this.levelDiff)t={z:0,x:0,y:0},n=1/(1<<this.levelDiff-i.z),s=new Je.default(0,0),r=r*n;else if(i.z<=this.levelDiff+this.maxDataLevel){let a=1<<this.levelDiff;t={z:i.z-this.levelDiff,x:Math.floor(i.x/a),y:Math.floor(i.y/a)},s=new Je.default(t.x*a*256,t.y*a*256)}else{n=1<<i.z-this.maxDataLevel-this.levelDiff;let a=1<<this.levelDiff;t={z:this.maxDataLevel,x:Math.floor(i.x/a/n),y:Math.floor(i.y/a/n)},s=new Je.default(t.x*a*n*256,t.y*a*n*256),r=r*n}return{data_tile:t,scale:n,origin:s,dim:r}}getBbox(i,t){return ai(this,null,function*(){let n=this.dataTilesForBounds(i,t);return(yield Promise.all(n.map(s=>this.tileCache.get(s.data_tile)))).map((s,a)=>{let l=n[a];return{data:s,z:i,data_tile:l.data_tile,scale:l.scale,dim:l.dim,origin:l.origin}})})}getDisplayTile(i){return ai(this,null,function*(){let t=this.dataTileForDisplayTile(i);return{data:yield this.tileCache.get(t.data_tile),z:i.z,data_tile:t.data_tile,scale:t.scale,origin:t.origin,dim:t.dim}})}queryFeatures(i,t,n){let r=Math.round(n),s=Math.min(r-this.levelDiff,this.maxDataLevel),a=16/(1<<r-s);return this.tileCache.queryFeatures(i,t,s,a)}},Hd=i=>{let t=r=>{let s=r.levelDiff===void 0?2:r.levelDiff,a=r.maxDataZoom||14,l;typeof r.url=="string"?r.url.endsWith(".pmtiles")?l=new fa(r.url,!0):l=new Fd(r.url,!0):l=new fa(r.url,!0);let u=new Wd(l,256*1<<s);return new Vd(u,a,s)},n=new Map;if(i.sources)for(const r in i.sources)n.set(r,t(i.sources[r]));else n.set("",t(i));return n},Gd=Xt(we());function $d(i,t,n,r,s,a,l,u,c){let d=performance.now();i.save(),i.miterLimit=2;for(var p of s){if(p.minzoom&&t<p.minzoom||p.maxzoom&&t>p.maxzoom)continue;let P=n.get(p.dataSource||"");if(P)for(let C of P){var m=C.data.get(p.dataLayer);if(m===void 0)continue;p.symbolizer.before&&p.symbolizer.before(i,C.z);let z=C.origin;C.dim;let I=C.scale;i.save(),i.translate(z.x-l.x,z.y-l.y);for(var v of m){let g=v.geom,w=v.bbox;w.maxX*I+z.x<a.minX||w.minX*I+z.x>a.maxX||w.minY*I+z.y>a.maxY||w.maxY*I+z.y<a.minY||p.filter&&!p.filter(C.z,v)||(I!=1&&(g=qh(g,I,new Gd.default(0,0))),p.symbolizer.draw(i,g,C.z,v))}i.restore()}}if(r){let P=r.searchBbox(a,1/0);for(var b of P)if(i.save(),i.translate(b.anchor.x-l.x,b.anchor.y-l.y),b.draw(i),i.restore(),c){i.lineWidth=.5,i.strokeStyle=c,i.fillStyle=c,i.globalAlpha=1,i.fillRect(b.anchor.x-l.x-2,b.anchor.y-l.y-2,4,4);for(let C of b.bboxes)i.strokeRect(C.minX-l.x,C.minY-l.y,C.maxX-C.minX,C.maxY-C.minY)}}return i.restore(),performance.now()-d}var qd=Xt(we()),Jd=Xt(Gf()),Kd=(i,t,n)=>{let r=256,s=t/r,a=Math.floor(n.minX/r),l=Math.floor(n.minY/r),u=Math.floor(n.maxX/r),c=Math.floor(n.maxY/r),d=Math.log2(s),p=[];for(let m=a;m<=u;m++){let v=m%(1<<i);for(let b=l;b<=c;b++)p.push({display:Ne({z:i,x:v,y:b}),key:Ne({z:i-d,x:Math.floor(v/s),y:Math.floor(b/s)})})}return p},Qd=class{constructor(i,t){this.tree=new Jd.default,this.current=new Map,this.dim=i,this.maxLabeledTiles=t}hasPrefix(i){for(let t of this.current.keys())if(t.startsWith(i))return!0;return!1}has(i){return this.current.has(i)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(i,t){let n=new Set;for(let r of this.tree.search(i))r.indexed_label.order<=t&&n.add(r.indexed_label);return n}searchLabel(i,t){let n=new Set;for(let r of i.bboxes)for(let s of this.tree.search(r))s.indexed_label.order<=t&&n.add(s.indexed_label);return n}bboxCollides(i,t){for(let n of this.tree.search(i))if(n.indexed_label.order<=t)return!0;return!1}labelCollides(i,t){for(let n of i.bboxes)for(let r of this.tree.search(n))if(r.indexed_label.order<=t)return!0;return!1}deduplicationCollides(i){if(!i.deduplicationKey||!i.deduplicationDistance)return!1;let t=i.deduplicationDistance,n={minX:i.anchor.x-t,minY:i.anchor.y-t,maxX:i.anchor.x+t,maxY:i.anchor.y+t};for(let r of this.tree.search(n))if(r.indexed_label.deduplicationKey===i.deduplicationKey&&r.indexed_label.anchor.dist(i.anchor)<t)return!0;return!1}makeEntry(i){this.current.get(i)&&console.log("consistency error 1");let t=new Set;this.current.set(i,t)}insert(i,t,n){let r={anchor:i.anchor,bboxes:i.bboxes,draw:i.draw,order:t,tileKey:n,deduplicationKey:i.deduplicationKey,deduplicationDistance:i.deduplicationDistance},s=this.current.get(n);if(!s){let p=new Set;this.current.set(n,p),s=p}s.add(r);var a=!1,l=!1;for(let p of i.bboxes){var u=p;u.indexed_label=r,this.tree.insert(u),p.minX<0&&(a=!0),p.maxX>this.dim&&(l=!0)}if(a||l){var c=a?this.dim:-this.dim,d=[];for(let v of i.bboxes)d.push({minX:v.minX+c,minY:v.minY,maxX:v.maxX+c,maxY:v.maxY});let p={anchor:new qd.default(i.anchor.x+c,i.anchor.y),bboxes:d,draw:i.draw,order:t,tileKey:n},m=this.current.get(n);m&&m.add(p);for(let v of d){var u=v;u.indexed_label=p,this.tree.insert(u)}}}pruneOrNoop(i){let t=i.split(":"),n,r=0,s=0;for(var a of this.current.keys()){let l=a.split(":");if(l[3]===t[3]){s++;let u=Math.sqrt(Math.pow(+l[0]-+t[0],2)+Math.pow(+l[1]-+t[1],2));u>r&&(r=u,n=a)}n&&s>this.maxLabeledTiles&&this.pruneKey(n)}}pruneKey(i){let t=this.current.get(i);if(!t)return;let n=[];for(let r of this.tree.all())t.has(r.indexed_label)&&n.push(r);n.forEach(r=>{this.tree.remove(r)}),this.current.delete(i)}removeLabel(i){let t=[];for(let r of this.tree.all())i==r.indexed_label&&t.push(r);t.forEach(r=>{this.tree.remove(r)});let n=this.current.get(i.tileKey);n&&n.delete(i)}},tp=class{constructor(i,t,n,r,s){this.index=new Qd(256*1<<i,r),this.z=i,this.scratch=t,this.labelRules=n,this.callback=s}layout(i){let t=performance.now(),n=new Set;for(let[l,u]of i)for(let c of u){let d=Ne(c.data_tile)+":"+l;this.index.has(d)||(this.index.makeEntry(d),n.add(d))}let r=new Set;for(let[l,u]of this.labelRules.entries()){if(u.visible==!1||u.minzoom&&this.z<u.minzoom||u.maxzoom&&this.z>u.maxzoom)continue;let c=u.dataSource||"",d=i.get(c);if(d)for(let p of d){let m=Ne(p.data_tile)+":"+c;if(!n.has(m))continue;let v=p.data.get(u.dataLayer);if(v===void 0)continue;let b=v;u.sort&&b.sort((C,z)=>u.sort?u.sort(C.props,z.props):0);let P={index:this.index,zoom:this.z,scratch:this.scratch,order:l,overzoom:this.z-p.data_tile.z};for(let C of b){if(u.filter&&!u.filter(this.z,C))continue;let z=qh(C.geom,p.scale,p.origin),I=u.symbolizer.place(P,z,C);if(I)for(let g of I){var s=!1;if(!(g.deduplicationKey&&this.index.deduplicationCollides(g))){if(this.index.labelCollides(g,1/0)){if(!this.index.labelCollides(g,l)){let w=this.index.searchLabel(g,1/0);for(let y of w){this.index.removeLabel(y);for(let S of y.bboxes)this.findInvalidatedTiles(r,p.dim,S,m)}this.index.insert(g,l,m),s=!0}}else this.index.insert(g,l,m),s=!0;if(s)for(let w of g.bboxes)(w.maxX>p.origin.x+p.dim||w.minX<p.origin.x||w.minY<p.origin.y||w.maxY>p.origin.y+p.dim)&&this.findInvalidatedTiles(r,p.dim,w,m)}}}}}for(var a of n)this.index.pruneOrNoop(a);return r.size>0&&this.callback&&this.callback(r),performance.now()-t}findInvalidatedTiles(i,t,n,r){let s=Kd(this.z,t,n);for(let a of s)a.key!=r&&this.index.hasPrefix(a.key)&&i.add(a.display)}add(i){var t=!0;for(let[n,r]of i)for(let s of r)this.index.has(Ne(s.data_tile)+":"+n)||(t=!1);return t?0:this.layout(i)}},_a=class{constructor(i,t,n,r){this.labelers=new Map,this.scratch=i,this.labelRules=t,this.maxLabeledTiles=n,this.callback=r}add(i,t){var n=this.labelers.get(i);return n||(n=new tp(i,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(i,n)),n.add(t)}getIndex(i){let t=this.labelers.get(i);if(t)return t.index}},ga={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"},va={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function Ui(i,t,n){return Math.min(Math.max(i,n),t)}var ki=class extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}};function ep(i){if(typeof i!="string")throw new ki(i);if(i.trim().toLowerCase()==="transparent")return[0,0,0,0];let t=i.trim();t=ap.test(i)?(function(l){const u=l.toLowerCase().trim(),c=ip[(function(d){let p=5381,m=d.length;for(;m;)p=33*p^d.charCodeAt(--m);return(p>>>0)%2341})(u)];if(!c)throw new ki(l);return`#${c}`})(i):i;const n=np.exec(t);if(n){const l=Array.from(n).slice(1);return[...l.slice(0,3).map(u=>parseInt(qi(u,2),16)),parseInt(qi(l[3]||"f",2),16)/255]}const r=rp.exec(t);if(r){const l=Array.from(r).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,16)),parseInt(l[3]||"ff",16)/255]}const s=op.exec(t);if(s){const l=Array.from(s).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,10)),parseFloat(l[3]||"1")]}const a=sp.exec(t);if(a){const[l,u,c,d]=Array.from(a).slice(1).map(parseFloat);if(Ui(0,100,u)!==u)throw new ki(i);if(Ui(0,100,c)!==c)throw new ki(i);return[...hp(l,u,c),d||1]}throw new ki(i)}var ya=i=>parseInt(i.replace(/_/g,""),36),ip="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((i,t)=>{const n=ya(t.substring(0,3)),r=ya(t.substring(3)).toString(16);let s="";for(let a=0;a<6-r.length;a++)s+="0";return i[n]=`${s}${r}`,i},{}),qi=(i,t)=>Array.from(Array(t)).map(()=>i).join(""),np=new RegExp(`^#${qi("([a-f0-9])",3)}([a-f0-9])?$`,"i"),rp=new RegExp(`^#${qi("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),op=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${qi(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),sp=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ap=/^[a-z]+$/i,wa=i=>Math.round(255*i),hp=(i,t,n)=>{let r=n/100;if(t===0)return[r,r,r].map(wa);const s=(i%360+360)%360/60,a=(1-Math.abs(2*r-1))*(t/100),l=a*(1-Math.abs(s%2-1));let u=0,c=0,d=0;s>=0&&s<1?(u=a,c=l):s>=1&&s<2?(u=l,c=a):s>=2&&s<3?(c=a,d=l):s>=3&&s<4?(c=l,d=a):s>=4&&s<5?(u=l,d=a):s>=5&&s<6&&(u=a,d=l);const p=r-a/2;return[u+p,c+p,d+p].map(wa)};function xa(i){const[t,n,r,s]=ep(i).map((d,p)=>p===3?d:d/255),a=Math.max(t,n,r),l=Math.min(t,n,r),u=(a+l)/2;if(a===l)return[0,0,u,s];const c=a-l;return[60*(t===a?(n-r)/c+(n<r?6:0):n===a?(r-t)/c+2:(t-n)/c+4),u>.5?c/(2-a-l):c/(a+l),u,s]}function lp(i,t,n,r){return`hsla(${(i%360).toFixed()}, ${Ui(0,100,100*t).toFixed()}%, ${Ui(0,100,100*n).toFixed()}%, ${parseFloat(Ui(0,1,r).toFixed(3))})`}var Qt=Xt(we());Xt($f());var up=Xt(Jf()),Ft=class{constructor(i,t){this.str=i??t,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(i,t){return typeof this.str=="function"?this.str(i,t):this.str}},gt=class{constructor(i,t=1){this.value=i??t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,t){return typeof this.value=="function"?this.value(i,t):this.value}},Lo=class{constructor(i){var t;this.label_props=(t=i?.label_props)!=null?t:["name"],this.textTransform=i?.textTransform}get(i,t){let n,r;typeof this.label_props=="function"?r=this.label_props(i,t):r=this.label_props;for(let a of r)if(t.props.hasOwnProperty(a)&&typeof t.props[a]=="string"){n=t.props[a];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(i,t):s=this.textTransform,n&&s==="uppercase"?n=n.toUpperCase():n&&s==="lowercase"?n=n.toLowerCase():n&&s==="capitalize"&&(n=n.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),n}},So=class{constructor(i){var t,n;i?.font?this.font=i.font:(this.family=(t=i?.fontFamily)!=null?t:"sans-serif",this.size=(n=i?.fontSize)!=null?n:12,this.weight=i?.fontWeight,this.style=i?.fontStyle)}get(i,t){if(this.font)return typeof this.font=="function"?this.font(i,t):this.font;var n="";this.style&&(typeof this.style=="function"?n=this.style(i,t)+" ":n=this.style+" ");var r="";this.weight&&(typeof this.weight=="function"?r=this.weight(i,t)+" ":r=this.weight+" ");var s;typeof this.size=="function"?s=this.size(i,t):s=this.size;var a;return typeof this.family=="function"?a=this.family(i,t):a=this.family,`${n}${r}${s}px ${a}`}},cp=class{constructor(i,t=[]){this.value=i??t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,t){return typeof this.value=="function"?this.value(i,t):this.value}},ba=Xt(we()),fp=(i,t,n)=>{var r=[],s,a,l,u=0,c=0,d=0,p=0,m=0,v=0,b=0,P=0,C=0,z=0,I=0,g=0;if(i.length<2)return[];if(i.length===2)return d=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),[{length:d,beginIndex:0,beginDistance:0,endIndex:2,endDistance:d}];for(p=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),u=1,c=i.length-1;u<c;u++)s=i[u-1],a=i[u],l=i[u+1],v=a.x-s.x,b=a.y-s.y,P=l.x-a.x,C=l.y-a.y,m=Math.sqrt(P*P+C*C),d+=p,z=Math.acos((v*P+b*C)/(p*m)),(z>t||d-g>n)&&(r.push({length:d-g,beginDistance:g,beginIndex:I,endIndex:u+1,endDistance:d}),I=u,g=d),p=m;return u-I>0&&r.push({length:d-g+m,beginIndex:I,beginDistance:g,endIndex:u+1,endDistance:d+m}),r};function dp(i,t,n,r){let s=[];for(let l of i){let u=fp(l,Math.PI/45,t);for(let c of u)if(c.length>=t+r){let d=new ba.default(l[c.beginIndex].x,l[c.beginIndex].y),p=l[c.endIndex-1],m=new ba.default((p.x-d.x)/c.length,(p.y-d.y)/c.length);for(var a=r;a<c.length-t;a+=n)s.push({start:d.add(m.mult(a)),end:d.add(m.mult(a+t))})}}return s}function pp(i,t,n,r){let s=t.x-i.x,a=t.y-i.y,l=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),u=[];for(var c=0;c<n+r;c+=2*r){let d=c*1/l;u.push({x:i.x+d*s,y:i.y+d*a})}return u}function Jh(i,t){if(i.length<=t)return[i];let n=t-1,r=i.lastIndexOf(" ",n),s=i.indexOf(" ",n);if(r==-1&&s==-1)return[i];let a,l;return s==-1||r>=0&&n-r<s-n?(a=i.substring(0,r),l=i.substring(r+1,i.length)):(a=i.substring(0,s),l=i.substring(s+1,i.length)),[a,...Jh(l,t)]}var Kh=5400,Ma;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(Ma||(Ma={}));var Pa;(function(i){i[i.N=1]="N",i[i.NE=2]="NE",i[i.E=3]="E",i[i.SE=4]="SE",i[i.S=5]="S",i[i.SW=6]="SW",i[i.W=7]="W",i[i.NW=8]="NW"})(Pa||(Pa={}));var Dt=class{constructor(i){var t;this.pattern=i.pattern,this.fill=new Ft(i.fill,"black"),this.opacity=new gt(i.opacity,1),this.stroke=new Ft(i.stroke,"black"),this.width=new gt(i.width,0),this.per_feature=(t=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||i.per_feature)!=null?t:!1,this.do_stroke=!1}before(i,t){if(!this.per_feature){i.globalAlpha=this.opacity.get(t),i.fillStyle=this.fill.get(t),i.strokeStyle=this.stroke.get(t);let n=this.width.get(t);n>0&&(this.do_stroke=!0),i.lineWidth=n}if(this.pattern){const n=i.createPattern(this.pattern,"repeat");n&&(i.fillStyle=n)}}draw(i,t,n,r){var s=!1;if(this.per_feature){i.globalAlpha=this.opacity.get(n,r),i.fillStyle=this.fill.get(n,r);var a=this.width.get(n,r);a&&(s=!0,i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a)}let l=()=>{i.fill(),(s||this.do_stroke)&&i.stroke()};var u=0;i.beginPath();for(var c of t){u+c.length>Kh&&(l(),u=0,i.beginPath());for(var d=0;d<c.length;d++){let p=c[d];d==0?i.moveTo(p.x,p.y):i.lineTo(p.x,p.y)}u+=c.length}u>0&&l()}};function mp(i,t){let n=0;for(;t[n+1][0]<i;)n++;return n}function _p(i,t,n){return i*(n-t)+t}function gp(i,t,n,r){const s=r[t+1][0]-r[t][0],a=i-r[t][0];return s===0?0:(Math.pow(n,a)-1)/(Math.pow(n,s)-1)}function Pe(i,t){return n=>{if(t.length<1)return 0;if(n<=t[0][0])return t[0][1];if(n>=t[t.length-1][0])return t[t.length-1][1];const r=mp(n,t),s=gp(n,r,i,t);return _p(s,t[r][1],t[r+1][1])}}var se=class{constructor(i){var t;this.color=new Ft(i.color,"black"),this.width=new gt(i.width),this.opacity=new gt(i.opacity),this.dash=i.dash?new cp(i.dash):null,this.dashColor=new Ft(i.dashColor,"black"),this.dashWidth=new gt(i.dashWidth,1),this.lineCap=new Ft(i.lineCap,"butt"),this.lineJoin=new Ft(i.lineJoin,"miter"),this.skip=!1,this.per_feature=!!((t=this.dash)!=null&&t.per_feature||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||i.per_feature)}before(i,t){this.per_feature||(i.strokeStyle=this.color.get(t),i.lineWidth=this.width.get(t),i.globalAlpha=this.opacity.get(t),i.lineCap=this.lineCap.get(t),i.lineJoin=this.lineJoin.get(t))}draw(i,t,n,r){if(this.skip)return;let s=()=>{this.per_feature&&(i.globalAlpha=this.opacity.get(n,r),i.lineCap=this.lineCap.get(n,r),i.lineJoin=this.lineJoin.get(n,r)),this.dash?(i.save(),this.per_feature?(i.lineWidth=this.dashWidth.get(n,r),i.strokeStyle=this.dashColor.get(n,r),i.setLineDash(this.dash.get(n,r))):i.setLineDash(this.dash.get(n)),i.stroke(),i.restore()):(i.save(),this.per_feature&&(i.lineWidth=this.width.get(n,r),i.strokeStyle=this.color.get(n,r)),i.stroke(),i.restore())};var a=0;i.beginPath();for(var l of t){a+l.length>Kh&&(s(),a=0,i.beginPath());for(var u=0;u<l.length;u++){let c=l[u];u==0?i.moveTo(c.x,c.y):i.lineTo(c.x,c.y)}a+=l.length}a>0&&s()}},lo=class{constructor(i){this.radius=new gt(i.radius,3),this.fill=new Ft(i.fill,"black"),this.stroke=new Ft(i.stroke,"white"),this.width=new gt(i.width,0),this.opacity=new gt(i.opacity)}draw(i,t,n,r){i.globalAlpha=this.opacity.get(n,r);let s=this.radius.get(n,r),a=this.width.get(n,r);a>0&&(i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a,i.beginPath(),i.arc(t[0][0].x,t[0][0].y,s+a/2,0,2*Math.PI),i.stroke()),i.fillStyle=this.fill.get(n,r),i.beginPath(),i.arc(t[0][0].x,t[0][0].y,s,0,2*Math.PI),i.fill()}place(i,t,n){t[0];let r=new Qt.default(t[0][0].x,t[0][0].y),s=this.radius.get(i.zoom,n),a={minX:r.x-s,minY:r.y-s,maxX:r.x+s,maxY:r.y+s};return[{anchor:r,bboxes:[a],draw:u=>{this.draw(u,[[new Qt.default(0,0)]],i.zoom,n)}}]}},vp=class{constructor(i){this.font=new So(i),this.text=new Lo(i),this.fill=new Ft(i.fill,"black"),this.background=new Ft(i.background,"white"),this.padding=new gt(i.padding,0)}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=i.scratch.measureText(r),l=a.width,u=a.actualBoundingBoxAscent,c=a.actualBoundingBoxDescent;t[0];let d=new Qt.default(t[0][0].x,t[0][0].y),p=this.padding.get(i.zoom,n),m={minX:d.x-l/2-p,minY:d.y-u-p,maxX:d.x+l/2+p,maxY:d.y+c+p};return[{anchor:d,bboxes:[m],draw:b=>{b.globalAlpha=1,b.fillStyle=this.background.get(i.zoom,n),b.fillRect(-l/2-p,-u-p,l+2*p,u+c+2*p),b.fillStyle=this.fill.get(i.zoom,n),b.font=s,b.fillText(r,-l/2,0)}}]}},La=class{constructor(i){this.list=i}place(i,t,n){var r=this.list[0].place(i,t,n);if(!r)return;var s=r[0];let a=s.anchor,l=s.bboxes[0],u=l.maxY-l.minY,c=[{draw:s.draw,translate:{x:0,y:0}}],d=[[new Qt.default(t[0][0].x,t[0][0].y+u)]];for(let m=1;m<this.list.length;m++)r=this.list[m].place(i,d,n),r&&(s=r[0],l=Qh(l,s.bboxes[0]),c.push({draw:s.draw,translate:{x:0,y:u}}));return[{anchor:a,bboxes:[l],draw:m=>{for(let v of c)m.save(),m.translate(v.translate.x,v.translate.y),v.draw(m),m.restore()}}]}},Qh=(i,t)=>({minX:Math.min(i.minX,t.minX),minY:Math.min(i.minY,t.minY),maxX:Math.max(i.maxX,t.maxX),maxY:Math.max(i.maxY,t.maxY)}),Sa=class{constructor(i){this.list=i}place(i,t,n){let r=this.list[0];if(!r)return;var s=r.place(i,t,n);if(!s)return;var a=s[0];let l=a.anchor,u=a.bboxes[0],c=[a.draw];for(let p=1;p<this.list.length;p++){if(s=this.list[p].place(i,t,n),!s)return;a=s[0],u=Qh(u,a.bboxes[0]),c.push(a.draw)}return[{anchor:l,bboxes:[u],draw:p=>{c.forEach(m=>m(p))}}]}},yp=class{constructor(i){this.symbolizer=i}place(i,t,n){let r=t[0][0],s=this.symbolizer.place(i,[[new Qt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=l.maxX-l.minX,c=l.maxY-l.minY,d={minX:r.x-u/2,maxX:r.x+u/2,minY:r.y-c/2,maxY:r.y+c/2};return[{anchor:r,bboxes:[d],draw:m=>{m.translate(-u/2,c/2-l.maxY),a.draw(m,{justify:2})}}]}},Eo=class{constructor(i){this.font=new So(i),this.text=new Lo(i),this.fill=new Ft(i.fill,"black"),this.stroke=new Ft(i.stroke,"black"),this.width=new gt(i.width,0),this.lineHeight=new gt(i.lineHeight,1),this.letterSpacing=new gt(i.letterSpacing,0),this.maxLineCodeUnits=new gt(i.maxLineChars,15),this.justify=i.justify}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=this.letterSpacing.get(i.zoom,n),l=Jh(r,this.maxLineCodeUnits.get(i.zoom,n));var u="",c=0;for(let I of l)I.length>c&&(c=I.length,u=I);let d=i.scratch.measureText(u),p=d.width+a*(c-1),m=d.actualBoundingBoxAscent,v=d.actualBoundingBoxDescent,b=(m+v)*this.lineHeight.get(i.zoom,n),P=new Qt.default(t[0][0].x,t[0][0].y),C={minX:P.x,minY:P.y-m,maxX:P.x+p,maxY:P.y+v+(l.length-1)*b};return[{anchor:P,bboxes:[C],draw:(I,g)=>{I.globalAlpha=1,I.font=s,I.fillStyle=this.fill.get(i.zoom,n);let w=this.width.get(i.zoom,n);var y=0;for(let k of l){var S=0;if(this.justify==2||g&&g.justify==2?S=(p-I.measureText(k).width)/2:(this.justify==3||g&&g.justify==3)&&(S=p-I.measureText(k).width),w)if(I.lineWidth=w*2,I.strokeStyle=this.stroke.get(i.zoom,n),a>0){var E=S;for(var T of k)I.strokeText(T,E,y),E+=I.measureText(T).width+a}else I.strokeText(k,S,y);if(a>0){var E=S;for(var T of k)I.fillText(T,E,y),E+=I.measureText(T).width+a}else I.fillText(k,S,y);y+=b}}}]}},Ti=class{constructor(i){this.centered=new yp(new Eo(i))}place(i,t,n){return this.centered.place(i,t,n)}},wp=class{constructor(i,t){var n,r,s;this.symbolizer=i,this.offsetX=new gt(t.offsetX,0),this.offsetY=new gt(t.offsetY,0),this.justify=(n=t.justify)!=null?n:void 0,this.placements=(r=t.placements)!=null?r:[2,6,8,4,1,3,5,7],this.ddValues=(s=t.ddValues)!=null?s:()=>({})}place(i,t,n){if(n.geomType!==ri.Point)return;let r=t[0][0],s=this.symbolizer.place(i,[[new Qt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=this.offsetX,c=this.offsetY,d=this.justify,p=this.placements;const{offsetX:m,offsetY:v,justify:b,placements:P}=this.ddValues(i.zoom,n)||{};m&&(u=new gt(m,0)),v&&(c=new gt(v,0)),b&&(d=b),P&&(p=P);const C=u.get(i.zoom,n),z=c.get(i.zoom,n);let I=(E,T)=>({minX:E.x+T.x+l.minX,minY:E.y+T.y+l.minY,maxX:E.x+T.x+l.maxX,maxY:E.y+T.y+l.maxY});var g=new Qt.default(C,z),w;let y=E=>{E.translate(g.x,g.y),a.draw(E,{justify:w})};const S=(E,T)=>{const k=I(E,T);if(!i.index.bboxCollides(k,i.order))return[{anchor:r,bboxes:[k],draw:y}]};for(let E of p){const T=this.computeXAxisOffset(C,l,E),k=this.computeYAxisOffset(z,l,E);return w=this.computeJustify(d,E),g=new Qt.default(T,k),S(r,g)}}computeXAxisOffset(i,t,n){const r=t.maxX,s=r/2;return[1,5].includes(n)?i-s:[8,7,6].includes(n)?i-r:i}computeYAxisOffset(i,t,n){const r=Math.abs(t.minY),s=t.maxY,a=(t.minY+t.maxY)/2;return[3,7].includes(n)?i-a:[8,2,1].includes(n)?i-s:[6,4,5].includes(n)?i+r:i}computeJustify(i,t){return i||([1,5].includes(t)?2:[2,3,4].includes(t)?1:3)}},Dn=class{constructor(i){this.symbolizer=new wp(new Eo(i),i)}place(i,t,n){return this.symbolizer.place(i,t,n)}},Ea;(function(i){i[i.Above=1]="Above",i[i.Center=2]="Center",i[i.Below=3]="Below"})(Ea||(Ea={}));var xp=class{constructor(i){var t;this.font=new So(i),this.text=new Lo(i),this.fill=new Ft(i.fill,"black"),this.stroke=new Ft(i.stroke,"black"),this.width=new gt(i.width,0),this.offset=new gt(i.offset,0),this.position=(t=i.position)!=null?t:1,this.maxLabelCodeUnits=new gt(i.maxLabelChars,40),this.repeatDistance=new gt(i.repeatDistance,250)}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r||r.length>this.maxLabelCodeUnits.get(i.zoom,n))return;let s=20,a=n.bbox;if(a.maxY-a.minY<s&&a.maxX-a.minX<s)return;let l=this.font.get(i.zoom,n);i.scratch.font=l;let u=i.scratch.measureText(r),c=u.width,d=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent;var p=this.repeatDistance.get(i.zoom,n);i.overzoom>4&&(p*=1<<i.overzoom-4);let m=d*2,v=dp(t,c,p,m);if(v.length==0)return;let b=[];for(let P of v){let C=P.end.x-P.start.x,z=P.end.y-P.start.y,g=pp(P.start,P.end,c,m/2).map(y=>({minX:y.x-m/2,minY:y.y-m/2,maxX:y.x+m/2,maxY:y.y+m/2})),w=y=>{y.globalAlpha=1,y.rotate(Math.atan2(z,C)),C<0&&(y.scale(-1,-1),y.translate(-c,0));let S=0;this.position===3?S+=d:this.position===2&&(S+=d/2),y.translate(0,S-this.offset.get(i.zoom,n)),y.font=l;let E=this.width.get(i.zoom,n);E&&(y.lineWidth=E,y.strokeStyle=this.stroke.get(i.zoom,n),y.strokeText(r,0,0)),y.fillStyle=this.fill.get(i.zoom,n),y.fillText(r,0,0)};b.push({anchor:P.start,bboxes:g,draw:w,deduplicationKey:r,deduplicationDistance:p})}return b}},Ur=class{constructor(i){this.symbolizer=new Eo(i)}place(i,t,n){let r=n.bbox;if((r.maxY-r.minY)*(r.maxX-r.minX)<2e4)return;let a=this.symbolizer.place(i,[[new Qt.default(0,0)]],n);if(!a||a.length==0)return;let l=a[0],u=l.bboxes[0],c=t[0],d=(0,up.default)([c.map(b=>[b.x,b.y])]),p=new Qt.default(d[0],d[1]),m={minX:p.x-(u.maxX-u.minX)/2,minY:p.y-(u.maxY-u.minY)/2,maxX:p.x+(u.maxX-u.minX)/2,maxY:p.y+(u.maxY-u.minY)/2};return[{anchor:p,bboxes:[m],draw:b=>{b.translate(l.anchor.x-(u.maxX-u.minX)/2,l.anchor.y),l.draw(b)}}]}},tl=(i,t)=>{let n=xa(t),r=Yf({},i);for(const[s,a]of Object.entries(i)){let l=xa(a);r[s]=lp(n[0],n[1],l[2],l[3])}return r},Ca=(i,t)=>(t&&(i=tl(i,t)),[{dataLayer:"earth",symbolizer:new Dt({fill:i.earth})},{dataLayer:"natural",symbolizer:new Dt({fill:i.glacier}),filter:(n,r)=>r.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.residential}),filter:(n,r)=>r.props.landuse=="residential"||r.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.hospital}),filter:(n,r)=>r.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.cemetery}),filter:(n,r)=>r.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.school}),filter:(n,r)=>r.props.amenity=="school"||r.props.amenity=="kindergarten"||r.props.amenity=="university"||r.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.industrial}),filter:(n,r)=>r.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new Dt({fill:i.wood}),filter:(n,r)=>r.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.grass}),filter:(n,r)=>r.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.park}),filter:(n,r)=>r.props.leisure=="park"},{dataLayer:"water",symbolizer:new Dt({fill:i.water})},{dataLayer:"natural",symbolizer:new Dt({fill:i.sand}),filter:(n,r)=>r.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new Dt({fill:i.buildings})},{dataLayer:"roads",symbolizer:new se({color:i.highwayCasing,width:Pe(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new se({color:i.majorRoadCasing,width:Pe(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new se({color:i.mediumRoadCasing,width:Pe(1.4,[[13,3],[17,6],[20,18]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new se({color:i.minorRoadCasing,width:Pe(1.4,[[14,2],[17,5],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new se({color:i.minorRoad,width:Pe(1.4,[[14,1],[17,3],[20,13]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new se({color:i.mediumRoad,width:Pe(1.4,[[13,2],[17,4],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new se({color:i.majorRoad,width:Pe(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new se({color:i.highway,width:Pe(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new se({color:i.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new Dt({fill:i.mask})}]),ka=(i,t,n,r)=>{t&&(i=tl(i,t));var s=["name"];n&&(s=n);let a=(l,u)=>r?l instanceof Dn?new La([l,new Dn({fill:u,label_props:r})]):new La([l,new Ti({fill:u,label_props:r})]):l;return[{dataLayer:"places",symbolizer:a(new Ti({label_props:s,fill:i.countryLabel,lineHeight:1.5,font:(l,u)=>l<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),i.countryLabel),filter:(l,u)=>u.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:a(new Ti({label_props:s,fill:i.stateLabel,font:"300 16px sans-serif"}),i.stateLabel),filter:(l,u)=>u.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",minzoom:7,symbolizer:a(new Ti({label_props:s,fill:i.cityLabel,font:(l,u)=>u?.props["pmap:rank"]===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new Sa([new lo({radius:2,fill:i.cityLabel}),a(new Dn({label_props:s,fill:i.cityLabel,offsetX:2,offsetY:2,font:(l,u)=>u?.props["pmap:rank"]===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel)]),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new Ti({label_props:s,fill:i.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),i.neighbourhoodLabel),filter:(l,u)=>u.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new Ur({label_props:s,fill:i.landuseLabel,font:"300 12px sans-serif"}),i.landuseLabel)},{dataLayer:"water",symbolizer:a(new Ur({label_props:s,fill:i.waterLabel,font:"italic 600 12px sans-serif"}),i.waterLabel)},{dataLayer:"natural",symbolizer:a(new Ur({label_props:s,fill:i.naturalLabel,font:"italic 300 12px sans-serif"}),i.naturalLabel)},{dataLayer:"roads",symbolizer:a(new xp({label_props:s,fill:i.roadsLabel,font:"500 12px sans-serif"}),i.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new vp({label_props:["ref"],font:"600 9px sans-serif",background:i.highway,padding:2,fill:i.neighbourhoodLabel}),filter:(l,u)=>u.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new Sa([new lo({radius:2,fill:i.poisLabel}),a(new Dn({label_props:s,fill:i.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),i.poisLabel)])}]},Ta=(i,t,n)=>[{dataSource:i,dataLayer:t,symbolizer:new lo({opacity:.2,fill:n,radius:4}),filter:(r,s)=>s.geomType==ri.Point},{dataSource:i,dataLayer:t,symbolizer:new se({opacity:.2,color:n,width:2}),filter:(r,s)=>s.geomType==ri.Line},{dataSource:i,dataLayer:t,symbolizer:new Dt({opacity:.2,fill:n,stroke:n,width:1}),filter:(r,s)=>s.geomType==ri.Polygon}],bp=(i,t)=>{var n=[];for(var[r,s]of i)for(var a of s)for(var l of a.data.keys())r===t.dataSource&&l===t.dataLayer||(n=n.concat(Ta(r,l,"steelblue")));return n=n.concat(Ta(t.dataSource||"",t.dataLayer,"red")),n},Mp=Xt(we()),Pp=i=>new Promise((t,n)=>{setTimeout(()=>{t()},i)}),Lp=i=>i.then(t=>({status:"fulfilled",value:t}),t=>({status:"rejected",reason:t})),Sp=(i={})=>{class t extends L.GridLayer{constructor(r={}){r.noWrap&&!r.bounds&&(r.bounds=[[-90,-180],[90,180]]),r.attribution==null&&(r.attribution='<a href="https://protomaps.com">Protomaps</a>  <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(r);let s=r.dark?va:ga;this.paint_rules=r.paint_rules||Ca(s,r.shade),this.label_rules=r.label_rules||ka(s,r.shade,r.language1,r.language2),this.backgroundColor=r.backgroundColor,this.lastRequestedZ=void 0,this.xray=r.xray,this.tasks=r.tasks||[],this.views=Hd(r),this.debug=r.debug;let a=document.createElement("canvas").getContext("2d");this.scratch=a,this.onTilesInvalidated=l=>{l.forEach(u=>{this.rerenderTile(u)})},this.labelers=new _a(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=r.tileDelay||3,this.lang=r.lang,this.inspector=this.inspect(this)}setDefaultStyle(r,s,a,l){let u=r?va:ga;this.paint_rules=Ca(u,s),this.label_rules=ka(u,s,a,l)}renderTile(r,s,a,l=()=>{}){return ai(this,null,function*(){this.lastRequestedZ=r.z;let u=[];for(const[T,k]of this.views){let B=k.getDisplayTile(r);u.push({key:T,promise:B})}let c=yield Promise.all(u.map(T=>T.promise.then(k=>({status:"fulfilled",value:k,key:T.key}),k=>({status:"rejected",reason:k,key:T.key})))),d=new Map;for(const T of c)T.status==="fulfilled"?d.set(T.key,[T.value]):T.reason.name==="AbortError"||console.error(T.reason);if(s.key!=a||this.lastRequestedZ!==r.z||(yield Promise.all(this.tasks.map(Lp)),s.key!=a)||this.lastRequestedZ!==r.z)return;let p=this.labelers.add(r.z,d);if(s.key!=a||this.lastRequestedZ!==r.z)return;let m=this.labelers.getIndex(r.z);if(!this._map)return;let v=this._map.getCenter().wrap(),b=this._getTiledPixelBounds(v),P=this._pxBoundsToTileRange(b),C=P.getCenter(),z=r.distanceTo(C)*this.tileDelay;if(yield Pp(z),s.key!=a||this.lastRequestedZ!==r.z)return;let I=16,g={minX:256*r.x-I,minY:256*r.y-I,maxX:256*(r.x+1)+I,maxY:256*(r.y+1)+I},w=new Mp.default(256*r.x,256*r.y);s.width=this.tile_size,s.height=this.tile_size;let y=s.getContext("2d");y.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),y.clearRect(0,0,256,256),this.backgroundColor&&(y.save(),y.fillStyle=this.backgroundColor,y.fillRect(0,0,256,256),y.restore());var S=0;let E=this.paint_rules;if(this.xray&&(E=bp(d,this.xray)),S=$d(y,r.z,d,this.xray?null:m,E,g,w,!1,this.debug),this.debug){y.save(),y.fillStyle=this.debug,y.font="600 12px sans-serif",y.fillText(r.z+" "+r.x+" "+r.y,4,14),y.font="12px sans-serif";let T=28;for(let[k,B]of d){let N=B[0].data_tile;y.fillText(k+(k?" ":"")+N.z+" "+N.x+" "+N.y,4,T),T+=14}y.font="600 10px sans-serif",S>8&&(y.fillText(S.toFixed()+" ms paint",4,T),T+=14),p>8&&y.fillText(p.toFixed()+" ms layout",4,T),y.strokeStyle=this.debug,y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(0,256),y.stroke(),y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(256,0),y.stroke(),y.restore()}l()})}rerenderTile(r){for(let s in this._tiles){let a=this._wrapCoords(this._keyToTileCoords(s));r===this._tileCoordsToKey(a)&&this.renderTile(a,this._tiles[s].el,r)}}clearLayout(){this.labelers=new _a(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let r in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(r)),a=this._tileCoordsToKey(s);this.renderTile(s,this._tiles[r].el,a)}}createTile(r,s){let a=L.DomUtil.create("canvas","leaflet-tile");a.lang=this.lang;let l=this._tileCoordsToKey(r);return a.key=l,this.renderTile(r,a,l,()=>{s(null,a)}),a}_removeTile(r){let s=this._tiles[r];s&&(s.el.removed=!0,s.el.key=void 0,L.DomUtil.removeClass(s.el,"leaflet-tile-loaded"),s.el.width=s.el.height=0,L.DomUtil.remove(s.el),delete this._tiles[r],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(r)}))}queryFeatures(r,s){let a=new Map;for(var[l,u]of this.views)a.set(l,u.queryFeatures(r,s,this._map.getZoom()));return a}inspect(r){return s=>{let a=["","",""],l=r._map.wrapLatLng(s.latlng),u=r.queryFeatures(l.lng,l.lat);var c="";let d=!0;for(var[p,m]of u)for(var v of m)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===p&&this.xray.dataLayer===v.layerName))){c=c+`<div style="margin-top:${d?0:.5}em">${a[v.feature.geomType-1]} <b>${p} ${p?"/":""} ${v.layerName}</b> ${v.feature.id||""}</div>`;for(const b in v.feature.props)c=c+`<div style="font-size:0.9em">${b} = ${v.feature.props[b]}</div>`;d=!1}d&&(c="No features."),L.popup().setLatLng(s.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+c+"</div>").openOn(r._map)}}addInspector(r){return r.on("click",this.inspector)}removeInspector(r){return r.off("click",this.inspector)}}return new t(i)};function Ep({L:i,id:t,lat:n,lng:r,zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:c}){const d=i.map(t,{center:[n,r],zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:c});return Sp({url:"https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf?key=d23c43b7c56e123d"}).addTo(d),d}var Ni={exports:{}};var Cp=Ni.exports,Da;function kp(){return Da||(Da=1,(function(i,t){(function(n,r){r(t)})(Cp,(function(n){var r="1.9.4";function s(e){var o,h,f,_;for(h=1,f=arguments.length;h<f;h++){_=arguments[h];for(o in _)e[o]=_[o]}return e}var a=Object.create||(function(){function e(){}return function(o){return e.prototype=o,new e}})();function l(e,o){var h=Array.prototype.slice;if(e.bind)return e.bind.apply(e,h.call(arguments,1));var f=h.call(arguments,2);return function(){return e.apply(o,f.length?f.concat(h.call(arguments)):arguments)}}var u=0;function c(e){return"_leaflet_id"in e||(e._leaflet_id=++u),e._leaflet_id}function d(e,o,h){var f,_,M,A;return A=function(){f=!1,_&&(M.apply(h,_),_=!1)},M=function(){f?_=arguments:(e.apply(h,arguments),setTimeout(A,o),f=!0)},M}function p(e,o,h){var f=o[1],_=o[0],M=f-_;return e===f&&h?e:((e-_)%M+M)%M+_}function m(){return!1}function v(e,o){if(o===!1)return e;var h=Math.pow(10,o===void 0?6:o);return Math.round(e*h)/h}function b(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function P(e){return b(e).split(/\s+/)}function C(e,o){Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?a(e.options):{});for(var h in o)e.options[h]=o[h];return e.options}function z(e,o,h){var f=[];for(var _ in e)f.push(encodeURIComponent(h?_.toUpperCase():_)+"="+encodeURIComponent(e[_]));return(!o||o.indexOf("?")===-1?"?":"&")+f.join("&")}var I=/\{ *([\w_ -]+) *\}/g;function g(e,o){return e.replace(I,function(h,f){var _=o[f];if(_===void 0)throw new Error("No value provided for variable "+h);return typeof _=="function"&&(_=_(o)),_})}var w=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function y(e,o){for(var h=0;h<e.length;h++)if(e[h]===o)return h;return-1}var S="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var T=0;function k(e){var o=+new Date,h=Math.max(0,16-(o-T));return T=o+h,window.setTimeout(e,h)}var B=window.requestAnimationFrame||E("RequestAnimationFrame")||k,N=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function Z(e,o,h){if(h&&B===k)e.call(o);else return B.call(window,l(e,o))}function j(e){e&&N.call(window,e)}var U={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:c,throttle:d,wrapNum:p,falseFn:m,formatNum:v,trim:b,splitWords:P,setOptions:C,getParamString:z,template:g,isArray:w,indexOf:y,emptyImageUrl:S,requestFn:B,cancelFn:N,requestAnimFrame:Z,cancelAnimFrame:j};function x(){}x.extend=function(e){var o=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=o.__super__=this.prototype,f=a(h);f.constructor=o,o.prototype=f;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(o[_]=this[_]);return e.statics&&s(o,e.statics),e.includes&&(D(e.includes),s.apply(null,[f].concat(e.includes))),s(f,e),delete f.statics,delete f.includes,f.options&&(f.options=h.options?a(h.options):{},s(f.options,e.options)),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var M=0,A=f._initHooks.length;M<A;M++)f._initHooks[M].call(this)}},o},x.include=function(e){var o=this.prototype.options;return s(this.prototype,e),e.options&&(this.prototype.options=o,this.mergeOptions(e.options)),this},x.mergeOptions=function(e){return s(this.prototype.options,e),this},x.addInitHook=function(e){var o=Array.prototype.slice.call(arguments,1),h=typeof e=="function"?e:function(){this[e].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function D(e){if(!(typeof L>"u"||!L||!L.Mixin)){e=w(e)?e:[e];for(var o=0;o<e.length;o++)e[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var O={on:function(e,o,h){if(typeof e=="object")for(var f in e)this._on(f,e[f],o);else{e=P(e);for(var _=0,M=e.length;_<M;_++)this._on(e[_],o,h)}return this},off:function(e,o,h){if(!arguments.length)delete this._events;else if(typeof e=="object")for(var f in e)this._off(f,e[f],o);else{e=P(e);for(var _=arguments.length===1,M=0,A=e.length;M<A;M++)_?this._off(e[M]):this._off(e[M],o,h)}return this},_on:function(e,o,h,f){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(e,o,h)===!1){h===this&&(h=void 0);var _={fn:o,ctx:h};f&&(_.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(_)}},_off:function(e,o,h){var f,_,M;if(this._events&&(f=this._events[e],!!f)){if(arguments.length===1){if(this._firingCount)for(_=0,M=f.length;_<M;_++)f[_].fn=m;delete this._events[e];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var A=this._listens(e,o,h);if(A!==!1){var F=f[A];this._firingCount&&(F.fn=m,this._events[e]=f=f.slice()),f.splice(A,1)}}},fire:function(e,o,h){if(!this.listens(e,h))return this;var f=s({},o,{type:e,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var _=this._events[e];if(_){this._firingCount=this._firingCount+1||1;for(var M=0,A=_.length;M<A;M++){var F=_[M],Y=F.fn;F.once&&this.off(e,Y,F.ctx),Y.call(F.ctx||this,f)}this._firingCount--}}return h&&this._propagateEvent(f),this},listens:function(e,o,h,f){typeof e!="string"&&console.warn('"string" type argument expected');var _=o;typeof o!="function"&&(f=!!o,_=void 0,h=void 0);var M=this._events&&this._events[e];if(M&&M.length&&this._listens(e,_,h)!==!1)return!0;if(f){for(var A in this._eventParents)if(this._eventParents[A].listens(e,o,h,f))return!0}return!1},_listens:function(e,o,h){if(!this._events)return!1;var f=this._events[e]||[];if(!o)return!!f.length;h===this&&(h=void 0);for(var _=0,M=f.length;_<M;_++)if(f[_].fn===o&&f[_].ctx===h)return _;return!1},once:function(e,o,h){if(typeof e=="object")for(var f in e)this._on(f,e[f],o,!0);else{e=P(e);for(var _=0,M=e.length;_<M;_++)this._on(e[_],o,h,!0)}return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[c(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[c(e)],this},_propagateEvent:function(e){for(var o in this._eventParents)this._eventParents[o].fire(e.type,s({layer:e.target,propagatedFrom:e.target},e),!0)}};O.addEventListener=O.on,O.removeEventListener=O.clearAllEventListeners=O.off,O.addOneTimeEventListener=O.once,O.fireEvent=O.fire,O.hasEventListeners=O.listens;var W=x.extend(O);function X(e,o,h){this.x=h?Math.round(e):e,this.y=h?Math.round(o):o}var $=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(e){return this.clone()._add(R(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(R(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new X(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new X(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=$(this.x),this.y=$(this.y),this},distanceTo:function(e){e=R(e);var o=e.x-this.x,h=e.y-this.y;return Math.sqrt(o*o+h*h)},equals:function(e){return e=R(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=R(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function R(e,o,h){return e instanceof X?e:w(e)?new X(e[0],e[1]):e==null?e:typeof e=="object"&&"x"in e&&"y"in e?new X(e.x,e.y):new X(e,o,h)}function G(e,o){if(e)for(var h=o?[e,o]:e,f=0,_=h.length;f<_;f++)this.extend(h[f])}G.prototype={extend:function(e){var o,h;if(!e)return this;if(e instanceof X||typeof e[0]=="number"||"x"in e)o=h=R(e);else if(e=H(e),o=e.min,h=e.max,!o||!h)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=h.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(e){return R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return R(this.min.x,this.max.y)},getTopRight:function(){return R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var o,h;return typeof e[0]=="number"||e instanceof X?e=R(e):e=H(e),e instanceof G?(o=e.min,h=e.max):o=h=e,o.x>=this.min.x&&h.x<=this.max.x&&o.y>=this.min.y&&h.y<=this.max.y},intersects:function(e){e=H(e);var o=this.min,h=this.max,f=e.min,_=e.max,M=_.x>=o.x&&f.x<=h.x,A=_.y>=o.y&&f.y<=h.y;return M&&A},overlaps:function(e){e=H(e);var o=this.min,h=this.max,f=e.min,_=e.max,M=_.x>o.x&&f.x<h.x,A=_.y>o.y&&f.y<h.y;return M&&A},isValid:function(){return!!(this.min&&this.max)},pad:function(e){var o=this.min,h=this.max,f=Math.abs(o.x-h.x)*e,_=Math.abs(o.y-h.y)*e;return H(R(o.x-f,o.y-_),R(h.x+f,h.y+_))},equals:function(e){return e?(e=H(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight())):!1}};function H(e,o){return!e||e instanceof G?e:new G(e,o)}function it(e,o){if(e)for(var h=o?[e,o]:e,f=0,_=h.length;f<_;f++)this.extend(h[f])}it.prototype={extend:function(e){var o=this._southWest,h=this._northEast,f,_;if(e instanceof K)f=e,_=e;else if(e instanceof it){if(f=e._southWest,_=e._northEast,!f||!_)return this}else return e?this.extend(q(e)||Q(e)):this;return!o&&!h?(this._southWest=new K(f.lat,f.lng),this._northEast=new K(_.lat,_.lng)):(o.lat=Math.min(f.lat,o.lat),o.lng=Math.min(f.lng,o.lng),h.lat=Math.max(_.lat,h.lat),h.lng=Math.max(_.lng,h.lng)),this},pad:function(e){var o=this._southWest,h=this._northEast,f=Math.abs(o.lat-h.lat)*e,_=Math.abs(o.lng-h.lng)*e;return new it(new K(o.lat-f,o.lng-_),new K(h.lat+f,h.lng+_))},getCenter:function(){return new K((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new K(this.getNorth(),this.getWest())},getSouthEast:function(){return new K(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof K||"lat"in e?e=q(e):e=Q(e);var o=this._southWest,h=this._northEast,f,_;return e instanceof it?(f=e.getSouthWest(),_=e.getNorthEast()):f=_=e,f.lat>=o.lat&&_.lat<=h.lat&&f.lng>=o.lng&&_.lng<=h.lng},intersects:function(e){e=Q(e);var o=this._southWest,h=this._northEast,f=e.getSouthWest(),_=e.getNorthEast(),M=_.lat>=o.lat&&f.lat<=h.lat,A=_.lng>=o.lng&&f.lng<=h.lng;return M&&A},overlaps:function(e){e=Q(e);var o=this._southWest,h=this._northEast,f=e.getSouthWest(),_=e.getNorthEast(),M=_.lat>o.lat&&f.lat<h.lat,A=_.lng>o.lng&&f.lng<h.lng;return M&&A},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,o){return e?(e=Q(e),this._southWest.equals(e.getSouthWest(),o)&&this._northEast.equals(e.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(e,o){return e instanceof it?e:new it(e,o)}function K(e,o,h){if(isNaN(e)||isNaN(o))throw new Error("Invalid LatLng object: ("+e+", "+o+")");this.lat=+e,this.lng=+o,h!==void 0&&(this.alt=+h)}K.prototype={equals:function(e,o){if(!e)return!1;e=q(e);var h=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return h<=(o===void 0?1e-9:o)},toString:function(e){return"LatLng("+v(this.lat,e)+", "+v(this.lng,e)+")"},distanceTo:function(e){return ut.distance(this,q(e))},wrap:function(){return ut.wrapLatLng(this)},toBounds:function(e){var o=180*e/40075017,h=o/Math.cos(Math.PI/180*this.lat);return Q([this.lat-o,this.lng-h],[this.lat+o,this.lng+h])},clone:function(){return new K(this.lat,this.lng,this.alt)}};function q(e,o,h){return e instanceof K?e:w(e)&&typeof e[0]!="object"?e.length===3?new K(e[0],e[1],e[2]):e.length===2?new K(e[0],e[1]):null:e==null?e:typeof e=="object"&&"lat"in e?new K(e.lat,"lng"in e?e.lng:e.lon,e.alt):o===void 0?null:new K(e,o,h)}var ot={latLngToPoint:function(e,o){var h=this.projection.project(e),f=this.scale(o);return this.transformation._transform(h,f)},pointToLatLng:function(e,o){var h=this.scale(o),f=this.transformation.untransform(e,h);return this.projection.unproject(f)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var o=this.projection.bounds,h=this.scale(e),f=this.transformation.transform(o.min,h),_=this.transformation.transform(o.max,h);return new G(f,_)},infinite:!1,wrapLatLng:function(e){var o=this.wrapLng?p(e.lng,this.wrapLng,!0):e.lng,h=this.wrapLat?p(e.lat,this.wrapLat,!0):e.lat,f=e.alt;return new K(h,o,f)},wrapLatLngBounds:function(e){var o=e.getCenter(),h=this.wrapLatLng(o),f=o.lat-h.lat,_=o.lng-h.lng;if(f===0&&_===0)return e;var M=e.getSouthWest(),A=e.getNorthEast(),F=new K(M.lat-f,M.lng-_),Y=new K(A.lat-f,A.lng-_);return new it(F,Y)}},ut=s({},ot,{wrapLng:[-180,180],R:6371e3,distance:function(e,o){var h=Math.PI/180,f=e.lat*h,_=o.lat*h,M=Math.sin((o.lat-e.lat)*h/2),A=Math.sin((o.lng-e.lng)*h/2),F=M*M+Math.cos(f)*Math.cos(_)*A*A,Y=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return this.R*Y}}),dt=6378137,xt={R:dt,MAX_LATITUDE:85.0511287798,project:function(e){var o=Math.PI/180,h=this.MAX_LATITUDE,f=Math.max(Math.min(h,e.lat),-h),_=Math.sin(f*o);return new X(this.R*e.lng*o,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(e){var o=180/Math.PI;return new K((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*o,e.x*o/this.R)},bounds:(function(){var e=dt*Math.PI;return new G([-e,-e],[e,e])})()};function bt(e,o,h,f){if(w(e)){this._a=e[0],this._b=e[1],this._c=e[2],this._d=e[3];return}this._a=e,this._b=o,this._c=h,this._d=f}bt.prototype={transform:function(e,o){return this._transform(e.clone(),o)},_transform:function(e,o){return o=o||1,e.x=o*(this._a*e.x+this._b),e.y=o*(this._c*e.y+this._d),e},untransform:function(e,o){return o=o||1,new X((e.x/o-this._b)/this._a,(e.y/o-this._d)/this._c)}};function Et(e,o,h,f){return new bt(e,o,h,f)}var Mt=s({},ut,{code:"EPSG:3857",projection:xt,transformation:(function(){var e=.5/(Math.PI*xt.R);return Et(e,.5,-e,.5)})()}),Ct=s({},Mt,{code:"EPSG:900913"});function Lt(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function It(e,o){var h="",f,_,M,A,F,Y;for(f=0,M=e.length;f<M;f++){for(F=e[f],_=0,A=F.length;_<A;_++)Y=F[_],h+=(_?"L":"M")+Y.x+" "+Y.y;h+=o?tt.svg?"z":"x":""}return h||"M0 0"}var kt=document.documentElement.style,Rt="ActiveXObject"in window,Se=Rt&&!document.addEventListener,en="msLaunchUri"in navigator&&!("documentMode"in document),hi=ee("webkit"),nn=ee("android"),rn=ee("android 2")||ee("android 3"),on=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),sn=nn&&ee("Google")&&on<537&&!("AudioNode"in window),Ee=!!window.opera,ko=!en&&ee("chrome"),To=ee("gecko")&&!hi&&!Ee&&!Rt,bl=!ko&&ee("safari"),Do=ee("phantom"),Ao="OTransition"in kt,Ml=navigator.platform.indexOf("Win")===0,Io=Rt&&"transition"in kt,rr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rn,Oo="MozPerspective"in kt,Pl=!window.L_DISABLE_3D&&(Io||rr||Oo)&&!Ao&&!Do,li=typeof orientation<"u"||ee("mobile"),Ll=li&&hi,Sl=li&&rr,zo=!window.PointerEvent&&window.MSPointerEvent,Bo=!!(window.PointerEvent||zo),No="ontouchstart"in window||!!window.TouchEvent,El=!window.L_NO_TOUCH&&(No||Bo),Cl=li&&Ee,kl=li&&To,Tl=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Dl=(function(){var e=!1;try{var o=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",m,o),window.removeEventListener("testPassiveEventSupport",m,o)}catch{}return e})(),Al=(function(){return!!document.createElement("canvas").getContext})(),or=!!(document.createElementNS&&Lt("svg").createSVGRect),Il=!!or&&(function(){var e=document.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Ol=!or&&(function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var o=e.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}})(),zl=navigator.platform.indexOf("Mac")===0,Bl=navigator.platform.indexOf("Linux")===0;function ee(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var tt={ie:Rt,ielt9:Se,edge:en,webkit:hi,android:nn,android23:rn,androidStock:sn,opera:Ee,chrome:ko,gecko:To,safari:bl,phantom:Do,opera12:Ao,win:Ml,ie3d:Io,webkit3d:rr,gecko3d:Oo,any3d:Pl,mobile:li,mobileWebkit:Ll,mobileWebkit3d:Sl,msPointer:zo,pointer:Bo,touch:El,touchNative:No,mobileOpera:Cl,mobileGecko:kl,retina:Tl,passiveEvents:Dl,canvas:Al,svg:or,vml:Ol,inlineSvg:Il,mac:zl,linux:Bl},Fo=tt.msPointer?"MSPointerDown":"pointerdown",Ro=tt.msPointer?"MSPointerMove":"pointermove",Zo=tt.msPointer?"MSPointerUp":"pointerup",Yo=tt.msPointer?"MSPointerCancel":"pointercancel",sr={touchstart:Fo,touchmove:Ro,touchend:Zo,touchcancel:Yo},Xo={touchstart:Xl,touchmove:an,touchend:an,touchcancel:an},Fe={},Uo=!1;function Nl(e,o,h){return o==="touchstart"&&Yl(),Xo[o]?(h=Xo[o].bind(this,h),e.addEventListener(sr[o],h,!1),h):(console.warn("wrong event specified:",o),m)}function Fl(e,o,h){if(!sr[o]){console.warn("wrong event specified:",o);return}e.removeEventListener(sr[o],h,!1)}function Rl(e){Fe[e.pointerId]=e}function Zl(e){Fe[e.pointerId]&&(Fe[e.pointerId]=e)}function jo(e){delete Fe[e.pointerId]}function Yl(){Uo||(document.addEventListener(Fo,Rl,!0),document.addEventListener(Ro,Zl,!0),document.addEventListener(Zo,jo,!0),document.addEventListener(Yo,jo,!0),Uo=!0)}function an(e,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var h in Fe)o.touches.push(Fe[h]);o.changedTouches=[o],e(o)}}function Xl(e,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&St(o),an(e,o)}function Ul(e){var o={},h,f;for(f in e)h=e[f],o[f]=h&&h.bind?h.bind(e):h;return e=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var jl=200;function Wl(e,o){e.addEventListener("dblclick",o);var h=0,f;function _(M){if(M.detail!==1){f=M.detail;return}if(!(M.pointerType==="mouse"||M.sourceCapabilities&&!M.sourceCapabilities.firesTouchEvents)){var A=$o(M);if(!(A.some(function(Y){return Y instanceof HTMLLabelElement&&Y.attributes.for})&&!A.some(function(Y){return Y instanceof HTMLInputElement||Y instanceof HTMLSelectElement}))){var F=Date.now();F-h<=jl?(f++,f===2&&o(Ul(M))):f=1,h=F}}}return e.addEventListener("click",_),{dblclick:o,simDblclick:_}}function Vl(e,o){e.removeEventListener("dblclick",o.dblclick),e.removeEventListener("click",o.simDblclick)}var ar=un(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ui=un(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Wo=ui==="webkitTransition"||ui==="OTransition"?ui+"End":"transitionend";function Vo(e){return typeof e=="string"?document.getElementById(e):e}function ci(e,o){var h=e.style[o]||e.currentStyle&&e.currentStyle[o];if((!h||h==="auto")&&document.defaultView){var f=document.defaultView.getComputedStyle(e,null);h=f?f[o]:null}return h==="auto"?null:h}function ct(e,o,h){var f=document.createElement(e);return f.className=o||"",h&&h.appendChild(f),f}function mt(e){var o=e.parentNode;o&&o.removeChild(e)}function hn(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Re(e){var o=e.parentNode;o&&o.lastChild!==e&&o.appendChild(e)}function Ze(e){var o=e.parentNode;o&&o.firstChild!==e&&o.insertBefore(e,o.firstChild)}function hr(e,o){if(e.classList!==void 0)return e.classList.contains(o);var h=ln(e);return h.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(h)}function at(e,o){if(e.classList!==void 0)for(var h=P(o),f=0,_=h.length;f<_;f++)e.classList.add(h[f]);else if(!hr(e,o)){var M=ln(e);lr(e,(M?M+" ":"")+o)}}function _t(e,o){e.classList!==void 0?e.classList.remove(o):lr(e,b((" "+ln(e)+" ").replace(" "+o+" "," ")))}function lr(e,o){e.className.baseVal===void 0?e.className=o:e.className.baseVal=o}function ln(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Ut(e,o){"opacity"in e.style?e.style.opacity=o:"filter"in e.style&&Hl(e,o)}function Hl(e,o){var h=!1,f="DXImageTransform.Microsoft.Alpha";try{h=e.filters.item(f)}catch{if(o===1)return}o=Math.round(o*100),h?(h.Enabled=o!==100,h.Opacity=o):e.style.filter+=" progid:"+f+"(opacity="+o+")"}function un(e){for(var o=document.documentElement.style,h=0;h<e.length;h++)if(e[h]in o)return e[h];return!1}function Ce(e,o,h){var f=o||new X(0,0);e.style[ar]=(tt.ie3d?"translate("+f.x+"px,"+f.y+"px)":"translate3d("+f.x+"px,"+f.y+"px,0)")+(h?" scale("+h+")":"")}function vt(e,o){e._leaflet_pos=o,tt.any3d?Ce(e,o):(e.style.left=o.x+"px",e.style.top=o.y+"px")}function ke(e){return e._leaflet_pos||new X(0,0)}var fi,di,ur;if("onselectstart"in document)fi=function(){st(window,"selectstart",St)},di=function(){pt(window,"selectstart",St)};else{var pi=un(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);fi=function(){if(pi){var e=document.documentElement.style;ur=e[pi],e[pi]="none"}},di=function(){pi&&(document.documentElement.style[pi]=ur,ur=void 0)}}function cr(){st(window,"dragstart",St)}function fr(){pt(window,"dragstart",St)}var cn,dr;function pr(e){for(;e.tabIndex===-1;)e=e.parentNode;e.style&&(fn(),cn=e,dr=e.style.outlineStyle,e.style.outlineStyle="none",st(window,"keydown",fn))}function fn(){cn&&(cn.style.outlineStyle=dr,cn=void 0,dr=void 0,pt(window,"keydown",fn))}function Ho(e){do e=e.parentNode;while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function mr(e){var o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}var Gl={__proto__:null,TRANSFORM:ar,TRANSITION:ui,TRANSITION_END:Wo,get:Vo,getStyle:ci,create:ct,remove:mt,empty:hn,toFront:Re,toBack:Ze,hasClass:hr,addClass:at,removeClass:_t,setClass:lr,getClass:ln,setOpacity:Ut,testProp:un,setTransform:Ce,setPosition:vt,getPosition:ke,get disableTextSelection(){return fi},get enableTextSelection(){return di},disableImageDrag:cr,enableImageDrag:fr,preventOutline:pr,restoreOutline:fn,getSizedParentNode:Ho,getScale:mr};function st(e,o,h,f){if(o&&typeof o=="object")for(var _ in o)gr(e,_,o[_],h);else{o=P(o);for(var M=0,A=o.length;M<A;M++)gr(e,o[M],h,f)}return this}var ie="_leaflet_events";function pt(e,o,h,f){if(arguments.length===1)Go(e),delete e[ie];else if(o&&typeof o=="object")for(var _ in o)vr(e,_,o[_],h);else if(o=P(o),arguments.length===2)Go(e,function(F){return y(o,F)!==-1});else for(var M=0,A=o.length;M<A;M++)vr(e,o[M],h,f);return this}function Go(e,o){for(var h in e[ie]){var f=h.split(/\d/)[0];(!o||o(f))&&vr(e,f,null,null,h)}}var _r={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function gr(e,o,h,f){var _=o+c(h)+(f?"_"+c(f):"");if(e[ie]&&e[ie][_])return this;var M=function(F){return h.call(f||e,F||window.event)},A=M;!tt.touchNative&&tt.pointer&&o.indexOf("touch")===0?M=Nl(e,o,M):tt.touch&&o==="dblclick"?M=Wl(e,M):"addEventListener"in e?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?e.addEventListener(_r[o]||o,M,tt.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(M=function(F){F=F||window.event,wr(e,F)&&A(F)},e.addEventListener(_r[o],M,!1)):e.addEventListener(o,A,!1):e.attachEvent("on"+o,M),e[ie]=e[ie]||{},e[ie][_]=M}function vr(e,o,h,f,_){_=_||o+c(h)+(f?"_"+c(f):"");var M=e[ie]&&e[ie][_];if(!M)return this;!tt.touchNative&&tt.pointer&&o.indexOf("touch")===0?Fl(e,o,M):tt.touch&&o==="dblclick"?Vl(e,M):"removeEventListener"in e?e.removeEventListener(_r[o]||o,M,!1):e.detachEvent("on"+o,M),e[ie][_]=null}function Te(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function yr(e){return gr(e,"wheel",Te),this}function mi(e){return st(e,"mousedown touchstart dblclick contextmenu",Te),e._leaflet_disable_click=!0,this}function St(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function De(e){return St(e),Te(e),this}function $o(e){if(e.composedPath)return e.composedPath();for(var o=[],h=e.target;h;)o.push(h),h=h.parentNode;return o}function qo(e,o){if(!o)return new X(e.clientX,e.clientY);var h=mr(o),f=h.boundingClientRect;return new X((e.clientX-f.left)/h.x-o.clientLeft,(e.clientY-f.top)/h.y-o.clientTop)}var $l=tt.linux&&tt.chrome?window.devicePixelRatio:tt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Jo(e){return tt.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/$l:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}function wr(e,o){var h=o.relatedTarget;if(!h)return!0;try{for(;h&&h!==e;)h=h.parentNode}catch{return!1}return h!==e}var ql={__proto__:null,on:st,off:pt,stopPropagation:Te,disableScrollPropagation:yr,disableClickPropagation:mi,preventDefault:St,stop:De,getPropagationPath:$o,getMousePosition:qo,getWheelDelta:Jo,isExternalTarget:wr,addListener:st,removeListener:pt},Ko=W.extend({run:function(e,o,h,f){this.stop(),this._el=e,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(f||.5,.2),this._startPos=ke(e),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Z(this._animate,this),this._step()},_step:function(e){var o=+new Date-this._startTime,h=this._duration*1e3;o<h?this._runFrame(this._easeOut(o/h),e):(this._runFrame(1),this._complete())},_runFrame:function(e,o){var h=this._startPos.add(this._offset.multiplyBy(e));o&&h._round(),vt(this._el,h),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),lt=W.extend({options:{crs:Mt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,o){o=C(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(q(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ui&&tt.any3d&&!tt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),st(this._proxy,Wo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,o,h){if(o=o===void 0?this._zoom:this._limitZoom(o),e=this._limitCenter(q(e),o,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var f=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,o,h.zoom):this._tryAnimatedPan(e,h.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(e,o,h.pan&&h.pan.noMoveStart),this},setZoom:function(e,o){return this._loaded?this.setView(this.getCenter(),e,{zoom:o}):(this._zoom=e,this)},zoomIn:function(e,o){return e=e||(tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,o)},zoomOut:function(e,o){return e=e||(tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,o)},setZoomAround:function(e,o,h){var f=this.getZoomScale(o),_=this.getSize().divideBy(2),M=e instanceof X?e:this.latLngToContainerPoint(e),A=M.subtract(_).multiplyBy(1-1/f),F=this.containerPointToLatLng(_.add(A));return this.setView(F,o,{zoom:h})},_getBoundsCenterZoom:function(e,o){o=o||{},e=e.getBounds?e.getBounds():Q(e);var h=R(o.paddingTopLeft||o.padding||[0,0]),f=R(o.paddingBottomRight||o.padding||[0,0]),_=this.getBoundsZoom(e,!1,h.add(f));if(_=typeof o.maxZoom=="number"?Math.min(o.maxZoom,_):_,_===1/0)return{center:e.getCenter(),zoom:_};var M=f.subtract(h).divideBy(2),A=this.project(e.getSouthWest(),_),F=this.project(e.getNorthEast(),_),Y=this.unproject(A.add(F).divideBy(2).add(M),_);return{center:Y,zoom:_}},fitBounds:function(e,o){if(e=Q(e),!e.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(e,o);return this.setView(h.center,h.zoom,o)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,o){return this.setView(e,this._zoom,{pan:o})},panBy:function(e,o){if(e=R(e).round(),o=o||{},!e.x&&!e.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ko,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){at(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,h,o.duration||.25,o.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,o,h){if(h=h||{},h.animate===!1||!tt.any3d)return this.setView(e,o,h);this._stop();var f=this.project(this.getCenter()),_=this.project(e),M=this.getSize(),A=this._zoom;e=q(e),o=o===void 0?A:o;var F=Math.max(M.x,M.y),Y=F*this.getZoomScale(A,o),V=_.distanceTo(f)||1,J=1.42,nt=J*J;function ht(yt){var Pn=yt?-1:1,Fu=yt?Y:F,Ru=Y*Y-F*F+Pn*nt*nt*V*V,Zu=2*Fu*nt*V,Dr=Ru/Zu,As=Math.sqrt(Dr*Dr+1)-Dr,Yu=As<1e-9?-18:Math.log(As);return Yu}function Tt(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function Pt(yt){return(Math.exp(yt)+Math.exp(-yt))/2}function Wt(yt){return Tt(yt)/Pt(yt)}var Ot=ht(0);function Ve(yt){return F*(Pt(Ot)/Pt(Ot+J*yt))}function Ou(yt){return F*(Pt(Ot)*Wt(Ot+J*yt)-Tt(Ot))/nt}function zu(yt){return 1-Math.pow(1-yt,1.5)}var Bu=Date.now(),Ts=(ht(1)-Ot)/J,Nu=h.duration?1e3*h.duration:1e3*Ts*.8;function Ds(){var yt=(Date.now()-Bu)/Nu,Pn=zu(yt)*Ts;yt<=1?(this._flyToFrame=Z(Ds,this),this._move(this.unproject(f.add(_.subtract(f).multiplyBy(Ou(Pn)/V)),A),this.getScaleZoom(F/Ve(Pn),A),{flyTo:!0})):this._move(e,o)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Ds.call(this),this},flyToBounds:function(e,o){var h=this._getBoundsCenterZoom(e,o);return this.flyTo(h.center,h.zoom,o)},setMaxBounds:function(e){return e=Q(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var o=this.options.minZoom;return this.options.minZoom=e,this._loaded&&o!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var o=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&o!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,o){this._enforcingBounds=!0;var h=this.getCenter(),f=this._limitCenter(h,this._zoom,Q(e));return h.equals(f)||this.panTo(f,o),this._enforcingBounds=!1,this},panInside:function(e,o){o=o||{};var h=R(o.paddingTopLeft||o.padding||[0,0]),f=R(o.paddingBottomRight||o.padding||[0,0]),_=this.project(this.getCenter()),M=this.project(e),A=this.getPixelBounds(),F=H([A.min.add(h),A.max.subtract(f)]),Y=F.getSize();if(!F.contains(M)){this._enforcingBounds=!0;var V=M.subtract(F.getCenter()),J=F.extend(M).getSize().subtract(Y);_.x+=V.x<0?-J.x:J.x,_.y+=V.y<0?-J.y:J.y,this.panTo(this.unproject(_),o),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=s({animate:!1,pan:!0},e===!0?{animate:!0}:e);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),f=o.divideBy(2).round(),_=h.divideBy(2).round(),M=f.subtract(_);return!M.x&&!M.y?this:(e.animate&&e.pan?this.panBy(M):(e.pan&&this._rawPanBy(M),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=s({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,h,e):navigator.geolocation.getCurrentPosition(o,h,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var o=e.code,h=e.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var o=e.coords.latitude,h=e.coords.longitude,f=new K(o,h),_=f.toBounds(e.coords.accuracy*2),M=this._locateOptions;if(M.setView){var A=this.getBoundsZoom(_);this.setView(f,M.maxZoom?Math.min(A,M.maxZoom):A)}var F={latlng:f,bounds:_,timestamp:e.timestamp};for(var Y in e.coords)typeof e.coords[Y]=="number"&&(F[Y]=e.coords[Y]);this.fire("locationfound",F)}},addHandler:function(e,o){if(!o)return this;var h=this[e]=new o(this);return this._handlers.push(h),this.options[e]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var e;for(e in this._layers)this._layers[e].remove();for(e in this._panes)mt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,o){var h="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),f=ct("div",h,o||this._mapPane);return e&&(this._panes[e]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),o=this.unproject(e.getBottomLeft()),h=this.unproject(e.getTopRight());return new it(o,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,o,h){e=Q(e),h=R(h||[0,0]);var f=this.getZoom()||0,_=this.getMinZoom(),M=this.getMaxZoom(),A=e.getNorthWest(),F=e.getSouthEast(),Y=this.getSize().subtract(h),V=H(this.project(F,f),this.project(A,f)).getSize(),J=tt.any3d?this.options.zoomSnap:1,nt=Y.x/V.x,ht=Y.y/V.y,Tt=o?Math.max(nt,ht):Math.min(nt,ht);return f=this.getScaleZoom(Tt,f),J&&(f=Math.round(f/(J/100))*(J/100),f=o?Math.ceil(f/J)*J:Math.floor(f/J)*J),Math.max(_,Math.min(M,f))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,o){var h=this._getTopLeftPoint(e,o);return new G(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===void 0?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,o){var h=this.options.crs;return o=o===void 0?this._zoom:o,h.scale(e)/h.scale(o)},getScaleZoom:function(e,o){var h=this.options.crs;o=o===void 0?this._zoom:o;var f=h.zoom(e*h.scale(o));return isNaN(f)?1/0:f},project:function(e,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(q(e),o)},unproject:function(e,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(R(e),o)},layerPointToLatLng:function(e){var o=R(e).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(e){var o=this.project(q(e))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(q(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(Q(e))},distance:function(e,o){return this.options.crs.distance(q(e),q(o))},containerPointToLayerPoint:function(e){return R(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return R(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var o=this.containerPointToLayerPoint(R(e));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(e)))},mouseEventToContainerPoint:function(e){return qo(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var o=this._container=Vo(e);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");st(o,"scroll",this._onScroll,this),this._containerId=c(o)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&tt.any3d,at(e,"leaflet-container"+(tt.touch?" leaflet-touch":"")+(tt.retina?" leaflet-retina":"")+(tt.ielt9?" leaflet-oldie":"")+(tt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=ci(e,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),vt(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(at(e.markerPane,"leaflet-zoom-hide"),at(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,o,h){vt(this._mapPane,new X(0,0));var f=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var _=this._zoom!==o;this._moveStart(_,h)._move(e,o)._moveEnd(_),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(e,o){return e&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(e,o,h,f){o===void 0&&(o=this._zoom);var _=this._zoom!==o;return this._zoom=o,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),f?h&&h.pinch&&this.fire("zoom",h):((_||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){vt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[c(this._container)]=this;var o=e?pt:st;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),tt.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=Z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,o){for(var h=[],f,_=o==="mouseout"||o==="mouseover",M=e.target||e.srcElement,A=!1;M;){if(f=this._targets[c(M)],f&&(o==="click"||o==="preclick")&&this._draggableMoved(f)){A=!0;break}if(f&&f.listens(o,!0)&&(_&&!wr(M,e)||(h.push(f),_))||M===this._container)break;M=M.parentNode}return!h.length&&!A&&!_&&this.listens(o,!0)&&(h=[this]),h},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var o=e.target||e.srcElement;if(!(!this._loaded||o._leaflet_disable_events||e.type==="click"&&this._isClickDisabled(o))){var h=e.type;h==="mousedown"&&pr(o),this._fireDOMEvent(e,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,o,h){if(e.type==="click"){var f=s({},e);f.type="preclick",this._fireDOMEvent(f,f.type,h)}var _=this._findEventTargets(e,o);if(h){for(var M=[],A=0;A<h.length;A++)h[A].listens(o,!0)&&M.push(h[A]);_=M.concat(_)}if(_.length){o==="contextmenu"&&St(e);var F=_[0],Y={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var V=F.getLatLng&&(!F._radius||F._radius<=10);Y.containerPoint=V?this.latLngToContainerPoint(F.getLatLng()):this.mouseEventToContainerPoint(e),Y.layerPoint=this.containerPointToLayerPoint(Y.containerPoint),Y.latlng=V?F.getLatLng():this.layerPointToLatLng(Y.layerPoint)}for(A=0;A<_.length;A++)if(_[A].fire(o,Y,!0),Y.originalEvent._stopped||_[A].options.bubblingMouseEvents===!1&&y(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,o=this._handlers.length;e<o;e++)this._handlers[e].disable()},whenReady:function(e,o){return this._loaded?e.call(o||this,{target:this}):this.on("load",e,o),this},_getMapPanePos:function(){return ke(this._mapPane)||new X(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,o){var h=e&&o!==void 0?this._getNewPixelOrigin(e,o):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,o){var h=this.getSize()._divideBy(2);return this.project(e,o)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,o,h){var f=this._getNewPixelOrigin(h,o);return this.project(e,o)._subtract(f)},_latLngBoundsToNewLayerBounds:function(e,o,h){var f=this._getNewPixelOrigin(h,o);return H([this.project(e.getSouthWest(),o)._subtract(f),this.project(e.getNorthWest(),o)._subtract(f),this.project(e.getSouthEast(),o)._subtract(f),this.project(e.getNorthEast(),o)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,o,h){if(!h)return e;var f=this.project(e,o),_=this.getSize().divideBy(2),M=new G(f.subtract(_),f.add(_)),A=this._getBoundsOffset(M,h,o);return Math.abs(A.x)<=1&&Math.abs(A.y)<=1?e:this.unproject(f.add(A),o)},_limitOffset:function(e,o){if(!o)return e;var h=this.getPixelBounds(),f=new G(h.min.add(e),h.max.add(e));return e.add(this._getBoundsOffset(f,o))},_getBoundsOffset:function(e,o,h){var f=H(this.project(o.getNorthEast(),h),this.project(o.getSouthWest(),h)),_=f.min.subtract(e.min),M=f.max.subtract(e.max),A=this._rebound(_.x,-M.x),F=this._rebound(_.y,-M.y);return new X(A,F)},_rebound:function(e,o){return e+o>0?Math.round(e-o)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(o))},_limitZoom:function(e){var o=this.getMinZoom(),h=this.getMaxZoom(),f=tt.any3d?this.options.zoomSnap:1;return f&&(e=Math.round(e/f)*f),Math.max(o,Math.min(h,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_t(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,o){var h=this._getCenterOffset(e)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,o),!0)},_createAnimProxy:function(){var e=this._proxy=ct("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(o){var h=ar,f=this._proxy.style[h];Ce(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),f===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){mt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),o=this.getZoom();Ce(this._proxy,this.project(e,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,o,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(o),_=this._getCenterOffset(e)._divideBy(1-1/f);return h.animate!==!0&&!this.getSize().contains(_)?!1:(Z(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(e,o,!0)},this),!0)},_animateZoom:function(e,o,h,f){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=o,at(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:o,noUpdate:f}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&_t(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Jl(e,o){return new lt(e,o)}var Ht=x.extend({options:{position:"topright"},initialize:function(e){C(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var o=this._map;return o&&o.removeControl(this),this.options.position=e,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var o=this._container=this.onAdd(e),h=this.getPosition(),f=e._controlCorners[h];return at(o,"leaflet-control"),h.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(mt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),_i=function(e){return new Ht(e)};lt.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},o="leaflet-",h=this._controlContainer=ct("div",o+"control-container",this._container);function f(_,M){var A=o+_+" "+o+M;e[_+M]=ct("div",A,h)}f("top","left"),f("top","right"),f("bottom","left"),f("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)mt(this._controlCorners[e]);mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Qo=Ht.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,o,h,f){return h<f?-1:f<h?1:0}},initialize:function(e,o,h){C(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var f in e)this._addLayer(e[f],f);for(f in o)this._addLayer(o[f],f,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return Ht.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,o){return this._addLayer(e,o),this._map?this._update():this},addOverlay:function(e,o){return this._addLayer(e,o,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var o=this._getLayer(c(e));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){at(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(at(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):_t(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return _t(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",o=this._container=ct("div",e),h=this.options.collapsed;o.setAttribute("aria-haspopup",!0),mi(o),yr(o);var f=this._section=ct("section",e+"-list");h&&(this._map.on("click",this.collapse,this),st(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=ct("a",e+"-toggle",o);_.href="#",_.title="Layers",_.setAttribute("role","button"),st(_,{keydown:function(M){M.keyCode===13&&this._expandSafely()},click:function(M){St(M),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=ct("div",e+"-base",f),this._separator=ct("div",e+"-separator",f),this._overlaysList=ct("div",e+"-overlays",f),o.appendChild(f)},_getLayer:function(e){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&c(this._layers[o].layer)===e)return this._layers[o]},_addLayer:function(e,o,h){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:o,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(f,_){return this.options.sortFunction(f.layer,_.layer,f.name,_.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;hn(this._baseLayersList),hn(this._overlaysList),this._layerControlInputs=[];var e,o,h,f,_=0;for(h=0;h<this._layers.length;h++)f=this._layers[h],this._addItem(f),o=o||f.overlay,e=e||!f.overlay,_+=f.overlay?0:1;return this.options.hideSingleBase&&(e=e&&_>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=o&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var o=this._getLayer(c(e.target)),h=o.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;h&&this._map.fire(h,o)},_createRadioElement:function(e,o){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(o?' checked="checked"':"")+"/>",f=document.createElement("div");return f.innerHTML=h,f.firstChild},_addItem:function(e){var o=document.createElement("label"),h=this._map.hasLayer(e.layer),f;e.overlay?(f=document.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=h):f=this._createRadioElement("leaflet-base-layers_"+c(this),h),this._layerControlInputs.push(f),f.layerId=c(e.layer),st(f,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+e.name;var M=document.createElement("span");o.appendChild(M),M.appendChild(f),M.appendChild(_);var A=e.overlay?this._overlaysList:this._baseLayersList;return A.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var e=this._layerControlInputs,o,h,f=[],_=[];this._handlingClick=!0;for(var M=e.length-1;M>=0;M--)o=e[M],h=this._getLayer(o.layerId).layer,o.checked?f.push(h):o.checked||_.push(h);for(M=0;M<_.length;M++)this._map.hasLayer(_[M])&&this._map.removeLayer(_[M]);for(M=0;M<f.length;M++)this._map.hasLayer(f[M])||this._map.addLayer(f[M]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e=this._layerControlInputs,o,h,f=this._map.getZoom(),_=e.length-1;_>=0;_--)o=e[_],h=this._getLayer(o.layerId).layer,o.disabled=h.options.minZoom!==void 0&&f<h.options.minZoom||h.options.maxZoom!==void 0&&f>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,st(e,"click",St),this.expand();var o=this;setTimeout(function(){pt(e,"click",St),o._preventClick=!1})}}),Kl=function(e,o,h){return new Qo(e,o,h)},xr=Ht.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var o="leaflet-control-zoom",h=ct("div",o+" leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,o+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,o+"-out",h,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,o,h,f,_){var M=ct("a",h,f);return M.innerHTML=e,M.href="#",M.title=o,M.setAttribute("role","button"),M.setAttribute("aria-label",o),mi(M),st(M,"click",De),st(M,"click",_,this),st(M,"click",this._refocusOnMap,this),M},_updateDisabled:function(){var e=this._map,o="leaflet-disabled";_t(this._zoomInButton,o),_t(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(at(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(at(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});lt.mergeOptions({zoomControl:!0}),lt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xr,this.addControl(this.zoomControl))});var Ql=function(e){return new xr(e)},ts=Ht.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var o="leaflet-control-scale",h=ct("div",o),f=this.options;return this._addScales(f,o+"-line",h),e.on(f.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),h},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,o,h){e.metric&&(this._mScale=ct("div",o,h)),e.imperial&&(this._iScale=ct("div",o,h))},_update:function(){var e=this._map,o=e.getSize().y/2,h=e.distance(e.containerPointToLatLng([0,o]),e.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(h)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var o=this._getRoundNum(e),h=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,h,o/e)},_updateImperial:function(e){var o=e*3.2808399,h,f,_;o>5280?(h=o/5280,f=this._getRoundNum(h),this._updateScale(this._iScale,f+" mi",f/h)):(_=this._getRoundNum(o),this._updateScale(this._iScale,_+" ft",_/o))},_updateScale:function(e,o,h){e.style.width=Math.round(this.options.maxWidth*h)+"px",e.innerHTML=o},_getRoundNum:function(e){var o=Math.pow(10,(Math.floor(e)+"").length-1),h=e/o;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,o*h}}),tu=function(e){return new ts(e)},eu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',br=Ht.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(tt.inlineSvg?eu+" ":"")+"Leaflet</a>"},initialize:function(e){C(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=ct("div","leaflet-control-attribution"),mi(this._container);for(var o in e._layers)e._layers[o].getAttribution&&this.addAttribution(e._layers[o].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var o in this._attributions)this._attributions[o]&&e.push(o);var h=[];this.options.prefix&&h.push(this.options.prefix),e.length&&h.push(e.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});lt.mergeOptions({attributionControl:!0}),lt.addInitHook(function(){this.options.attributionControl&&new br().addTo(this)});var iu=function(e){return new br(e)};Ht.Layers=Qo,Ht.Zoom=xr,Ht.Scale=ts,Ht.Attribution=br,_i.layers=Kl,_i.zoom=Ql,_i.scale=tu,_i.attribution=iu;var ne=x.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ne.addTo=function(e,o){return e.addHandler(o,this),this};var nu={Events:O},es=tt.touch?"touchstart mousedown":"mousedown",xe=W.extend({options:{clickTolerance:3},initialize:function(e,o,h,f){C(this,f),this._element=e,this._dragStartTarget=o||e,this._preventOutline=h},enable:function(){this._enabled||(st(this._dragStartTarget,es,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(xe._dragging===this&&this.finishDrag(!0),pt(this._dragStartTarget,es,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!hr(this._element,"leaflet-zoom-anim"))){if(e.touches&&e.touches.length!==1){xe._dragging===this&&this.finishDrag();return}if(!(xe._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(xe._dragging=this,this._preventOutline&&pr(this._element),cr(),fi(),!this._moving)){this.fire("down");var o=e.touches?e.touches[0]:e,h=Ho(this._element);this._startPoint=new X(o.clientX,o.clientY),this._startPos=ke(this._element),this._parentScale=mr(h);var f=e.type==="mousedown";st(document,f?"mousemove":"touchmove",this._onMove,this),st(document,f?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(e){if(this._enabled){if(e.touches&&e.touches.length>1){this._moved=!0;return}var o=e.touches&&e.touches.length===1?e.touches[0]:e,h=new X(o.clientX,o.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,St(e),this._moved||(this.fire("dragstart"),this._moved=!0,at(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),at(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=e,this._updatePosition())}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),vt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){_t(document.body,"leaflet-dragging"),this._lastTarget&&(_t(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),pt(document,"mousemove touchmove",this._onMove,this),pt(document,"mouseup touchend touchcancel",this._onUp,this),fr(),di();var o=this._moved&&this._moving;this._moving=!1,xe._dragging=!1,o&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function is(e,o,h){var f,_=[1,4,2,8],M,A,F,Y,V,J,nt,ht;for(M=0,J=e.length;M<J;M++)e[M]._code=Ae(e[M],o);for(F=0;F<4;F++){for(nt=_[F],f=[],M=0,J=e.length,A=J-1;M<J;A=M++)Y=e[M],V=e[A],Y._code&nt?V._code&nt||(ht=dn(V,Y,nt,o,h),ht._code=Ae(ht,o),f.push(ht)):(V._code&nt&&(ht=dn(V,Y,nt,o,h),ht._code=Ae(ht,o),f.push(ht)),f.push(Y));e=f}return e}function ns(e,o){var h,f,_,M,A,F,Y,V,J;if(!e||e.length===0)throw new Error("latlngs not passed");jt(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var nt=q([0,0]),ht=Q(e),Tt=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Tt<1700&&(nt=Mr(e));var Pt=e.length,Wt=[];for(h=0;h<Pt;h++){var Ot=q(e[h]);Wt.push(o.project(q([Ot.lat-nt.lat,Ot.lng-nt.lng])))}for(F=Y=V=0,h=0,f=Pt-1;h<Pt;f=h++)_=Wt[h],M=Wt[f],A=_.y*M.x-M.y*_.x,Y+=(_.x+M.x)*A,V+=(_.y+M.y)*A,F+=A*3;F===0?J=Wt[0]:J=[Y/F,V/F];var Ve=o.unproject(R(J));return q([Ve.lat+nt.lat,Ve.lng+nt.lng])}function Mr(e){for(var o=0,h=0,f=0,_=0;_<e.length;_++){var M=q(e[_]);o+=M.lat,h+=M.lng,f++}return q([o/f,h/f])}var ru={__proto__:null,clipPolygon:is,polygonCenter:ns,centroid:Mr};function rs(e,o){if(!o||!e.length)return e.slice();var h=o*o;return e=au(e,h),e=su(e,h),e}function os(e,o,h){return Math.sqrt(gi(e,o,h,!0))}function ou(e,o,h){return gi(e,o,h)}function su(e,o){var h=e.length,f=typeof Uint8Array<"u"?Uint8Array:Array,_=new f(h);_[0]=_[h-1]=1,Pr(e,_,o,0,h-1);var M,A=[];for(M=0;M<h;M++)_[M]&&A.push(e[M]);return A}function Pr(e,o,h,f,_){var M=0,A,F,Y;for(F=f+1;F<=_-1;F++)Y=gi(e[F],e[f],e[_],!0),Y>M&&(A=F,M=Y);M>h&&(o[A]=1,Pr(e,o,h,f,A),Pr(e,o,h,A,_))}function au(e,o){for(var h=[e[0]],f=1,_=0,M=e.length;f<M;f++)hu(e[f],e[_])>o&&(h.push(e[f]),_=f);return _<M-1&&h.push(e[M-1]),h}var ss;function as(e,o,h,f,_){var M=f?ss:Ae(e,h),A=Ae(o,h),F,Y,V;for(ss=A;;){if(!(M|A))return[e,o];if(M&A)return!1;F=M||A,Y=dn(e,o,F,h,_),V=Ae(Y,h),F===M?(e=Y,M=V):(o=Y,A=V)}}function dn(e,o,h,f,_){var M=o.x-e.x,A=o.y-e.y,F=f.min,Y=f.max,V,J;return h&8?(V=e.x+M*(Y.y-e.y)/A,J=Y.y):h&4?(V=e.x+M*(F.y-e.y)/A,J=F.y):h&2?(V=Y.x,J=e.y+A*(Y.x-e.x)/M):h&1&&(V=F.x,J=e.y+A*(F.x-e.x)/M),new X(V,J,_)}function Ae(e,o){var h=0;return e.x<o.min.x?h|=1:e.x>o.max.x&&(h|=2),e.y<o.min.y?h|=4:e.y>o.max.y&&(h|=8),h}function hu(e,o){var h=o.x-e.x,f=o.y-e.y;return h*h+f*f}function gi(e,o,h,f){var _=o.x,M=o.y,A=h.x-_,F=h.y-M,Y=A*A+F*F,V;return Y>0&&(V=((e.x-_)*A+(e.y-M)*F)/Y,V>1?(_=h.x,M=h.y):V>0&&(_+=A*V,M+=F*V)),A=e.x-_,F=e.y-M,f?A*A+F*F:new X(_,M)}function jt(e){return!w(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]<"u"}function hs(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),jt(e)}function ls(e,o){var h,f,_,M,A,F,Y,V;if(!e||e.length===0)throw new Error("latlngs not passed");jt(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var J=q([0,0]),nt=Q(e),ht=nt.getNorthWest().distanceTo(nt.getSouthWest())*nt.getNorthEast().distanceTo(nt.getNorthWest());ht<1700&&(J=Mr(e));var Tt=e.length,Pt=[];for(h=0;h<Tt;h++){var Wt=q(e[h]);Pt.push(o.project(q([Wt.lat-J.lat,Wt.lng-J.lng])))}for(h=0,f=0;h<Tt-1;h++)f+=Pt[h].distanceTo(Pt[h+1])/2;if(f===0)V=Pt[0];else for(h=0,M=0;h<Tt-1;h++)if(A=Pt[h],F=Pt[h+1],_=A.distanceTo(F),M+=_,M>f){Y=(M-f)/_,V=[F.x-Y*(F.x-A.x),F.y-Y*(F.y-A.y)];break}var Ot=o.unproject(R(V));return q([Ot.lat+J.lat,Ot.lng+J.lng])}var lu={__proto__:null,simplify:rs,pointToSegmentDistance:os,closestPointOnSegment:ou,clipSegment:as,_getEdgeIntersection:dn,_getBitCode:Ae,_sqClosestPointOnSegment:gi,isFlat:jt,_flat:hs,polylineCenter:ls},Lr={project:function(e){return new X(e.lng,e.lat)},unproject:function(e){return new K(e.y,e.x)},bounds:new G([-180,-90],[180,90])},Sr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new G([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(e){var o=Math.PI/180,h=this.R,f=e.lat*o,_=this.R_MINOR/h,M=Math.sqrt(1-_*_),A=M*Math.sin(f),F=Math.tan(Math.PI/4-f/2)/Math.pow((1-A)/(1+A),M/2);return f=-h*Math.log(Math.max(F,1e-10)),new X(e.lng*o*h,f)},unproject:function(e){for(var o=180/Math.PI,h=this.R,f=this.R_MINOR/h,_=Math.sqrt(1-f*f),M=Math.exp(-e.y/h),A=Math.PI/2-2*Math.atan(M),F=0,Y=.1,V;F<15&&Math.abs(Y)>1e-7;F++)V=_*Math.sin(A),V=Math.pow((1-V)/(1+V),_/2),Y=Math.PI/2-2*Math.atan(M*V)-A,A+=Y;return new K(A*o,e.x*o/h)}},uu={__proto__:null,LonLat:Lr,Mercator:Sr,SphericalMercator:xt},cu=s({},ut,{code:"EPSG:3395",projection:Sr,transformation:(function(){var e=.5/(Math.PI*Sr.R);return Et(e,.5,-e,.5)})()}),us=s({},ut,{code:"EPSG:4326",projection:Lr,transformation:Et(1/180,1,-1/180,.5)}),fu=s({},ot,{projection:Lr,transformation:Et(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,o){var h=o.lng-e.lng,f=o.lat-e.lat;return Math.sqrt(h*h+f*f)},infinite:!0});ot.Earth=ut,ot.EPSG3395=cu,ot.EPSG3857=Mt,ot.EPSG900913=Ct,ot.EPSG4326=us,ot.Simple=fu;var Gt=W.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[c(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[c(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var o=e.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var h=this.getEvents();o.on(h,this),this.once("remove",function(){o.off(h,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});lt.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var o=c(e);return this._layers[o]?this:(this._layers[o]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var o=c(e);return this._layers[o]?(this._loaded&&e.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return c(e)in this._layers},eachLayer:function(e,o){for(var h in this._layers)e.call(o,this._layers[h]);return this},_addLayers:function(e){e=e?w(e)?e:[e]:[];for(var o=0,h=e.length;o<h;o++)this.addLayer(e[o])},_addZoomLimit:function(e){(!isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[c(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var o=c(e);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,o=-1/0,h=this._getZoomSpan();for(var f in this._zoomBoundLayers){var _=this._zoomBoundLayers[f].options;e=_.minZoom===void 0?e:Math.min(e,_.minZoom),o=_.maxZoom===void 0?o:Math.max(o,_.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=e===1/0?void 0:e,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ye=Gt.extend({initialize:function(e,o){C(this,o),this._layers={};var h,f;if(e)for(h=0,f=e.length;h<f;h++)this.addLayer(e[h])},addLayer:function(e){var o=this.getLayerId(e);return this._layers[o]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var o=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(e){var o=typeof e=="number"?e:this.getLayerId(e);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var o=Array.prototype.slice.call(arguments,1),h,f;for(h in this._layers)f=this._layers[h],f[e]&&f[e].apply(f,o);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,o){for(var h in this._layers)e.call(o,this._layers[h]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return c(e)}}),du=function(e,o){return new Ye(e,o)},ce=Ye.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Ye.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Ye.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new it;for(var o in this._layers){var h=this._layers[o];e.extend(h.getBounds?h.getBounds():h.getLatLng())}return e}}),pu=function(e,o){return new ce(e,o)},Xe=x.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){C(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,o){var h=this._getIconUrl(e);if(!h){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var f=this._createImg(h,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(f,e),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f},_setIconStyles:function(e,o){var h=this.options,f=h[o+"Size"];typeof f=="number"&&(f=[f,f]);var _=R(f),M=R(o==="shadow"&&h.shadowAnchor||h.iconAnchor||_&&_.divideBy(2,!0));e.className="leaflet-marker-"+o+" "+(h.className||""),M&&(e.style.marginLeft=-M.x+"px",e.style.marginTop=-M.y+"px"),_&&(e.style.width=_.x+"px",e.style.height=_.y+"px")},_createImg:function(e,o){return o=o||document.createElement("img"),o.src=e,o},_getIconUrl:function(e){return tt.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function mu(e){return new Xe(e)}var vi=Xe.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return typeof vi.imagePath!="string"&&(vi.imagePath=this._detectIconPath()),(this.options.imagePath||vi.imagePath)+Xe.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var o=function(h,f,_){var M=f.exec(h);return M&&M[_]};return e=o(e,/^url\((['"])?(.+)\1\)$/,2),e&&o(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=ct("div","leaflet-default-icon-path",document.body),o=ci(e,"background-image")||ci(e,"backgroundImage");if(document.body.removeChild(e),o=this._stripUrl(o),o)return o;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),cs=ne.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new xe(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),at(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&_t(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var o=this._marker,h=o._map,f=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,M=ke(o._icon),A=h.getPixelBounds(),F=h.getPixelOrigin(),Y=H(A.min._subtract(F).add(_),A.max._subtract(F).subtract(_));if(!Y.contains(M)){var V=R((Math.max(Y.max.x,M.x)-Y.max.x)/(A.max.x-Y.max.x)-(Math.min(Y.min.x,M.x)-Y.min.x)/(A.min.x-Y.min.x),(Math.max(Y.max.y,M.y)-Y.max.y)/(A.max.y-Y.max.y)-(Math.min(Y.min.y,M.y)-Y.min.y)/(A.min.y-Y.min.y)).multiplyBy(f);h.panBy(V,{animate:!1}),this._draggable._newPos._add(V),this._draggable._startPos._add(V),vt(o._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=Z(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=Z(this._adjustPan.bind(this,e)))},_onDrag:function(e){var o=this._marker,h=o._shadow,f=ke(o._icon),_=o._map.layerPointToLatLng(f);h&&vt(h,f),o._latlng=_,e.latlng=_,e.oldLatLng=this._oldLatLng,o.fire("move",e).fire("drag",e)},_onDragEnd:function(e){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),pn=Gt.extend({options:{icon:new vi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,o){C(this,o),this._latlng=q(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var o=this._latlng;return this._latlng=q(e),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=e.icon.createIcon(this._icon),f=!1;h!==this._icon&&(this._icon&&this._removeIcon(),f=!0,e.title&&(h.title=e.title),h.tagName==="IMG"&&(h.alt=e.alt||"")),at(h,o),e.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(h,"focus",this._panOnFocus,this);var _=e.icon.createShadow(this._shadow),M=!1;_!==this._shadow&&(this._removeShadow(),M=!0),_&&(at(_,o),_.alt=""),this._shadow=_,e.opacity<1&&this._updateOpacity(),f&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&M&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pt(this._icon,"focus",this._panOnFocus,this),mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&mt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&vt(this._icon,e),this._shadow&&vt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(at(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),cs)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new cs(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Ut(this._icon,e),this._shadow&&Ut(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var o=this.options.icon.options,h=o.iconSize?R(o.iconSize):R(0,0),f=o.iconAnchor?R(o.iconAnchor):R(0,0);e.panInside(this._latlng,{paddingTopLeft:f,paddingBottomRight:h.subtract(f)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _u(e,o){return new pn(e,o)}var be=Gt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return C(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),mn=be.extend({options:{fill:!0,radius:10},initialize:function(e,o){C(this,o),this._latlng=q(e),this._radius=this.options.radius},setLatLng:function(e){var o=this._latlng;return this._latlng=q(e),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var o=e&&e.radius||this._radius;return be.prototype.setStyle.call(this,e),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,o=this._radiusY||e,h=this._clickTolerance(),f=[e+h,o+h];this._pxBounds=new G(this._point.subtract(f),this._point.add(f))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function gu(e,o){return new mn(e,o)}var Er=mn.extend({initialize:function(e,o,h){if(typeof o=="number"&&(o=s({},h,{radius:o})),C(this,o),this._latlng=q(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new it(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:be.prototype.setStyle,_project:function(){var e=this._latlng.lng,o=this._latlng.lat,h=this._map,f=h.options.crs;if(f.distance===ut.distance){var _=Math.PI/180,M=this._mRadius/ut.R/_,A=h.project([o+M,e]),F=h.project([o-M,e]),Y=A.add(F).divideBy(2),V=h.unproject(Y).lat,J=Math.acos((Math.cos(M*_)-Math.sin(o*_)*Math.sin(V*_))/(Math.cos(o*_)*Math.cos(V*_)))/_;(isNaN(J)||J===0)&&(J=M/Math.cos(Math.PI/180*o)),this._point=Y.subtract(h.getPixelOrigin()),this._radius=isNaN(J)?0:Y.x-h.project([V,e-J]).x,this._radiusY=Y.y-A.y}else{var nt=f.unproject(f.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(nt).x}this._updateBounds()}});function vu(e,o,h){return new Er(e,o,h)}var fe=be.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,o){C(this,o),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var o=1/0,h=null,f=gi,_,M,A=0,F=this._parts.length;A<F;A++)for(var Y=this._parts[A],V=1,J=Y.length;V<J;V++){_=Y[V-1],M=Y[V];var nt=f(e,_,M,!0);nt<o&&(o=nt,h=f(e,_,M))}return h&&(h.distance=Math.sqrt(o)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ls(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,o){return o=o||this._defaultShape(),e=q(e),o.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new it,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return jt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var o=[],h=jt(e),f=0,_=e.length;f<_;f++)h?(o[f]=q(e[f]),this._bounds.extend(o[f])):o[f]=this._convertLatLngs(e[f]);return o},_project:function(){var e=new G;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),o=new X(e,e);this._rawPxBounds&&(this._pxBounds=new G([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(e,o,h){var f=e[0]instanceof K,_=e.length,M,A;if(f){for(A=[],M=0;M<_;M++)A[M]=this._map.latLngToLayerPoint(e[M]),h.extend(A[M]);o.push(A)}else for(M=0;M<_;M++)this._projectLatlngs(e[M],o,h)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,h,f,_,M,A,F,Y;for(h=0,_=0,M=this._rings.length;h<M;h++)for(Y=this._rings[h],f=0,A=Y.length;f<A-1;f++)F=as(Y[f],Y[f+1],e,f,!0),F&&(o[_]=o[_]||[],o[_].push(F[0]),(F[1]!==Y[f+1]||f===A-2)&&(o[_].push(F[1]),_++))}},_simplifyPoints:function(){for(var e=this._parts,o=this.options.smoothFactor,h=0,f=e.length;h<f;h++)e[h]=rs(e[h],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,o){var h,f,_,M,A,F,Y=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(h=0,M=this._parts.length;h<M;h++)for(F=this._parts[h],f=0,A=F.length,_=A-1;f<A;_=f++)if(!(!o&&f===0)&&os(e,F[_],F[f])<=Y)return!0;return!1}});function yu(e,o){return new fe(e,o)}fe._flat=hs;var Ue=fe.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ns(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var o=fe.prototype._convertLatLngs.call(this,e),h=o.length;return h>=2&&o[0]instanceof K&&o[0].equals(o[h-1])&&o.pop(),o},_setLatLngs:function(e){fe.prototype._setLatLngs.call(this,e),jt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return jt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,o=this.options.weight,h=new X(o,o);if(e=new G(e.min.subtract(h),e.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}for(var f=0,_=this._rings.length,M;f<_;f++)M=is(this._rings[f],e,!0),M.length&&this._parts.push(M)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var o=!1,h,f,_,M,A,F,Y,V;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(M=0,Y=this._parts.length;M<Y;M++)for(h=this._parts[M],A=0,V=h.length,F=V-1;A<V;F=A++)f=h[A],_=h[F],f.y>e.y!=_.y>e.y&&e.x<(_.x-f.x)*(e.y-f.y)/(_.y-f.y)+f.x&&(o=!o);return o||fe.prototype._containsPoint.call(this,e,!0)}});function wu(e,o){return new Ue(e,o)}var de=ce.extend({initialize:function(e,o){C(this,o),this._layers={},e&&this.addData(e)},addData:function(e){var o=w(e)?e:e.features,h,f,_;if(o){for(h=0,f=o.length;h<f;h++)_=o[h],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var M=this.options;if(M.filter&&!M.filter(e))return this;var A=_n(e,M);return A?(A.feature=yn(e),A.defaultOptions=A.options,this.resetStyle(A),M.onEachFeature&&M.onEachFeature(e,A),this.addLayer(A)):this},resetStyle:function(e){return e===void 0?this.eachLayer(this.resetStyle,this):(e.options=s({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(o){this._setLayerStyle(o,e)},this)},_setLayerStyle:function(e,o){e.setStyle&&(typeof o=="function"&&(o=o(e.feature)),e.setStyle(o))}});function _n(e,o){var h=e.type==="Feature"?e.geometry:e,f=h?h.coordinates:null,_=[],M=o&&o.pointToLayer,A=o&&o.coordsToLatLng||Cr,F,Y,V,J;if(!f&&!h)return null;switch(h.type){case"Point":return F=A(f),fs(M,e,F,o);case"MultiPoint":for(V=0,J=f.length;V<J;V++)F=A(f[V]),_.push(fs(M,e,F,o));return new ce(_);case"LineString":case"MultiLineString":return Y=gn(f,h.type==="LineString"?0:1,A),new fe(Y,o);case"Polygon":case"MultiPolygon":return Y=gn(f,h.type==="Polygon"?1:2,A),new Ue(Y,o);case"GeometryCollection":for(V=0,J=h.geometries.length;V<J;V++){var nt=_n({geometry:h.geometries[V],type:"Feature",properties:e.properties},o);nt&&_.push(nt)}return new ce(_);case"FeatureCollection":for(V=0,J=h.features.length;V<J;V++){var ht=_n(h.features[V],o);ht&&_.push(ht)}return new ce(_);default:throw new Error("Invalid GeoJSON object.")}}function fs(e,o,h,f){return e?e(o,h):new pn(h,f&&f.markersInheritOptions&&f)}function Cr(e){return new K(e[1],e[0],e[2])}function gn(e,o,h){for(var f=[],_=0,M=e.length,A;_<M;_++)A=o?gn(e[_],o-1,h):(h||Cr)(e[_]),f.push(A);return f}function kr(e,o){return e=q(e),e.alt!==void 0?[v(e.lng,o),v(e.lat,o),v(e.alt,o)]:[v(e.lng,o),v(e.lat,o)]}function vn(e,o,h,f){for(var _=[],M=0,A=e.length;M<A;M++)_.push(o?vn(e[M],jt(e[M])?0:o-1,h,f):kr(e[M],f));return!o&&h&&_.length>0&&_.push(_[0].slice()),_}function je(e,o){return e.feature?s({},e.feature,{geometry:o}):yn(o)}function yn(e){return e.type==="Feature"||e.type==="FeatureCollection"?e:{type:"Feature",properties:{},geometry:e}}var Tr={toGeoJSON:function(e){return je(this,{type:"Point",coordinates:kr(this.getLatLng(),e)})}};pn.include(Tr),Er.include(Tr),mn.include(Tr),fe.include({toGeoJSON:function(e){var o=!jt(this._latlngs),h=vn(this._latlngs,o?1:0,!1,e);return je(this,{type:(o?"Multi":"")+"LineString",coordinates:h})}}),Ue.include({toGeoJSON:function(e){var o=!jt(this._latlngs),h=o&&!jt(this._latlngs[0]),f=vn(this._latlngs,h?2:o?1:0,!0,e);return o||(f=[f]),je(this,{type:(h?"Multi":"")+"Polygon",coordinates:f})}}),Ye.include({toMultiPoint:function(e){var o=[];return this.eachLayer(function(h){o.push(h.toGeoJSON(e).geometry.coordinates)}),je(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(e){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(e);var h=o==="GeometryCollection",f=[];return this.eachLayer(function(_){if(_.toGeoJSON){var M=_.toGeoJSON(e);if(h)f.push(M.geometry);else{var A=yn(M);A.type==="FeatureCollection"?f.push.apply(f,A.features):f.push(A)}}}),h?je(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});function ds(e,o){return new de(e,o)}var xu=ds,wn=Gt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,o,h){this._url=e,this._bounds=Q(o),C(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(at(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&Re(this._image),this},bringToBack:function(){return this._map&&Ze(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=Q(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._url.tagName==="IMG",o=this._image=e?this._url:ct("img");if(at(o,"leaflet-image-layer"),this._zoomAnimated&&at(o,"leaflet-zoom-animated"),this.options.className&&at(o,this.options.className),o.onselectstart=m,o.onmousemove=m,o.onload=l(this.fire,this,"load"),o.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(e){var o=this._map.getZoomScale(e.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Ce(this._image,h,o)},_reset:function(){var e=this._image,o=new G(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=o.getSize();vt(e,o.min),e.style.width=h.x+"px",e.style.height=h.y+"px"},_updateOpacity:function(){Ut(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),bu=function(e,o,h){return new wn(e,o,h)},ps=wn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e=this._url.tagName==="VIDEO",o=this._image=e?this._url:ct("video");if(at(o,"leaflet-image-layer"),this._zoomAnimated&&at(o,"leaflet-zoom-animated"),this.options.className&&at(o,this.options.className),o.onselectstart=m,o.onmousemove=m,o.onloadeddata=l(this.fire,this,"load"),e){for(var h=o.getElementsByTagName("source"),f=[],_=0;_<h.length;_++)f.push(h[_].src);this._url=h.length>0?f:[o.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var M=0;M<this._url.length;M++){var A=ct("source");A.src=this._url[M],o.appendChild(A)}}});function Mu(e,o,h){return new ps(e,o,h)}var ms=wn.extend({_initImage:function(){var e=this._image=this._url;at(e,"leaflet-image-layer"),this._zoomAnimated&&at(e,"leaflet-zoom-animated"),this.options.className&&at(e,this.options.className),e.onselectstart=m,e.onmousemove=m}});function Pu(e,o,h){return new ms(e,o,h)}var re=Gt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,o){e&&(e instanceof K||w(e))?(this._latlng=q(e),C(this,o)):(C(this,e),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(e){return e=arguments.length?e:this._source._map,e.hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Ut(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Ut(this._container,1),this.bringToFront(),this.options.interactive&&(at(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(Ut(this._container,0),this._removeTimeout=setTimeout(l(mt,void 0,this._container),200)):mt(this._container),this.options.interactive&&(_t(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=q(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Re(this._container),this},bringToBack:function(){return this._map&&Ze(this._container),this},_prepareOpen:function(e){var o=this._source;if(!o._map)return!1;if(o instanceof ce){o=null;var h=this._source._layers;for(var f in h)if(h[f]._map){o=h[f];break}if(!o)return!1;this._source=o}if(!e)if(o.getCenter)e=o.getCenter();else if(o.getLatLng)e=o.getLatLng();else if(o.getBounds)e=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")e.innerHTML=o;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),o=R(this.options.offset),h=this._getAnchor();this._zoomAnimated?vt(this._container,e.add(h)):o=o.add(e).add(h);var f=this._containerBottom=-o.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=f+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});lt.include({_initOverlay:function(e,o,h,f){var _=o;return _ instanceof e||(_=new e(f).setContent(o)),h&&_.setLatLng(h),_}}),Gt.include({_initOverlay:function(e,o,h,f){var _=h;return _ instanceof e?(C(_,f),_._source=this):(_=o&&!f?o:new e(f,this),_.setContent(h)),_}});var xn=re.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return e=arguments.length?e:this._source._map,!e.hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,re.prototype.openOn.call(this,e)},onAdd:function(e){re.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof be||this._source.on("preclick",Te))},onRemove:function(e){re.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof be||this._source.off("preclick",Te))},getEvents:function(){var e=re.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",o=this._container=ct("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=ct("div",e+"-content-wrapper",o);if(this._contentNode=ct("div",e+"-content",h),mi(o),yr(this._contentNode),st(o,"contextmenu",Te),this._tipContainer=ct("div",e+"-tip-container",o),this._tip=ct("div",e+"-tip",this._tipContainer),this.options.closeButton){var f=this._closeButton=ct("a",e+"-close-button",o);f.setAttribute("role","button"),f.setAttribute("aria-label","Close popup"),f.href="#close",f.innerHTML='<span aria-hidden="true">&#215;</span>',st(f,"click",function(_){St(_),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,o=e.style;o.width="",o.whiteSpace="nowrap";var h=e.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),o.width=h+1+"px",o.whiteSpace="",o.height="";var f=e.offsetHeight,_=this.options.maxHeight,M="leaflet-popup-scrolled";_&&f>_?(o.height=_+"px",at(e,M)):_t(e,M),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),h=this._getAnchor();vt(this._container,o.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var e=this._map,o=parseInt(ci(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+o,f=this._containerWidth,_=new X(this._containerLeft,-h-this._containerBottom);_._add(ke(this._container));var M=e.layerPointToContainerPoint(_),A=R(this.options.autoPanPadding),F=R(this.options.autoPanPaddingTopLeft||A),Y=R(this.options.autoPanPaddingBottomRight||A),V=e.getSize(),J=0,nt=0;M.x+f+Y.x>V.x&&(J=M.x+f-V.x+Y.x),M.x-J-F.x<0&&(J=M.x-F.x),M.y+h+Y.y>V.y&&(nt=M.y+h-V.y+Y.y),M.y-nt-F.y<0&&(nt=M.y-F.y),(J||nt)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([J,nt]))}},_getAnchor:function(){return R(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lu=function(e,o){return new xn(e,o)};lt.mergeOptions({closePopupOnClick:!0}),lt.include({openPopup:function(e,o,h){return this._initOverlay(xn,e,o,h).openOn(this),this},closePopup:function(e){return e=arguments.length?e:this._popup,e&&e.close(),this}}),Gt.include({bindPopup:function(e,o){return this._popup=this._initOverlay(xn,this._popup,e,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof ce||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(!(!this._popup||!this._map)){De(e);var o=e.layer||e.target;if(this._popup._source===o&&!(o instanceof be)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng);return}this._popup._source=o,this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){e.originalEvent.keyCode===13&&this._openPopup(e)}});var bn=re.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){re.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){re.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=re.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip",o=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ct("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var o,h,f=this._map,_=this._container,M=f.latLngToContainerPoint(f.getCenter()),A=f.layerPointToContainerPoint(e),F=this.options.direction,Y=_.offsetWidth,V=_.offsetHeight,J=R(this.options.offset),nt=this._getAnchor();F==="top"?(o=Y/2,h=V):F==="bottom"?(o=Y/2,h=0):F==="center"?(o=Y/2,h=V/2):F==="right"?(o=0,h=V/2):F==="left"?(o=Y,h=V/2):A.x<M.x?(F="right",o=0,h=V/2):(F="left",o=Y+(J.x+nt.x)*2,h=V/2),e=e.subtract(R(o,h,!0)).add(J).add(nt),_t(_,"leaflet-tooltip-right"),_t(_,"leaflet-tooltip-left"),_t(_,"leaflet-tooltip-top"),_t(_,"leaflet-tooltip-bottom"),at(_,"leaflet-tooltip-"+F),vt(_,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Ut(this._container,e)},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(o)},_getAnchor:function(){return R(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Su=function(e,o){return new bn(e,o)};lt.include({openTooltip:function(e,o,h){return this._initOverlay(bn,e,o,h).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Gt.include({bindTooltip:function(e,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(bn,this._tooltip,e,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!(!e&&this._tooltipHandlersAdded)){var o=e?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[o](h),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof ce||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var o=typeof e.getElement=="function"&&e.getElement();o&&(st(o,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),st(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var o=typeof e.getElement=="function"&&e.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(e)});return}this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)}},_moveTooltip:function(e){var o=e.latlng,h,f;this._tooltip.options.sticky&&e.originalEvent&&(h=this._map.mouseEventToContainerPoint(e.originalEvent),f=this._map.containerPointToLayerPoint(h),o=this._map.layerPointToLatLng(f)),this._tooltip.setLatLng(o)}});var _s=Xe.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var o=e&&e.tagName==="DIV"?e:document.createElement("div"),h=this.options;if(h.html instanceof Element?(hn(o),o.appendChild(h.html)):o.innerHTML=h.html!==!1?h.html:"",h.bgPos){var f=R(h.bgPos);o.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Eu(e){return new _s(e)}Xe.Default=vi;var yi=Gt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:tt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){C(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),mt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Re(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ze(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof X?e:new X(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var o=this.getPane().children,h=-e(-1/0,1/0),f=0,_=o.length,M;f<_;f++)M=o[f].style.zIndex,o[f]!==this._container&&M&&(h=e(h,+M));isFinite(h)&&(this.options.zIndex=h+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tt.ielt9){Ut(this._container,this.options.opacity);var e=+new Date,o=!1,h=!1;for(var f in this._tiles){var _=this._tiles[f];if(!(!_.current||!_.loaded)){var M=Math.min(1,(e-_.loaded)/200);Ut(_.el,M),M<1?o=!0:(_.active?h=!0:this._onOpaqueTile(_),_.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),o&&(j(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=ct("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,o=this.options.maxZoom;if(e!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===e?(this._levels[h].el.style.zIndex=o-Math.abs(e-h),this._onUpdateLevel(h)):(mt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var f=this._levels[e],_=this._map;return f||(f=this._levels[e]={},f.el=ct("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=o,f.origin=_.project(_.unproject(_.getPixelOrigin()),e).round(),f.zoom=e,this._setZoomTransform(f,_.getCenter(),_.getZoom()),m(f.el.offsetWidth),this._onCreateLevel(f)),this._level=f,f}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var e,o,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)o=this._tiles[e],o.retain=o.current;for(e in this._tiles)if(o=this._tiles[e],o.current&&!o.active){var f=o.coords;this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(e){for(var o in this._tiles)this._tiles[o].coords.z===e&&this._removeTile(o)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)mt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,o,h,f){var _=Math.floor(e/2),M=Math.floor(o/2),A=h-1,F=new X(+_,+M);F.z=+A;var Y=this._tileCoordsToKey(F),V=this._tiles[Y];return V&&V.active?(V.retain=!0,!0):(V&&V.loaded&&(V.retain=!0),A>f?this._retainParent(_,M,A,f):!1)},_retainChildren:function(e,o,h,f){for(var _=2*e;_<2*e+2;_++)for(var M=2*o;M<2*o+2;M++){var A=new X(_,M);A.z=h+1;var F=this._tileCoordsToKey(A),Y=this._tiles[F];if(Y&&Y.active){Y.retain=!0;continue}else Y&&Y.loaded&&(Y.retain=!0);h+1<f&&this._retainChildren(_,M,h+1,f)}},_resetView:function(e){var o=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var o=this.options;return o.minNativeZoom!==void 0&&e<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<e?o.maxNativeZoom:e},_setView:function(e,o,h,f){var _=Math.round(o);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var M=this.options.updateWhenZooming&&_!==this._tileZoom;(!f||M)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(e),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(e,o)},_setZoomTransforms:function(e,o){for(var h in this._levels)this._setZoomTransform(this._levels[h],e,o)},_setZoomTransform:function(e,o,h){var f=this._map.getZoomScale(h,e.zoom),_=e.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(o,h)).round();tt.any3d?Ce(e.el,_,f):vt(e.el,_)},_resetGrid:function(){var e=this._map,o=e.options.crs,h=this._tileSize=this.getTileSize(),f=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,o.wrapLng[0]],f).x/h.x),Math.ceil(e.project([0,o.wrapLng[1]],f).x/h.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([o.wrapLat[0],0],f).y/h.x),Math.ceil(e.project([o.wrapLat[1],0],f).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(e){var o=this._map,h=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),f=o.getZoomScale(h,this._tileZoom),_=o.project(e,this._tileZoom).floor(),M=o.getSize().divideBy(f*2);return new G(_.subtract(M),_.add(M))},_update:function(e){var o=this._map;if(o){var h=this._clampZoom(o.getZoom());if(e===void 0&&(e=o.getCenter()),this._tileZoom!==void 0){var f=this._getTiledPixelBounds(e),_=this._pxBoundsToTileRange(f),M=_.getCenter(),A=[],F=this.options.keepBuffer,Y=new G(_.getBottomLeft().subtract([F,-F]),_.getTopRight().add([F,-F]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var V in this._tiles){var J=this._tiles[V].coords;(J.z!==this._tileZoom||!Y.contains(new X(J.x,J.y)))&&(this._tiles[V].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(e,h);return}for(var nt=_.min.y;nt<=_.max.y;nt++)for(var ht=_.min.x;ht<=_.max.x;ht++){var Tt=new X(ht,nt);if(Tt.z=this._tileZoom,!!this._isValidTile(Tt)){var Pt=this._tiles[this._tileCoordsToKey(Tt)];Pt?Pt.current=!0:A.push(Tt)}}if(A.sort(function(Ot,Ve){return Ot.distanceTo(M)-Ve.distanceTo(M)}),A.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Wt=document.createDocumentFragment();for(ht=0;ht<A.length;ht++)this._addTile(A[ht],Wt);this._level.el.appendChild(Wt)}}}},_isValidTile:function(e){var o=this._map.options.crs;if(!o.infinite){var h=this._globalTileRange;if(!o.wrapLng&&(e.x<h.min.x||e.x>h.max.x)||!o.wrapLat&&(e.y<h.min.y||e.y>h.max.y))return!1}if(!this.options.bounds)return!0;var f=this._tileCoordsToBounds(e);return Q(this.options.bounds).overlaps(f)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var o=this._map,h=this.getTileSize(),f=e.scaleBy(h),_=f.add(h),M=o.unproject(f,e.z),A=o.unproject(_,e.z);return[M,A]},_tileCoordsToBounds:function(e){var o=this._tileCoordsToNwSe(e),h=new it(o[0],o[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var o=e.split(":"),h=new X(+o[0],+o[1]);return h.z=+o[2],h},_removeTile:function(e){var o=this._tiles[e];o&&(mt(o.el),delete this._tiles[e],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){at(e,"leaflet-tile");var o=this.getTileSize();e.style.width=o.x+"px",e.style.height=o.y+"px",e.onselectstart=m,e.onmousemove=m,tt.ielt9&&this.options.opacity<1&&Ut(e,this.options.opacity)},_addTile:function(e,o){var h=this._getTilePos(e),f=this._tileCoordsToKey(e),_=this.createTile(this._wrapCoords(e),l(this._tileReady,this,e));this._initTile(_),this.createTile.length<2&&Z(l(this._tileReady,this,e,null,_)),vt(_,h),this._tiles[f]={el:_,coords:e,current:!0},o.appendChild(_),this.fire("tileloadstart",{tile:_,coords:e})},_tileReady:function(e,o,h){o&&this.fire("tileerror",{error:o,tile:h,coords:e});var f=this._tileCoordsToKey(e);h=this._tiles[f],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Ut(h.el,0),j(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),o||(at(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tt.ielt9||!this._map._fadeAnimated?Z(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var o=new X(this._wrapX?p(e.x,this._wrapX):e.x,this._wrapY?p(e.y,this._wrapY):e.y);return o.z=e.z,o},_pxBoundsToTileRange:function(e){var o=this.getTileSize();return new G(e.min.unscaleBy(o).floor(),e.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Cu(e){return new yi(e)}var We=yi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,o){this._url=e,o=C(this,o),o.detectRetina&&tt.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,o){return this._url===e&&o===void 0&&(o=!0),this._url=e,o||this.redraw(),this},createTile:function(e,o){var h=document.createElement("img");return st(h,"load",l(this._tileOnLoad,this,o,h)),st(h,"error",l(this._tileOnError,this,o,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(e),h},getTileUrl:function(e){var o={r:tt.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-e.y;this.options.tms&&(o.y=h),o["-y"]=h}return g(this._url,s(o,this.options))},_tileOnLoad:function(e,o){tt.ielt9?setTimeout(l(e,this,null,o),0):e(null,o)},_tileOnError:function(e,o,h){var f=this.options.errorTileUrl;f&&o.getAttribute("src")!==f&&(o.src=f),e(h,o)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,o=this.options.maxZoom,h=this.options.zoomReverse,f=this.options.zoomOffset;return h&&(e=o-e),e+f},_getSubdomain:function(e){var o=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var e,o;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&(o=this._tiles[e].el,o.onload=m,o.onerror=m,!o.complete)){o.src=S;var h=this._tiles[e].coords;mt(o),delete this._tiles[e],this.fire("tileabort",{tile:o,coords:h})}},_removeTile:function(e){var o=this._tiles[e];if(o)return o.el.setAttribute("src",S),yi.prototype._removeTile.call(this,e)},_tileReady:function(e,o,h){if(!(!this._map||h&&h.getAttribute("src")===S))return yi.prototype._tileReady.call(this,e,o,h)}});function gs(e,o){return new We(e,o)}var vs=We.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,o){this._url=e;var h=s({},this.defaultWmsParams);for(var f in o)f in this.options||(h[f]=o[f]);o=C(this,o);var _=o.detectRetina&&tt.retina?2:1,M=this.getTileSize();h.width=M.x*_,h.height=M.y*_,this.wmsParams=h},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,We.prototype.onAdd.call(this,e)},getTileUrl:function(e){var o=this._tileCoordsToNwSe(e),h=this._crs,f=H(h.project(o[0]),h.project(o[1])),_=f.min,M=f.max,A=(this._wmsVersion>=1.3&&this._crs===us?[_.y,_.x,M.y,M.x]:[_.x,_.y,M.x,M.y]).join(","),F=We.prototype.getTileUrl.call(this,e);return F+z(this.wmsParams,F,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+A},setParams:function(e,o){return s(this.wmsParams,e),o||this.redraw(),this}});function ku(e,o){return new vs(e,o)}We.WMS=vs,gs.wms=ku;var pe=Gt.extend({options:{padding:.1},initialize:function(e){C(this,e),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),at(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,o){var h=this._map.getZoomScale(o,this._zoom),f=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,o),M=f.multiplyBy(-h).add(_).subtract(this._map._getNewPixelOrigin(e,o));tt.any3d?Ce(this._container,M,h):vt(this._container,M)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var e in this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,o=this._map.getSize(),h=this._map.containerPointToLayerPoint(o.multiplyBy(-e)).round();this._bounds=new G(h,h.add(o.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ys=pe.extend({options:{tolerance:0},getEvents:function(){var e=pe.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){pe.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");st(e,"mousemove",this._onMouseMove,this),st(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),st(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,mt(this._container),pt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var e;this._redrawBounds=null;for(var o in this._layers)e=this._layers[o],e._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){pe.prototype._update.call(this);var e=this._bounds,o=this._container,h=e.getSize(),f=tt.retina?2:1;vt(o,e.min),o.width=f*h.x,o.height=f*h.y,o.style.width=h.x+"px",o.style.height=h.y+"px",tt.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){pe.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[c(e)]=e;var o=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var o=e._order,h=o.next,f=o.prev;h?h.prev=f:this._drawLast=f,f?f.next=h:this._drawFirst=h,delete e._order,delete this._layers[c(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(typeof e.options.dashArray=="string"){var o=e.options.dashArray.split(/[, ]+/),h=[],f,_;for(_=0;_<o.length;_++){if(f=Number(o[_]),isNaN(f))return;h.push(f)}e.options._dashArray=h}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||Z(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var o=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new G,this._redrawBounds.extend(e._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(e._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var o=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,o=this._redrawBounds;if(this._ctx.save(),o){var h=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)e=f.layer,(!o||e._pxBounds&&e._pxBounds.intersects(o))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,o){if(this._drawing){var h,f,_,M,A=e._parts,F=A.length,Y=this._ctx;if(F){for(Y.beginPath(),h=0;h<F;h++){for(f=0,_=A[h].length;f<_;f++)M=A[h][f],Y[f?"lineTo":"moveTo"](M.x,M.y);o&&Y.closePath()}this._fillStroke(Y,e)}}},_updateCircle:function(e){if(!(!this._drawing||e._empty())){var o=e._point,h=this._ctx,f=Math.max(Math.round(e._radius),1),_=(Math.max(Math.round(e._radiusY),1)||f)/f;_!==1&&(h.save(),h.scale(1,_)),h.beginPath(),h.arc(o.x,o.y/_,f,0,Math.PI*2,!1),_!==1&&h.restore(),this._fillStroke(h,e)}},_fillStroke:function(e,o){var h=o.options;h.fill&&(e.globalAlpha=h.fillOpacity,e.fillStyle=h.fillColor||h.color,e.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(e.setLineDash&&e.setLineDash(o.options&&o.options._dashArray||[]),e.globalAlpha=h.opacity,e.lineWidth=h.weight,e.strokeStyle=h.color,e.lineCap=h.lineCap,e.lineJoin=h.lineJoin,e.stroke())},_onClick:function(e){for(var o=this._map.mouseEventToLayerPoint(e),h,f,_=this._drawFirst;_;_=_.next)h=_.layer,h.options.interactive&&h._containsPoint(o)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(h))&&(f=h);this._fireEvent(f?[f]:!1,e)},_onMouseMove:function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,o)}},_handleMouseOut:function(e){var o=this._hoveredLayer;o&&(_t(this._container,"leaflet-interactive"),this._fireEvent([o],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,o){if(!this._mouseHoverThrottled){for(var h,f,_=this._drawFirst;_;_=_.next)h=_.layer,h.options.interactive&&h._containsPoint(o)&&(f=h);f!==this._hoveredLayer&&(this._handleMouseOut(e),f&&(at(this._container,"leaflet-interactive"),this._fireEvent([f],e,"mouseover"),this._hoveredLayer=f)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,e),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,o,h){this._map._fireDOMEvent(o,h||o.type,e)},_bringToFront:function(e){var o=e._order;if(o){var h=o.next,f=o.prev;if(h)h.prev=f;else return;f?f.next=h:h&&(this._drawFirst=h),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(e)}},_bringToBack:function(e){var o=e._order;if(o){var h=o.next,f=o.prev;if(f)f.next=h;else return;h?h.prev=f:f&&(this._drawLast=f),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(e)}}});function ws(e){return tt.canvas?new ys(e):null}var wi=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch{}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Tu={_initContainer:function(){this._container=ct("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(pe.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var o=e._container=wi("shape");at(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",e._path=wi("path"),o.appendChild(e._path),this._updateStyle(e),this._layers[c(e)]=e},_addPath:function(e){var o=e._container;this._container.appendChild(o),e.options.interactive&&e.addInteractiveTarget(o)},_removePath:function(e){var o=e._container;mt(o),e.removeInteractiveTarget(o),delete this._layers[c(e)]},_updateStyle:function(e){var o=e._stroke,h=e._fill,f=e.options,_=e._container;_.stroked=!!f.stroke,_.filled=!!f.fill,f.stroke?(o||(o=e._stroke=wi("stroke")),_.appendChild(o),o.weight=f.weight+"px",o.color=f.color,o.opacity=f.opacity,f.dashArray?o.dashStyle=w(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=f.lineCap.replace("butt","flat"),o.joinstyle=f.lineJoin):o&&(_.removeChild(o),e._stroke=null),f.fill?(h||(h=e._fill=wi("fill")),_.appendChild(h),h.color=f.fillColor||f.color,h.opacity=f.fillOpacity):h&&(_.removeChild(h),e._fill=null)},_updateCircle:function(e){var o=e._point.round(),h=Math.round(e._radius),f=Math.round(e._radiusY||h);this._setPath(e,e._empty()?"M0 0":"AL "+o.x+","+o.y+" "+h+","+f+" 0,"+65535*360)},_setPath:function(e,o){e._path.v=o},_bringToFront:function(e){Re(e._container)},_bringToBack:function(e){Ze(e._container)}},Mn=tt.vml?wi:Lt,xi=pe.extend({_initContainer:function(){this._container=Mn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Mn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){mt(this._container),pt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){pe.prototype._update.call(this);var e=this._bounds,o=e.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,h.setAttribute("width",o.x),h.setAttribute("height",o.y)),vt(h,e.min),h.setAttribute("viewBox",[e.min.x,e.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(e){var o=e._path=Mn("path");e.options.className&&at(o,e.options.className),e.options.interactive&&at(o,"leaflet-interactive"),this._updateStyle(e),this._layers[c(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){mt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[c(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var o=e._path,h=e.options;o&&(h.stroke?(o.setAttribute("stroke",h.color),o.setAttribute("stroke-opacity",h.opacity),o.setAttribute("stroke-width",h.weight),o.setAttribute("stroke-linecap",h.lineCap),o.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?o.setAttribute("stroke-dasharray",h.dashArray):o.removeAttribute("stroke-dasharray"),h.dashOffset?o.setAttribute("stroke-dashoffset",h.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),h.fill?(o.setAttribute("fill",h.fillColor||h.color),o.setAttribute("fill-opacity",h.fillOpacity),o.setAttribute("fill-rule",h.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(e,o){this._setPath(e,It(e._parts,o))},_updateCircle:function(e){var o=e._point,h=Math.max(Math.round(e._radius),1),f=Math.max(Math.round(e._radiusY),1)||h,_="a"+h+","+f+" 0 1,0 ",M=e._empty()?"M0 0":"M"+(o.x-h)+","+o.y+_+h*2+",0 "+_+-h*2+",0 ";this._setPath(e,M)},_setPath:function(e,o){e._path.setAttribute("d",o)},_bringToFront:function(e){Re(e._path)},_bringToBack:function(e){Ze(e._path)}});tt.vml&&xi.include(Tu);function xs(e){return tt.svg||tt.vml?new xi(e):null}lt.include({getRenderer:function(e){var o=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(e){if(e==="overlayPane"||e===void 0)return!1;var o=this._paneRenderers[e];return o===void 0&&(o=this._createRenderer({pane:e}),this._paneRenderers[e]=o),o},_createRenderer:function(e){return this.options.preferCanvas&&ws(e)||xs(e)}});var bs=Ue.extend({initialize:function(e,o){Ue.prototype.initialize.call(this,this._boundsToLatLngs(e),o)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=Q(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Du(e,o){return new bs(e,o)}xi.create=Mn,xi.pointsToPath=It,de.geometryToLayer=_n,de.coordsToLatLng=Cr,de.coordsToLatLngs=gn,de.latLngToCoords=kr,de.latLngsToCoords=vn,de.getFeature=je,de.asFeature=yn,lt.mergeOptions({boxZoom:!0});var Ms=ne.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){pt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),fi(),cr(),this._startPoint=this._map.mouseEventToContainerPoint(e),st(document,{contextmenu:De,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=ct("div","leaflet-zoom-box",this._container),at(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var o=new G(this._point,this._startPoint),h=o.getSize();vt(this._box,o.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(mt(this._box),_t(this._container,"leaflet-crosshair")),di(),fr(),pt(document,{contextmenu:De,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var o=new it(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(e){e.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});lt.addInitHook("addHandler","boxZoom",Ms),lt.mergeOptions({doubleClickZoom:!0});var Ps=ne.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var o=this._map,h=o.getZoom(),f=o.options.zoomDelta,_=e.originalEvent.shiftKey?h-f:h+f;o.options.doubleClickZoom==="center"?o.setZoom(_):o.setZoomAround(e.containerPoint,_)}});lt.addInitHook("addHandler","doubleClickZoom",Ps),lt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ls=ne.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new xe(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}at(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){_t(this._map._container,"leaflet-grab"),_t(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=Q(this._map.options.maxBounds);this._offsetLimit=H(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var o=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(o),this._prunePositions(o)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,o){return e-(e-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var e=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;e.x<o.min.x&&(e.x=this._viscousLimit(e.x,o.min.x)),e.y<o.min.y&&(e.y=this._viscousLimit(e.y,o.min.y)),e.x>o.max.x&&(e.x=this._viscousLimit(e.x,o.max.x)),e.y>o.max.y&&(e.y=this._viscousLimit(e.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,o=Math.round(e/2),h=this._initialWorldOffset,f=this._draggable._newPos.x,_=(f-o+h)%e+o-h,M=(f+o+h)%e-o-h,A=Math.abs(_+h)<Math.abs(M+h)?_:M;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=A},_onDragEnd:function(e){var o=this._map,h=o.options,f=!h.inertia||e.noInertia||this._times.length<2;if(o.fire("dragend",e),f)o.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),M=(this._lastTime-this._times[0])/1e3,A=h.easeLinearity,F=_.multiplyBy(A/M),Y=F.distanceTo([0,0]),V=Math.min(h.inertiaMaxSpeed,Y),J=F.multiplyBy(V/Y),nt=V/(h.inertiaDeceleration*A),ht=J.multiplyBy(-nt/2).round();!ht.x&&!ht.y?o.fire("moveend"):(ht=o._limitOffset(ht,o.options.maxBounds),Z(function(){o.panBy(ht,{duration:nt,easeLinearity:A,noMoveStart:!0,animate:!0})}))}}});lt.addInitHook("addHandler","dragging",Ls),lt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ss=ne.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),st(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),pt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,o=document.documentElement,h=e.scrollTop||o.scrollTop,f=e.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(f,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var o=this._panKeys={},h=this.keyCodes,f,_;for(f=0,_=h.left.length;f<_;f++)o[h.left[f]]=[-1*e,0];for(f=0,_=h.right.length;f<_;f++)o[h.right[f]]=[e,0];for(f=0,_=h.down.length;f<_;f++)o[h.down[f]]=[0,e];for(f=0,_=h.up.length;f<_;f++)o[h.up[f]]=[0,-1*e]},_setZoomDelta:function(e){var o=this._zoomKeys={},h=this.keyCodes,f,_;for(f=0,_=h.zoomIn.length;f<_;f++)o[h.zoomIn[f]]=e;for(f=0,_=h.zoomOut.length;f<_;f++)o[h.zoomOut[f]]=-e},_addHooks:function(){st(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){pt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var o=e.keyCode,h=this._map,f;if(o in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(f=this._panKeys[o],e.shiftKey&&(f=R(f).multiplyBy(3)),h.options.maxBounds&&(f=h._limitOffset(R(f),h.options.maxBounds)),h.options.worldCopyJump){var _=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(f)));h.panTo(_)}else h.panBy(f)}else if(o in this._zoomKeys)h.setZoom(h.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;De(e)}}});lt.addInitHook("addHandler","keyboard",Ss),lt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Es=ne.extend({addHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){pt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var o=Jo(e),h=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var f=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),f),De(e)},_performZoom:function(){var e=this._map,o=e.getZoom(),h=this._map.options.zoomSnap||0;e._stop();var f=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(f))))/Math.LN2,M=h?Math.ceil(_/h)*h:_,A=e._limitZoom(o+(this._delta>0?M:-M))-o;this._delta=0,this._startTime=null,A&&(e.options.scrollWheelZoom==="center"?e.setZoom(o+A):e.setZoomAround(this._lastMousePos,o+A))}});lt.addInitHook("addHandler","scrollWheelZoom",Es);var Au=600;lt.mergeOptions({tapHold:tt.touchNative&&tt.safari&&tt.mobile,tapTolerance:15});var Cs=ne.extend({addHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){pt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),e.touches.length===1){var o=e.touches[0];this._startPos=this._newPos=new X(o.clientX,o.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(st(document,"touchend",St),st(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Au),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){pt(document,"touchend",St),pt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),pt(document,"touchend touchcancel contextmenu",this._cancel,this),pt(document,"touchmove",this._onMove,this)},_onMove:function(e){var o=e.touches[0];this._newPos=new X(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,o){var h=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});h._simulated=!0,o.target.dispatchEvent(h)}});lt.addInitHook("addHandler","tapHold",Cs),lt.mergeOptions({touchZoom:tt.touch,bounceAtZoomLimits:!0});var ks=ne.extend({addHooks:function(){at(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_t(this._map._container,"leaflet-touch-zoom"),pt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var o=this._map;if(!(!e.touches||e.touches.length!==2||o._animatingZoom||this._zooming)){var h=o.mouseEventToContainerPoint(e.touches[0]),f=o.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(h.add(f)._divideBy(2))),this._startDist=h.distanceTo(f),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),St(e)}},_onTouchMove:function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var o=this._map,h=o.mouseEventToContainerPoint(e.touches[0]),f=o.mouseEventToContainerPoint(e.touches[1]),_=h.distanceTo(f)/this._startDist;if(this._zoom=o.getScaleZoom(_,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&_<1||this._zoom>o.getMaxZoom()&&_>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var M=h._add(f)._divideBy(2)._subtract(this._centerPoint);if(_===1&&M.x===0&&M.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(M),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var A=l(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Z(A,this,!0),St(e)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),pt(document,"touchmove",this._onTouchMove,this),pt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});lt.addInitHook("addHandler","touchZoom",ks),lt.BoxZoom=Ms,lt.DoubleClickZoom=Ps,lt.Drag=Ls,lt.Keyboard=Ss,lt.ScrollWheelZoom=Es,lt.TapHold=Cs,lt.TouchZoom=ks,n.Bounds=G,n.Browser=tt,n.CRS=ot,n.Canvas=ys,n.Circle=Er,n.CircleMarker=mn,n.Class=x,n.Control=Ht,n.DivIcon=_s,n.DivOverlay=re,n.DomEvent=ql,n.DomUtil=Gl,n.Draggable=xe,n.Evented=W,n.FeatureGroup=ce,n.GeoJSON=de,n.GridLayer=yi,n.Handler=ne,n.Icon=Xe,n.ImageOverlay=wn,n.LatLng=K,n.LatLngBounds=it,n.Layer=Gt,n.LayerGroup=Ye,n.LineUtil=lu,n.Map=lt,n.Marker=pn,n.Mixin=nu,n.Path=be,n.Point=X,n.PolyUtil=ru,n.Polygon=Ue,n.Polyline=fe,n.Popup=xn,n.PosAnimation=Ko,n.Projection=uu,n.Rectangle=bs,n.Renderer=pe,n.SVG=xi,n.SVGOverlay=ms,n.TileLayer=We,n.Tooltip=bn,n.Transformation=bt,n.Util=U,n.VideoOverlay=ps,n.bind=l,n.bounds=H,n.canvas=ws,n.circle=vu,n.circleMarker=gu,n.control=_i,n.divIcon=Eu,n.extend=s,n.featureGroup=pu,n.geoJSON=ds,n.geoJson=xu,n.gridLayer=Cu,n.icon=mu,n.imageOverlay=bu,n.latLng=q,n.latLngBounds=Q,n.layerGroup=du,n.map=Jl,n.marker=_u,n.point=R,n.polygon=wu,n.polyline=yu,n.popup=Lu,n.rectangle=Du,n.setOptions=C,n.stamp=c,n.svg=xs,n.svgOverlay=Pu,n.tileLayer=gs,n.tooltip=Su,n.transformation=Et,n.version=r,n.videoOverlay=Mu;var Iu=window.L;n.noConflict=function(){return window.L=Iu,this},window.L=n}))})(Ni,Ni.exports)),Ni.exports}var el=kp();const Tp=mh(el),il=Xu({__proto__:null,default:Tp},[el]),Dp="_button_bm3j1_1",Ap="_active_bm3j1_20",Ip="_hiddenOnMobile_bm3j1_25",Zn={button:Dp,active:Ap,hiddenOnMobile:Ip};function Op(i){return i.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}const zp=({mode:i,currentMode:t,changeMode:n,label:r,hiddenOnTouch:s})=>{let a=Zn.button;return s&&(a=`${Zn.hiddenOnMobile} ${a}`),t===i&&(a=`${Zn.active} ${a}`),et("button",{id:i,class:a,onClick:()=>{n(i)},children:r||Op(i)})},Bp=({label:i,onClick:t})=>et("button",{id:"clear",class:Zn.button,onClick:()=>{t()},children:i}),Np="_controls_11tz1_5",Fp="_primaryRow_11tz1_19",Rp="_primaryControl_11tz1_23",Zp="_button_11tz1_27",Yp="_routingSelect_11tz1_28",Xp="_toggle_11tz1_68",Up="_inlineInputs_11tz1_89",jp="_inlineLabel_11tz1_96",Wp="_numberInput_11tz1_105",Vt={controls:Np,primaryRow:Fp,primaryControl:Rp,button:Zp,routingSelect:Yp,toggle:Xp,inlineInputs:Up,inlineLabel:jp,numberInput:Wp},Vp=(i,t)=>{const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3};function Hp(i){const t=.0033528106647474805,n=t*(2-t),r=Math.PI/180,s=Math.cos(i*r),a=1/(1-n*(1-s*s)),l=Math.sqrt(a),u=6378.137*r,c=u*l*s,d=u*l*a*(1-n);return function(p,m){let v=p[0]-m[0];for(;v<-180;)v+=360;for(;v>180;)v-=360;const b=v*c,P=(p[1]-m[1])*d;return Math.sqrt(b*b+P*P)}}let Gp=class{constructor(){this.keys=[],this.values=[],this.idxs=[],this.length=0,this.insertCounter=0}insert(t,n){let r=this.length;this.length=r+1;let s=t,a=n,l=this.insertCounter++;for(;r>0;){const u=r-1>>>2,c=this.keys[u],d=this.idxs[u];if(s>c||s===c&&l>d)break;this.keys[r]=c,this.values[r]=this.values[u],this.idxs[r]=d,r=u}this.keys[r]=s,this.values[r]=a,this.idxs[r]=l}extractMin(){const t=this.length;if(t===0)return null;const n=this.values[0],r=t-1;return this.length=r,r>0&&(this.keys[0]=this.keys[r],this.values[0]=this.values[r],this.idxs[0]=this.idxs[r],this.bubbleDown(0)),n}size(){return this.length}bubbleDown(t){const n=this.length,r=this.keys,s=this.values,a=this.idxs,l=r[t],u=s[t],c=a[t];for(;;){const d=1+(t<<2);if(d>=n)break;let p=d,m=r[d],v=a[d],b=s[d];const P=d+1;if(P<n){const I=r[P],g=a[P];(I<m||I===m&&g<v)&&(p=P,m=I,v=g,b=s[P])}const C=d+2;if(C<n){const I=r[C],g=a[C];(I<m||I===m&&g<v)&&(p=C,m=I,v=g,b=s[C])}const z=d+3;if(z<n){const I=r[z],g=a[z];(I<m||I===m&&g<v)&&(p=z,m=I,v=g,b=s[z])}if(!(m<l||m===l&&v<c))break;r[t]=m,s[t]=b,a[t]=v,t=p}r[t]=l,s[t]=u,a[t]=c}},$p=class{constructor(t){var n,r;this.network=null,this.distanceMeasurement=void 0,this.heapConstructor=void 0,this.coordinateIndexMap=new Map,this.coordinates=[],this.adjacencyList=[],this.csrOffsets=null,this.csrIndices=null,this.csrDistances=null,this.csrNodeCount=0,this.gScoreScratch=null,this.cameFromScratch=null,this.visitedScratch=null,this.hScratch=null,this.gScoreRevScratch=null,this.cameFromRevScratch=null,this.visitedRevScratch=null,this.hRevScratch=null,this.scratchCapacity=0,this.distanceMeasurement=(n=t?.distanceMeasurement)!=null?n:Vp,this.heapConstructor=(r=t?.heap)!=null?r:Gp}buildRouteGraph(t){this.network=t,this.coordinateIndexMap=new Map,this.coordinates=[],this.adjacencyList=[],this.csrOffsets=null,this.csrIndices=null,this.csrDistances=null,this.csrNodeCount=0;const n=this.coordinateIndexMap,r=this.coordinates,s=this.distanceMeasurement,a=[];this.forEachSegment(t,(b,P)=>{var C,z;const I=this.indexCoordinate(b,n,r),g=this.indexCoordinate(P,n,r);a[I]=((C=a[I])!=null?C:0)+1,a[g]=((z=a[g])!=null?z:0)+1});const l=this.coordinates.length;this.csrNodeCount=l;const u=new Int32Array(l+1);for(let b=0;b<l;b++){var c;const P=(c=a[b])!=null?c:0;u[b+1]=u[b]+P}const d=u[l],p=new Int32Array(d),m=new Float64Array(d),v=u.slice();this.forEachSegment(t,(b,P)=>{const C=this.coordinateIndexMap.get(b[0]).get(b[1]),z=this.coordinateIndexMap.get(P[0]).get(P[1]),I=s(b,P);let g=v[C]++;p[g]=z,m[g]=I,g=v[z]++,p[g]=C,m[g]=I}),this.csrOffsets=u,this.csrIndices=p,this.csrDistances=m,this.adjacencyList=new Array(l)}expandRouteGraph(t){if(this.network===null)throw new Error("Network not built. Please call buildRouteGraph(network) first.");this.network={type:"FeatureCollection",features:[...this.network.features,...t.features]};const n=this.coordinateIndexMap,r=this.coordinates,s=this.distanceMeasurement,a=this.adjacencyList;for(let l=0;l<a.length;l++)a[l]===void 0&&(a[l]=[]);this.forEachSegment(t,(l,u)=>{const c=this.indexCoordinate(l,n,r,m=>{a[m]=[]}),d=this.indexCoordinate(u,n,r,m=>{a[m]=[]}),p=s(l,u);a[c].push({node:d,distance:p}),a[d].push({node:c,distance:p})}),this.rebuildCsrFromAdjacency()}rebuildCsrFromAdjacency(){const t=this.coordinates.length,n=this.adjacencyList,r=new Int32Array(t);if(this.csrOffsets&&this.csrIndices&&this.csrDistances){const d=this.csrOffsets,p=Math.min(this.csrNodeCount,t);for(let m=0;m<p;m++)r[m]+=d[m+1]-d[m]}for(let d=0;d<t;d++){const p=n[d];p&&p.length&&(r[d]+=p.length)}const s=new Int32Array(t+1);for(let d=0;d<t;d++)s[d+1]=s[d]+r[d];const a=s[t],l=new Int32Array(a),u=new Float64Array(a),c=s.slice();if(this.csrOffsets&&this.csrIndices&&this.csrDistances){const d=this.csrOffsets,p=this.csrIndices,m=this.csrDistances,v=Math.min(this.csrNodeCount,t);for(let b=0;b<v;b++){const P=d[b+1];let C=c[b];for(let z=d[b];z<P;z++)l[C]=p[z],u[C]=m[z],C++;c[b]=C}}for(let d=0;d<t;d++){const p=n[d];if(!p||p.length===0)continue;let m=c[d];for(let v=0,b=p.length;v<b;v++){const P=p[v];l[m]=P.node,u[m]=P.distance,m++}c[d]=m}this.csrOffsets=s,this.csrIndices=l,this.csrDistances=u,this.csrNodeCount=t,this.adjacencyList=new Array(t)}getRoute(t,n){if(this.network===null)throw new Error("Network not built. Please call buildRouteGraph(network) first.");const r=this.getOrCreateIndex(t.geometry.coordinates),s=this.getOrCreateIndex(n.geometry.coordinates);if(r===s)return null;const a=this.coordinates,l=this.adjacencyList,u=a.length;this.ensureScratch(u);const c=this.gScoreScratch,d=this.gScoreRevScratch,p=this.cameFromScratch,m=this.cameFromRevScratch,v=this.visitedScratch,b=this.visitedRevScratch,P=this.hScratch,C=this.hRevScratch;c.fill(Number.POSITIVE_INFINITY,0,u),d.fill(Number.POSITIVE_INFINITY,0,u),p.fill(-1,0,u),m.fill(-1,0,u),v.fill(0,0,u),b.fill(0,0,u),P.fill(-1,0,u),C.fill(-1,0,u);const z=new this.heapConstructor,I=new this.heapConstructor;c[r]=0,d[s]=0,z.insert(0,r),I.insert(0,s);let g=Number.POSITIVE_INFINITY,w=-1,y=0,S=0;for(;z.size()>0&&I.size()>0&&!(w>=0&&y+S>=g);)if(z.size()<=I.size()){const k=z.extractMin();if(v[k]!==0)continue;if(y=c[k],v[k]=1,b[k]!==0){const B=c[k]+d[k];B<g&&(g=B,w=k)}if(this.csrOffsets&&k<this.csrNodeCount){const B=this.csrOffsets,N=this.csrIndices,Z=this.csrDistances;for(let j=B[k],U=B[k+1];j<U;j++){const x=N[j],D=c[k]+Z[j];if(D<c[x]){c[x]=D,p[x]=k;const O=d[x];if(O!==Number.POSITIVE_INFINITY){const W=D+O;W<g&&(g=W,w=x)}z.insert(D,x)}}}else{const B=l[k];if(B&&B.length)for(let N=0,Z=B.length;N<Z;N++){const j=B[N],U=j.node,x=c[k]+j.distance;if(x<c[U]){c[U]=x,p[U]=k;const D=d[U];if(D!==Number.POSITIVE_INFINITY){const O=x+D;O<g&&(g=O,w=U)}z.insert(x,U)}}}}else{const k=I.extractMin();if(b[k]!==0)continue;if(S=d[k],b[k]=1,v[k]!==0){const B=c[k]+d[k];B<g&&(g=B,w=k)}if(this.csrOffsets&&k<this.csrNodeCount){const B=this.csrOffsets,N=this.csrIndices,Z=this.csrDistances;for(let j=B[k],U=B[k+1];j<U;j++){const x=N[j],D=d[k]+Z[j];if(D<d[x]){d[x]=D,m[x]=k;const O=c[x];if(O!==Number.POSITIVE_INFINITY){const W=D+O;W<g&&(g=W,w=x)}I.insert(D,x)}}}else{const B=l[k];if(B&&B.length)for(let N=0,Z=B.length;N<Z;N++){const j=B[N],U=j.node,x=d[k]+j.distance;if(x<d[U]){d[U]=x,m[U]=k;const D=c[U];if(D!==Number.POSITIVE_INFINITY){const O=x+D;O<g&&(g=O,w=U)}I.insert(x,U)}}}}if(w<0)return null;const E=[];let T=w;for(;T!==r&&T>=0;)E.push(a[T]),T=p[T];if(T!==r)return null;for(E.push(a[r]),E.reverse(),T=w;T!==s;){if(T=m[T],T<0)return null;E.push(a[T])}return{type:"Feature",geometry:{type:"LineString",coordinates:E},properties:{}}}getOrCreateIndex(t){const n=t[0],r=t[1];let s=this.coordinateIndexMap.get(n);s===void 0&&(s=new Map,this.coordinateIndexMap.set(n,s));let a=s.get(r);if(a===void 0&&(a=this.coordinates.length,this.coordinates.push(t),s.set(r,a),this.adjacencyList[a]=[],this.csrOffsets)){const l=this.csrNodeCount;if(a===l){const u=new Int32Array(l+2);u.set(this.csrOffsets,0),u[l+1]=u[l],this.csrOffsets=u,this.csrNodeCount=l+1}}return a}ensureScratch(t){if(this.scratchCapacity>=t&&this.gScoreScratch&&this.cameFromScratch&&this.visitedScratch&&this.hScratch&&this.gScoreRevScratch&&this.cameFromRevScratch&&this.visitedRevScratch&&this.hRevScratch)return;const n=0|t;this.gScoreScratch=new Float64Array(n),this.cameFromScratch=new Int32Array(n),this.visitedScratch=new Uint8Array(n),this.hScratch=new Float64Array(n),this.gScoreRevScratch=new Float64Array(n),this.cameFromRevScratch=new Int32Array(n),this.visitedRevScratch=new Uint8Array(n),this.hRevScratch=new Float64Array(n),this.scratchCapacity=n}forEachSegment(t,n){const r=t.features;for(let s=0,a=r.length;s<a;s++){const l=r[s].geometry.coordinates;for(let u=0,c=l.length-1;u<c;u++)n(l[u],l[u+1])}}indexCoordinate(t,n,r,s){const a=t[0],l=t[1];let u=n.get(a);u===void 0&&(u=new Map,n.set(a,u));let c=u.get(l);return c===void 0&&(c=r.length,r.push(t),u.set(l,c),s&&s(c)),c}};var zt=63710088e-1,qp={centimeters:zt*100,centimetres:zt*100,degrees:zt/111325,feet:zt*3.28084,inches:zt*39.37,kilometers:zt/1e3,kilometres:zt/1e3,meters:zt,metres:zt,miles:zt/1609.344,millimeters:zt*1e3,millimetres:zt*1e3,nauticalmiles:zt/1852,radians:1,yards:zt*1.0936};function nl(i,t,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Qn(i,t,n){if(n===void 0&&(n={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Aa(i[0])||!Aa(i[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:i};return nl(r,t,n)}function Jp(i,t,n){if(n===void 0&&(n={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:i};return nl(r,t,n)}function rl(i,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=i,n}function Kp(i,t){t===void 0&&(t="kilometers");var n=qp[t];if(!n)throw new Error(t+" units is invalid");return i*n}function An(i){var t=i%360;return t*Math.PI/180}function Aa(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Qp(i,t,n,r={}){const s={vertices:Object.keys(i).reduce((m,v)=>(m[v]={...i[v]},m),{}),coordinates:Object.keys(i).reduce((m,v)=>{m[v]={};for(const b of Object.keys(i[v]))m[v][b]=[t[v]];return m},{}),edgeData:"edgeDataReducer"in r?Object.keys(i).reduce((m,v)=>(m[v]=Object.keys(i[v]).reduce((b,P)=>(b[P]=n[v][P],b),{}),m),{}):{}},{vertices:a,coordinates:l,edgeData:u}=s,c="edgeDataReducer"in r&&u,d=Object.keys(i).filter(m=>im(i,m));for(const m of d){const v=a[m],b=Object.keys(v);if(b.length!==0){for(const P of b)for(const C of b)P!==C&&(p(m,P,C),p(m,C,P));for(const P of b){if(!a[P])throw new Error(`Missing neighbor vertex for ${P}`);delete a[P][m],delete l[P][m]}delete a[m],delete l[m]}}return s;function p(m,v,b){const P=a[m],C=a[v],z=C[m];if(!C[b]&&z){C[b]=z+P[b],l[v][b]=[...l[v][m],...l[m][b]];let I=c?u[v][m]:void 0;const g=c?u[m][b]:void 0;c&&I&&g&&(u[v][b]=r.edgeDataReducer(I,g))}}}function tm(i,t,n,r,s,a,l={}){const u=t[i];return Object.keys(u).reduce(c,{edges:{},incomingEdges:{},coordinates:{},incomingCoordinates:{},reducedEdges:{}});function c(d,p){const m=em(i,p,t,n,r,s,a,l),v=m.weight,b=m.reverseWeight;if(m.vertexKey!==i&&((!d.edges[m.vertexKey]||d.edges[m.vertexKey]>v)&&(d.edges[m.vertexKey]=v,d.coordinates[m.vertexKey]=[r[i]].concat(m.coordinates),d.reducedEdges[m.vertexKey]=m.reducedEdge),!isNaN(b)&&(!d.incomingEdges[m.vertexKey]||d.incomingEdges[m.vertexKey]>b))){d.incomingEdges[m.vertexKey]=b;var P=[r[i]].concat(m.coordinates);P.reverse(),d.incomingCoordinates[m.vertexKey]=P}return d}}function em(i,t,n,r,s,a,l,u={}){let c=n[i][t],d=n[t][i];const p=[],m=[];let v="edgeDataReducer"in u?a[t][i]:void 0;for(;!r[t];){var b=n[t];if(!b)break;var P=Object.keys(b).filter(function(I){return I!==i})[0];c+=b[P];{if(d+=n[P]?.[t]||1/0,m.indexOf(t)>=0){r[t]=n[t];break}m.push(t)}const C=a[t]&&a[t][P];"edgeDataReducer"in u&&v&&C&&(v=u.edgeDataReducer(v,C)),p.push(s[t]),i=t,t=P}return{vertexKey:t,weight:c,reverseWeight:d,coordinates:p,reducedEdge:v}}function im(i,t){const n=i[t],r=Object.keys(n);switch(r.length){case 1:return!i[r[0]][t];case 2:return r.every(a=>i[a][t]);default:return!1}}class ol{constructor(t=[],n=nm){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=(t<<1)+1,u=n[l];const c=l+1;if(c<this.length&&r(n[c],u)<0&&(l=c,u=n[c]),r(u,a)>=0)break;n[t]=u,t=l}n[t]=a}}function nm(i,t){return i<t?-1:i>t?1:0}const rm=Object.freeze(Object.defineProperty({__proto__:null,default:ol},Symbol.toStringTag,{value:"Module"}));function om(i,t,n){const r={[t]:0},s=[0,[t],t],a=new ol([s],(l,u)=>l[0]-u[0]);for(;;){const l=a.pop();if(!l)return;const u=l[0],c=l[2];if(c===n)return[l[0],l[1]];const d=i[c];Object.keys(d).forEach(function(p){var m=u+d[p];if(m<1/0&&(!(p in r)||m<r[p])){r[p]=m;const v=[m,l[1].concat([p]),p];a.push(v)}})}}function Ia(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function sm(i,t,n){n===void 0&&(n={});var r=Ia(i),s=Ia(t),a=An(s[1]-r[1]),l=An(s[0]-r[0]),u=An(r[1]),c=An(s[1]),d=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(c);return Kp(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),n.units)}function uo(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,m=0,v,b=i.type,P=b==="FeatureCollection",C=b==="Feature",z=P?i.features.length:1,I=0;I<z;I++){d=P?i.features[I].geometry:C?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var w=0,y=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var S=l.type;switch(p=0,S){case null:break;case"Point":if(t(c,m,I,w,y)===!1)return!1;m++,w++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],m,I,w,y)===!1)return!1;m++,S==="MultiPoint"&&w++}S==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],m,I,w,y)===!1)return!1;m++}S==="MultiLineString"&&w++,S==="Polygon"&&y++}S==="Polygon"&&w++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],m,I,w,y)===!1)return!1;m++}y++}w++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(uo(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function am(i,t){if(i.type==="Feature")t(i,0);else if(i.type==="FeatureCollection")for(var n=0;n<i.features.length&&t(i.features[n],n)!==!1;n++);}function hm(i){var t=[];return i.type==="FeatureCollection"?am(i,function(n){uo(n,function(r){t.push(Qn(r,n.properties))})}):uo(i,function(n){t.push(Qn(n,i.properties))}),rl(t)}function ji(i,t){return[Math.round(i[0]/t)*t,Math.round(i[1]/t)*t]}function lm(i,t={}){const{key:n=al}=t,{tolerance:r=1e-5}=t,s=rl(i.features.filter(d=>d.geometry.type==="LineString")),l=hm(s).features.reduce(function(p,m,v,b){var P=ji(m.geometry.coordinates,r);return p[n(P)]=m.geometry.coordinates,v%1e3===0&&t.progress&&t.progress("topo:vertices",v,b.length),p},{}),u=sl(s,c,[]);return{vertices:l,edges:u};function c(d,p){return p.geometry.coordinates.forEach(function(v,b,P){if(b>0){var C=n(ji(P[b-1],r)),z=n(ji(v,r));d.push([C,z,p.properties])}}),d}}function sl(i,t,n){return i.type==="FeatureCollection"?i.features.reduce(function(s,a){return sl(a,t,s)},n):t(n,i)}function al(i){return i.join(",")}function um(i,t={}){const n=lm(i,t),{weight:r=cm}=t,s=n.edges.reduce(c,{edgeData:{},vertices:{}}),{vertices:a,coordinates:l,edgeData:u}=Qp(s.vertices,n.vertices,s.edgeData,t);return{vertices:s.vertices,edgeData:s.edgeData,sourceCoordinates:n.vertices,compactedVertices:a,compactedCoordinates:l,compactedEdges:u};function c(d,p,m,v){const[b,P,C]=p,z=r(n.vertices[b],n.vertices[P],C);return z&&(I(b),I(P),z instanceof Object?(g(b,P,z.forward||1/0),g(P,b,z.backward||1/0)):(g(b,P,z||1/0),g(P,b,z||1/0))),m%1e3===0&&t.progress&&t.progress("edgeweights",m,v.length),d;function I(w){d.vertices[w]||(d.vertices[w]={},d.edgeData[w]={})}function g(w,y,S){var E=d.vertices[w];E[y]=S,d.edgeData[w][y]="edgeDataReducer"in t?t.edgeDataSeed(C):void 0}}}function cm(i,t){return sm(Qn(i),Qn(t))}class jr{constructor(t,n={}){this.graph=um(t,n),this.options=n}findPath(t,n){const{key:r=al,tolerance:s=1e-5}=this.options,a=r(ji(t.geometry.coordinates,s)),l=r(ji(n.geometry.coordinates,s));if(!this.graph.vertices[a]||!this.graph.vertices[l])return;const u=this._createPhantom(a),c=this._createPhantom(l);try{const d=om(this.graph.compactedVertices,a,l);if(d){const[p,m]=d;return{path:m.reduce((v,b,P,C)=>(P>0&&(v=v.concat(this.graph.compactedCoordinates[C[P-1]][b])),v),[]).concat([this.graph.sourceCoordinates[l]]),weight:p,edgeDatas:"edgeDataReducer"in this.options?m.reduce((v,b,P,C)=>(P>0&&v.push(this.graph.compactedEdges[C[P-1]][b]),v),[]):void 0}}else return}finally{this._removePhantom(u),this._removePhantom(c)}}_createPhantom(t){if(this.graph.compactedVertices[t])return;const n=tm(t,this.graph.vertices,this.graph.compactedVertices,this.graph.sourceCoordinates,this.graph.edgeData,!0,this.options);return this.graph.compactedVertices[t]=n.edges,this.graph.compactedCoordinates[t]=n.coordinates,"edgeDataReducer"in this.options&&(this.graph.compactedEdges[t]=n.reducedEdges),Object.keys(n.incomingEdges).forEach(r=>{this.graph.compactedVertices[r][t]=n.incomingEdges[r],this.graph.compactedCoordinates[r]||(this.graph.compactedCoordinates[r]={}),this.graph.compactedCoordinates[r][t]=[this.graph.sourceCoordinates[r],...n.incomingCoordinates[r].slice(0,-1)],this.graph.compactedEdges&&(this.graph.compactedEdges[r]||(this.graph.compactedEdges[r]={}),this.graph.compactedEdges[r][t]=n.reducedEdges[r])}),t}_removePhantom(t){t&&(Object.keys(this.graph.compactedVertices[t]).forEach(n=>{delete this.graph.compactedVertices[n][t]}),Object.keys(this.graph.compactedCoordinates[t]).forEach(n=>{delete this.graph.compactedCoordinates[n][t]}),"edgeDataReducer"in this.options&&Object.keys(this.graph.compactedEdges[t]).forEach(n=>{delete this.graph.compactedEdges[n][t]}),delete this.graph.compactedVertices[t],delete this.graph.compactedCoordinates[t],this.graph.compactedEdges&&delete this.graph.compactedEdges[t])}}function fm(i){if(i){const{weight:t,edgeDatas:n}=i;return Jp(i.path,{weight:t,edgeDatas:n})}}function dm(i){let t=new jr(i);const n=i;return{getRoute:(s,a)=>{const l=t.findPath(s,a);return l&&l.path.length>1?fm(l):null},setNetwork:s=>{t=new jr(s)},expandNetwork:s=>{n.features.push(...s.features),t=new jr(n)}}}function pm(i){const t=Hp(i.features[0].geometry.coordinates[0][1]),n=new $p({distanceMeasurement:t});return n.buildRouteGraph(i),{getRoute:n.getRoute.bind(n),setNetwork:r=>{n.buildRouteGraph(r)},expandNetwork:r=>{n.expandRouteGraph(r)}}}const Kt={TerraRoute:"terra-route",GeoJSONPathFinder:"geojson-path-finder"};function Oa(i,t=Kt.TerraRoute){let n;if(t===Kt.GeoJSONPathFinder)n=dm(i);else if(t===Kt.TerraRoute)n=pm(i);else throw new Error(`Unknown routing option: ${t}`);return n}const mm=({mode:i,onClear:t,changeMode:n,onPrune:r,routingOption:s,routingDisabled:a,onRoutingChange:l,fallbackToStraightLineEnabled:u,snapToleranceEnterPx:c,nearPx:d,onFallbackToStraightLineEnabledChange:p,onSnapToleranceEnterPxChange:m,onNearPxChange:v})=>et("div",{class:Vt.controls,children:[et("div",{class:Vt.primaryRow,children:[et("div",{class:Vt.primaryControl,children:et(zp,{label:"Route Snap",mode:"routesnap",currentMode:i,changeMode:n})}),et("div",{class:Vt.primaryControl,children:et(Bp,{onClick:t,label:"Clear"})})]}),et("button",{class:Vt.button,onClick:r,children:"Prune"}),et("label",{class:Vt.toggle,children:[et("input",{type:"checkbox",checked:u,onChange:b=>{const P=b.target;p(P.checked)}}),et("span",{children:"Straight line"})]}),et("div",{class:Vt.inlineInputs,"aria-disabled":!u,children:[et("label",{class:Vt.inlineLabel,children:["Snap tolerance (px)",et("input",{class:Vt.numberInput,type:"number",min:0,step:1,value:c,disabled:!u,onInput:b=>{const P=b.target,C=Number(P.value);m(Number.isFinite(C)?C:0)}})]}),et("label",{class:Vt.inlineLabel,children:["Near (px)",et("input",{class:Vt.numberInput,type:"number",min:0,step:1,value:d,disabled:!u,onInput:b=>{const P=b.target,C=Number(P.value);v(Number.isFinite(C)?C:0)}})]})]}),et("select",{value:s,disabled:a,onChange:b=>{const P=b.target,C=P.options[P.selectedIndex].value;l(C)},class:Vt.routingSelect,children:[et("option",{value:Kt.TerraRoute,children:"Terra Route"}),et("option",{value:Kt.GeoJSONPathFinder,children:"GeoJSON Path Finder"})]})]});function _m(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function gm(i,t,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return _m({type:"Polygon",coordinates:i},t,n)}function hl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,m=0,v,b=i.type,P=b==="FeatureCollection",C=b==="Feature",z=P?i.features.length:1,I=0;I<z;I++){d=P?i.features[I].geometry:C?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var w=0,y=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var S=l.type;switch(p=0,S){case null:break;case"Point":if(t(c,m,I,w,y)===!1)return!1;m++,w++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],m,I,w,y)===!1)return!1;m++,S==="MultiPoint"&&w++}S==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],m,I,w,y)===!1)return!1;m++}S==="MultiLineString"&&w++,S==="Polygon"&&y++}S==="Polygon"&&w++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],m,I,w,y)===!1)return!1;m++}y++}w++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(hl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var In={exports:{}},Yn={exports:{}},vm=Yn.exports,za;function ym(){return za||(za=1,(function(i,t){(function(n,r){i.exports=r()})(vm,function(){function n(g,w,y,S,E){(function T(k,B,N,Z,j){for(;Z>N;){if(Z-N>600){var U=Z-N+1,x=B-N+1,D=Math.log(U),O=.5*Math.exp(2*D/3),W=.5*Math.sqrt(D*O*(U-O)/U)*(x-U/2<0?-1:1),X=Math.max(N,Math.floor(B-x*O/U+W)),$=Math.min(Z,Math.floor(B+(U-x)*O/U+W));T(k,B,X,$,j)}var R=k[B],G=N,H=Z;for(r(k,N,B),j(k[Z],R)>0&&r(k,N,Z);G<H;){for(r(k,G,H),G++,H--;j(k[G],R)<0;)G++;for(;j(k[H],R)>0;)H--}j(k[N],R)===0?r(k,N,H):r(k,++H,Z),H<=B&&(N=H+1),B<=H&&(Z=H-1)}})(g,w,y||0,S||g.length-1,E||s)}function r(g,w,y){var S=g[w];g[w]=g[y],g[y]=S}function s(g,w){return g<w?-1:g>w?1:0}var a=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(g,w,y){if(!y)return w.indexOf(g);for(var S=0;S<w.length;S++)if(y(g,w[S]))return S;return-1}function u(g,w){c(g,0,g.children.length,w,g)}function c(g,w,y,S,E){E||(E=z(null)),E.minX=1/0,E.minY=1/0,E.maxX=-1/0,E.maxY=-1/0;for(var T=w;T<y;T++){var k=g.children[T];d(E,g.leaf?S(k):k)}return E}function d(g,w){return g.minX=Math.min(g.minX,w.minX),g.minY=Math.min(g.minY,w.minY),g.maxX=Math.max(g.maxX,w.maxX),g.maxY=Math.max(g.maxY,w.maxY),g}function p(g,w){return g.minX-w.minX}function m(g,w){return g.minY-w.minY}function v(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function b(g){return g.maxX-g.minX+(g.maxY-g.minY)}function P(g,w){return g.minX<=w.minX&&g.minY<=w.minY&&w.maxX<=g.maxX&&w.maxY<=g.maxY}function C(g,w){return w.minX<=g.maxX&&w.minY<=g.maxY&&w.maxX>=g.minX&&w.maxY>=g.minY}function z(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function I(g,w,y,S,E){for(var T=[w,y];T.length;)if(!((y=T.pop())-(w=T.pop())<=S)){var k=w+Math.ceil((y-w)/S/2)*S;n(g,k,w,y,E),T.push(w,k,k,y)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(g){var w=this.data,y=[];if(!C(g,w))return y;for(var S=this.toBBox,E=[];w;){for(var T=0;T<w.children.length;T++){var k=w.children[T],B=w.leaf?S(k):k;C(g,B)&&(w.leaf?y.push(k):P(g,B)?this._all(k,y):E.push(k))}w=E.pop()}return y},a.prototype.collides=function(g){var w=this.data;if(!C(g,w))return!1;for(var y=[];w;){for(var S=0;S<w.children.length;S++){var E=w.children[S],T=w.leaf?this.toBBox(E):E;if(C(g,T)){if(w.leaf||P(g,T))return!0;y.push(E)}}w=y.pop()}return!1},a.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var w=0;w<g.length;w++)this.insert(g[w]);return this}var y=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===y.height)this._splitRoot(this.data,y);else{if(this.data.height<y.height){var S=this.data;this.data=y,y=S}this._insert(y,this.data.height-y.height-1,!0)}else this.data=y;return this},a.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},a.prototype.clear=function(){return this.data=z([]),this},a.prototype.remove=function(g,w){if(!g)return this;for(var y,S,E,T=this.data,k=this.toBBox(g),B=[],N=[];T||B.length;){if(T||(T=B.pop(),S=B[B.length-1],y=N.pop(),E=!0),T.leaf){var Z=l(g,T.children,w);if(Z!==-1)return T.children.splice(Z,1),B.push(T),this._condense(B),this}E||T.leaf||!P(T,k)?S?(y++,T=S.children[y],E=!1):T=null:(B.push(T),N.push(y),y=0,S=T,T=T.children[0])}return this},a.prototype.toBBox=function(g){return g},a.prototype.compareMinX=function(g,w){return g.minX-w.minX},a.prototype.compareMinY=function(g,w){return g.minY-w.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(g){return this.data=g,this},a.prototype._all=function(g,w){for(var y=[];g;)g.leaf?w.push.apply(w,g.children):y.push.apply(y,g.children),g=y.pop();return w},a.prototype._build=function(g,w,y,S){var E,T=y-w+1,k=this._maxEntries;if(T<=k)return u(E=z(g.slice(w,y+1)),this.toBBox),E;S||(S=Math.ceil(Math.log(T)/Math.log(k)),k=Math.ceil(T/Math.pow(k,S-1))),(E=z([])).leaf=!1,E.height=S;var B=Math.ceil(T/k),N=B*Math.ceil(Math.sqrt(k));I(g,w,y,N,this.compareMinX);for(var Z=w;Z<=y;Z+=N){var j=Math.min(Z+N-1,y);I(g,Z,j,B,this.compareMinY);for(var U=Z;U<=j;U+=B){var x=Math.min(U+B-1,j);E.children.push(this._build(g,U,x,S-1))}}return u(E,this.toBBox),E},a.prototype._chooseSubtree=function(g,w,y,S){for(;S.push(w),!w.leaf&&S.length-1!==y;){for(var E=1/0,T=1/0,k=void 0,B=0;B<w.children.length;B++){var N=w.children[B],Z=v(N),j=(U=g,x=N,(Math.max(x.maxX,U.maxX)-Math.min(x.minX,U.minX))*(Math.max(x.maxY,U.maxY)-Math.min(x.minY,U.minY))-Z);j<T?(T=j,E=Z<E?Z:E,k=N):j===T&&Z<E&&(E=Z,k=N)}w=k||w.children[0]}var U,x;return w},a.prototype._insert=function(g,w,y){var S=y?g:this.toBBox(g),E=[],T=this._chooseSubtree(S,this.data,w,E);for(T.children.push(g),d(T,S);w>=0&&E[w].children.length>this._maxEntries;)this._split(E,w),w--;this._adjustParentBBoxes(S,E,w)},a.prototype._split=function(g,w){var y=g[w],S=y.children.length,E=this._minEntries;this._chooseSplitAxis(y,E,S);var T=this._chooseSplitIndex(y,E,S),k=z(y.children.splice(T,y.children.length-T));k.height=y.height,k.leaf=y.leaf,u(y,this.toBBox),u(k,this.toBBox),w?g[w-1].children.push(k):this._splitRoot(y,k)},a.prototype._splitRoot=function(g,w){this.data=z([g,w]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(g,w,y){for(var S,E,T,k,B,N,Z,j=1/0,U=1/0,x=w;x<=y-w;x++){var D=c(g,0,x,this.toBBox),O=c(g,x,y,this.toBBox),W=(E=D,T=O,k=void 0,B=void 0,N=void 0,Z=void 0,k=Math.max(E.minX,T.minX),B=Math.max(E.minY,T.minY),N=Math.min(E.maxX,T.maxX),Z=Math.min(E.maxY,T.maxY),Math.max(0,N-k)*Math.max(0,Z-B)),X=v(D)+v(O);W<j?(j=W,S=x,U=X<U?X:U):W===j&&X<U&&(U=X,S=x)}return S||y-w},a.prototype._chooseSplitAxis=function(g,w,y){var S=g.leaf?this.compareMinX:p,E=g.leaf?this.compareMinY:m;this._allDistMargin(g,w,y,S)<this._allDistMargin(g,w,y,E)&&g.children.sort(S)},a.prototype._allDistMargin=function(g,w,y,S){g.children.sort(S);for(var E=this.toBBox,T=c(g,0,w,E),k=c(g,y-w,y,E),B=b(T)+b(k),N=w;N<y-w;N++){var Z=g.children[N];d(T,g.leaf?E(Z):Z),B+=b(T)}for(var j=y-w-1;j>=w;j--){var U=g.children[j];d(k,g.leaf?E(U):U),B+=b(k)}return B},a.prototype._adjustParentBBoxes=function(g,w,y){for(var S=y;S>=0;S--)d(w[S],g)},a.prototype._condense=function(g){for(var w=g.length-1,y=void 0;w>=0;w--)g[w].children.length===0?w>0?(y=g[w-1].children).splice(y.indexOf(g[w]),1):this.clear():u(g[w],this.toBBox)},a})})(Yn)),Yn.exports}const wm=go(rm);var Di={exports:{}},Wr,Ba;function xm(){return Ba||(Ba=1,Wr=function(t,n,r,s){var a=t[0],l=t[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var c=(s-r)/2,d=0,p=c-1;d<c;p=d++){var m=n[r+d*2+0],v=n[r+d*2+1],b=n[r+p*2+0],P=n[r+p*2+1],C=v>l!=P>l&&a<(b-m)*(l-v)/(P-v)+m;C&&(u=!u)}return u}),Wr}var Vr,Na;function bm(){return Na||(Na=1,Vr=function(t,n,r,s){var a=t[0],l=t[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var c=s-r,d=0,p=c-1;d<c;p=d++){var m=n[d+r][0],v=n[d+r][1],b=n[p+r][0],P=n[p+r][1],C=v>l!=P>l&&a<(b-m)*(l-v)/(P-v)+m;C&&(u=!u)}return u}),Vr}var Fa;function Mm(){if(Fa)return Di.exports;Fa=1;var i=xm(),t=bm();return Di.exports=function(r,s,a,l){return s.length>0&&Array.isArray(s[0])?t(r,s,a,l):i(r,s,a,l)},Di.exports.nested=t,Di.exports.flat=i,Di.exports}var Fi={exports:{}},Pm=Fi.exports,Ra;function Lm(){return Ra||(Ra=1,(function(i,t){(function(n,r){r(t)})(Pm,function(n){const s=33306690738754706e-32;function a(C,z,I,g,w){let y,S,E,T,k=z[0],B=g[0],N=0,Z=0;B>k==B>-k?(y=k,k=z[++N]):(y=B,B=g[++Z]);let j=0;if(N<C&&Z<I)for(B>k==B>-k?(E=y-((S=k+y)-k),k=z[++N]):(E=y-((S=B+y)-B),B=g[++Z]),y=S,E!==0&&(w[j++]=E);N<C&&Z<I;)B>k==B>-k?(E=y-((S=y+k)-(T=S-y))+(k-T),k=z[++N]):(E=y-((S=y+B)-(T=S-y))+(B-T),B=g[++Z]),y=S,E!==0&&(w[j++]=E);for(;N<C;)E=y-((S=y+k)-(T=S-y))+(k-T),k=z[++N],y=S,E!==0&&(w[j++]=E);for(;Z<I;)E=y-((S=y+B)-(T=S-y))+(B-T),B=g[++Z],y=S,E!==0&&(w[j++]=E);return y===0&&j!==0||(w[j++]=y),j}function l(C){return new Float64Array(C)}const u=33306690738754716e-32,c=22204460492503146e-32,d=11093356479670487e-47,p=l(4),m=l(8),v=l(12),b=l(16),P=l(4);n.orient2d=function(C,z,I,g,w,y){const S=(z-y)*(I-w),E=(C-w)*(g-y),T=S-E;if(S===0||E===0||S>0!=E>0)return T;const k=Math.abs(S+E);return Math.abs(T)>=u*k?T:-(function(B,N,Z,j,U,x,D){let O,W,X,$,R,G,H,it,Q,K,q,ot,ut,dt,xt,bt,Et,Mt;const Ct=B-U,Lt=Z-U,It=N-x,kt=j-x;R=(xt=(it=Ct-(H=(G=134217729*Ct)-(G-Ct)))*(K=kt-(Q=(G=134217729*kt)-(G-kt)))-((dt=Ct*kt)-H*Q-it*Q-H*K))-(q=xt-(Et=(it=It-(H=(G=134217729*It)-(G-It)))*(K=Lt-(Q=(G=134217729*Lt)-(G-Lt)))-((bt=It*Lt)-H*Q-it*Q-H*K))),p[0]=xt-(q+R)+(R-Et),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),p[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,p[2]=ot-(Mt-R)+(q-R),p[3]=Mt;let Rt=(function(rn,on){let sn=on[0];for(let Ee=1;Ee<rn;Ee++)sn+=on[Ee];return sn})(4,p),Se=c*D;if(Rt>=Se||-Rt>=Se||(O=B-(Ct+(R=B-Ct))+(R-U),X=Z-(Lt+(R=Z-Lt))+(R-U),W=N-(It+(R=N-It))+(R-x),$=j-(kt+(R=j-kt))+(R-x),O===0&&W===0&&X===0&&$===0)||(Se=d*D+s*Math.abs(Rt),(Rt+=Ct*$+kt*O-(It*X+Lt*W))>=Se||-Rt>=Se))return Rt;R=(xt=(it=O-(H=(G=134217729*O)-(G-O)))*(K=kt-(Q=(G=134217729*kt)-(G-kt)))-((dt=O*kt)-H*Q-it*Q-H*K))-(q=xt-(Et=(it=W-(H=(G=134217729*W)-(G-W)))*(K=Lt-(Q=(G=134217729*Lt)-(G-Lt)))-((bt=W*Lt)-H*Q-it*Q-H*K))),P[0]=xt-(q+R)+(R-Et),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),P[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,P[2]=ot-(Mt-R)+(q-R),P[3]=Mt;const en=a(4,p,4,P,m);R=(xt=(it=Ct-(H=(G=134217729*Ct)-(G-Ct)))*(K=$-(Q=(G=134217729*$)-(G-$)))-((dt=Ct*$)-H*Q-it*Q-H*K))-(q=xt-(Et=(it=It-(H=(G=134217729*It)-(G-It)))*(K=X-(Q=(G=134217729*X)-(G-X)))-((bt=It*X)-H*Q-it*Q-H*K))),P[0]=xt-(q+R)+(R-Et),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),P[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,P[2]=ot-(Mt-R)+(q-R),P[3]=Mt;const hi=a(en,m,4,P,v);R=(xt=(it=O-(H=(G=134217729*O)-(G-O)))*(K=$-(Q=(G=134217729*$)-(G-$)))-((dt=O*$)-H*Q-it*Q-H*K))-(q=xt-(Et=(it=W-(H=(G=134217729*W)-(G-W)))*(K=X-(Q=(G=134217729*X)-(G-X)))-((bt=W*X)-H*Q-it*Q-H*K))),P[0]=xt-(q+R)+(R-Et),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),P[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,P[2]=ot-(Mt-R)+(q-R),P[3]=Mt;const nn=a(hi,v,4,P,b);return b[nn-1]})(C,z,I,g,w,y,k)},n.orient2dfast=function(C,z,I,g,w,y){return(z-y)*(I-w)-(C-w)*(g-y)},Object.defineProperty(n,"__esModule",{value:!0})})})(Fi,Fi.exports)),Fi.exports}var Za;function Sm(){if(Za)return In.exports;Za=1;var i=ym(),t=wm,n=Mm(),r=Lm().orient2d;t.default&&(t=t.default),In.exports=s,In.exports.default=s;function s(y,S,E){S=Math.max(0,S===void 0?2:S),E=E||0;var T=b(y),k=new i(16);k.toBBox=function(H){return{minX:H[0],minY:H[1],maxX:H[0],maxY:H[1]}},k.compareMinX=function(H,it){return H[0]-it[0]},k.compareMinY=function(H,it){return H[1]-it[1]},k.load(y);for(var B=[],N=0,Z;N<T.length;N++){var j=T[N];k.remove(j),Z=P(j,Z),B.push(Z)}var U=new i(16);for(N=0;N<B.length;N++)U.insert(v(B[N]));for(var x=S*S,D=E*E;B.length;){var O=B.shift(),W=O.p,X=O.next.p,$=C(W,X);if(!($<D)){var R=$/x;j=a(k,O.prev.p,W,X,O.next.next.p,R,U),j&&Math.min(C(j,W),C(j,X))<=R&&(B.push(O),B.push(P(j,O)),k.remove(j),U.remove(O),U.insert(v(O)),U.insert(v(O.next)))}}O=Z;var G=[];do G.push(O.p),O=O.next;while(O!==Z);return G.push(O.p),G}function a(y,S,E,T,k,B,N){for(var Z=new t([],l),j=y.data;j;){for(var U=0;U<j.children.length;U++){var x=j.children[U],D=j.leaf?z(x,E,T):u(E,T,x);D>B||Z.push({node:x,dist:D})}for(;Z.length&&!Z.peek().node.children;){var O=Z.pop(),W=O.node,X=z(W,S,E),$=z(W,T,k);if(O.dist<X&&O.dist<$&&d(E,W,N)&&d(T,W,N))return W}j=Z.pop(),j&&(j=j.node)}return null}function l(y,S){return y.dist-S.dist}function u(y,S,E){if(c(y,E)||c(S,E))return 0;var T=I(y[0],y[1],S[0],S[1],E.minX,E.minY,E.maxX,E.minY);if(T===0)return 0;var k=I(y[0],y[1],S[0],S[1],E.minX,E.minY,E.minX,E.maxY);if(k===0)return 0;var B=I(y[0],y[1],S[0],S[1],E.maxX,E.minY,E.maxX,E.maxY);if(B===0)return 0;var N=I(y[0],y[1],S[0],S[1],E.minX,E.maxY,E.maxX,E.maxY);return N===0?0:Math.min(T,k,B,N)}function c(y,S){return y[0]>=S.minX&&y[0]<=S.maxX&&y[1]>=S.minY&&y[1]<=S.maxY}function d(y,S,E){for(var T=Math.min(y[0],S[0]),k=Math.min(y[1],S[1]),B=Math.max(y[0],S[0]),N=Math.max(y[1],S[1]),Z=E.search({minX:T,minY:k,maxX:B,maxY:N}),j=0;j<Z.length;j++)if(m(Z[j].p,Z[j].next.p,y,S))return!1;return!0}function p(y,S,E){return r(y[0],y[1],S[0],S[1],E[0],E[1])}function m(y,S,E,T){return y!==T&&S!==E&&p(y,S,E)>0!=p(y,S,T)>0&&p(E,T,y)>0!=p(E,T,S)>0}function v(y){var S=y.p,E=y.next.p;return y.minX=Math.min(S[0],E[0]),y.minY=Math.min(S[1],E[1]),y.maxX=Math.max(S[0],E[0]),y.maxY=Math.max(S[1],E[1]),y}function b(y){for(var S=y[0],E=y[0],T=y[0],k=y[0],B=0;B<y.length;B++){var N=y[B];N[0]<S[0]&&(S=N),N[0]>T[0]&&(T=N),N[1]<E[1]&&(E=N),N[1]>k[1]&&(k=N)}var Z=[S,E,T,k],j=Z.slice();for(B=0;B<y.length;B++)n(y[B],Z)||j.push(y[B]);return w(j)}function P(y,S){var E={p:y,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return S?(E.next=S.next,E.prev=S,S.next.prev=E,S.next=E):(E.prev=E,E.next=E),E}function C(y,S){var E=y[0]-S[0],T=y[1]-S[1];return E*E+T*T}function z(y,S,E){var T=S[0],k=S[1],B=E[0]-T,N=E[1]-k;if(B!==0||N!==0){var Z=((y[0]-T)*B+(y[1]-k)*N)/(B*B+N*N);Z>1?(T=E[0],k=E[1]):Z>0&&(T+=B*Z,k+=N*Z)}return B=y[0]-T,N=y[1]-k,B*B+N*N}function I(y,S,E,T,k,B,N,Z){var j=E-y,U=T-S,x=N-k,D=Z-B,O=y-k,W=S-B,X=j*j+U*U,$=j*x+U*D,R=x*x+D*D,G=j*O+U*W,H=x*O+D*W,it=X*R-$*$,Q,K,q,ot,ut=it,dt=it;it===0?(K=0,ut=1,ot=H,dt=R):(K=$*H-R*G,ot=X*H-$*G,K<0?(K=0,ot=H,dt=R):K>ut&&(K=ut,ot=H+$,dt=R)),ot<0?(ot=0,-G<0?K=0:-G>X?K=ut:(K=-G,ut=X)):ot>dt&&(ot=dt,-G+$<0?K=0:-G+$>X?K=ut:(K=-G+$,ut=X)),Q=K===0?0:K/ut,q=ot===0?0:ot/dt;var xt=(1-Q)*y+Q*E,bt=(1-Q)*S+Q*T,Et=(1-q)*k+q*N,Mt=(1-q)*B+q*Z,Ct=Et-xt,Lt=Mt-bt;return Ct*Ct+Lt*Lt}function g(y,S){return y[0]===S[0]?y[1]-S[1]:y[0]-S[0]}function w(y){y.sort(g);for(var S=[],E=0;E<y.length;E++){for(;S.length>=2&&p(S[S.length-2],S[S.length-1],y[E])<=0;)S.pop();S.push(y[E])}for(var T=[],k=y.length-1;k>=0;k--){for(;T.length>=2&&p(T[T.length-2],T[T.length-1],y[k])<=0;)T.pop();T.push(y[k])}return T.pop(),S.pop(),S.concat(T)}return In.exports}var Em=Sm();const Cm=mh(Em);function km(i,t={}){t.concavity=t.concavity||1/0;const n=[];if(hl(i,s=>{n.push([s[0],s[1]])}),!n.length)return null;const r=Cm(n,t.concavity);return r.length>3?gm([r]):null}var Ya=km;function Tm(i){if(!i)throw new Error("geojson is required");switch(i.type){case"Feature":return ll(i);case"FeatureCollection":return Dm(i);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Co(i);default:throw new Error("unknown GeoJSON type")}}function ll(i){const t={type:"Feature"};return Object.keys(i).forEach(n=>{switch(n){case"type":case"properties":case"geometry":return;default:t[n]=i[n]}}),t.properties=ul(i.properties),i.geometry==null?t.geometry=null:t.geometry=Co(i.geometry),t}function ul(i){const t={};return i&&Object.keys(i).forEach(n=>{const r=i[n];typeof r=="object"?r===null?t[n]=null:Array.isArray(r)?t[n]=r.map(s=>s):t[n]=ul(r):t[n]=r}),t}function Dm(i){const t={type:"FeatureCollection"};return Object.keys(i).forEach(n=>{switch(n){case"type":case"features":return;default:t[n]=i[n]}}),t.features=i.features.map(n=>ll(n)),t}function Co(i){const t={type:i.type};return i.bbox&&(t.bbox=i.bbox),i.type==="GeometryCollection"?(t.geometries=i.geometries.map(n=>Co(n)),t):(t.coordinates=cl(i.coordinates),t)}function cl(i){const t=i;return typeof t[0]!="object"?t.slice():t.map(n=>cl(n))}function fl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,m=0,v,b=i.type,P=b==="FeatureCollection",C=b==="Feature",z=P?i.features.length:1,I=0;I<z;I++){d=P?i.features[I].geometry:C?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var w=0,y=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var S=l.type;switch(p=0,S){case null:break;case"Point":if(t(c,m,I,w,y)===!1)return!1;m++,w++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],m,I,w,y)===!1)return!1;m++,S==="MultiPoint"&&w++}S==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],m,I,w,y)===!1)return!1;m++}S==="MultiLineString"&&w++,S==="Polygon"&&y++}S==="Polygon"&&w++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],m,I,w,y)===!1)return!1;m++}y++}w++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(fl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function tr(i,t={}){if(i.bbox!=null&&t.recompute!==!0)return i.bbox;const n=[1/0,1/0,-1/0,-1/0];return fl(i,r=>{n[0]>r[0]&&(n[0]=r[0]),n[1]>r[1]&&(n[1]=r[1]),n[2]<r[0]&&(n[2]=r[0]),n[3]<r[1]&&(n[3]=r[1])}),n}function Am(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Im(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Xa(i[0])||!Xa(i[1]))throw new Error("coordinates must contain numbers");return Am({type:"Point",coordinates:i},t,n)}function Xa(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Om(i,t={}){const n=tr(i),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return Im([r,s],t.properties,t)}function zm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Bm(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ua(i[0])||!Ua(i[1]))throw new Error("coordinates must contain numbers");return zm({type:"Point",coordinates:i},t,n)}function Ua(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function dl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,m=0,v,b=i.type,P=b==="FeatureCollection",C=b==="Feature",z=P?i.features.length:1,I=0;I<z;I++){d=P?i.features[I].geometry:C?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var w=0,y=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var S=l.type;switch(p=S==="Polygon"||S==="MultiPolygon"?1:0,S){case null:break;case"Point":if(t(c,m,I,w,y)===!1)return!1;m++,w++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],m,I,w,y)===!1)return!1;m++,S==="MultiPoint"&&w++}S==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],m,I,w,y)===!1)return!1;m++}S==="MultiLineString"&&w++,S==="Polygon"&&y++}S==="Polygon"&&w++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],m,I,w,y)===!1)return!1;m++}y++}w++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(dl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Nm(i,t={}){let n=0,r=0,s=0;return dl(i,function(a){n+=a[0],r+=a[1],s++}),Bm([n/s,r/s],t.properties)}function Fm(i){return i%(2*Math.PI)*180/Math.PI}function Hr(i){return i%360*Math.PI/180}function On(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Rm(i,t,n={}){let r;return n.final?r=ja(On(t),On(i)):r=ja(On(i),On(t)),r>180?-(360-r):r}function ja(i,t){const n=Hr(i[1]),r=Hr(t[1]);let s=Hr(t[0]-i[0]);s>Math.PI&&(s-=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI);const a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),l=Math.atan2(s,a);return(Fm(l)+360)%360}var Bt=63710088e-1,pl={centimeters:Bt*100,centimetres:Bt*100,degrees:360/(2*Math.PI),feet:Bt*3.28084,inches:Bt*39.37,kilometers:Bt/1e3,kilometres:Bt/1e3,meters:Bt,metres:Bt,miles:Bt/1609.344,millimeters:Bt*1e3,millimetres:Bt*1e3,nauticalmiles:Bt/1852,radians:1,yards:Bt*1.0936};function Zm(i,t="kilometers"){const n=pl[t];if(!n)throw new Error(t+" units is invalid");return i*n}function Ym(i,t="kilometers"){const n=pl[t];if(!n)throw new Error(t+" units is invalid");return i/n}function Xm(i,t="kilometers",n="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return Zm(Ym(i,t),n)}function Wa(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Um(i,t,n={}){const r=Wa(i),s=Wa(t);s[0]+=s[0]-r[0]>180?-360:r[0]-s[0]>180?360:0;const a=jm(r,s);return Xm(a,"meters",n.units)}function jm(i,t,n){n=n===void 0?Bt:Number(n);const r=n,s=i[1]*Math.PI/180,a=t[1]*Math.PI/180,l=a-s;let u=Math.abs(t[0]-i[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);const c=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=Math.abs(c)>1e-11?l/c:Math.cos(s);return Math.sqrt(l*l+d*d*u*u)*r}var Nt=63710088e-1,ml={centimeters:Nt*100,centimetres:Nt*100,degrees:360/(2*Math.PI),feet:Nt*3.28084,inches:Nt*39.37,kilometers:Nt/1e3,kilometres:Nt/1e3,meters:Nt,metres:Nt,miles:Nt/1609.344,millimeters:Nt*1e3,millimetres:Nt*1e3,nauticalmiles:Nt/1852,radians:1,yards:Nt*1.0936};function Wm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Vm(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ha(i[0])||!Ha(i[1]))throw new Error("coordinates must contain numbers");return Wm({type:"Point",coordinates:i},t,n)}function Hm(i,t="kilometers"){const n=ml[t];if(!n)throw new Error(t+" units is invalid");return i*n}function Gm(i,t="kilometers"){const n=ml[t];if(!n)throw new Error(t+" units is invalid");return i/n}function Va(i){return i%360*Math.PI/180}function $m(i,t="kilometers",n="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return Hm(Gm(i,t),n)}function Ha(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function qm(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Jm(i,t,n,r={}){const s=t<0;let a=$m(Math.abs(t),r.units,"meters");s&&(a=-Math.abs(a));const l=qm(i),u=Km(l,a,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,Vm(u,r.properties)}function Km(i,t,n,r){r=r===void 0?Nt:Number(r);const s=t/r,a=i[0]*Math.PI/180,l=Va(i[1]),u=Va(n),c=s*Math.cos(u);let d=l+c;Math.abs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d);const p=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),m=Math.abs(p)>1e-11?c/p:Math.cos(l),v=s*Math.sin(u)/m;return[((a+v)*180/Math.PI+540)%360-180,d*180/Math.PI]}function Qm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function zn(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ga(i[0])||!Ga(i[1]))throw new Error("coordinates must contain numbers");return Qm({type:"Point",coordinates:i},t,n)}function Ga(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function t_(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)}function _l(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,m=0,v,b=i.type,P=b==="FeatureCollection",C=b==="Feature",z=P?i.features.length:1,I=0;I<z;I++){d=P?i.features[I].geometry:C?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var w=0,y=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var S=l.type;switch(p=0,S){case null:break;case"Point":if(t(c,m,I,w,y)===!1)return!1;m++,w++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],m,I,w,y)===!1)return!1;m++,S==="MultiPoint"&&w++}S==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],m,I,w,y)===!1)return!1;m++}S==="MultiLineString"&&w++,S==="Polygon"&&y++}S==="Polygon"&&w++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],m,I,w,y)===!1)return!1;m++}y++}w++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(_l(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function e_(i,t){if(i.type==="Feature")t(i,0);else if(i.type==="FeatureCollection")for(var n=0;n<i.features.length&&t(i.features[n],n)!==!1;n++);}function i_(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function n_(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function r_(i,t){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}function o_(i,t,n){if(n=n||{},!t_(n))throw new Error("options is invalid");const r=n.origin||"centroid",s=n.mutate||!1;if(!i)throw new Error("geojson required");if(typeof t!="number"||t<=0)throw new Error("invalid factor");const a=Array.isArray(r)||typeof r=="object";return s!==!0&&(i=Tm(i)),i.type==="FeatureCollection"&&!a?(e_(i,function(l,u){i.features[u]=$a(l,t,r)}),i):$a(i,t,r)}function $a(i,t,n){const r=r_(i)==="Point",s=s_(i,n);return t===1||r||(_l(i,function(a){const l=Um(s,a),u=Rm(s,a),c=l*t,d=n_(Jm(s,c,u));a[0]=d[0],a[1]=d[1],a.length===3&&(a[2]*=t)}),delete i.bbox),i}function s_(i,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return i_(t);const n=i.bbox?i.bbox:tr(i,{recompute:!0}),r=n[0],s=n[1],a=n[2],l=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return zn([r,s]);case"se":case"southeast":case"eastsouth":case"bottomright":return zn([a,s]);case"nw":case"northwest":case"westnorth":case"topleft":return zn([r,l]);case"ne":case"northeast":case"eastnorth":case"topright":return zn([a,l]);case"center":return Om(i);case void 0:case null:case"centroid":return Nm(i);default:throw new Error("invalid origin")}}function a_(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function h_(i,t,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return a_({type:"Polygon",coordinates:i},t,n)}function l_(i,t={}){const n=Number(i[0]),r=Number(i[1]),s=Number(i[2]),a=Number(i[3]);if(i.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const l=[n,r];return h_([[l,[s,r],[s,a],[n,a],l]],t.properties,{bbox:i,id:t.id})}function gl(i,t,n){n[i]=!0;for(const r of t[i])n[r]||gl(r,t,n)}function u_(i,t){const n=JSON.stringify(i),r=JSON.stringify(t);return n<r?`${n}|${r}`:`${r}|${n}`}function c_(i,t){const[n,r]=(function(s,a){const[l,u]=s,[c,d]=a;return l<c||l===c&&u<=d?[s,a]:[a,s]})(i,t);return JSON.stringify([n,r])}function vl(i){const t=new Map;for(const n of i.features){const r=n.geometry.coordinates;for(let s=0;s<r.length-1;s++){const a=r[s],l=r[s+1],u=c_(a,l);t.has(u)||t.set(u,{type:"Feature",geometry:{type:"LineString",coordinates:[a,l]},properties:{}})}}return{type:"FeatureCollection",features:Array.from(t.values())}}function f_(i,t){const n=i.length,r=t.length;if(n>r)return!1;for(let a=0;a<=r-n;a++){let l=!0;for(let u=0;u<n;u++)if(t[a+u][0]!==i[u][0]||t[a+u][1]!==i[u][1]){l=!1;break}if(l)return!0}const s=[...i].reverse();for(let a=0;a<=r-n;a++){let l=!0;for(let u=0;u<n;u++)if(t[a+u][0]!==s[u][0]||t[a+u][1]!==s[u][1]){l=!1;break}if(l)return!0}return!1}function Gr(i){const t=vl(i),n=new Map;function r(l){return l.join(",")}for(let l=0;l<t.features.length;l++){const u=t.features[l].geometry.coordinates;if(u.length<2)continue;const c=r(u[0]),d=r(u[u.length-1]);n.set(c,(n.get(c)||0)+1),n.set(d,(n.get(d)||0)+1)}const s=new Map,a=new Map;for(let l=0;l<t.features.length;l++){const u=t.features[l],c=u.geometry.coordinates;if(c.length<2)continue;const d=r(c[0]),p=r(c[c.length-1]),m=n.get(d)||0,v=n.get(p)||0,b=c.map(r).join(";");m===1||v===1?s.has(b)||s.set(b,u):a.has(b)||a.set(b,u)}return{leafEdges:{type:"FeatureCollection",features:Array.from(s.values())},nonLeafEdges:{type:"FeatureCollection",features:Array.from(a.values())}}}function d_(i,t,n,r,s){const a=i.geometry.coordinates;for(const l of a)if(!p_(l,t,n,r,s))return!1;return!0}function p_(i,t,n,r,s){const[a,l]=i;return a>=t&&a<=r&&l>=n&&l<=s}function Wi(){return Wi=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Wi.apply(null,arguments)}const yl=(i,t)=>{const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3},m_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class __{constructor(t,n=64,r=Float64Array,s){if(this.data=void 0,this.ids=void 0,this.coords=void 0,this._pos=void 0,this._finished=void 0,this.numItems=void 0,this.nodeSize=void 0,this.ArrayType=void 0,this.IndexArrayType=void 0,isNaN(t)||t<0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=t,this.nodeSize=Math.min(Math.max(n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=m_.indexOf(this.ArrayType),l=2*t*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+c,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+l+u+c),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+c,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return co(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function co(i,t,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;wl(i,t,l,r,s,a),co(i,t,n,r,l-1,1-a),co(i,t,n,l+1,s,1-a)}function wl(i,t,n,r,s,a){for(;s>r;){if(s-r>600){const d=s-r+1,p=n-r+1,m=Math.log(d),v=.5*Math.exp(2*m/3),b=.5*Math.sqrt(m*v*(d-v)/d)*(p-d/2<0?-1:1);wl(i,t,n,Math.max(r,Math.floor(n-p*v/d+b)),Math.min(s,Math.floor(n+(d-p)*v/d+b)),a)}const l=t[2*n+a];let u=r,c=s;for(Ai(i,t,r,n),t[2*s+a]>l&&Ai(i,t,r,s);u<c;){for(Ai(i,t,u,c),u++,c--;t[2*u+a]<l;)u++;for(;t[2*c+a]>l;)c--}t[2*r+a]===l?Ai(i,t,r,c):(c++,Ai(i,t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function Ai(i,t,n,r){$r(i,n,r),$r(t,2*n,2*r),$r(t,2*n+1,2*r+1)}function $r(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}class g_{constructor(t=[],n=(r,s)=>r<s?-1:r>s?1:0){if(this.data=void 0,this.length=void 0,this.compare=void 0,this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=1+(t<<1);const u=l+1;if(u<this.length&&r(n[u],n[l])<0&&(l=u),r(n[l],a)>=0)break;n[t]=n[l],t=l}n[t]=a}}const ae=Math.PI/180;function qa(i,t,n,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(i>=s&&i<=a)return t<l?ze((t-l)*ae):t>u?ze((t-u)*ae):0;const c=Math.min(ze((i-s)*ae),ze((i-a)*ae)),d=(function(p,m){const v=1-2*m;return v<=0?p>0?90:-90:Math.atan(Math.tan(p*ae)/v)/ae})(t,c);return d>l&&d<u?Xn(c,n,t,d):Math.min(Xn(c,n,t,l),Xn(c,n,t,u))}function v_(i,t){return i.dist-t.dist}function ze(i){const t=Math.sin(i/2);return t*t}function Xn(i,t,n,r){return t*Math.cos(r*ae)*i+ze((n-r)*ae)}function Ja(i,t,n,r,s){return Xn(ze((i-n)*ae),s,t,r)}function Le(i){const t=i.geometry.coordinates;let n=0;for(let r=0;r<t.length-1;r++)n+=yl(t[r],t[r+1]);return n}class y_{constructor(t){this.network=void 0,this.network=t}getRouteLength(t){return Le(t)}setNetwork(t){this.network=t}getNetwork(){return this.network}getNetworkInBoundingBox(t){return(function(n,r){const[s,a,l,u]=r;if(s>=l||a>=u)throw new Error("Invalid bounding box: min values must be less than max values");const c=[];for(const d of n.features)d_(d,s,a,l,u)&&c.push(d);return{type:"FeatureCollection",features:c}})(this.network,t)}getNetworkWithoutDuplicatesOrSubsections(){return(function(t){const n=t.features,r=new Set;for(let s=0;s<n.length;s++){const a=n[s].geometry.coordinates;for(let l=0;l<n.length;l++){if(s===l)continue;const u=n[l].geometry.coordinates;if(f_(a,u)&&(a.length<u.length||a.length===u.length&&s>l)){r.add(s);break}}}return{type:"FeatureCollection",features:n.filter((s,a)=>!r.has(a))}})(this.network)}getConnectedComponents(){return(function(t){const n=t.features,r=new Map,s=new Map;function a(d){return`${d[0]},${d[1]}`}for(let d=0;d<n.length;d++){const p=n[d].geometry.coordinates;for(const m of p){const v=a(m);s.has(v)||s.set(v,new Set),s.get(v).add(d)}}for(let d=0;d<n.length;d++){r.set(d,new Set);const p=n[d].geometry.coordinates;for(const m of p){const v=a(m),b=s.get(v);if(b)for(const P of b)P!==d&&r.get(d).add(P)}}const l=new Set,u=[];function c(d,p){const m=[d];for(;m.length>0;){const v=m.pop();if(l.has(v))continue;l.add(v),p.push(n[v]);const b=r.get(v);if(b)for(const P of b)l.has(P)||m.push(P)}}for(let d=0;d<n.length;d++)if(!l.has(d)){const p=[];c(d,p),u.push({type:"FeatureCollection",features:p})}return u.sort((d,p)=>d.features.length-p.features.length),u})(this.network)}getConnectedComponentCount(){return(function(t){const n=t.features,r=n.length,s=new Map;for(let d=0;d<r;d++){const p=n[d].geometry.coordinates;for(const m of p){const v=`${(a=m)[0]},${a[1]}`;s.has(v)||s.set(v,[]),s.get(v).push(d)}}var a;const l=Array.from({length:r},()=>[]);for(const d of s.values())for(let p=0;p<d.length;p++)for(let m=p+1;m<d.length;m++){const v=d[p],b=d[m];l[v].push(b),l[b].push(v)}const u=new Array(r).fill(!1);let c=0;for(let d=0;d<r;d++)u[d]||(gl(d,l,u),c++);return c})(this.network)}getNodeAndEdgeCount(){return(function(t){const n=new Set,r=new Set;for(const s of t.features){const a=s.geometry.coordinates;for(const l of a)n.add(JSON.stringify(l));for(let l=0;l<a.length-1;l++){const u=u_(a[l],a[l+1]);r.add(u)}}return{nodeCount:n.size,edgeCount:r.size}})(this.network)}getNodes(){return{type:"FeatureCollection",features:(function(t){const n=new Set,r=[];for(const s of t.features)for(const a of s.geometry.coordinates){const l=a.join(",");n.has(l)||(n.add(l),r.push({type:"Feature",geometry:{type:"Point",coordinates:a},properties:{}}))}return r})(this.network)}}getNodeCount(){const{nodeCount:t}=this.getNodeAndEdgeCount();return t}getEdges(){return vl(this.network)}getLongestEdgeLength(){const t=this.getLongestEdge();return t?Le(t):-1}getAverageEdgeLength(){const t=this.getEdges().features;return t.length===0?-1:t.reduce((n,r)=>n+Le(r),0)/t.length}getNodeDegrees(){const t={},n=this.getEdges().features;for(const r of n){const[s,a]=r.geometry.coordinates,l=`${s[0]},${s[1]}`,u=`${a[0]},${a[1]}`;t[l]=(t[l]||0)+1,t[u]=(t[u]||0)+1}return t}getNodeDegreeStats(){const t=Object.values(this.getNodeDegrees());return t.length===0?{min:0,max:0,avg:0}:{min:Math.min(...t),max:Math.max(...t),avg:t.reduce((n,r)=>n+r,0)/t.length}}getShortestEdgeLength(){const t=this.getShortestEdge();return t?Le(t):-1}getLongestEdge(){const t=this.getEdges().features;if(t.length===0)return null;const n=t.sort((r,s)=>Le(r)-Le(s));return n[n.length-1]}getShortestEdge(){const t=this.getEdges().features;return t.length===0?null:t.sort((n,r)=>Le(n)-Le(r))[0]}getEdgeCount(){const{edgeCount:t}=this.getNodeAndEdgeCount();return t}getLeafEdges(){return Gr(this.network).leafEdges}getPrunedEdges(t){if(t&&t>0){let n=this.network;for(let r=0;r<t;r++)n=Gr(n).nonLeafEdges;return n}return Gr(this.network).nonLeafEdges}getUnifiedNetwork(t){return(function(n,r){if(n.features.length<2)return n;const s=new Set,a=new Map,l=[],u=new Map;for(const m of n.features)for(const v of m.geometry.coordinates){const b=`${v[0]},${v[1]}`;u.has(b)||(u.set(b,l.length),l.push(v))}let c=new __(l.length);for(const m of l)c.add(m[0],m[1]);function d(m,v,b){let P=null,C=1/0;const z=(function(I,g,w,y=1/0,S=1/0){let E=1;const T=[];y===void 0&&(y=1/0),S!==void 0&&(E=ze(S/6371));const k=new g_([],v_);let B={left:0,right:I.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const N=Math.cos(w*ae);for(;B;){const Z=B.right,j=B.left;if(Z-j<=I.nodeSize)for(let U=j;U<=Z;U++){const x=I.ids[U],D=Ja(g,w,I.coords[2*U],I.coords[2*U+1],N);k.push({id:x,dist:D})}else{const U=j+Z>>1,x=I.coords[2*U],D=I.coords[2*U+1],O=I.ids[U],W=Ja(g,w,x,D,N);k.push({id:O,dist:W});const X=(B.axis+1)%2,$={left:j,right:U-1,axis:X,minLng:B.minLng,minLat:B.minLat,maxLng:B.axis===0?x:B.maxLng,maxLat:B.axis===1?D:B.maxLat,dist:0},R={left:U+1,right:Z,axis:X,minLng:B.axis===0?x:B.minLng,minLat:B.axis===1?D:B.minLat,maxLng:B.maxLng,maxLat:B.maxLat,dist:0};$.dist=qa(g,w,N,$),R.dist=qa(g,w,N,R),k.push($),k.push(R)}for(;k.length&&k.peek().id!=null;){const U=k.pop();if(U.dist>E||(T.push(U.id),T.length===y))return T}B=k.pop()}return T})(c,m[0],m[1],1/0,r/1e3);for(const I of z){const g=l[I],w=`${g[0]},${g[1]}`;if(!s.has(w)||v.includes(g)||b.has(w))continue;const y=1e3*yl(g,m);y<=r&&y<C&&(P=g,C=y)}return P!==null?P:(s.add(`${m[0]},${m[1]}`),m)}c.finish();const p=n.features.map(m=>{const v=[],b=[],P=new Set;for(const C of m.geometry.coordinates){const z=`${C[0]},${C[1]}`;if(!a.has(z)){const w=d(C,v,P);P.has(`${w[0]},${w[1]}`)?a.set(z,C):a.set(z,w)}const I=a.get(z),g=`${I[0]},${I[1]}`;P.has(g)||(b.push(I),P.add(g)),v.push(C)}return Wi({},m,{geometry:Wi({},m.geometry,{coordinates:b})})});return Wi({},n,{features:p})})(this.network,t)}}const qr=51.539931,Jr=-.078,Ka={L:il,id:"leaflet-map",lng:Jr,lat:qr,zoom:13,minZoom:10,maxZoom:20,tapTolerance:10,maxBounds:[[qr-.05,Jr-.05],[qr+.05,Jr+.05]]},w_=()=>{const i=Dc(null),[t,n]=_e(),[r,s]=_e("static"),[a,l]=_e(),[u,c]=_e(),[d,p]=_e(!0);Ws(()=>{const N=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/public/network.json":"./network.json";fetch(N).then(Z=>{Z.json().then(j=>{l(j)})})},[]),Ws(()=>{t||n(Ep(Ka))},[t]);const[m,v]=_e(Kt.TerraRoute),[b,P]=_e(!1),[C,z]=_e(20),[I,g]=_e(5),w=Gi(()=>{if(a)return{[Kt.TerraRoute]:Oa(a,Kt.TerraRoute),[Kt.GeoJSONPathFinder]:Oa(a,Kt.GeoJSONPathFinder)}},[a]),{draw:y,routing:S}=Gi(()=>{if(t&&a&&w){const B=new kf({network:a,useCache:!0,routeFinder:w[Kt.TerraRoute]}),N=zf(t,il,B,{fallbackToStraightLineEnabled:b,snapToleranceEnterPx:C,nearPx:I});N.start();const Z=Ya(a);return Z&&Z.properties&&(Z.properties.mode="networkOutline"),N.addFeatures([Z]),{draw:N,routing:B}}return{draw:void 0,routing:void 0}},[t,a,w,b,C,I]),E=Ir(B=>{y&&(s(B),y.setMode(B))},[y]),T=Ir(()=>{if(!y)return;const B=y.getSnapshot().filter(({properties:N})=>N.mode!=="networkOutline").map(({id:N})=>N);y.removeFeatures(B)},[y]),k=Ir(()=>{let B;if(!u&&a)B=a;else if(u)B=u;else return;const N=tr(B),Z=l_(N),j=o_(Z,.9),U=new y_(B),x=tr(j),D=U.getNetworkInBoundingBox(x);S?.setNetwork(D),c(D);const O=y?.getSnapshot().find(({properties:X})=>X.mode==="networkOutline");y?.removeFeatures([O.id]);const W=Ya(D);W&&W.properties&&(W.properties.mode="networkOutline"),y?.addFeatures([W])},[y,a,u,S]);return et("div",{class:me.home,children:et("div",{ref:i,class:me.map,id:Ka.id,children:[d?et("div",{class:me.helpOverlay,role:"note","aria-label":"Demo instructions",children:[et("div",{class:me.helpHeader,children:[et("div",{class:me.helpTitle,children:"Terra Draw Route Snap Mode demo"}),et("button",{type:"button",class:me.helpClose,onClick:()=>p(!1),"aria-label":"Close instructions",children:""})]}),et("div",{class:me.helpBody,children:[et("p",{children:["This demo shows how ",et("strong",{children:"Terra Draw Route Snap Mode"})," snaps the line you draw onto a routing network."]}),et("ol",{children:[et("li",{children:["Select ",et("strong",{children:"Route Snap"})," from the mode buttons."]}),et("li",{children:["Click on the map to add up to ",et("strong",{children:"5"})," points."]}),et("li",{children:"Double-click (or finish) to commit the route."}),et("li",{children:["Use ",et("strong",{children:"Clear"})," to remove drawn routes and ",et("strong",{children:"Prune"})," to shrink the network."]})]}),et("div",{class:me.helpHint,children:"Tip: you can reopen this panel by refreshing the page."})]})]}):null,y?et(mm,{mode:r,changeMode:E,onClear:T,onPrune:k,routingOption:m,routingDisabled:!S||!w,onRoutingChange:B=>{!S||!w||(v(B),S.setRouteFinder(w[B]))},fallbackToStraightLineEnabled:b,snapToleranceEnterPx:C,nearPx:I,onFallbackToStraightLineEnabledChange:P,onSnapToleranceEnterPxChange:z,onNearPxChange:g}):null,y?null:et("div",{class:me.loading,children:"Loading..."})]})})};console.log("App.tsx");const x_=()=>et("div",{id:"app",children:[et(wc,{}),et(w_,{})]});let Ie,Ri;const b_=(i,t)=>{if(Ie=void 0,t&&t.type==="click"){if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button!==0)return i;const n=t.target.closest("a[href]"),r=n&&n.getAttribute("href");if(!n||n.origin!=location.origin||/^#/.test(r)||!/^(_?self)?$/i.test(n.target)||Ri&&(typeof Ri=="string"?!r.startsWith(Ri):!Ri.test(r)))return i;Ie=!0,t.preventDefault(),t=n.href.replace(location.origin,"")}else typeof t=="string"?Ie=!0:t&&t.url?(Ie=!t.replace,t=t.url):t=location.pathname+location.search;return Ie===!0?history.pushState(null,"",t):Ie===!1&&history.replaceState(null,"",t),t};function xl(i){const[t,n]=Mh(b_,i.url||location.pathname+location.search);i.scope&&(Ri=i.scope);const r=Ie===!0,s=Gi(()=>{const a=new URL(t,location.origin),l=a.pathname.replace(/\/+$/g,"")||"/";return{url:t,path:l,query:Object.fromEntries(a.searchParams),route:(u,c)=>n({url:u,replace:c}),wasPush:r}},[t]);return Tc(()=>(addEventListener("click",n),addEventListener("popstate",n),()=>{removeEventListener("click",n),removeEventListener("popstate",n)}),[]),oi(xl.ctx.Provider,{value:s},i.children)}Promise.resolve();xl.ctx=_o({});_o({});const Qa=rt.__b;rt.__b=i=>{i.type&&i.type._forwarded&&i.ref&&(i.props.ref=i.ref,i.ref=null),Qa&&Qa(i)};const th=rt.__e;rt.__e=(i,t,n)=>{if(i&&i.then){let r=t;for(;r=r.__;)if(r.__c&&r.__c.__c)return t.__e==null&&(t.__c.__z=[n.__e],t.__e=n.__e,t.__k=n.__k),t.__k||(t.__k=[]),r.__c.__c(i,t)}th&&th(i,t,n)};let eh;function M_(i,t){if(typeof window>"u")return;let n=document.querySelector("script[type=isodata]");t=t||n&&n.parentNode||document.body,!eh&&n?mo(i,t):po(i,t),eh=!0}typeof window<"u"&&M_(et(x_,{}),document.getElementById("app"));
