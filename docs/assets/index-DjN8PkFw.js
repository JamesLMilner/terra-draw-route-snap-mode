function Vl(i,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in i)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var Oi,it,fa,pa,Li,cs,_a,bn={},ma=[],Hl=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ce(i,e){for(var n in e)i[n]=e[n];return i}function ga(i){var e=i.parentNode;e&&e.removeChild(i)}function Je(i,e,n){var r,s,a,l={};for(a in e)a=="key"?r=e[a]:a=="ref"?s=e[a]:l[a]=e[a];if(arguments.length>2&&(l.children=arguments.length>3?Oi.call(arguments,2):n),typeof i=="function"&&i.defaultProps!=null)for(a in i.defaultProps)l[a]===void 0&&(l[a]=i.defaultProps[a]);return Ci(i,l,r,s,null)}function Ci(i,e,n,r,s){var a={type:i,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++fa};return s==null&&it.vnode!=null&&it.vnode(a),a}function Gl(){return{current:null}}function Ai(i){return i.children}function qe(i,e){this.props=i,this.context=e}function Ei(i,e){if(e==null)return i.__?Ei(i.__,i.__.__k.indexOf(i)+1):null;for(var n;e<i.__k.length;e++)if((n=i.__k[e])!=null&&n.__e!=null)return n.__e;return typeof i.type=="function"?Ei(i):null}function va(i){var e,n;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((n=i.__k[e])!=null&&n.__e!=null){i.__e=i.__c.base=n.__e;break}return va(i)}}function Cr(i){(!i.__d&&(i.__d=!0)&&Li.push(i)&&!Pn.__r++||cs!==it.debounceRendering)&&((cs=it.debounceRendering)||setTimeout)(Pn)}function Pn(){for(var i;Pn.__r=Li.length;)i=Li.sort(function(e,n){return e.__v.__b-n.__v.__b}),Li=[],i.some(function(e){var n,r,s,a,l,u;e.__d&&(l=(a=(n=e).__v).__e,(u=n.__P)&&(r=[],(s=ce({},a)).__v=a.__v+1,Nr(u,a,s,n.__n,u.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Ei(a),a.__h),ba(r,a),a.__e!=l&&va(a)))})}function ya(i,e,n,r,s,a,l,u,d,_){var f,g,w,b,M,C,I,A=r&&r.__k||ma,m=A.length;for(n.__k=[],f=0;f<e.length;f++)if((b=n.__k[f]=(b=e[f])==null||typeof b=="boolean"?null:typeof b=="string"||typeof b=="number"||typeof b=="bigint"?Ci(null,b,null,null,b):Array.isArray(b)?Ci(Ai,{children:b},null,null,null):b.__b>0?Ci(b.type,b.props,b.key,b.ref?b.ref:null,b.__v):b)!=null){if(b.__=n,b.__b=n.__b+1,(w=A[f])===null||w&&b.key==w.key&&b.type===w.type)A[f]=void 0;else for(g=0;g<m;g++){if((w=A[g])&&b.key==w.key&&b.type===w.type){A[g]=void 0;break}w=null}Nr(i,b,w=w||bn,s,a,l,u,d,_),M=b.__e,(g=b.ref)&&w.ref!=g&&(I||(I=[]),w.ref&&I.push(w.ref,null,b),I.push(g,b.__c||M,b)),M!=null?(C==null&&(C=M),typeof b.type=="function"&&b.__k===w.__k?b.__d=d=xa(b,d,i):d=wa(i,b,w,A,M,d),typeof n.type=="function"&&(n.__d=d)):d&&w.__e==d&&d.parentNode!=i&&(d=Ei(w))}for(n.__e=C,f=m;f--;)A[f]!=null&&Ma(A[f],A[f]);if(I)for(f=0;f<I.length;f++)Pa(I[f],I[++f],I[++f])}function xa(i,e,n){for(var r,s=i.__k,a=0;s&&a<s.length;a++)(r=s[a])&&(r.__=i,e=typeof r.type=="function"?xa(r,e,n):wa(n,r,r,s,r.__e,e));return e}function Mn(i,e){return e=e||[],i==null||typeof i=="boolean"||(Array.isArray(i)?i.some(function(n){Mn(n,e)}):e.push(i)),e}function wa(i,e,n,r,s,a){var l,u,d;if(e.__d!==void 0)l=e.__d,e.__d=void 0;else if(n==null||s!=a||s.parentNode==null)t:if(a==null||a.parentNode!==i)i.appendChild(s),l=null;else{for(u=a,d=0;(u=u.nextSibling)&&d<r.length;d+=1)if(u==s)break t;i.insertBefore(s,a),l=a}return l!==void 0?l:s.nextSibling}function ql(i,e,n,r,s){var a;for(a in n)a==="children"||a==="key"||a in e||Ln(i,a,null,n[a],r);for(a in e)s&&typeof e[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===e[a]||Ln(i,a,e[a],n[a],r)}function ds(i,e,n){e[0]==="-"?i.setProperty(e,n):i[e]=n==null?"":typeof n!="number"||Hl.test(e)?n:n+"px"}function Ln(i,e,n,r,s){var a;t:if(e==="style")if(typeof n=="string")i.style.cssText=n;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(e in r)n&&e in n||ds(i.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||ds(i.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")a=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in i?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+a]=n,n?r||i.addEventListener(e,a?ps:fs,a):i.removeEventListener(e,a?ps:fs,a);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in i)try{i[e]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&e.indexOf("-")==-1?i.removeAttribute(e):i.setAttribute(e,n))}}function fs(i){this.l[i.type+!1](it.event?it.event(i):i)}function ps(i){this.l[i.type+!0](it.event?it.event(i):i)}function Nr(i,e,n,r,s,a,l,u,d){var _,f,g,w,b,M,C,I,A,m,x,P,k,E,T,B=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(d=n.__h,u=e.__e=n.__e,e.__h=null,a=[u]),(_=it.__b)&&_(e);try{t:if(typeof B=="function"){if(I=e.props,A=(_=B.contextType)&&r[_.__c],m=_?A?A.props.value:_.__:r,n.__c?C=(f=e.__c=n.__c).__=f.__E:("prototype"in B&&B.prototype.render?e.__c=f=new B(I,m):(e.__c=f=new qe(I,m),f.constructor=B,f.render=Kl),A&&A.sub(f),f.props=I,f.state||(f.state={}),f.context=m,f.__n=r,g=f.__d=!0,f.__h=[],f._sb=[]),f.__s==null&&(f.__s=f.state),B.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=ce({},f.__s)),ce(f.__s,B.getDerivedStateFromProps(I,f.__s))),w=f.props,b=f.state,g)B.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(B.getDerivedStateFromProps==null&&I!==w&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(I,m),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(I,f.__s,m)===!1||e.__v===n.__v){for(f.props=I,f.state=f.__s,e.__v!==n.__v&&(f.__d=!1),f.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(R){R&&(R.__=e)}),x=0;x<f._sb.length;x++)f.__h.push(f._sb[x]);f._sb=[],f.__h.length&&l.push(f);break t}f.componentWillUpdate!=null&&f.componentWillUpdate(I,f.__s,m),f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(w,b,M)})}if(f.context=m,f.props=I,f.__v=e,f.__P=i,P=it.__r,k=0,"prototype"in B&&B.prototype.render){for(f.state=f.__s,f.__d=!1,P&&P(e),_=f.render(f.props,f.state,f.context),E=0;E<f._sb.length;E++)f.__h.push(f._sb[E]);f._sb=[]}else do f.__d=!1,P&&P(e),_=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++k<25);f.state=f.__s,f.getChildContext!=null&&(r=ce(ce({},r),f.getChildContext())),g||f.getSnapshotBeforeUpdate==null||(M=f.getSnapshotBeforeUpdate(w,b)),T=_!=null&&_.type===Ai&&_.key==null?_.props.children:_,ya(i,Array.isArray(T)?T:[T],e,n,r,s,a,l,u,d),f.base=e.__e,e.__h=null,f.__h.length&&l.push(f),C&&(f.__E=f.__=null),f.__e=!1}else a==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=$l(n.__e,e,n,r,s,a,l,d);(_=it.diffed)&&_(e)}catch(R){e.__v=null,(d||a!=null)&&(e.__e=u,e.__h=!!d,a[a.indexOf(u)]=null),it.__e(R,e,n)}}function ba(i,e){it.__c&&it.__c(e,i),i.some(function(n){try{i=n.__h,n.__h=[],i.some(function(r){r.call(n)})}catch(r){it.__e(r,n.__v)}})}function $l(i,e,n,r,s,a,l,u){var d,_,f,g=n.props,w=e.props,b=e.type,M=0;if(b==="svg"&&(s=!0),a!=null){for(;M<a.length;M++)if((d=a[M])&&"setAttribute"in d==!!b&&(b?d.localName===b:d.nodeType===3)){i=d,a[M]=null;break}}if(i==null){if(b===null)return document.createTextNode(w);i=s?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,w.is&&w),a=null,u=!1}if(b===null)g===w||u&&i.data===w||(i.data=w);else{if(a=a&&Oi.call(i.childNodes),_=(g=n.props||bn).dangerouslySetInnerHTML,f=w.dangerouslySetInnerHTML,!u){if(a!=null)for(g={},M=0;M<i.attributes.length;M++)g[i.attributes[M].name]=i.attributes[M].value;(f||_)&&(f&&(_&&f.__html==_.__html||f.__html===i.innerHTML)||(i.innerHTML=f&&f.__html||""))}if(ql(i,w,g,s,u),f)e.__k=[];else if(M=e.props.children,ya(i,Array.isArray(M)?M:[M],e,n,r,s&&b!=="foreignObject",a,l,a?a[0]:n.__k&&Ei(n,0),u),a!=null)for(M=a.length;M--;)a[M]!=null&&ga(a[M]);u||("value"in w&&(M=w.value)!==void 0&&(M!==i.value||b==="progress"&&!M||b==="option"&&M!==g.value)&&Ln(i,"value",M,g.value,!1),"checked"in w&&(M=w.checked)!==void 0&&M!==i.checked&&Ln(i,"checked",M,g.checked,!1))}return i}function Pa(i,e,n){try{typeof i=="function"?i(e):i.current=e}catch(r){it.__e(r,n)}}function Ma(i,e,n){var r,s;if(it.unmount&&it.unmount(i),(r=i.ref)&&(r.current&&r.current!==i.__e||Pa(r,null,e)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){it.__e(a,e)}r.base=r.__P=null,i.__c=void 0}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&Ma(r[s],e,n||typeof i.type!="function");n||i.__e==null||ga(i.__e),i.__=i.__e=i.__d=void 0}function Kl(i,e,n){return this.constructor(i,n)}function jr(i,e,n){var r,s,a;it.__&&it.__(i,e),s=(r=typeof n=="function")?null:n&&n.__k||e.__k,a=[],Nr(e,i=(!r&&n||e).__k=Je(Ai,null,[i]),s||bn,bn,e.ownerSVGElement!==void 0,!r&&n?[n]:s?null:e.firstChild?Oi.call(e.childNodes):null,a,!r&&n?n:s?s.__e:e.firstChild,r),ba(a,i)}function Wr(i,e){jr(i,e,Wr)}function La(i,e,n){var r,s,a,l=ce({},i.props);for(a in e)a=="key"?r=e[a]:a=="ref"?s=e[a]:l[a]=e[a];return arguments.length>2&&(l.children=arguments.length>3?Oi.call(arguments,2):n),Ci(i.type,l,r||i.key,s||i.ref,null)}function Yr(i,e){var n={__c:e="__cC"+_a++,__:i,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,a;return this.getChildContext||(s=[],(a={})[e]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&s.some(Cr)},this.sub=function(l){s.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){s.splice(s.indexOf(l),1),u&&u.call(l)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Oi=ma.slice,it={__e:function(i,e,n,r){for(var s,a,l;e=e.__;)if((s=e.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(i)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),l=s.__d),l)return s.__E=s}catch(u){i=u}throw i}},fa=0,pa=function(i){return i!=null&&i.constructor===void 0},qe.prototype.setState=function(i,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ce({},this.state),typeof i=="function"&&(i=i(ce({},n),this.props)),i&&ce(n,i),i!=null&&this.__v&&(e&&this._sb.push(e),Cr(this))},qe.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Cr(this))},qe.prototype.render=Ai,Li=[],Pn.__r=0,_a=0;const Jl=Object.freeze(Object.defineProperty({__proto__:null,Component:qe,Fragment:Ai,cloneElement:La,createContext:Yr,createElement:Je,createRef:Gl,h:Je,hydrate:Wr,get isValidElement(){return pa},get options(){return it},render:jr,toChildArray:Mn},Symbol.toStringTag,{value:"Module"}));var Ql=0;function _t(i,e,n,r,s){var a,l,u={};for(l in e)l=="ref"?a=e[l]:u[l]=e[l];var d={type:i,props:u,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Ql,__source:s,__self:r};if(typeof i=="function"&&(a=i.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return it.vnode&&it.vnode(d),d}var Xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ca(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Ur(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),n}var Qe={};const tu=Ur(Jl);var eu={};function Sa(i,e){for(var n in e)i[n]=e[n];return i}function Vr(i,e,n){var r=/(?:\?([^#]*))?(#.*)?$/,s=i.match(r),a={},l;if(s&&s[1])for(var u=s[1].split("&"),d=0;d<u.length;d++){var _=u[d].split("=");a[decodeURIComponent(_[0])]=decodeURIComponent(_.slice(1).join("="))}i=Sr(i.replace(r,"")),e=Sr(e||"");for(var f=Math.max(i.length,e.length),g=0;g<f;g++)if(e[g]&&e[g].charAt(0)===":"){var w=e[g].replace(/(^:|[+*?]+$)/g,""),b=(e[g].match(/[+*?]+$/)||eu)[0]||"",M=~b.indexOf("+"),C=~b.indexOf("*"),I=i[g]||"";if(!I&&!C&&(b.indexOf("?")<0||M)){l=!1;break}if(a[w]=decodeURIComponent(I),M||C){a[w]=i.slice(g).map(decodeURIComponent).join("/");break}}else if(e[g]!==i[g]){l=!1;break}return n.default!==!0&&l===!1?!1:a}function iu(i,e){return i.rank<e.rank?1:i.rank>e.rank?-1:i.index-e.index}function nu(i,e){return i.index=e,i.rank=su(i),i.props}function Sr(i){return i.replace(/(^\/+|\/+$)/g,"").split("/")}function ru(i){return i.charAt(0)==":"?1+"*+?".indexOf(i.charAt(i.length-1))||4:5}function ou(i){return Sr(i).map(ru).join("")}function su(i){return i.props.default?0:ou(i.props.path)}var Rt=null,Se=[],Cn=[],au={};function hu(i,e){e===void 0&&(e="push"),Rt&&Rt[e]?Rt[e](i):typeof history<"u"&&history[e+"State"]&&history[e+"State"](null,null,i)}function In(){var i;return Rt&&Rt.location?i=Rt.location:Rt&&Rt.getCurrentLocation?i=Rt.getCurrentLocation():i=typeof location<"u"?location:au,""+(i.pathname||"")+(i.search||"")}function Hr(i,e){return e===void 0&&(e=!1),typeof i!="string"&&i.url&&(e=i.replace,i=i.url),lu(i)&&hu(i,e?"replace":"push"),ka(i)}function lu(i){for(var e=Se.length;e--;)if(Se[e].canRoute(i))return!0;return!1}function ka(i){for(var e=!1,n=0;n<Se.length;n++)Se[n].routeTo(i)===!0&&(e=!0);for(var r=Cn.length;r--;)Cn[r](i);return e}function Ta(i){if(!(!i||!i.getAttribute)){var e=i.getAttribute("href"),n=i.getAttribute("target");if(!(!e||!e.match(/^\//g)||n&&!n.match(/^_?self$/i)))return Hr(e)}}function uu(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0))return Ta(i.currentTarget||i.target||this),Ea(i)}function Ea(i){return i&&(i.stopImmediatePropagation&&i.stopImmediatePropagation(),i.stopPropagation&&i.stopPropagation(),i.preventDefault()),!1}function cu(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0)){var e=i.target;do if(String(e.nodeName).toUpperCase()==="A"&&e.getAttribute("href")){if(e.hasAttribute("native"))return;if(Ta(e))return Ea(i)}while(e=e.parentNode)}}var _s=!1;function du(){_s||(typeof addEventListener=="function"&&(Rt||addEventListener("popstate",function(){ka(In())}),addEventListener("click",cu)),_s=!0)}var oe=function(i){function e(n){i.call(this,n),n.history&&(Rt=n.history),this.state={url:n.url||In()},du()}return i&&(e.__proto__=i),e.prototype=Object.create(i&&i.prototype),e.prototype.constructor=e,e.prototype.shouldComponentUpdate=function(r){return r.static!==!0?!0:r.url!==this.props.url||r.onChange!==this.props.onChange},e.prototype.canRoute=function(r){var s=Mn(this.props.children);return this.getMatchingChildren(s,r,!1).length>0},e.prototype.routeTo=function(r){this.setState({url:r});var s=this.canRoute(r);return this.updating||this.forceUpdate(),s},e.prototype.componentWillMount=function(){Se.push(this),this.updating=!0},e.prototype.componentDidMount=function(){var r=this;Rt&&(this.unlisten=Rt.listen(function(s){r.routeTo(""+(s.pathname||"")+(s.search||""))})),this.updating=!1},e.prototype.componentWillUnmount=function(){typeof this.unlisten=="function"&&this.unlisten(),Se.splice(Se.indexOf(this),1)},e.prototype.componentWillUpdate=function(){this.updating=!0},e.prototype.componentDidUpdate=function(){this.updating=!1},e.prototype.getMatchingChildren=function(r,s,a){return r.filter(nu).sort(iu).map(function(l){var u=Vr(s,l.props.path,l.props);if(u){if(a!==!1){var d={url:s,matches:u};return Sa(d,u),delete d.ref,delete d.key,La(l,d)}return l}}).filter(Boolean)},e.prototype.render=function(r,s){var a=r.children,l=r.onChange,u=s.url,d=this.getMatchingChildren(Mn(a),u,!0),_=d[0]||null,f=this.previousUrl;return u!==f&&(this.previousUrl=u,typeof l=="function"&&l({router:this,url:u,previous:f,active:d,current:_})),_},e}(qe),Da=function(i){return Je("a",Sa({onClick:uu},i))},Ia=function(i){return Je(i.component,i)};oe.subscribers=Cn;oe.getCurrentUrl=In;oe.route=Hr;oe.Router=oe;oe.Route=Ia;oe.Link=Da;oe.exec=Vr;const fu=Object.freeze(Object.defineProperty({__proto__:null,Link:Da,Route:Ia,Router:oe,default:oe,exec:Vr,getCurrentUrl:In,route:Hr,subscribers:Cn},Symbol.toStringTag,{value:"Module"})),pu=Ur(fu);Object.defineProperty(Qe,"__esModule",{value:!0});var Ba=Qe.Link=Qe.Match=void 0,_u=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},kr=tu,Ue=pu;function mu(i,e){var n={};for(var r in i)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r]);return n}function gu(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function ms(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i}function vu(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)}var Gr=Qe.Match=function(i){vu(e,i);function e(){var n,r,s;gu(this,e);for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];return s=(n=(r=ms(this,i.call.apply(i,[this].concat(l))),r),r.update=function(d){r.nextUrl=d,r.setState({})},n),ms(r,s)}return e.prototype.componentDidMount=function(){Ue.subscribers.push(this.update)},e.prototype.componentWillUnmount=function(){Ue.subscribers.splice(Ue.subscribers.indexOf(this.update)>>>0,1)},e.prototype.render=function(r){var s=this.nextUrl||(0,Ue.getCurrentUrl)(),a=s.replace(/\?.+$/,"");return this.nextUrl=null,r.children({url:s,path:a,matches:(0,Ue.exec)(a,r.path,{})!==!1})},e}(kr.Component),za=function(e){var n=e.activeClassName,r=e.path,s=mu(e,["activeClassName","path"]);return(0,kr.h)(Gr,{path:r||s.href},function(a){var l=a.matches;return(0,kr.h)(Ue.Link,_u({},s,{class:[s.class||s.className,l&&n].filter(Boolean).join(" ")}))})};Ba=Qe.Link=za;Qe.default=Gr;Gr.Link=za;const yu="_header_19max_1",xu="_nav_19max_14",wu="_github_19max_19",bu="_logo_19max_26",Pu="_active_19max_66",_i={header:yu,nav:xu,github:wu,logo:bu,active:Pu},Mu=""+new URL("logo-DQvm3LRv.png",import.meta.url).href,Lu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",Cu=()=>_t("header",{class:_i.header,children:[_t("div",{class:_i.nav,children:[_t("img",{class:_i.logo,src:Mu}),_t("nav",{children:_t(Ba,{activeClassName:_i.active,href:"/",children:"Home"})})]}),_t("div",{class:_i.github,children:_t("a",{href:"https://www.github.com/JamesLMilner/terra-draw",children:_t("img",{src:Lu})})})]}),Su="_home_13jfp_1",ku="_map_13jfp_7",Tu="_loading_13jfp_75",dr={home:Su,map:ku,loading:Tu};var Fi,yt,fr,gs,Di=0,Oa=[],mn=[],vs=it.__b,ys=it.__r,xs=it.diffed,ws=it.__c,bs=it.unmount;function Bn(i,e){it.__h&&it.__h(yt,i,Di||e),Di=0;var n=yt.__H||(yt.__H={__:[],__h:[]});return i>=n.__.length&&n.__.push({__V:mn}),n.__[i]}function pr(i){return Di=1,Aa(Fa,i)}function Aa(i,e,n){var r=Bn(Fi++,2);if(r.t=i,!r.__c&&(r.__=[Fa(void 0,e),function(a){var l=r.__N?r.__N[0]:r.__[0],u=r.t(l,a);l!==u&&(r.__N=[u,r.__[1]],r.__c.setState({}))}],r.__c=yt,!yt.u)){yt.u=!0;var s=yt.shouldComponentUpdate;yt.shouldComponentUpdate=function(a,l,u){if(!r.__c.__H)return!0;var d=r.__c.__H.__.filter(function(f){return f.__c});if(d.every(function(f){return!f.__N}))return!s||s.call(this,a,l,u);var _=!1;return d.forEach(function(f){if(f.__N){var g=f.__[0];f.__=f.__N,f.__N=void 0,g!==f.__[0]&&(_=!0)}}),!(!_&&r.__c.props===a)&&(!s||s.call(this,a,l,u))}}return r.__N||r.__}function Ps(i,e){var n=Bn(Fi++,3);!it.__s&&qr(n.__H,e)&&(n.__=i,n.i=e,yt.__H.__h.push(n))}function Eu(i,e){var n=Bn(Fi++,4);!it.__s&&qr(n.__H,e)&&(n.__=i,n.i=e,yt.__h.push(n))}function Du(i){return Di=5,zn(function(){return{current:i}},[])}function zn(i,e){var n=Bn(Fi++,7);return qr(n.__H,e)?(n.__V=i(),n.i=e,n.__h=i,n.__V):n.__}function Iu(i,e){return Di=8,zn(function(){return i},e)}function Bu(){for(var i;i=Oa.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(gn),i.__H.__h.forEach(Tr),i.__H.__h=[]}catch(e){i.__H.__h=[],it.__e(e,i.__v)}}it.__b=function(i){yt=null,vs&&vs(i)},it.__r=function(i){ys&&ys(i),Fi=0;var e=(yt=i.__c).__H;e&&(fr===yt?(e.__h=[],yt.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=mn,n.__N=n.i=void 0})):(e.__h.forEach(gn),e.__h.forEach(Tr),e.__h=[])),fr=yt},it.diffed=function(i){xs&&xs(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(Oa.push(e)!==1&&gs===it.requestAnimationFrame||((gs=it.requestAnimationFrame)||zu)(Bu)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==mn&&(n.__=n.__V),n.i=void 0,n.__V=mn})),fr=yt=null},it.__c=function(i,e){e.some(function(n){try{n.__h.forEach(gn),n.__h=n.__h.filter(function(r){return!r.__||Tr(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],it.__e(r,n.__v)}}),ws&&ws(i,e)},it.unmount=function(i){bs&&bs(i);var e,n=i.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{gn(r)}catch(s){e=s}}),n.__H=void 0,e&&it.__e(e,n.__v))};var Ms=typeof requestAnimationFrame=="function";function zu(i){var e,n=function(){clearTimeout(r),Ms&&cancelAnimationFrame(e),setTimeout(i)},r=setTimeout(n,100);Ms&&(e=requestAnimationFrame(n))}function gn(i){var e=yt,n=i.__c;typeof n=="function"&&(i.__c=void 0,n()),yt=e}function Tr(i){var e=yt;i.__c=i.__(),yt=e}function qr(i,e){return!i||i.length!==e.length||e.some(function(n,r){return n!==i[r]})}function Fa(i,e){return typeof e=="function"?e(i):e}function Kt(){return Kt=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Kt.apply(null,arguments)}var fe;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(fe||(fe={}));const de={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT:"selectionPoint"},Za="coordinatePoint",Ra="coordinatePointIds";function _r(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function Ls(i){return!!(i&&typeof i=="object"&&"properties"in i&&typeof i.properties=="object"&&i.properties!==null&&"mode"in i.properties)}function Cs(i){return!!function(e){return typeof e=="number"&&!isNaN(new Date(e).valueOf())}(i)}const Ou="Feature mode property does not match the mode being added to";var De;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(De||(De={}));let $r=class{get state(){return this._state}set state(e){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(e){if(typeof e!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=e}registerBehaviors(e){}constructor(e,n=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=De.Drawing,this.mode="base",n||this.updateOptions(e)}updateOptions(e){e!=null&&e.styles&&(this.styles=Kt({},this._styles,e.styles)),e!=null&&e.pointerDistance&&(this.pointerDistance=e.pointerDistance),e!=null&&e.validation&&(this.validate=e&&e.validation),e!=null&&e.projection&&(this.projection=e.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(e){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=e.store,this.store.registerOnChange(e.onChange),this.setDoubleClickToZoom=e.setDoubleClickToZoom,this.project=e.project,this.unproject=e.unproject,this.onSelect=e.onSelect,this.onDeselect=e.onDeselect,this.setCursor=e.setCursor,this.onStyleChange=e.onChange,this.onFinish=e.onFinish,this.coordinatePrecision=e.coordinatePrecision,this.registerBehaviors({mode:e.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:e.coordinatePrecision,projection:this.projection})}validateFeature(e){return this.performFeatureValidation(e)}afterFeatureAdded(e){}performFeatureValidation(e){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=function(r,s){let a;if(_r(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(_r(r.geometry))if(_r(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}}(e,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(e,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:fe.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(e,n){const r=this.performFeatureValidation(e);return r.valid?e.properties.mode!==this.mode?{valid:!1,reason:Ou}:n(e):{valid:!1,reason:r.reason}}onFinish(e,n){}onDeselect(e){}onSelect(e){}onKeyDown(e){}onKeyUp(e){}onMouseMove(e){}onClick(e){}onDragStart(e,n){}onDrag(e,n){}onDragEnd(e,n){}getHexColorStylingValue(e,n,r){return this.getStylingValue(e,n,r)}getNumericStylingValue(e,n,r){return this.getStylingValue(e,n,r)}getStylingValue(e,n,r){return e===void 0?n:typeof e=="function"?e(r):e}};class Au extends $r{constructor(...e){super(...e),this.type=De.Select}}function Na(i,e){const n=_=>_*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(e[1]),l=a-r,u=n(e[0])-s,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6371e3/1e3}const ja=63710088e-1;function Si(i){return i%360*Math.PI/180}function Fu(i){return i%(2*Math.PI)*180/Math.PI}function At(i,e=9){const n=Math.pow(10,e);return Math.round(i*n)/n}const Ss=57.29577951308232,ks=.017453292519943295,Sn=6378137,wt=(i,e)=>({x:i===0?0:i*ks*Sn,y:e===0?0:Math.log(Math.tan(Math.PI/4+e*ks/2))*Sn}),ke=(i,e)=>({lng:i===0?0:Ss*(i/Sn),lat:e===0?0:(2*Math.atan(Math.exp(e/Sn))-Math.PI/2)*Ss});function Zu(i){let e;if(i.geometry.type==="Polygon")e=i.geometry.coordinates;else{if(i.geometry.type!=="LineString")throw new Error("Self intersects only accepts Polygons and LineStrings");e=[i.geometry.coordinates]}const n=[];for(let a=0;a<e.length;a++)for(let l=0;l<e[a].length-1;l++)for(let u=0;u<e.length;u++)for(let d=0;d<e[u].length-1;d++)s(a,l,u,d);return n.length>0;function r(a){return a<0||a>1}function s(a,l,u,d){const _=e[a][l],f=e[a][l+1],g=e[u][d],w=e[u][d+1],b=function(I,A,m,x){if(ln(I,m)||ln(I,x)||ln(A,m)||ln(x,m))return null;const P=I[0],k=I[1],E=A[0],T=A[1],B=m[0],R=m[1],j=x[0],W=x[1],U=(P-E)*(R-W)-(k-T)*(B-j);return U===0?null:[((P*T-k*E)*(B-j)-(P-E)*(B*W-R*j))/U,((P*T-k*E)*(R-W)-(k-T)*(B*W-R*j))/U]}(_,f,g,w);if(b===null)return;let M,C;M=f[0]!==_[0]?(b[0]-_[0])/(f[0]-_[0]):(b[1]-_[1])/(f[1]-_[1]),C=w[0]!==g[0]?(b[0]-g[0])/(w[0]-g[0]):(b[1]-g[1])/(w[1]-g[1]),r(M)||r(C)||(b.toString(),n.push(b))}}function ln(i,e){return i[0]===e[0]&&i[1]===e[1]}function On(i,e){return Ts(i[0])<=e&&Ts(i[1])<=e}function Kr(i){return i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"&&i[0]!==1/0&&i[1]!==1/0&&(n=i[0])>=-180&&n<=180&&(e=i[1])>=-90&&e<=90;var e,n}function Ts(i){let e=1,n=0;for(;Math.round(i*e)/e!==i;)e*=10,n++;return n}const Ru="Feature has holes",Nu="Feature has less than 4 coordinates",ju="Feature has invalid coordinates",Wu="Feature coordinates are not closed";function Yu(i,e){if(i.geometry.type!=="Polygon")return{valid:!1,reason:"Feature is not a Polygon"};if(i.geometry.coordinates.length!==1)return{valid:!1,reason:Ru};if(i.geometry.coordinates[0].length<4)return{valid:!1,reason:Nu};for(let s=0;s<i.geometry.coordinates[0].length;s++){if(!Kr(i.geometry.coordinates[0][s]))return{valid:!1,reason:ju};if(!On(i.geometry.coordinates[0][s],e))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return(n=i.geometry.coordinates[0][0])[0]!==(r=i.geometry.coordinates[0][i.geometry.coordinates[0].length-1])[0]||n[1]!==r[1]?{valid:!1,reason:Wu}:{valid:!0};var n,r}const Te=(i,e)=>{const{x:n,y:r}=i,{x:s,y:a}=e,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};class Ut{constructor({store:e,mode:n,project:r,unproject:s,pointerDistance:a,coordinatePrecision:l,projection:u}){this.store=void 0,this.mode=void 0,this.project=void 0,this.unproject=void 0,this.pointerDistance=void 0,this.coordinatePrecision=void 0,this.projection=void 0,this.store=e,this.mode=n,this.project=r,this.unproject=s,this.pointerDistance=a,this.coordinatePrecision=l,this.projection=u}}function Wa({unproject:i,point:e,pointerDistance:n}){const r=n/2,{x:s,y:a}=e;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[i(s-r,a-r),i(s+r,a-r),i(s+r,a+r),i(s-r,a+r),i(s-r,a-r)].map(l=>[l.lng,l.lat])]}}}class Xu extends Ut{constructor(e){super(e)}create(e){const{containerX:n,containerY:r}=e;return Wa({unproject:this.unproject,point:{x:n,y:r},pointerDistance:this.pointerDistance})}}class Uu extends Ut{constructor(e){super(e)}measure(e,n){const{x:r,y:s}=this.project(n[0],n[1]);return Te({x:r,y:s},{x:e.containerX,y:e.containerY})}}class Vu extends Ut{constructor(e,n,r){super(e),this.config=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.getSnappableCoordinateFirstClick=s=>this.getSnappable(s,a=>!!(a.properties&&a.properties.mode===this.mode)).coordinate,this.getSnappableCoordinate=(s,a)=>this.getSnappable(s,l=>!!(l.properties&&l.properties.mode===this.mode&&l.id!==a)).coordinate,this.config=e,this.pixelDistance=n,this.clickBoundingBox=r}getSnappable(e,n){const r=this.clickBoundingBox.create(e),s=this.store.search(r,n),a={featureId:void 0,featureCoordinateIndex:void 0,coordinate:void 0,minDist:1/0};return s.forEach(l=>{let u;if(l.geometry.type==="Polygon")u=l.geometry.coordinates[0];else{if(l.geometry.type!=="LineString")return;u=l.geometry.coordinates}u.forEach((d,_)=>{const f=this.pixelDistance.measure(e,d);f<a.minDist&&f<this.pointerDistance&&(a.coordinate=d,a.minDist=f,a.featureId=l.id,a.featureCoordinateIndex=_)})}),a}}function Hu({x:i,y:e},{x:n,y:r}){let s=Math.atan2(r-e,n-i);return s*=180/Math.PI,s>180?s-=360:s<-180&&(s+=360),s}function Gu(i,e){if(i.geometry.type!=="LineString")return{valid:!1,reason:"Feature is not a LineString"};if(i.geometry.coordinates.length<2)return{valid:!1,reason:"Feature has less than 2 coordinates"};for(let n=0;n<i.geometry.coordinates.length;n++){if(!Kr(i.geometry.coordinates[n]))return{valid:!1,reason:"Feature has invalid coordinates"};if(!On(i.geometry.coordinates[n],e))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return{valid:!0}}const qu="Feature is not a Point",$u="Feature has invalid coordinates",Ku="Feature has coordinates with excessive precision";function Ju(i,e){return i.geometry.type!=="Point"?{valid:!1,reason:qu}:Kr(i.geometry.coordinates)?On(i.geometry.coordinates,e)?{valid:!0}:{valid:!1,reason:Ku}:{valid:!1,reason:$u}}class Qu extends Ut{constructor(e){super(e)}createOrUpdate(e){const n=this.store.getGeometryCopy(e),r=this.store.getPropertiesCopy(e);let s;if(n.type==="Polygon")s=n.coordinates[0].slice(0,-1);else{if(n.type!=="LineString")return;s=n.coordinates}const a=this.store.getPropertiesCopy(e);if(a.coordinatePointIds){const l=a.coordinatePointIds,u=l.map(d=>this.store.getGeometryCopy(d).coordinates);if(l.length!==s.length){this.deleteCoordinatePoints(l);const d=this.createPoints(s,r.mode);this.setFeatureCoordinatePoints(e,d)}else s.forEach((d,_)=>{d[0]===u[_][0]&&d[1]===u[_][1]||this.store.updateGeometry([{id:l[_],geometry:{type:"Point",coordinates:d}}])})}else{const l=this.createPoints(s,r.mode);this.setFeatureCoordinatePoints(e,l)}}deletePointsByFeatureIds(e){for(const n of e)this.deleteIfPresent(n)}getUpdated(e,n){const r=this.store.getPropertiesCopy(e);if(r.coordinatePointIds)return r.coordinatePointIds.map((s,a)=>({id:s,geometry:Kt({},this.store.getGeometryCopy(s),{coordinates:n[a]})}))}createPoints(e,n){return this.store.create(e.map(r=>({geometry:{type:"Point",coordinates:r},properties:{mode:n,[Za]:!0}})))}setFeatureCoordinatePoints(e,n){this.store.updateProperty([{id:e,property:Ra,value:n}])}deleteCoordinatePoints(e){this.store.delete(e)}deleteIfPresent(e){const n=this.store.getPropertiesCopy(e);n.coordinatePointIds&&(this.deleteCoordinatePoints(n.coordinatePointIds),this.setFeatureCoordinatePoints(e,null))}}class tc extends $r{constructor(e){if(!e.modeName)throw new Error("Mode name is required for TerraDrawRenderMode");super(e,!0),this.type=De.Render,this.mode="render",this.updateOptions(e)}updateOptions(e){super.updateOptions(e),e!=null&&e.modeName&&(this.mode=e.modeName)}registerBehaviors(e){this.mode=e.mode}start(){this.setStarted()}stop(){this.setStopped()}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(e){return{pointColor:this.getHexColorStylingValue(this.styles.pointColor,"#3f97e0",e),pointWidth:this.getNumericStylingValue(this.styles.pointWidth,6,e),pointOutlineColor:this.getHexColorStylingValue(this.styles.pointOutlineColor,"#ffffff",e),pointOutlineWidth:this.getNumericStylingValue(this.styles.pointOutlineWidth,0,e),polygonFillColor:this.getHexColorStylingValue(this.styles.polygonFillColor,"#3f97e0",e),polygonFillOpacity:this.getNumericStylingValue(this.styles.polygonFillOpacity,.3,e),polygonOutlineColor:this.getHexColorStylingValue(this.styles.polygonOutlineColor,"#3f97e0",e),polygonOutlineWidth:this.getNumericStylingValue(this.styles.polygonOutlineWidth,4,e),lineStringWidth:this.getNumericStylingValue(this.styles.lineStringWidth,4,e),lineStringColor:this.getHexColorStylingValue(this.styles.lineStringColor,"#3f97e0",e),zIndex:this.getNumericStylingValue(this.styles.zIndex,0,e)}}validateFeature(e){const n=super.validateFeature(e);if(n.valid){const r=e,s=Ju(r,this.coordinatePrecision).valid||Yu(r,this.coordinatePrecision).valid||Gu(r,this.coordinatePrecision).valid;return s?{valid:!0}:{valid:s,reason:"Feature is not a valid Point, Polygon or LineString feature"}}return n}}function kn(i,e){const n=i,r=e,s=Si(n[1]),a=Si(r[1]);let l=Si(r[0]-n[0]);l>Math.PI&&(l-=2*Math.PI),l<-Math.PI&&(l+=2*Math.PI);const u=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=(Fu(Math.atan2(l,u))+360)%360;return d>180?-(360-d):d}function Jr(i,e,n){let r=e;e<0&&(r=-Math.abs(r));const s=r/ja,a=i[0]*Math.PI/180,l=Si(i[1]),u=Si(n),d=s*Math.cos(u);let _=l+d;Math.abs(_)>Math.PI/2&&(_=_>0?Math.PI-_:-Math.PI-_);const f=Math.log(Math.tan(_/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),g=Math.abs(f)>1e-11?d/f:Math.cos(l),w=[(180*(a+s*Math.sin(u)/g)/Math.PI+540)%360-180,180*_/Math.PI];return w[0]+=w[0]-i[0]>180?-360:i[0]-w[0]>180?360:0,w}function ec(i,e,n,r,s){const a=r(i[0],i[1]),l=r(e[0],e[1]),{lng:u,lat:d}=s((a.x+l.x)/2,(a.y+l.y)/2);return[At(u,n),At(d,n)]}function ic(i,e,n){const r=Jr(i,1e3*Na(i,e)/2,kn(i,e));return[At(r[0],n),At(r[1],n)]}function Es({featureCoords:i,precision:e,unproject:n,project:r,projection:s}){const a=[];for(let l=0;l<i.length-1;l++){let u;if(s==="web-mercator")u=ec(i[l],i[l+1],e,r,n);else{if(s!=="globe")throw new Error("Invalid projection");u=ic(i[l],i[l+1],e)}a.push(u)}return a}class nc extends Ut{constructor(e,n,r){super(e),this.config=void 0,this.selectionPointBehavior=void 0,this.coordinatePointBehavior=void 0,this._midPoints=[],this.config=e,this.selectionPointBehavior=n,this.coordinatePointBehavior=r}get ids(){return this._midPoints.concat()}set ids(e){}insert(e,n,r){const s=this.store.getGeometryCopy(n),{midPointFeatureId:a,midPointSegment:l}=this.store.getPropertiesCopy(n),u=this.store.getGeometryCopy(a),d=u.type==="Polygon"?u.coordinates[0]:u.coordinates;d.splice(l+1,0,s.coordinates),u.coordinates=u.type==="Polygon"?[d]:d,this.store.updateGeometry([{id:a,geometry:u}]),this.store.getPropertiesCopy(e)[Ra]&&this.coordinatePointBehavior.createOrUpdate(e),this.store.delete([...this._midPoints,...this.selectionPointBehavior.ids]),this.create(d,a,r),this.selectionPointBehavior.create(d,u.type,a)}create(e,n,r){if(!this.store.has(n))throw new Error("Store does not have feature with this id");this._midPoints=this.store.create(function(s,a,l,u,d,_){return Es({featureCoords:s,precision:l,project:u,unproject:d,projection:_}).map((f,g)=>({geometry:{type:"Point",coordinates:f},properties:a(g)}))}(e,s=>({mode:this.mode,[de.MID_POINT]:!0,midPointSegment:s,midPointFeatureId:n}),r,this.config.project,this.config.unproject,this.projection))}delete(){this._midPoints.length&&(this.store.delete(this._midPoints),this._midPoints=[])}getUpdated(e){if(this._midPoints.length!==0)return Es({featureCoords:e,precision:this.coordinatePrecision,project:this.config.project,unproject:this.config.unproject,projection:this.config.projection}).map((n,r)=>({id:this._midPoints[r],geometry:{type:"Point",coordinates:n}}))}}class rc extends Ut{constructor(e){super(e),this._selectionPoints=[]}get ids(){return this._selectionPoints.concat()}set ids(e){}create(e,n,r){this._selectionPoints=this.store.create(function(s,a,l){const u=[],d=a==="Polygon"?s.length-1:s.length;for(let _=0;_<d;_++)u.push({geometry:{type:"Point",coordinates:s[_]},properties:l(_)});return u}(e,n,s=>({mode:this.mode,selectionPoint:!0,selectionPointFeatureId:r,index:s})))}delete(){this.ids.length&&(this.store.delete(this.ids),this._selectionPoints=[])}getUpdated(e){if(this._selectionPoints.length!==0)return this._selectionPoints.map((n,r)=>({id:n,geometry:{type:"Point",coordinates:e[r]}}))}getOneUpdated(e,n){if(this._selectionPoints[e]!==void 0)return{id:this._selectionPoints[e],geometry:{type:"Point",coordinates:n}}}}function Ya(i,e){let n=!1;for(let l=0,u=e.length;l<u;l++){const d=e[l];for(let _=0,f=d.length,g=f-1;_<f;g=_++)(s=d[_])[1]>(r=i)[1]!=(a=d[g])[1]>r[1]&&r[0]<(a[0]-s[0])*(r[1]-s[1])/(a[1]-s[1])+s[0]&&(n=!n)}var r,s,a;return n}const Xa=(i,e,n)=>{const r=a=>a*a,s=(a,l)=>r(a.x-l.x)+r(a.y-l.y);return Math.sqrt(((a,l,u)=>{const d=s(l,u);if(d===0)return s(a,l);let _=((a.x-l.x)*(u.x-l.x)+(a.y-l.y)*(u.y-l.y))/d;return _=Math.max(0,Math.min(1,_)),s(a,{x:l.x+_*(u.x-l.x),y:l.y+_*(u.y-l.y)})})(i,e,n))};class oc extends Ut{constructor(e,n,r){super(e),this.config=void 0,this.createClickBoundingBox=void 0,this.pixelDistance=void 0,this.config=e,this.createClickBoundingBox=n,this.pixelDistance=r}find(e,n){let r,s,a,l,u=1/0,d=1/0,_=1/0;const f=this.createClickBoundingBox.create(e),g=this.store.search(f);for(let w=0;w<g.length;w++){const b=g[w],M=b.geometry;if(M.type==="Point"){if(b.properties.selectionPoint||b.properties.coordinatePoint||!n&&b.properties[de.MID_POINT])continue;const C=this.pixelDistance.measure(e,M.coordinates);b.properties[de.MID_POINT]&&C<this.pointerDistance&&C<_?(_=C,a=b):!b.properties[de.MID_POINT]&&C<this.pointerDistance&&C<u&&(u=C,r=b)}else if(M.type==="LineString"){if(r)continue;for(let C=0;C<M.coordinates.length-1;C++){const I=M.coordinates[C],A=M.coordinates[C+1],m=Xa({x:e.containerX,y:e.containerY},this.project(I[0],I[1]),this.project(A[0],A[1]));m<this.pointerDistance&&m<d&&(d=m,s=b)}}else if(M.type==="Polygon"){if(r||s)continue;Ya([e.lng,e.lat],M.coordinates)&&(l=b)}}return{clickedFeature:r||s||l,clickedMidPoint:a}}}class sc extends Ut{constructor(e,n,r,s,a){super(e),this.config=void 0,this.featuresAtCursorEvent=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.draggedFeatureId=null,this.dragPosition=void 0,this.config=e,this.featuresAtCursorEvent=n,this.selectionPoints=r,this.midPoints=s,this.coordinatePoints=a}startDragging(e,n){this.draggedFeatureId=n,this.dragPosition=[e.lng,e.lat]}stopDragging(){this.draggedFeatureId=null,this.dragPosition=void 0}isDragging(){return this.draggedFeatureId!==null}canDrag(e,n){const{clickedFeature:r}=this.featuresAtCursorEvent.find(e,!0);return!(!r||r.id!==n)}drag(e,n){if(!this.draggedFeatureId)return;const r=this.store.getGeometryCopy(this.draggedFeatureId),s=[e.lng,e.lat];if(r.type==="Polygon"||r.type==="LineString"){let a,l;if(r.type==="Polygon"?(a=r.coordinates[0],l=a.length-1):(a=r.coordinates,l=a.length),!this.dragPosition)return!1;for(let f=0;f<l;f++){const g=a[f];let w,b;if(this.config.projection==="web-mercator"){const M=wt(this.dragPosition[0],this.dragPosition[1]),C=wt(s[0],s[1]),I=wt(g[0],g[1]),A={x:M.x-C.x,y:M.y-C.y},m=I.x-A.x,x=I.y-A.y,{lng:P,lat:k}=ke(m,x);w=P,b=k}else{const M=[this.dragPosition[0]-s[0],this.dragPosition[1]-s[1]];w=g[0]-M[0],b=g[1]-M[1]}if(w=At(w,this.config.coordinatePrecision),b=At(b,this.config.coordinatePrecision),w>180||w<-180||b>90||b<-90)return!1;a[f]=[w,b]}r.type==="Polygon"&&(a[a.length-1]=[a[0][0],a[0][1]]);const u=this.selectionPoints.getUpdated(a)||[],d=this.midPoints.getUpdated(a)||[],_=this.coordinatePoints.getUpdated(this.draggedFeatureId,a)||[];if(n&&!n({type:"Feature",id:this.draggedFeatureId,geometry:r,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:fe.Provisional}).valid)return!1;this.store.updateGeometry([{id:this.draggedFeatureId,geometry:r},...u,...d,..._]),this.dragPosition=[e.lng,e.lat]}else r.type==="Point"&&(this.store.updateGeometry([{id:this.draggedFeatureId,geometry:{type:"Point",coordinates:s}}]),this.dragPosition=[e.lng,e.lat])}}class ac extends Ut{constructor(e,n,r,s,a,l){super(e),this.config=void 0,this.pixelDistance=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.coordinateSnapping=void 0,this.draggedCoordinate={id:null,index:-1},this.config=e,this.pixelDistance=n,this.selectionPoints=r,this.midPoints=s,this.coordinatePoints=a,this.coordinateSnapping=l}getClosestCoordinate(e,n){const r={dist:1/0,index:-1,isFirstOrLastPolygonCoord:!1};let s;if(n.type==="LineString")s=n.coordinates;else{if(n.type!=="Polygon")return r;s=n.coordinates[0]}for(let a=0;a<s.length;a++){const l=this.pixelDistance.measure(e,s[a]);if(l<this.pointerDistance&&l<r.dist){const u=n.type==="Polygon"&&(a===s.length-1||a===0);r.dist=l,r.index=u?0:a,r.isFirstOrLastPolygonCoord=u}}return r}getDraggableIndex(e,n){const r=this.store.getGeometryCopy(n),s=this.getClosestCoordinate(e,r);return s.index===-1?-1:s.index}drag(e,n,r,s){if(this.draggedCoordinate.id===null)return!1;const a=this.draggedCoordinate.index,l=this.store.getGeometryCopy(this.draggedCoordinate.id),u=this.store.getPropertiesCopy(this.draggedCoordinate.id),d=l.type==="LineString"?l.coordinates:l.coordinates[0],_=l.type==="Polygon"&&(a===d.length-1||a===0);let f=[e.lng,e.lat];if(s){let C;C=this.coordinateSnapping.getSnappable(e,I=>!!(I.properties&&I.properties.mode===u.mode&&I.id!==this.draggedCoordinate.id)).coordinate,C&&(f=C)}if(e.lng>180||e.lng<-180||e.lat>90||e.lat<-90)return!1;if(_){const C=d.length-1;d[0]=f,d[C]=f}else d[a]=f;const g=this.selectionPoints.getOneUpdated(a,f),w=g?[g]:[],b=this.midPoints.getUpdated(d)||[],M=this.coordinatePoints.getUpdated(this.draggedCoordinate.id,d)||[];return!(l.type!=="Point"&&!n&&Zu({geometry:l})||r&&!r({type:"Feature",id:this.draggedCoordinate.id,geometry:l,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:fe.Provisional}).valid||(this.store.updateGeometry([{id:this.draggedCoordinate.id,geometry:l},...w,...b,...M]),0))}isDragging(){return this.draggedCoordinate.id!==null}startDragging(e,n){this.draggedCoordinate={id:e,index:n}}stopDragging(){this.draggedCoordinate={id:null,index:-1}}}function Tn(i){let e=0,n=0,r=0;return(i.geometry.type==="Polygon"?i.geometry.coordinates[0].slice(0,-1):i.geometry.coordinates).forEach(s=>{e+=s[0],n+=s[1],r++},!0),[e/r,n/r]}function Ua(i,e){i[0]+=i[0]-e[0]>180?-360:e[0]-i[0]>180?360:0;const n=ja,r=e[1]*Math.PI/180,s=i[1]*Math.PI/180,a=s-r;let l=Math.abs(i[0]-e[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);const u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),d=Math.abs(u)>1e-11?a/u:Math.cos(r);return Math.sqrt(a*a+d*d*l*l)*n}function En(i){const e=(i.geometry.type==="Polygon"?i.geometry.coordinates[0]:i.geometry.coordinates).map(n=>{const{x:r,y:s}=wt(n[0],n[1]);return[r,s]});return i.geometry.type==="Polygon"?function(n){let r=0,s=0,a=0;const l=n.length;for(let u=0;u<l-1;u++){const[d,_]=n[u],[f,g]=n[u+1],w=d*g-f*_;r+=w,s+=(d+f)*w,a+=(_+g)*w}return r/=2,s/=6*r,a/=6*r,{x:s,y:a}}(e):function(n){const r=n.length;let s=0,a=0;for(let l=0;l<r;l++){const[u,d]=n[l];s+=u,a+=d}return{x:s/r,y:a/r}}(e)}class hc extends Ut{constructor(e,n,r,s){super(e),this.config=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.lastBearing=void 0,this.config=e,this.selectionPoints=n,this.midPoints=r,this.coordinatePoints=s}reset(){this.lastBearing=void 0}rotate(e,n,r){const s=this.store.getGeometryCopy(n);if(s.type!=="Polygon"&&s.type!=="LineString")return;const a=[e.lng,e.lat];let l;const u={type:"Feature",geometry:s,properties:{}};if(this.config.projection==="web-mercator"){if(l=Hu(En(u),wt(e.lng,e.lat)),!this.lastBearing)return void(this.lastBearing=l);((w,b)=>{if(b===0||b===360||b===-360)return w;const M=.017453292519943295*b,C=(w.geometry.type==="Polygon"?w.geometry.coordinates[0]:w.geometry.coordinates).map(([m,x])=>wt(m,x)),I=C.reduce((m,x)=>({x:m.x+x.x,y:m.y+x.y}),{x:0,y:0});I.x/=C.length,I.y/=C.length;const A=C.map(m=>({x:I.x+(m.x-I.x)*Math.cos(M)-(m.y-I.y)*Math.sin(M),y:I.y+(m.x-I.x)*Math.sin(M)+(m.y-I.y)*Math.cos(M)})).map(({x:m,y:x})=>[ke(m,x).lng,ke(m,x).lat]);w.geometry.type==="Polygon"?w.geometry.coordinates[0]=A:w.geometry.coordinates=A})(u,-(this.lastBearing-l))}else{if(this.config.projection!=="globe")throw new Error("Unsupported projection");if(l=kn(Tn({geometry:s}),a),!this.lastBearing)return void(this.lastBearing=l+180);(function(w,b){if(b===0||b===360||b===-360)return w;const M=Tn(w);(w.geometry.type==="Polygon"?w.geometry.coordinates[0]:w.geometry.coordinates).forEach(C=>{const I=kn(M,C)+b,A=Ua(M,C),m=Jr(M,A,I);C[0]=m[0],C[1]=m[1]})})(u,-(this.lastBearing-(l+180)))}const d=s.type==="Polygon"?s.coordinates[0]:s.coordinates;d.forEach(w=>{w[0]=At(w[0],this.coordinatePrecision),w[1]=At(w[1],this.coordinatePrecision)});const _=this.midPoints.getUpdated(d)||[],f=this.selectionPoints.getUpdated(d)||[],g=this.coordinatePoints.getUpdated(n,d)||[];if(r&&!r({id:n,type:"Feature",geometry:s,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:fe.Provisional}))return!1;this.store.updateGeometry([{id:n,geometry:s},...f,..._,...g]),this.projection==="web-mercator"?this.lastBearing=l:this.projection==="globe"&&(this.lastBearing=l+180)}}class lc extends Ut{constructor(e,n,r,s){super(e),this.config=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.lastDistance=void 0,this.config=e,this.selectionPoints=n,this.midPoints=r,this.coordinatePoints=s}reset(){this.lastDistance=void 0}scale(e,n,r){const s=this.store.getGeometryCopy(n);if(s.type!=="Polygon"&&s.type!=="LineString")return;const a=[e.lng,e.lat],l={type:"Feature",geometry:s,properties:{}};let u;const d=En(l);if(this.config.projection==="web-mercator"){const M=wt(e.lng,e.lat);u=Te(d,M)}else{if(this.config.projection!=="globe")throw new Error("Invalid projection");u=Na(Tn({geometry:s}),a)}if(!this.lastDistance)return void(this.lastDistance=u);const _=1-(this.lastDistance-u)/u;if(this.config.projection==="web-mercator"){const{lng:M,lat:C}=ke(d.x,d.y);(function(I,A,m){if(A===1)return I;const x=(I.geometry.type==="Polygon"?I.geometry.coordinates[0]:I.geometry.coordinates).map(([E,T])=>wt(E,T)),P=wt(m[0],m[1]),k=x.map(E=>({x:P.x+(E.x-P.x)*A,y:P.y+(E.y-P.y)*A})).map(({x:E,y:T})=>[ke(E,T).lng,ke(E,T).lat]);I.geometry.type==="Polygon"?I.geometry.coordinates[0]=k:I.geometry.coordinates=k})(l,_,[M,C])}else this.config.projection==="globe"&&function(M,C,I,A="xy"){C===1||(M.geometry.type==="Polygon"?M.geometry.coordinates[0]:M.geometry.coordinates).forEach(m=>{const x=Ua(I,m),P=kn(I,m),k=Jr(I,x*C,P);A!=="x"&&A!=="xy"||(m[0]=k[0]),A!=="y"&&A!=="xy"||(m[1]=k[1])})}(l,_,Tn(l));const f=s.type==="Polygon"?s.coordinates[0]:s.coordinates;f.forEach(M=>{M[0]=At(M[0],this.coordinatePrecision),M[1]=At(M[1],this.coordinatePrecision)});const g=this.midPoints.getUpdated(f)||[],w=this.selectionPoints.getUpdated(f)||[],b=this.coordinatePoints.getUpdated(n,f)||[];if(r&&!r({id:n,type:"Feature",geometry:s,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:fe.Provisional}))return!1;this.store.updateGeometry([{id:n,geometry:s},...w,...g,...b]),this.lastDistance=u}}class uc extends Ut{constructor(e,n,r,s,a){super(e),this.config=void 0,this.pixelDistance=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.minimumScale=1e-4,this.draggedCoordinate={id:null,index:-1},this.boundingBoxMaps={opposite:{0:4,1:5,2:6,3:7,4:0,5:1,6:2,7:3}},this.config=e,this.pixelDistance=n,this.selectionPoints=r,this.midPoints=s,this.coordinatePoints=a}getClosestCoordinate(e,n){const r={dist:1/0,index:-1,isFirstOrLastPolygonCoord:!1};let s;if(n.type==="LineString")s=n.coordinates;else{if(n.type!=="Polygon")return r;s=n.coordinates[0]}for(let a=0;a<s.length;a++){const l=this.pixelDistance.measure(e,s[a]);if(l<this.pointerDistance&&l<r.dist){const u=n.type==="Polygon"&&(a===s.length-1||a===0);r.dist=l,r.index=u?0:a,r.isFirstOrLastPolygonCoord=u}}return r}isValidDragWebMercator(e,n,r){switch(e){case 0:if(n<=0||r>=0)return!1;break;case 1:if(r>=0)return!1;break;case 2:if(n>=0||r>=0)return!1;break;case 3:if(n>=0)return!1;break;case 4:if(n>=0||r<=0)return!1;break;case 5:if(r<=0)return!1;break;case 6:if(n<=0||r<=0)return!1;break;case 7:if(n<=0)return!1}return!0}getSelectedFeatureDataWebMercator(){if(!this.draggedCoordinate.id||this.draggedCoordinate.index===-1)return null;const e=this.getFeature(this.draggedCoordinate.id);if(!e)return null;const n=this.getNormalisedCoordinates(e.geometry);return{boundingBox:this.getBBoxWebMercator(n),feature:e,updatedCoords:n,selectedCoordinate:n[this.draggedCoordinate.index]}}centerWebMercatorDrag(e){const n=this.getSelectedFeatureDataWebMercator();if(!n)return null;const{feature:r,boundingBox:s,updatedCoords:a,selectedCoordinate:l}=n,u=En(r);if(!u)return null;const d=wt(l[0],l[1]),{closestBBoxIndex:_}=this.getIndexesWebMercator(s,d),f=wt(e.lng,e.lat);return this.scaleWebMercator({closestBBoxIndex:_,updatedCoords:a,webMercatorCursor:f,webMercatorSelected:d,webMercatorOrigin:u}),a}centerFixedWebMercatorDrag(e){const n=this.getSelectedFeatureDataWebMercator();if(!n)return null;const{feature:r,boundingBox:s,updatedCoords:a,selectedCoordinate:l}=n,u=En(r);if(!u)return null;const d=wt(l[0],l[1]),{closestBBoxIndex:_}=this.getIndexesWebMercator(s,d),f=wt(e.lng,e.lat);return this.scaleFixedWebMercator({closestBBoxIndex:_,updatedCoords:a,webMercatorCursor:f,webMercatorSelected:d,webMercatorOrigin:u}),a}scaleFixedWebMercator({closestBBoxIndex:e,webMercatorOrigin:n,webMercatorSelected:r,webMercatorCursor:s,updatedCoords:a}){if(!this.isValidDragWebMercator(e,n.x-s.x,n.y-s.y))return null;let l=Te(n,s)/Te(n,r);return l<0&&(l=this.minimumScale),this.performWebMercatorScale(a,n.x,n.y,l,l),a}oppositeFixedWebMercatorDrag(e){const n=this.getSelectedFeatureDataWebMercator();if(!n)return null;const{boundingBox:r,updatedCoords:s,selectedCoordinate:a}=n,l=wt(a[0],a[1]),{oppositeBboxIndex:u,closestBBoxIndex:d}=this.getIndexesWebMercator(r,l),_={x:r[u][0],y:r[u][1]},f=wt(e.lng,e.lat);return this.scaleFixedWebMercator({closestBBoxIndex:d,updatedCoords:s,webMercatorCursor:f,webMercatorSelected:l,webMercatorOrigin:_}),s}oppositeWebMercatorDrag(e){const n=this.getSelectedFeatureDataWebMercator();if(!n)return null;const{boundingBox:r,updatedCoords:s,selectedCoordinate:a}=n,l=wt(a[0],a[1]),{oppositeBboxIndex:u,closestBBoxIndex:d}=this.getIndexesWebMercator(r,l),_={x:r[u][0],y:r[u][1]},f=wt(e.lng,e.lat);return this.scaleWebMercator({closestBBoxIndex:d,updatedCoords:s,webMercatorCursor:f,webMercatorSelected:l,webMercatorOrigin:_}),s}scaleWebMercator({closestBBoxIndex:e,webMercatorOrigin:n,webMercatorSelected:r,webMercatorCursor:s,updatedCoords:a}){const l=n.x-s.x,u=n.y-s.y;if(!this.isValidDragWebMercator(e,l,u))return null;let d=1;l!==0&&e!==1&&e!==5&&(d=1-(n.x-r.x-l)/l);let _=1;return u!==0&&e!==3&&e!==7&&(_=1-(n.y-r.y-u)/u),this.validateScale(d,_)?(d<0&&(d=this.minimumScale),_<0&&(_=this.minimumScale),this.performWebMercatorScale(a,n.x,n.y,d,_),a):null}getFeature(e){if(this.draggedCoordinate.id===null)return null;const n=this.store.getGeometryCopy(e);return n.type!=="Polygon"&&n.type!=="LineString"?null:{id:e,type:"Feature",geometry:n,properties:{}}}getNormalisedCoordinates(e){return e.type==="Polygon"?e.coordinates[0]:e.coordinates}validateScale(e,n){const r=!isNaN(e)&&n<Number.MAX_SAFE_INTEGER,s=!isNaN(n)&&n<Number.MAX_SAFE_INTEGER;return r&&s}performWebMercatorScale(e,n,r,s,a){e.forEach(l=>{const{x:u,y:d}=wt(l[0],l[1]),_=n+(u-n)*s,f=r+(d-r)*a,{lng:g,lat:w}=ke(_,f);l[0]=g,l[1]=w})}getBBoxWebMercator(e){const n=[1/0,1/0,-1/0,-1/0];(e=e.map(u=>{const{x:d,y:_}=wt(u[0],u[1]);return[d,_]})).forEach(([u,d])=>{u<n[0]&&(n[0]=u),d<n[1]&&(n[1]=d),u>n[2]&&(n[2]=u),d>n[3]&&(n[3]=d)});const[r,s,a,l]=n;return[[r,l],[(r+a)/2,l],[a,l],[a,l+(s-l)/2],[a,s],[(r+a)/2,s],[r,s],[r,l+(s-l)/2]]}getIndexesWebMercator(e,n){let r,s=1/0;for(let a=0;a<e.length;a++){const l=Te({x:n.x,y:n.y},{x:e[a][0],y:e[a][1]});l<s&&(r=a,s=l)}if(r===void 0)throw new Error("No closest coordinate found");return{oppositeBboxIndex:this.boundingBoxMaps.opposite[r],closestBBoxIndex:r}}isDragging(){return this.draggedCoordinate.id!==null}startDragging(e,n){this.draggedCoordinate={id:e,index:n}}stopDragging(){this.draggedCoordinate={id:null,index:-1}}getDraggableIndex(e,n){const r=this.store.getGeometryCopy(n),s=this.getClosestCoordinate(e,r);return s.index===-1?-1:s.index}drag(e,n,r){if(!this.draggedCoordinate.id)return!1;const s=this.getFeature(this.draggedCoordinate.id);if(!s)return!1;let a=null;if(n==="center"?a=this.centerWebMercatorDrag(e):n==="opposite"?a=this.oppositeWebMercatorDrag(e):n==="center-fixed"?a=this.centerFixedWebMercatorDrag(e):n==="opposite-fixed"&&(a=this.oppositeFixedWebMercatorDrag(e)),!a)return!1;for(let f=0;f<a.length;f++){const g=a[f];if(g[0]=At(g[0],this.coordinatePrecision),g[1]=At(g[1],this.coordinatePrecision),!On(g,this.coordinatePrecision))return!1}const l=this.midPoints.getUpdated(a)||[],u=this.selectionPoints.getUpdated(a)||[],d=this.coordinatePoints.getUpdated(s.id,a)||[],_={type:s.geometry.type,coordinates:s.geometry.type==="Polygon"?[a]:a};return!(r&&!r({id:this.draggedCoordinate.id,type:"Feature",geometry:_,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:fe.Provisional}).valid||(this.store.updateGeometry([{id:this.draggedCoordinate.id,geometry:_},...u,...l,...d]),0))}}const cc={deselect:"Escape",delete:"Delete",rotate:["Control","r"],scale:["Control","s"]},Ds={pointerOver:"move",dragStart:"move",dragEnd:"move",insertMidpoint:"crosshair"};class dc extends Au{constructor(e){super(e,!0),this.mode="select",this.allowManualDeselection=!0,this.dragEventThrottle=5,this.dragEventCount=0,this.selected=[],this.flags={},this.keyEvents=cc,this.cursors=Ds,this.validations={},this.selectionPoints=void 0,this.midPoints=void 0,this.coordinateSnap=void 0,this.featuresAtMouseEvent=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.dragFeature=void 0,this.dragCoordinate=void 0,this.rotateFeature=void 0,this.scaleFeature=void 0,this.dragCoordinateResizeFeature=void 0,this.coordinatePoints=void 0,this.updateOptions(e)}updateOptions(e){if(super.updateOptions(e),this.cursors=e&&e.cursors?Kt({},this.cursors,e.cursors):Ds,(e==null?void 0:e.keyEvents)===null?this.keyEvents={deselect:null,delete:null,rotate:null,scale:null}:e!=null&&e.keyEvents&&(this.keyEvents=Kt({},this.keyEvents,e.keyEvents)),(e==null?void 0:e.dragEventThrottle)!==void 0&&(this.dragEventThrottle=e.dragEventThrottle),(e==null?void 0:e.allowManualDeselection)!==void 0&&(this.allowManualDeselection=e.allowManualDeselection),e!=null&&e.flags){this.flags=Kt({},this.flags,e.flags),this.validations={};for(const n in this.flags){const r=this.flags[n].feature;r&&r.validation&&(this.validations[n]=r.validation)}}}createOrUpdateCoordinatePoint(e){const n=this.store.getPropertiesCopy(e);n.coordinatePointIds&&this.store.delete(n.coordinatePointIds);const r=this.store.getGeometryCopy(e),s=this.store.create(r.coordinates[0].map(a=>({geometry:{type:"Point",coordinates:a},properties:{mode:this.mode,[Za]:!0}})));this.store.updateProperty([{id:e,property:"coordinatePointIds",value:s}])}selectFeature(e){this.select(e,!1)}setSelecting(){if(this._state!=="started")throw new Error("Mode must be started to move to selecting state");this._state="selecting"}registerBehaviors(e){this.pixelDistance=new Uu(e),this.clickBoundingBox=new Xu(e),this.featuresAtMouseEvent=new oc(e,this.clickBoundingBox,this.pixelDistance),this.selectionPoints=new rc(e),this.coordinatePoints=new Qu(e),this.midPoints=new nc(e,this.selectionPoints,this.coordinatePoints),this.coordinateSnap=new Vu(e,this.pixelDistance,this.clickBoundingBox),this.rotateFeature=new hc(e,this.selectionPoints,this.midPoints,this.coordinatePoints),this.scaleFeature=new lc(e,this.selectionPoints,this.midPoints,this.coordinatePoints),this.dragFeature=new sc(e,this.featuresAtMouseEvent,this.selectionPoints,this.midPoints,this.coordinatePoints),this.dragCoordinate=new ac(e,this.pixelDistance,this.selectionPoints,this.midPoints,this.coordinatePoints,this.coordinateSnap),this.dragCoordinateResizeFeature=new uc(e,this.pixelDistance,this.selectionPoints,this.midPoints,this.coordinatePoints)}deselectFeature(){this.deselect()}deselect(){const e=this.selected.filter(n=>this.store.has(n)).map(n=>({id:n,property:de.SELECTED,value:!1}));this.store.updateProperty(e),this.onDeselect(this.selected[0]),this.selected=[],this.selectionPoints.delete(),this.midPoints.delete()}deleteSelected(){this.store.delete(this.selected),this.selected=[]}onRightClick(e){if(!this.selectionPoints.ids.length)return;let n,r=1/0;if(this.selectionPoints.ids.forEach(w=>{const b=this.store.getGeometryCopy(w),M=this.pixelDistance.measure(e,b.coordinates);M<this.pointerDistance&&M<r&&(r=M,n=this.store.getPropertiesCopy(w))}),!n)return;const s=n.selectionPointFeatureId,a=n.index,l=this.store.getPropertiesCopy(s),u=this.flags[l.mode],d=this.validations[l.mode];if(!(u&&u.feature&&u.feature.coordinates&&u.feature.coordinates.deletable))return;const _=this.store.getGeometryCopy(s);let f;if(_.type==="Polygon"){if(f=_.coordinates[0],f.length<=4)return}else if(_.type==="LineString"&&(f=_.coordinates,f.length<=2))return;if(!f||(_.type!=="Polygon"||a!==0&&a!==f.length-1?f.splice(a,1):(f.shift(),f.pop(),f.push([f[0][0],f[0][1]])),d&&!d({id:s,type:"Feature",geometry:_,properties:l},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:fe.Commit}).valid))return;const g=[...this.midPoints.ids,...this.selectionPoints.ids];this.store.delete(g),this.store.updateGeometry([{id:s,geometry:_}]),l.coordinatePointIds&&this.coordinatePoints.createOrUpdate(s),this.selectionPoints.create(f,_.type,s),u&&u.feature&&u.feature.coordinates&&u.feature.coordinates.midpoints&&this.midPoints.create(f,s,this.coordinatePrecision)}select(e,n=!0){if(this.selected[0]===e)return;const{mode:r}=this.store.getPropertiesCopy(e),s=this.flags[r];if(!s||!s.feature)return;const a=this.selected[0];if(a){if(a===e)return;this.deselect()}n&&this.setCursor(this.cursors.pointerOver),this.selected=[e],this.store.updateProperty([{id:e,property:"selected",value:!0}]),this.onSelect(e);const{type:l,coordinates:u}=this.store.getGeometryCopy(e);if(l!=="LineString"&&l!=="Polygon")return;const d=l==="LineString"?u:u[0];d&&s&&s.feature.coordinates&&(this.selectionPoints.create(d,l,e),s.feature.coordinates.midpoints&&this.midPoints.create(d,e,this.coordinatePrecision))}onLeftClick(e){const{clickedFeature:n,clickedMidPoint:r}=this.featuresAtMouseEvent.find(e,this.selected.length>0);if(this.selected.length&&r)this.midPoints.insert(this.selected[0],r.id,this.coordinatePrecision);else if(n&&n.id)this.select(n.id,!0);else if(this.selected.length&&this.allowManualDeselection)return void this.deselect()}start(){this.setStarted(),this.setSelecting()}stop(){this.cleanUp(),this.setStarted(),this.setStopped()}onClick(e){e.button!=="right"?e.button==="left"&&this.onLeftClick(e):this.onRightClick(e)}canScale(e){return this.keyEvents.scale&&this.keyEvents.scale.every(n=>e.heldKeys.includes(n))}canRotate(e){return this.keyEvents.rotate&&this.keyEvents.rotate.every(n=>e.heldKeys.includes(n))}preventDefaultKeyEvent(e){const n=this.canRotate(e),r=this.canScale(e);(n||r)&&e.preventDefault()}onKeyDown(e){this.preventDefaultKeyEvent(e)}onKeyUp(e){if(this.preventDefaultKeyEvent(e),this.keyEvents.delete&&e.key===this.keyEvents.delete){if(!this.selected.length)return;this.onDeselect(this.selected[0]),this.deleteSelected(),this.selectionPoints.delete(),this.midPoints.delete()}else this.keyEvents.deselect&&e.key===this.keyEvents.deselect&&this.cleanUp()}cleanUp(){this.selected.length&&this.deselect()}onDragStart(e,n){if(!this.selected.length)return;const r=this.store.getPropertiesCopy(this.selected[0]),s=this.flags[r.mode];if(!(s&&s.feature&&(s.feature.draggable||s.feature.coordinates&&s.feature.coordinates.draggable||s.feature.coordinates&&s.feature.coordinates.resizable||s.feature.coordinates&&typeof s.feature.coordinates.midpoints=="object"&&s.feature.coordinates.midpoints.draggable)))return;this.dragEventCount=0;const a=this.selected[0],l=this.dragCoordinate.getDraggableIndex(e,a);if(s&&s.feature&&s.feature.coordinates&&(s.feature.coordinates.draggable||s.feature.coordinates.resizable)&&l!==-1)return this.setCursor(this.cursors.dragStart),s.feature.coordinates.resizable?this.dragCoordinateResizeFeature.startDragging(a,l):this.dragCoordinate.startDragging(a,l),void n(!1);if(s&&s.feature&&s.feature.coordinates&&typeof s.feature.coordinates.midpoints=="object"&&s.feature.coordinates.midpoints.draggable){const{clickedMidPoint:u}=this.featuresAtMouseEvent.find(e,this.selected.length>0);if(this.selected.length&&u){this.midPoints.insert(a,u.id,this.coordinatePrecision);const d=this.dragCoordinate.getDraggableIndex(e,a);return this.dragCoordinate.startDragging(a,d),void n(!1)}}return s&&s.feature&&s.feature.draggable&&this.dragFeature.canDrag(e,a)?(this.setCursor(this.cursors.dragStart),this.dragFeature.startDragging(e,a),void n(!1)):void 0}onDrag(e,n){const r=this.selected[0];if(!r)return;const s=this.store.getPropertiesCopy(r),a=this.flags[s.mode],l=(a&&a.feature&&a.feature.selfIntersectable)===!0;if(this.dragEventCount++,this.dragEventCount%this.dragEventThrottle==0)return;const u=this.validations[s.mode];if(a&&a.feature&&a.feature.rotateable&&this.canRotate(e))return n(!1),void this.rotateFeature.rotate(e,r,u);if(a&&a.feature&&a.feature.scaleable&&this.canScale(e))return n(!1),void this.scaleFeature.scale(e,r,u);if(this.dragCoordinateResizeFeature.isDragging()&&a.feature&&a.feature.coordinates&&a.feature.coordinates.resizable){if(this.projection==="globe")throw new Error("Globe is currently unsupported projection for resizable");return n(!1),void this.dragCoordinateResizeFeature.drag(e,a.feature.coordinates.resizable,u)}if(this.dragCoordinate.isDragging()){var d;const _=!!(!((d=a.feature)==null||(d=d.coordinates)==null)&&d.snappable);this.dragCoordinate.drag(e,l,u,_)}else this.dragFeature.isDragging()?this.dragFeature.drag(e,u):n(!0)}onDragEnd(e,n){this.setCursor(this.cursors.dragEnd),this.dragCoordinate.isDragging()?this.onFinish(this.selected[0],{mode:this.mode,action:"dragCoordinate"}):this.dragFeature.isDragging()?this.onFinish(this.selected[0],{mode:this.mode,action:"dragFeature"}):this.dragCoordinateResizeFeature.isDragging()&&this.onFinish(this.selected[0],{mode:this.mode,action:"dragCoordinateResize"}),this.dragCoordinate.stopDragging(),this.dragFeature.stopDragging(),this.dragCoordinateResizeFeature.stopDragging(),this.rotateFeature.reset(),this.scaleFeature.reset(),n(!0)}onMouseMove(e){if(!this.selected.length)return void this.setCursor("unset");if(this.dragFeature.isDragging())return;let n=!1;this.midPoints.ids.forEach(a=>{if(n)return;const l=this.store.getGeometryCopy(a);this.pixelDistance.measure(e,l.coordinates)<this.pointerDistance&&(n=!0)});let r=!1;if(this.selectionPoints.ids.forEach(a=>{const l=this.store.getGeometryCopy(a);this.pixelDistance.measure(e,l.coordinates)<this.pointerDistance&&(n=!1,r=!0)}),n)return void this.setCursor(this.cursors.insertMidpoint);const{clickedFeature:s}=this.featuresAtMouseEvent.find(e,!0);this.setCursor(this.selected.length>0&&(s&&s.id===this.selected[0]||r)?this.cursors.pointerOver:"unset")}styleFeature(e){const n=Kt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});if(e.properties.mode===this.mode&&e.geometry.type==="Point"){if(e.properties.selectionPoint)return n.pointColor=this.getHexColorStylingValue(this.styles.selectionPointColor,n.pointColor,e),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.selectionPointOutlineColor,n.pointOutlineColor,e),n.pointWidth=this.getNumericStylingValue(this.styles.selectionPointWidth,n.pointWidth,e),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.selectionPointOutlineWidth,2,e),n.zIndex=30,n;if(e.properties.midPoint)return n.pointColor=this.getHexColorStylingValue(this.styles.midPointColor,n.pointColor,e),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.midPointOutlineColor,n.pointOutlineColor,e),n.pointWidth=this.getNumericStylingValue(this.styles.midPointWidth,4,e),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.midPointOutlineWidth,2,e),n.zIndex=40,n}else if(e.properties[de.SELECTED]){if(e.geometry.type==="Polygon")return n.polygonFillColor=this.getHexColorStylingValue(this.styles.selectedPolygonColor,n.polygonFillColor,e),n.polygonOutlineWidth=this.getNumericStylingValue(this.styles.selectedPolygonOutlineWidth,n.polygonOutlineWidth,e),n.polygonOutlineColor=this.getHexColorStylingValue(this.styles.selectedPolygonOutlineColor,n.polygonOutlineColor,e),n.polygonFillOpacity=this.getNumericStylingValue(this.styles.selectedPolygonFillOpacity,n.polygonFillOpacity,e),n.zIndex=10,n;if(e.geometry.type==="LineString")return n.lineStringColor=this.getHexColorStylingValue(this.styles.selectedLineStringColor,n.lineStringColor,e),n.lineStringWidth=this.getNumericStylingValue(this.styles.selectedLineStringWidth,n.lineStringWidth,e),n.zIndex=10,n;if(e.geometry.type==="Point")return n.pointWidth=this.getNumericStylingValue(this.styles.selectedPointWidth,n.pointWidth,e),n.pointColor=this.getHexColorStylingValue(this.styles.selectedPointColor,n.pointColor,e),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.selectedPointOutlineColor,n.pointOutlineColor,e),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.selectedPointOutlineWidth,n.pointOutlineWidth,e),n.zIndex=10,n}return n}}class fc extends $r{constructor(...e){super(...e),this.type=De.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return Kt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0})}}function Va(i,e,n,r,s){for(;r>n;){if(r-n>600){const d=r-n+1,_=e-n+1,f=Math.log(d),g=.5*Math.exp(2*f/3),w=.5*Math.sqrt(f*g*(d-g)/d)*(_-d/2<0?-1:1);Va(i,e,Math.max(n,Math.floor(e-_*g/d+w)),Math.min(r,Math.floor(e+(d-_)*g/d+w)),s)}const a=i[e];let l=n,u=r;for(mi(i,n,e),s(i[r],a)>0&&mi(i,n,r);l<u;){for(mi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?mi(i,n,u):(u++,mi(i,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}}function mi(i,e,n){const r=i[e];i[e]=i[n],i[n]=r}function je(i,e){bi(i,0,i.children.length,e,i)}function bi(i,e,n,r,s){s||(s=Ve([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=e;a<n;a++){const l=i.children[a];Pi(s,i.leaf?r(l):l)}return s}function Pi(i,e){return i.minX=Math.min(i.minX,e.minX),i.minY=Math.min(i.minY,e.minY),i.maxX=Math.max(i.maxX,e.maxX),i.maxY=Math.max(i.maxY,e.maxY),i}function pc(i,e){return i.minX-e.minX}function _c(i,e){return i.minY-e.minY}function mr(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function un(i){return i.maxX-i.minX+(i.maxY-i.minY)}function mc(i,e){const n=Math.max(i.minX,e.minX),r=Math.max(i.minY,e.minY),s=Math.min(i.maxX,e.maxX),a=Math.min(i.maxY,e.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function gr(i,e){return i.minX<=e.minX&&i.minY<=e.minY&&e.maxX<=i.maxX&&e.maxY<=i.maxY}function cn(i,e){return e.minX<=i.maxX&&e.minY<=i.maxY&&e.maxX>=i.minX&&e.maxY>=i.minY}function Ve(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Is(i,e,n,r,s){const a=[e,n];for(;a.length;){if((n=a.pop())-(e=a.pop())<=r)continue;const l=e+Math.ceil((n-e)/r/2)*r;Va(i,l,e,n,s),a.push(e,l,l,n)}}class gc{constructor(e){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(e){let n=this.data;const r=[];if(!cn(e,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],d=n.leaf?s(u):u;cn(e,d)&&(n.leaf?r.push(u):gr(e,d)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(e){let n=this.data;if(cn(e,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(cn(e,l)){if(n.leaf||gr(e,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(e){if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return}let n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(e){this._insert(e,this.data.height-1)}clear(){this.data=Ve([])}remove(e){let n=this.data;const r=this.toBBox(e),s=[],a=[];let l,u,d=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),d=!0),n.leaf){const _=n.children.indexOf(e);_!==-1&&(n.children.splice(_,1),s.push(n),this._condense(s))}d||n.leaf||!gr(n,r)?u?(l++,n=u.children[l],d=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=Ve(e.slice(n,r+1)),je(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=Ve([]),l.leaf=!1,l.height=s;const d=Math.ceil(a/u),_=d*Math.ceil(Math.sqrt(u));Is(e,n,r,_,this.compareMinX);for(let f=n;f<=r;f+=_){const g=Math.min(f+_-1,r);Is(e,f,g,d,this.compareMinY);for(let w=f;w<=g;w+=d){const b=Math.min(w+d-1,g);l.children.push(this._build(e,w,b,s-1))}}return je(l,this.toBBox),l}_chooseSubtree(e,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,d=1/0,_=1/0;for(let f=0;f<n.children.length;f++){const g=n.children[f],w=mr(g),b=(a=e,l=g,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-w);b<_?(_=b,d=w<d?w:d,u=g):b===_&&w<d&&(d=w,u=g)}n=u||n.children[0]}var a,l;return n}_insert(e,n,r){const s=r?e:this.toBBox(e),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(e),Pi(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(e,n){const r=e[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=Ve(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,je(r,this.toBBox),je(u,this.toBBox),n?e[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(e,n){this.data=Ve([e,n]),this.data.height=e.height+1,this.data.leaf=!1,je(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const d=bi(e,0,u,this.toBBox),_=bi(e,u,r,this.toBBox),f=mc(d,_),g=mr(d)+mr(_);f<a?(a=f,s=u,l=g<l?g:l):f===a&&g<l&&(l=g,s=u)}return s||r-n}_chooseSplitAxis(e,n,r){const s=e.leaf?this.compareMinX:pc,a=e.leaf?this.compareMinY:_c;this._allDistMargin(e,n,r,s)<this._allDistMargin(e,n,r,a)&&e.children.sort(s)}_allDistMargin(e,n,r,s){e.children.sort(s);const a=this.toBBox,l=bi(e,0,n,a),u=bi(e,r-n,r,a);let d=un(l)+un(u);for(let _=n;_<r-n;_++){const f=e.children[_];Pi(l,e.leaf?a(f):f),d+=un(l)}for(let _=r-n-1;_>=n;_--){const f=e.children[_];Pi(u,e.leaf?a(f):f),d+=un(u)}return d}_adjustParentBBoxes(e,n,r){for(let s=r;s>=0;s--)Pi(n[s],e)}_condense(e){for(let n,r=e.length-1;r>=0;r--)e[r].children.length===0?r>0?(n=e[r-1].children,n.splice(n.indexOf(e[r]),1)):this.clear():je(e[r],this.toBBox)}}class vc{constructor(e){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new gc(e&&e.maxEntries?e.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(e,n){this.idToNode.set(e.id,n),this.nodeToId.set(n,e.id)}toBBox(e){const n=[],r=[];let s;if(e.geometry.type==="Polygon")s=e.geometry.coordinates[0];else if(e.geometry.type==="LineString")s=e.geometry.coordinates;else{if(e.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[e.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(e){if(this.idToNode.get(String(e.id)))throw new Error("Feature already exists");const n=this.toBBox(e);this.setMaps(e,n),this.tree.insert(n)}load(e){const n=[],r=new Set;e.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(e){this.remove(e.id);const n=this.toBBox(e);this.setMaps(e,n),this.tree.insert(n)}remove(e){const n=this.idToNode.get(e);if(!n)throw new Error(`${e} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(e){return this.tree.search(this.toBBox(e)).map(n=>this.nodeToId.get(n))}collides(e){return this.tree.collides(this.toBBox(e))}}const yc={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=16*Math.random()|0;return(i=="x"?e:3&e|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36};class xc{constructor(e){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new vc,this.tracked=!e||e.tracked!==!1,this.idStrategy=e&&e.idStrategy?e.idStrategy:yc}clone(e){return JSON.parse(JSON.stringify(e))}getId(){return this.idStrategy.getId()}has(e){return!!this.store[e]}load(e,n,r){if(e.length===0)return[];let s=this.clone(e);const a=[],l=[];return s=s.filter(u=>{u.id==null&&(u.id=this.idStrategy.getId());const d=u.id;if(n){const _=n(u);if(!_.valid)return l.push({id:d,valid:!1,reason:_.reason}),!1}if(this.tracked){if(u.properties.createdAt){if(!Cs(u.properties.createdAt))return l.push({id:u.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else u.properties.createdAt=+new Date;if(u.properties.updatedAt){if(!Cs(u.properties.updatedAt))return l.push({id:u.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else u.properties.updatedAt=+new Date}return this.has(d)?(l.push({id:d,valid:!1,reason:`Feature already exists with this id: ${d}`}),!1):(this.store[d]=u,a.push(d),r&&r(u),l.push({id:d,valid:!0}),!0)}),this.spatialIndex.load(s),this._onChange(a,"create"),l}search(e,n){const r=this.spatialIndex.search(e).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(e){this._onChange=(n,r)=>{e(n,r)}}getGeometryCopy(e){const n=this.store[e];if(!n)throw new Error(`No feature with this id (${e}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(e){const n=this.store[e];if(!n)throw new Error(`No feature with this id (${e}), can not get properties copy`);return this.clone(n.properties)}updateProperty(e){const n=[];e.forEach(({id:r,property:s,value:a})=>{const l=this.store[r];if(!l)throw new Error(`No feature with this (${r}), can not update geometry`);n.push(r),l.properties[s]=a,this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}updateGeometry(e){const n=[];e.forEach(({id:r,geometry:s})=>{n.push(r);const a=this.store[r];if(!a)throw new Error(`No feature with this (${r}), can not update geometry`);a.geometry=this.clone(s),this.spatialIndex.update(a),this.tracked&&(a.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}create(e){const n=[];return e.forEach(({geometry:r,properties:s})=>{let a,l=Kt({},s);this.tracked&&(a=+new Date,s?(l.createdAt=typeof s.createdAt=="number"?s.createdAt:a,l.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:a):l={createdAt:a,updatedAt:a});const u=this.getId(),d={id:u,type:"Feature",geometry:r,properties:l};this.store[u]=d,this.spatialIndex.insert(d),n.push(u)}),this._onChange&&this._onChange([...n],"create"),n}delete(e){e.forEach(n=>{if(!this.store[n])throw new Error("No feature with this id, can not delete");delete this.store[n],this.spatialIndex.remove(n)}),this._onChange&&this._onChange([...e],"delete")}copy(e){return this.clone(this.store[e])}copyAll(){return this.clone(Object.keys(this.store).map(e=>this.store[e]))}copyAllWhere(e){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&e(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class We{constructor({name:e,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=e,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}}var wc={__proto__:null,TerraDrawBaseAdapter:class{constructor(i){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const e=this.getMapEventElement(),{left:n,top:r}=e.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i){const e=this.getLngLatFromEvent(i);if(!e)return null;const{lng:n,lat:r}=e,{containerX:s,containerY:a}=this.getMapElementXYPosition(i),l=this.getButton(i),u=Array.from(this._heldKeys);return{lng:At(n,this._coordinatePrecision),lat:At(r,this._coordinatePrecision),containerX:s,containerY:a,button:l,heldKeys:u}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(e=>{e.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new We({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const e=this.getDrawEventFromEvent(i);e&&(this._dragState="pre-dragging",this._lastDrawEvent=e)},register:i=>{this.getMapEventElement().addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerdown",i)}}),new We({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const e=this.getDrawEventFromEvent(i);if(e)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(e),this._lastDrawEvent=e;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:e.containerX,y:e.containerY},s=this._currentModeCallbacks.getState(),a=Te(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(e,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(e,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement().addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointermove",i)}}),new We({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&i.preventDefault()},register:i=>{this.getMapEventElement().addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement().removeEventListener("contextmenu",i)}}),new We({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement()||!i.isPrimary)return;const e=this.getDrawEventFromEvent(i);e&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(e,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(e),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement().addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerup",i)}}),new We({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keyup",i)}}),new We({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear()}}};class bc{constructor(e){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=e.adapter,this._mode=new fc;const n=new Set,r=e.modes.reduce((f,g)=>{if(n.has(g.mode))throw new Error(`There is already a ${g.mode} mode provided`);return n.add(g.mode),f[g.mode]=g,f},{}),s=Object.keys(r);if(s.length===0)throw new Error("No modes provided");s.forEach(f=>{if(r[f].type===De.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=f}}),this._modes=Kt({},r,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new xc({tracked:!!e.tracked,idStrategy:e.idStrategy?e.idStrategy:void 0});const a=f=>{const g=[],w=this._store.copyAll().filter(b=>!f.includes(b.id)||(g.push(b),!1));return{changed:g,unchanged:w}},l=(f,g)=>{this._enabled&&this._eventListeners.finish.forEach(w=>{w(f,g)})},u=(f,g)=>{if(!this._enabled)return;this._eventListeners.change.forEach(M=>{M(f,g)});const{changed:w,unchanged:b}=a(f);g==="create"?this._adapter.render({created:w,deletedIds:[],unchanged:b,updated:[]},this.getModeStyles()):g==="update"?this._adapter.render({created:[],deletedIds:[],unchanged:b,updated:w},this.getModeStyles()):g==="delete"?this._adapter.render({created:[],deletedIds:f,unchanged:b,updated:[]},this.getModeStyles()):g==="styling"&&this._adapter.render({created:[],deletedIds:[],unchanged:b,updated:[]},this.getModeStyles())},d=f=>{if(!this._enabled)return;this._eventListeners.select.forEach(b=>{b(f)});const{changed:g,unchanged:w}=a([f]);this._adapter.render({created:[],deletedIds:[],unchanged:w,updated:g},this.getModeStyles())},_=f=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(b=>{b()});const{changed:g,unchanged:w}=a([f]);g&&this._adapter.render({created:[],deletedIds:[],unchanged:w,updated:g},this.getModeStyles())};Object.keys(this._modes).forEach(f=>{this._modes[f].register({mode:f,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:u,onSelect:d,onDeselect:_,onFinish:l,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const e={};return Object.keys(this._modes).forEach(n=>{e[n]=r=>this._instanceSelectMode&&r.properties[de.SELECTED]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(r):this._modes[n].styleFeature.bind(this._modes[n])(r)}),e}featuresAtLocation({lng:e,lat:n},r){const s=r&&r.pointerDistance!==void 0?r.pointerDistance:30,a=!r||r.ignoreSelectFeatures===void 0||r.ignoreSelectFeatures,l=this._adapter.unproject.bind(this._adapter),u=this._adapter.project.bind(this._adapter),d=u(e,n),_=Wa({unproject:l,point:d,pointerDistance:s});return this._store.search(_).filter(f=>{if(a&&(f.properties[de.MID_POINT]||f.properties[de.SELECTION_POINT]))return!1;if(f.geometry.type==="Point"){const g=f.geometry.coordinates,w=u(g[0],g[1]);return Te(d,w)<s}if(f.geometry.type==="LineString"){const g=f.geometry.coordinates;for(let w=0;w<g.length-1;w++){const b=g[w],M=g[w+1];if(Xa(d,u(b[0],b[1]),u(M[0],M[1]))<s)return!0}return!1}return!!Ya([e,n],f.geometry.coordinates)||void 0})}getSelectMode(){if(this.checkEnabled(),!this._instanceSelectMode)throw new Error("No select mode defined in instance");return this.getMode()!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}setModeStyles(e,n){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].styles=n}updateModeOptions(e,n){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].updateOptions(n)}getSnapshot(){return this._store.copyAll()}getSnapshotFeature(e){if(this._store.has(e))return this._store.copy(e)}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(e){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}setMode(e){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[e],this._mode.start()}removeFeatures(e){this.checkEnabled(),this._store.delete(e)}selectFeature(e){this.getSelectMode().selectFeature(e)}deselectFeature(e){this.getSelectMode().deselectFeature(e)}getFeatureId(){return this._store.getId()}hasFeature(e){return this._store.has(e)}addFeatures(e){return this.checkEnabled(),e.length===0?[]:this._store.load(e,n=>{if(Ls(n)){const r=n.properties.mode,s=this._modes[r];if(!s)return{id:n.id,valid:!1,reason:`${r} mode is not in the list of instantiated modes`};const a=s.validateFeature.bind(s)(n);return{id:n.id,valid:a.valid,reason:a.reason?a.reason:a.valid?void 0:"Feature is invalid"}}return{id:n.id,valid:!1,reason:"Mode property does not exist"}},n=>{if(Ls(n)){const r=this._modes[n.properties.mode];r&&r.afterFeatureAdded&&r.afterFeatureAdded(n)}})}start(){this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(e=>{e()})},getState:()=>this._mode.state,onClick:e=>{this._mode.onClick(e)},onMouseMove:e=>{this._mode.onMouseMove(e)},onKeyDown:e=>{this._mode.onKeyDown(e)},onKeyUp:e=>{this._mode.onKeyUp(e)},onDragStart:(e,n)=>{this._mode.onDragStart(e,n)},onDrag:(e,n)=>{this._mode.onDrag(e,n)},onDragEnd:(e,n)=>{this._mode.onDragEnd(e,n)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}})}getFeaturesAtLngLat(e,n){const{lng:r,lat:s}=e;return this.featuresAtLocation({lng:r,lat:s},n)}getFeaturesAtPointerEvent(e,n){const r=this._adapter.getLngLatFromEvent.bind(this._adapter)(e);return r===null?[]:this.featuresAtLocation(r,n)}stop(){this._enabled=!1,this._adapter.unregister()}on(e,n){const r=this._eventListeners[e];r.includes(n)||r.push(n)}off(e,n){const r=this._eventListeners[e];r.includes(n)&&r.splice(r.indexOf(n),1)}}let Pc=class extends wc.TerraDrawBaseAdapter{constructor(e){super(e),this._lib=void 0,this._map=void 0,this._panes={},this._container=void 0,this._layers={},this._lib=e.lib,this._map=e.map,this._container=this._map.getContainer()}createPaneStyleSheet(e,n){const r=document.createElement("style");return r.innerHTML=`.leaflet-${e}-pane {z-index: ${n+600}`,document.getElementsByTagName("head")[0].appendChild(r),this._map.createPane(e),r}clearPanes(){Object.values(this._panes).forEach(e=>{e&&e.remove()}),this._panes={}}clearLayers(){Object.values(this._layers).forEach(e=>{this._map.removeLayer(e)}),this._layers={}}styleGeoJSONLayer(e){return{pointToLayer:(n,r)=>{if(!n.properties)throw new Error("Feature has no properties");if(typeof n.properties.mode!="string")throw new Error("Feature mode is not a string");const s=(0,e[n.properties.mode])(n),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),this._lib.circleMarker(r,{radius:s.pointWidth,stroke:s.pointOutlineWidth||!1,color:s.pointOutlineColor,weight:s.pointOutlineWidth,fillOpacity:.8,fillColor:s.pointColor,pane:a,interactive:!1})},style:n=>{if(!n||!n.properties)return{};const r=n,s=(0,e[r.properties.mode])(r),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),r.geometry.type==="LineString"?{interactive:!1,color:s.lineStringColor,weight:s.lineStringWidth,pane:a}:r.geometry.type==="Polygon"?{interactive:!1,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,weight:s.polygonOutlineWidth,stroke:!0,color:s.polygonOutlineColor,pane:a}:{}}}}getLngLatFromEvent(e){const{containerX:n,containerY:r}=this.getMapElementXYPosition(e),s=this._map.containerPointToLatLng({x:n,y:r});return s.lng===null||isNaN(s.lng)||s.lat===null||isNaN(s.lat)?null:{lng:s.lng,lat:s.lat}}getMapEventElement(){return this._container}setDraggability(e){e?this._map.dragging.enable():this._map.dragging.disable()}project(e,n){const{x:r,y:s}=this._map.latLngToContainerPoint({lng:e,lat:n});return{x:r,y:s}}unproject(e,n){const{lng:r,lat:s}=this._map.containerPointToLatLng({x:e,y:n});return{lng:r,lat:s}}setCursor(e){e==="unset"?this.getMapEventElement().style.removeProperty("cursor"):this.getMapEventElement().style.cursor=e}setDoubleClickToZoom(e){e?this._map.doubleClickZoom.enable():this._map.doubleClickZoom.disable()}render(e,n){if(e.created.forEach(r=>{r.id&&(this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),e.deletedIds.forEach(r=>{this._layers[r]&&(this._map.removeLayer(this._layers[r]),delete this._layers[r])}),e.updated.forEach(r=>{r.id&&(this._layers[r.id]&&this._map.removeLayer(this._layers[r.id]),this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),e.created.length===0&&e.updated.length===0&&e.deletedIds.length===0){const r=[];Object.keys(this._layers).forEach(s=>{r.push(()=>{const a=this._layers[s],l=a.toGeoJSON();this._map.removeLayer(a);const u=this._lib.geoJSON(l,this.styleGeoJSONLayer(n));this._layers[s]=u,u.addTo(this._map),this._map.addLayer(this._layers[s])})}),setTimeout(()=>{r.forEach(s=>s())})}}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers(),this.clearPanes())}register(e){var n;super.register(e),(n=this._currentModeCallbacks)!=null&&n.onReady&&this._currentModeCallbacks.onReady()}getCoordinatePrecision(){return super.getCoordinatePrecision()}unregister(){return super.unregister()}};function Er(){return Er=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Er.apply(null,arguments)}var Dr;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(Dr||(Dr={}));function vr(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}const Mc="Feature mode property does not match the mode being added to";var Ir;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(Ir||(Ir={}));class Lc{get state(){return this._state}set state(e){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(e){if(typeof e!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=e}registerBehaviors(e){}constructor(e,n=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=Ir.Drawing,this.mode="base",n||this.updateOptions(e)}updateOptions(e){e!=null&&e.styles&&(this.styles=Er({},this._styles,e.styles)),e!=null&&e.pointerDistance&&(this.pointerDistance=e.pointerDistance),e!=null&&e.validation&&(this.validate=e&&e.validation),e!=null&&e.projection&&(this.projection=e.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(e){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=e.store,this.store.registerOnChange(e.onChange),this.setDoubleClickToZoom=e.setDoubleClickToZoom,this.project=e.project,this.unproject=e.unproject,this.onSelect=e.onSelect,this.onDeselect=e.onDeselect,this.setCursor=e.setCursor,this.onStyleChange=e.onChange,this.onFinish=e.onFinish,this.coordinatePrecision=e.coordinatePrecision,this.registerBehaviors({mode:e.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:e.coordinatePrecision,projection:this.projection})}validateFeature(e){return this.performFeatureValidation(e)}afterFeatureAdded(e){}performFeatureValidation(e){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=function(r,s){let a;if(vr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(vr(r.geometry))if(vr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}}(e,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(e,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:Dr.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(e,n){const r=this.performFeatureValidation(e);return r.valid?e.properties.mode!==this.mode?{valid:!1,reason:Mc}:n(e):{valid:!1,reason:r.reason}}onFinish(e,n){}onDeselect(e){}onSelect(e){}onKeyDown(e){}onKeyUp(e){}onMouseMove(e){}onClick(e){}onDragStart(e,n){}onDrag(e,n){}onDragEnd(e,n){}getHexColorStylingValue(e,n,r){return this.getStylingValue(e,n,r)}getNumericStylingValue(e,n,r){return this.getStylingValue(e,n,r)}getStylingValue(e,n,r){return e===void 0?n:typeof e=="function"?e(r):e}}var Cc={__proto__:null,TerraDrawBaseDrawMode:Lc};const{TerraDrawBaseDrawMode:Sc}=Cc;class kc extends Sc{constructor(e){if(super(e),this.mode="routesnap",this.currentCoordinate=0,this.currentPointIds=[],this.routeId=0,this.pixelDistance=(n,r)=>{const{x:s,y:a}=n,{x:l,y:u}=r,d=l-s,_=u-a;return Math.sqrt(_*_+d*d)},this.routing=e.routing,this.maxPoints=e.maxPoints||1,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const n={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?{...n,...e.keyEvents}:n}}measure(e,n){const{x:r,y:s}=this.project(n[0],n[1]);return this.pixelDistance({x:r,y:s},{x:e.containerX,y:e.containerY})}close(){this.currentId&&(this.currentCoordinate=0,this.currentId=void 0,this.currentPointIds=[],this.state==="drawing"&&this.setStarted())}registerBehaviors(e){}start(){this.setStarted(),this.setCursor("crosshair")}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(e){if(this.setCursor("crosshair"),!this.currentId||this.currentCoordinate===0)return;if(this.currentId){const u=this.store.getGeometryCopy(this.currentId);if(this.measure(e,u.coordinates[u.coordinates.length-1])<this.pointerDistance){this.setCursor("pointer"),this.moveLineId&&(this.store.delete([this.moveLineId]),this.moveLineId=void 0);return}}const n=this.store.getGeometryCopy(this.currentId),r=[e.lng,e.lat];let s=this.routing.getClosestNetworkCoordinate(r);if(!s)return;const a=n.coordinates.length-1,l=this.routing.getRoute(n.coordinates[a],s);if(l)if(this.moveLineId)this.store.updateGeometry([{id:this.moveLineId,geometry:l.geometry}]);else{const[u]=this.store.create([{geometry:l.geometry,properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.moveLineId=u}}onClick(e){if(e.button==="right")return;this.setCursor("pointer");const n=[e.lng,e.lat];if(this.currentId){const s=this.store.getGeometryCopy(this.currentId);if(this.measure(e,s.coordinates[s.coordinates.length-1])<this.pointerDistance){this.currentCoordinate===1&&this.store.delete(this.currentPointIds),this.close();return}}else this.routeId++;let r=this.routing.getClosestNetworkCoordinate(n);if(this.currentCoordinate===0){if(r){const[s,a]=this.store.create([{geometry:{type:"LineString",coordinates:[r]},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}},{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentId=s,this.currentPointIds.push(a),this.currentCoordinate++,this.state==="started"&&this.setDrawing()}}else if(this.currentCoordinate===1&&this.currentId&&r){const s=this.store.getGeometryCopy(this.currentId),a=this.routing.getRoute(s.coordinates[0],r);if(a){this.store.updateGeometry([{id:this.currentId,geometry:a==null?void 0:a.geometry}]);const[l]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentCoordinate=2,this.currentPointIds.push(l)}if(this.maxPoints===1){this.close();return}}else if(this.currentCoordinate>1&&this.currentId&&r&&this.currentCoordinate<=this.maxPoints){const s=this.store.getGeometryCopy(this.currentId),a=s.coordinates.length-1,l=this.routing.getRoute(s.coordinates[a],r);if(l){const u={...s,coordinates:[...s.coordinates,...l.geometry.coordinates]};this.store.updateGeometry([{id:this.currentId,geometry:u}]);const[d]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.maxPoints===this.currentCoordinate?this.close():(this.currentCoordinate++,this.currentPointIds.push(d))}}}onKeyDown(){}onKeyUp(e){e.key===this.keyEvents.cancel&&this.cleanUp(),e.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){try{this.currentId&&this.store.delete([this.currentId,...this.currentPointIds])}catch{}this.currentId=void 0,this.moveLineId=void 0,this.currentCoordinate=0,this.state==="drawing"&&this.setStarted()}styleFeature(e){const n={polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#B90E0A",pointOutlineColor:"#ffffff",pointOutlineWidth:2,pointWidth:5,lineStringColor:"#B90E0A",lineStringWidth:4,zIndex:0};return e.type==="Feature"&&e.geometry.type==="LineString"&&e.properties.mode===this.mode?(n.lineStringColor=this.getHexColorStylingValue(this.styles.lineStringColor,"#B90E0A",e),n.zIndex=10,n.lineStringWidth=this.getNumericStylingValue(this.styles.lineStringWidth,4,e),n):(e.type==="Feature"&&e.geometry.type==="Point"&&e.properties.mode===this.mode&&(console.log("point"),n.pointColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",e),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",e),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.routePointOutlineWidth,1,e)),n)}}function Br(i,e,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;Ha(i,e,l,r,s,a%2),Br(i,e,n,r,l-1,a+1),Br(i,e,n,l+1,s,a+1)}function Ha(i,e,n,r,s,a){for(;s>r;){if(s-r>600){const _=s-r+1,f=n-r+1,g=Math.log(_),w=.5*Math.exp(2*g/3),b=.5*Math.sqrt(g*w*(_-w)/_)*(f-_/2<0?-1:1),M=Math.max(r,Math.floor(n-f*w/_+b)),C=Math.min(s,Math.floor(n+(_-f)*w/_+b));Ha(i,e,n,M,C,a)}const l=e[2*n+a];let u=r,d=s;for(gi(i,e,r,n),e[2*s+a]>l&&gi(i,e,r,s);u<d;){for(gi(i,e,u,d),u++,d--;e[2*u+a]<l;)u++;for(;e[2*d+a]>l;)d--}e[2*r+a]===l?gi(i,e,r,d):(d++,gi(i,e,d,s)),d<=n&&(r=d+1),n<=d&&(s=d-1)}}function gi(i,e,n,r){yr(i,n,r),yr(e,2*n,2*r),yr(e,2*n+1,2*r+1)}function yr(i,e,n){const r=i[e];i[e]=i[n],i[n]=r}function Tc(i,e,n,r,s,a,l){const u=[0,i.length-1,0],d=[];let _,f;for(;u.length;){const g=u.pop(),w=u.pop(),b=u.pop();if(w-b<=l){for(let I=b;I<=w;I++)_=e[2*I],f=e[2*I+1],_>=n&&_<=s&&f>=r&&f<=a&&d.push(i[I]);continue}const M=Math.floor((b+w)/2);_=e[2*M],f=e[2*M+1],_>=n&&_<=s&&f>=r&&f<=a&&d.push(i[M]);const C=(g+1)%2;(g===0?n<=_:r<=f)&&(u.push(b),u.push(M-1),u.push(C)),(g===0?s>=_:a>=f)&&(u.push(M+1),u.push(w),u.push(C))}return d}function Ec(i,e,n,r,s,a){const l=[0,i.length-1,0],u=[],d=s*s;for(;l.length;){const _=l.pop(),f=l.pop(),g=l.pop();if(f-g<=a){for(let I=g;I<=f;I++)Bs(e[2*I],e[2*I+1],n,r)<=d&&u.push(i[I]);continue}const w=Math.floor((g+f)/2),b=e[2*w],M=e[2*w+1];Bs(b,M,n,r)<=d&&u.push(i[w]);const C=(_+1)%2;(_===0?n-s<=b:r-s<=M)&&(l.push(g),l.push(w-1),l.push(C)),(_===0?n+s>=b:r+s>=M)&&(l.push(w+1),l.push(f),l.push(C))}return u}function Bs(i,e,n,r){const s=i-n,a=e-r;return s*s+a*a}const Dc=i=>i[0],Ic=i=>i[1];class Bc{constructor(e,n=Dc,r=Ic,s=64,a=Float64Array){this.nodeSize=s,this.points=e;const l=e.length<65536?Uint16Array:Uint32Array,u=this.ids=new l(e.length),d=this.coords=new a(e.length*2);for(let _=0;_<e.length;_++)u[_]=_,d[2*_]=n(e[_]),d[2*_+1]=r(e[_]);Br(u,d,s,0,u.length-1,0)}range(e,n,r,s){return Tc(this.ids,this.coords,e,n,r,s,this.nodeSize)}within(e,n,r){return Ec(this.ids,this.coords,e,n,r,this.nodeSize)}}var Qr={},to={exports:{}};to.exports=Ii;to.exports.default=Ii;function Ii(i,e){if(!(this instanceof Ii))return new Ii(i,e);if(this.data=i||[],this.length=this.data.length,this.compare=e||zc,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function zc(i,e){return i<e?-1:i>e?1:0}Ii.prototype={push:function(i){this.data.push(i),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var i=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),i}},peek:function(){return this.data[0]},_up:function(i){for(var e=this.data,n=this.compare,r=e[i];i>0;){var s=i-1>>1,a=e[s];if(n(r,a)>=0)break;e[i]=a,i=s}e[i]=r},_down:function(i){for(var e=this.data,n=this.compare,r=this.length>>1,s=e[i];i<r;){var a=(i<<1)+1,l=a+1,u=e[a];if(l<this.length&&n(e[l],u)<0&&(a=l,u=e[l]),n(u,s)>=0)break;e[i]=u,i=a}e[i]=s}};var Oc=to.exports,Ac=Oc;Qr.around=Fc;Qr.distance=Rc;var Ga=6371,zs=40007,pe=Math.PI/180;function Fc(i,e,n,r,s,a){var l=[];r===void 0&&(r=1/0),s===void 0&&(s=1/0);for(var u=Math.cos(n*pe),d=Math.sin(n*pe),_=Ac(null,Zc),f={left:0,right:i.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};f;){var g=f.right,w=f.left;if(g-w<=i.nodeSize)for(var b=w;b<=g;b++){var M=i.points[i.ids[b]];(!a||a(M))&&_.push({item:M,dist:zr(e,n,i.coords[2*b],i.coords[2*b+1],u,d)})}else{var C=w+g>>1,I=i.coords[2*C],A=i.coords[2*C+1];M=i.points[i.ids[C]],(!a||a(M))&&_.push({item:M,dist:zr(e,n,I,A,u,d)});var m=(f.axis+1)%2,x={left:w,right:C-1,axis:m,minLng:f.minLng,minLat:f.minLat,maxLng:f.axis===0?I:f.maxLng,maxLat:f.axis===1?A:f.maxLat,dist:0},P={left:C+1,right:g,axis:m,minLng:f.axis===0?I:f.minLng,minLat:f.axis===1?A:f.minLat,maxLng:f.maxLng,maxLat:f.maxLat,dist:0};x.dist=Os(e,n,x,u,d),P.dist=Os(e,n,P,u,d),_.push(x),_.push(P)}for(;_.length&&_.peek().item;){var k=_.pop();if(k.dist>s||(l.push(k.item),l.length===r))return l}f=_.pop()}return l}function Os(i,e,n,r,s){var a=n.minLng,l=n.maxLng,u=n.minLat,d=n.maxLat;if(i>=a&&i<=l)return e<=u?zs*(u-e)/360:e>=d?zs*(e-d)/360:0;var _=(a-i+360)%360<=(i-l+360)%360?a:l,f=Math.cos((_-i)*pe),g=Math.atan(s/(r*f))/pe,w=Math.max(vn(u,r,s,f),vn(d,r,s,f));return g>u&&g<d&&(w=Math.max(w,vn(g,r,s,f))),Ga*Math.acos(w)}function Zc(i,e){return i.dist-e.dist}function zr(i,e,n,r,s,a){var l=Math.cos((n-i)*pe);return Ga*Math.acos(vn(r,s,a,l))}function vn(i,e,n,r){var s=n*Math.sin(i*pe)+e*Math.cos(i*pe)*r;return Math.min(s,1)}function Rc(i,e,n,r){return zr(i,e,n,r,Math.cos(e*pe),Math.sin(e*pe))}class Nc{constructor(e){this.useCache=!0,this._routeCache={},this.useCache=e.useCache||!0,this.network=e.network,this.routeFinder=e.routeFinder;const n=[];this.network.features.forEach(r=>{r.geometry.coordinates.forEach(s=>{n.push(s)})}),this.indexedNetworkPoints=new Bc(n)}getClosestNetworkCoordinate(e){const n=Qr.around(this.indexedNetworkPoints,e[0],e[1],1);return n?n[0]:void 0}getRoute(e,n){if(this.useCache){const l=`${e}-${n}`;if(this._routeCache[l])return this._routeCache[l]}const r={type:"Feature",geometry:{type:"Point",coordinates:e},properties:{}},s={type:"Feature",geometry:{type:"Point",coordinates:n},properties:{}},a=this.routeFinder.getRoute(r,s);if(this.useCache){const l=`${e}-${n}`;return this._routeCache[l]=a,a}return a}}class jc{constructor(){this.heap=[],this.insertCounter=0}insert(e,n){const r={key:e,value:n,index:this.insertCounter++};let s=this.heap.length;for(this.heap.push(r);s>0;){const a=s-1>>>1,l=this.heap[a];if(r.key>l.key||r.key===l.key&&r.index>l.index)break;this.heap[s]=l,s=a}this.heap[s]=r}extractMin(){const e=this.heap.length;if(e===0)return null;const n=this.heap[0],r=this.heap.pop();return e>1&&(this.heap[0]=r,this.bubbleDown(0)),n.value}size(){return this.heap.length}bubbleDown(e){const n=this.heap.length,r=this.heap[e];for(;;){const s=(e<<1)+1,a=s+1;let l=e;if(s<n&&(this.heap[s].key<this.heap[l].key||this.heap[s].key===this.heap[l].key&&this.heap[s].index<this.heap[l].index)&&(l=s),a<n&&(this.heap[a].key<this.heap[l].key||this.heap[a].key===this.heap[l].key&&this.heap[a].index<this.heap[l].index)&&(l=a),l===e)break;this.heap[e]=this.heap[l],this.heap[l]=r,e=l}}}const Wc=(i,e)=>{const n=b=>b*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(e[1]),l=n(e[0]),u=a-r,d=l-s,_=Math.sin(u/2)*Math.sin(u/2)+Math.cos(r)*Math.cos(a)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_)))/1e3};class Yc{constructor(e,n){this.network=e,this.adjacencyList=new Map,this.coords=[],this.coordMap=new Map,this.distanceMeasurement=n||Wc,this.buildNetworkGraph()}coordinateIndex(e){const[n,r]=e;this.coordMap.has(n)||this.coordMap.set(n,new Map);const s=this.coordMap.get(n);if(s.has(r))return s.get(r);const a=this.coords.length;return this.coords.push(e),s.set(r,a),a}buildNetworkGraph(){for(const e of this.network.features){const n=e.geometry.coordinates;for(let r=0;r<n.length-1;r++){const s=this.coordinateIndex(n[r]),a=this.coordinateIndex(n[r+1]),l=this.distanceMeasurement(n[r],n[r+1]);this.adjacencyList.has(s)||this.adjacencyList.set(s,[]),this.adjacencyList.has(a)||this.adjacencyList.set(a,[]),this.adjacencyList.get(s).push({node:a,distance:l}),this.adjacencyList.get(a).push({node:s,distance:l})}}}getRoute(e,n){const r=this.coordinateIndex(e.geometry.coordinates),s=this.coordinateIndex(n.geometry.coordinates),a=new jc;a.insert(0,r);const l=new Map,u=new Map([[r,0]]);for(;a.size()>0;){const d=a.extractMin();if(d===s){const _=[];let f=d;for(;f!==void 0;)_.unshift(this.coords[f]),f=l.get(f);return{type:"Feature",geometry:{type:"LineString",coordinates:_},properties:{}}}for(const _ of this.adjacencyList.get(d)||[]){const f=(u.get(d)??1/0)+_.distance;if(f<(u.get(_.node)??1/0)){l.set(_.node,d),u.set(_.node,f);const g=f+this.distanceMeasurement(this.coords[_.node],this.coords[s]);a.insert(g,_.node)}}}return null}}function Xc(i){const n=.0033528106647474805,r=n*(2-n),s=Math.PI/180,a=Math.cos(i*s),l=1/(1-r*(1-a*a)),u=Math.sqrt(l),d=s*6378.137,_=d*u*a,f=d*u*l*(1-r);return function(w,b){let M=w[0]-b[0];for(;M<-180;)M+=360;for(;M>180;)M-=360;const C=M*_,I=(w[1]-b[1])*f;return Math.sqrt(C*C+I*I)}}function As(){const i=[[30,60],[190,250],[260,290]],[e,n]=i[Math.floor(Math.random()*i.length)],r=Math.floor(Math.random()*(n-e+1))+e,s=60+Math.random()*20,a=50+Math.random()*10;return Uc(r,s,a)}function Uc(i,e,n){e/=100,n/=100;const r=l=>(l+i/30)%12,s=e*Math.min(n,1-n),a=l=>Math.round(255*(n-s*Math.max(-1,Math.min(r(l)-3,Math.min(9-r(l),1)))));return`#${[a(0),a(8),a(4)].map(l=>l.toString(16).padStart(2,"0")).join("")}`}function Vc(i,e,n){const r=Xc(n.features[0].geometry.coordinates[0][1]),s=new Yc(n,r),a=new Nc({network:n,useCache:!1,routeFinder:s}),l={};return new bc({adapter:new Pc({lib:e,map:i,coordinatePrecision:9}),modes:[new tc({modeName:"networkOutline",styles:{polygonOutlineColor:"#d1cfcf",polygonFillColor:"#eeeeee",polygonFillOpacity:.2,polygonOutlineWidth:2}}),new kc({routing:a,maxPoints:5,styles:{lineStringColor:d=>(l[d.properties.routeId]||(l[d.properties.routeId]=As()),l[d.properties.routeId]),routePointColor:d=>(console.log("routePointColor",d.properties.routeId),l[d.properties.routeId]||(l[d.properties.routeId]=As()),l[d.properties.routeId])}}),new dc({flags:{routesnap:{feature:{coordinates:{}}}}})]})}var Hc=Object.create,An=Object.defineProperty,Gc=Object.getOwnPropertyDescriptor,qc=Object.getOwnPropertyNames,Fs=Object.getOwnPropertySymbols,$c=Object.getPrototypeOf,qa=Object.prototype.hasOwnProperty,Kc=Object.prototype.propertyIsEnumerable,Zs=(i,e,n)=>e in i?An(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,Jc=(i,e)=>{for(var n in e||(e={}))qa.call(e,n)&&Zs(i,n,e[n]);if(Fs)for(var n of Fs(e))Kc.call(e,n)&&Zs(i,n,e[n]);return i},Qc=i=>An(i,"__esModule",{value:!0}),Qt=(i,e)=>function(){return e||(0,i[Object.keys(i)[0]])((e={exports:{}}).exports,e),e.exports},td=(i,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of qc(e))!qa.call(i,r)&&r!=="default"&&An(i,r,{get:()=>e[r],enumerable:!(n=Gc(e,r))||n.enumerable});return i},jt=i=>td(Qc(An(i!=null?Hc($c(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),ti=(i,e,n)=>new Promise((r,s)=>{var a=d=>{try{u(n.next(d))}catch(_){s(_)}},l=d=>{try{u(n.throw(d))}catch(_){s(_)}},u=d=>d.done?r(d.value):Promise.resolve(d.value).then(a,l);u((n=n.apply(i,e)).next())}),_e=Qt({"node_modules/@mapbox/point-geometry/index.js"(i,e){e.exports=n;function n(r,s){this.x=r,this.y=s}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,a=r.y-this.y;return s*s+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=s,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),a=Math.sin(r),l=s*this.x-a*this.y,u=a*this.x+s*this.y;return this.x=l,this.y=u,this},_rotateAround:function(r,s){var a=Math.cos(r),l=Math.sin(r),u=s.x+a*(this.x-s.x)-l*(this.y-s.y),d=s.y+l*(this.x-s.x)+a*(this.y-s.y);return this.x=u,this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(r){return r instanceof n?r:Array.isArray(r)?new n(r[0],r[1]):r}}}),$a=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(i,e){var n=_e();e.exports=r;function r(d,_,f,g,w){this.properties={},this.extent=f,this.type=0,this._pbf=d,this._geometry=-1,this._keys=g,this._values=w,d.readFields(s,this,_)}function s(d,_,f){d==1?_.id=f.readVarint():d==2?a(f,_):d==3?_.type=f.readVarint():d==4&&(_._geometry=f.pos)}function a(d,_){for(var f=d.readVarint()+d.pos;d.pos<f;){var g=_._keys[d.readVarint()],w=_._values[d.readVarint()];_.properties[g]=w}}r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,f=1,g=0,w=0,b=0,M=[],C;d.pos<_;){if(g<=0){var I=d.readVarint();f=I&7,g=I>>3}if(g--,f===1||f===2)w+=d.readSVarint(),b+=d.readSVarint(),f===1&&(C&&M.push(C),C=[]),C.push(new n(w,b));else if(f===7)C&&C.push(C[0].clone());else throw new Error("unknown command "+f)}return C&&M.push(C),M},r.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,f=1,g=0,w=0,b=0,M=1/0,C=-1/0,I=1/0,A=-1/0;d.pos<_;){if(g<=0){var m=d.readVarint();f=m&7,g=m>>3}if(g--,f===1||f===2)w+=d.readSVarint(),b+=d.readSVarint(),w<M&&(M=w),w>C&&(C=w),b<I&&(I=b),b>A&&(A=b);else if(f!==7)throw new Error("unknown command "+f)}return[M,I,C,A]},r.prototype.toGeoJSON=function(d,_,f){var g=this.extent*Math.pow(2,f),w=this.extent*d,b=this.extent*_,M=this.loadGeometry(),C=r.types[this.type],I,A;function m(k){for(var E=0;E<k.length;E++){var T=k[E],B=180-(T.y+b)*360/g;k[E]=[(T.x+w)*360/g-180,360/Math.PI*Math.atan(Math.exp(B*Math.PI/180))-90]}}switch(this.type){case 1:var x=[];for(I=0;I<M.length;I++)x[I]=M[I][0];M=x,m(M);break;case 2:for(I=0;I<M.length;I++)m(M[I]);break;case 3:for(M=l(M),I=0;I<M.length;I++)for(A=0;A<M[I].length;A++)m(M[I][A]);break}M.length===1?M=M[0]:C="Multi"+C;var P={type:"Feature",geometry:{type:C,coordinates:M},properties:this.properties};return"id"in this&&(P.id=this.id),P};function l(d){var _=d.length;if(_<=1)return[d];for(var f=[],g,w,b=0;b<_;b++){var M=u(d[b]);M!==0&&(w===void 0&&(w=M<0),w===M<0?(g&&f.push(g),g=[d[b]]):g.push(d[b]))}return g&&f.push(g),f}function u(d){for(var _=0,f=0,g=d.length,w=g-1,b,M;f<g;w=f++)b=d[f],M=d[w],_+=(M.x-b.x)*(b.y+M.y);return _}}}),Ka=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(i,e){var n=$a();e.exports=r;function r(l,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,u),this.length=this._features.length}function s(l,u,d){l===15?u.version=d.readVarint():l===1?u.name=d.readString():l===5?u.extent=d.readVarint():l===2?u._features.push(d.pos):l===3?u._keys.push(d.readString()):l===4&&u._values.push(a(d))}function a(l){for(var u=null,d=l.readVarint()+l.pos;l.pos<d;){var _=l.readVarint()>>3;u=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return u}r.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var u=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,u,this.extent,this._keys,this._values)}}}),ed=Qt({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(i,e){var n=Ka();e.exports=r;function r(a,l){this.layers=a.readFields(s,{},l)}function s(a,l,u){if(a===3){var d=new n(u,u.readVarint()+u.pos);d.length&&(l[d.name]=d)}}}}),id=Qt({"node_modules/@mapbox/vector-tile/index.js"(i,e){e.exports.VectorTile=ed(),e.exports.VectorTileFeature=$a(),e.exports.VectorTileLayer=Ka()}}),nd=Qt({"node_modules/ieee754/index.js"(i){i.read=function(e,n,r,s,a){var l,u,d=a*8-s-1,_=(1<<d)-1,f=_>>1,g=-7,w=r?a-1:0,b=r?-1:1,M=e[n+w];for(w+=b,l=M&(1<<-g)-1,M>>=-g,g+=d;g>0;l=l*256+e[n+w],w+=b,g-=8);for(u=l&(1<<-g)-1,l>>=-g,g+=s;g>0;u=u*256+e[n+w],w+=b,g-=8);if(l===0)l=1-f;else{if(l===_)return u?NaN:(M?-1:1)*(1/0);u=u+Math.pow(2,s),l=l-f}return(M?-1:1)*u*Math.pow(2,l-s)},i.write=function(e,n,r,s,a,l){var u,d,_,f=l*8-a-1,g=(1<<f)-1,w=g>>1,b=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=s?0:l-1,C=s?1:-1,I=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(d=isNaN(n)?1:0,u=g):(u=Math.floor(Math.log(n)/Math.LN2),n*(_=Math.pow(2,-u))<1&&(u--,_*=2),u+w>=1?n+=b/_:n+=b*Math.pow(2,1-w),n*_>=2&&(u++,_/=2),u+w>=g?(d=0,u=g):u+w>=1?(d=(n*_-1)*Math.pow(2,a),u=u+w):(d=n*Math.pow(2,w-1)*Math.pow(2,a),u=0));a>=8;e[r+M]=d&255,M+=C,d/=256,a-=8);for(u=u<<a|d,f+=a;f>0;e[r+M]=u&255,M+=C,u/=256,f-=8);e[r+M-C]|=I*128}}}),rd=Qt({"node_modules/pbf/index.js"(i,e){e.exports=r;var n=nd();function r(v){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(v)?v:new Uint8Array(v||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=65536*65536,a=1/s,l=12,u=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(v,D,z){for(z=z||this.length;this.pos<z;){var V=this.readVarint(),N=V>>3,K=this.pos;this.type=V&7,v(N,D,this),this.pos===K&&this.skip(V)}return D},readMessage:function(v,D){return this.readFields(v,D,this.readVarint()+this.pos)},readFixed32:function(){var v=B(this.buf,this.pos);return this.pos+=4,v},readSFixed32:function(){var v=j(this.buf,this.pos);return this.pos+=4,v},readFixed64:function(){var v=B(this.buf,this.pos)+B(this.buf,this.pos+4)*s;return this.pos+=8,v},readSFixed64:function(){var v=B(this.buf,this.pos)+j(this.buf,this.pos+4)*s;return this.pos+=8,v},readFloat:function(){var v=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,v},readDouble:function(){var v=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,v},readVarint:function(v){var D=this.buf,z,V;return V=D[this.pos++],z=V&127,V<128||(V=D[this.pos++],z|=(V&127)<<7,V<128)||(V=D[this.pos++],z|=(V&127)<<14,V<128)||(V=D[this.pos++],z|=(V&127)<<21,V<128)?z:(V=D[this.pos],z|=(V&15)<<28,d(z,v,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var v=this.readVarint();return v%2===1?(v+1)/-2:v/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var v=this.readVarint()+this.pos,D=this.pos;return this.pos=v,v-D>=l&&u?U(this.buf,D,v):W(this.buf,D,v)},readBytes:function(){var v=this.readVarint()+this.pos,D=this.buf.subarray(this.pos,v);return this.pos=v,D},readPackedVarint:function(v,D){if(this.type!==r.Bytes)return v.push(this.readVarint(D));var z=_(this);for(v=v||[];this.pos<z;)v.push(this.readVarint(D));return v},readPackedSVarint:function(v){if(this.type!==r.Bytes)return v.push(this.readSVarint());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readSVarint());return v},readPackedBoolean:function(v){if(this.type!==r.Bytes)return v.push(this.readBoolean());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readBoolean());return v},readPackedFloat:function(v){if(this.type!==r.Bytes)return v.push(this.readFloat());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readFloat());return v},readPackedDouble:function(v){if(this.type!==r.Bytes)return v.push(this.readDouble());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readDouble());return v},readPackedFixed32:function(v){if(this.type!==r.Bytes)return v.push(this.readFixed32());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readFixed32());return v},readPackedSFixed32:function(v){if(this.type!==r.Bytes)return v.push(this.readSFixed32());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readSFixed32());return v},readPackedFixed64:function(v){if(this.type!==r.Bytes)return v.push(this.readFixed64());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readFixed64());return v},readPackedSFixed64:function(v){if(this.type!==r.Bytes)return v.push(this.readSFixed64());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readSFixed64());return v},skip:function(v){var D=v&7;if(D===r.Varint)for(;this.buf[this.pos++]>127;);else if(D===r.Bytes)this.pos=this.readVarint()+this.pos;else if(D===r.Fixed32)this.pos+=4;else if(D===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+D)},writeTag:function(v,D){this.writeVarint(v<<3|D)},realloc:function(v){for(var D=this.length||16;D<this.pos+v;)D*=2;if(D!==this.length){var z=new Uint8Array(D);z.set(this.buf),this.buf=z,this.length=D}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(v){this.realloc(4),R(this.buf,v,this.pos),this.pos+=4},writeSFixed32:function(v){this.realloc(4),R(this.buf,v,this.pos),this.pos+=4},writeFixed64:function(v){this.realloc(8),R(this.buf,v&-1,this.pos),R(this.buf,Math.floor(v*a),this.pos+4),this.pos+=8},writeSFixed64:function(v){this.realloc(8),R(this.buf,v&-1,this.pos),R(this.buf,Math.floor(v*a),this.pos+4),this.pos+=8},writeVarint:function(v){if(v=+v||0,v>268435455||v<0){g(v,this);return}this.realloc(4),this.buf[this.pos++]=v&127|(v>127?128:0),!(v<=127)&&(this.buf[this.pos++]=(v>>>=7)&127|(v>127?128:0),!(v<=127)&&(this.buf[this.pos++]=(v>>>=7)&127|(v>127?128:0),!(v<=127)&&(this.buf[this.pos++]=v>>>7&127)))},writeSVarint:function(v){this.writeVarint(v<0?-v*2-1:v*2)},writeBoolean:function(v){this.writeVarint(!!v)},writeString:function(v){v=String(v),this.realloc(v.length*4),this.pos++;var D=this.pos;this.pos=X(this.buf,v,this.pos);var z=this.pos-D;z>=128&&M(D,z,this),this.pos=D-1,this.writeVarint(z),this.pos+=z},writeFloat:function(v){this.realloc(4),n.write(this.buf,v,this.pos,!0,23,4),this.pos+=4},writeDouble:function(v){this.realloc(8),n.write(this.buf,v,this.pos,!0,52,8),this.pos+=8},writeBytes:function(v){var D=v.length;this.writeVarint(D),this.realloc(D);for(var z=0;z<D;z++)this.buf[this.pos++]=v[z]},writeRawMessage:function(v,D){this.pos++;var z=this.pos;v(D,this);var V=this.pos-z;V>=128&&M(z,V,this),this.pos=z-1,this.writeVarint(V),this.pos+=V},writeMessage:function(v,D,z){this.writeTag(v,r.Bytes),this.writeRawMessage(D,z)},writePackedVarint:function(v,D){D.length&&this.writeMessage(v,C,D)},writePackedSVarint:function(v,D){D.length&&this.writeMessage(v,I,D)},writePackedBoolean:function(v,D){D.length&&this.writeMessage(v,x,D)},writePackedFloat:function(v,D){D.length&&this.writeMessage(v,A,D)},writePackedDouble:function(v,D){D.length&&this.writeMessage(v,m,D)},writePackedFixed32:function(v,D){D.length&&this.writeMessage(v,P,D)},writePackedSFixed32:function(v,D){D.length&&this.writeMessage(v,k,D)},writePackedFixed64:function(v,D){D.length&&this.writeMessage(v,E,D)},writePackedSFixed64:function(v,D){D.length&&this.writeMessage(v,T,D)},writeBytesField:function(v,D){this.writeTag(v,r.Bytes),this.writeBytes(D)},writeFixed32Field:function(v,D){this.writeTag(v,r.Fixed32),this.writeFixed32(D)},writeSFixed32Field:function(v,D){this.writeTag(v,r.Fixed32),this.writeSFixed32(D)},writeFixed64Field:function(v,D){this.writeTag(v,r.Fixed64),this.writeFixed64(D)},writeSFixed64Field:function(v,D){this.writeTag(v,r.Fixed64),this.writeSFixed64(D)},writeVarintField:function(v,D){this.writeTag(v,r.Varint),this.writeVarint(D)},writeSVarintField:function(v,D){this.writeTag(v,r.Varint),this.writeSVarint(D)},writeStringField:function(v,D){this.writeTag(v,r.Bytes),this.writeString(D)},writeFloatField:function(v,D){this.writeTag(v,r.Fixed32),this.writeFloat(D)},writeDoubleField:function(v,D){this.writeTag(v,r.Fixed64),this.writeDouble(D)},writeBooleanField:function(v,D){this.writeVarintField(v,!!D)}};function d(v,D,z){var V=z.buf,N,K;if(K=V[z.pos++],N=(K&112)>>4,K<128||(K=V[z.pos++],N|=(K&127)<<3,K<128)||(K=V[z.pos++],N|=(K&127)<<10,K<128)||(K=V[z.pos++],N|=(K&127)<<17,K<128)||(K=V[z.pos++],N|=(K&127)<<24,K<128)||(K=V[z.pos++],N|=(K&1)<<31,K<128))return f(v,N,D);throw new Error("Expected varint not more than 10 bytes")}function _(v){return v.type===r.Bytes?v.readVarint()+v.pos:v.pos+1}function f(v,D,z){return z?D*4294967296+(v>>>0):(D>>>0)*4294967296+(v>>>0)}function g(v,D){var z,V;if(v>=0?(z=v%4294967296|0,V=v/4294967296|0):(z=~(-v%4294967296),V=~(-v/4294967296),z^4294967295?z=z+1|0:(z=0,V=V+1|0)),v>=18446744073709552e3||v<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");D.realloc(10),w(z,V,D),b(V,D)}function w(v,D,z){z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos]=v&127}function b(v,D){var z=(v&7)<<4;D.buf[D.pos++]|=z|((v>>>=3)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127)))))}function M(v,D,z){var V=D<=16383?1:D<=2097151?2:D<=268435455?3:Math.floor(Math.log(D)/(Math.LN2*7));z.realloc(V);for(var N=z.pos-1;N>=v;N--)z.buf[N+V]=z.buf[N]}function C(v,D){for(var z=0;z<v.length;z++)D.writeVarint(v[z])}function I(v,D){for(var z=0;z<v.length;z++)D.writeSVarint(v[z])}function A(v,D){for(var z=0;z<v.length;z++)D.writeFloat(v[z])}function m(v,D){for(var z=0;z<v.length;z++)D.writeDouble(v[z])}function x(v,D){for(var z=0;z<v.length;z++)D.writeBoolean(v[z])}function P(v,D){for(var z=0;z<v.length;z++)D.writeFixed32(v[z])}function k(v,D){for(var z=0;z<v.length;z++)D.writeSFixed32(v[z])}function E(v,D){for(var z=0;z<v.length;z++)D.writeFixed64(v[z])}function T(v,D){for(var z=0;z<v.length;z++)D.writeSFixed64(v[z])}function B(v,D){return(v[D]|v[D+1]<<8|v[D+2]<<16)+v[D+3]*16777216}function R(v,D,z){v[z]=D,v[z+1]=D>>>8,v[z+2]=D>>>16,v[z+3]=D>>>24}function j(v,D){return(v[D]|v[D+1]<<8|v[D+2]<<16)+(v[D+3]<<24)}function W(v,D,z){for(var V="",N=D;N<z;){var K=v[N],Z=null,H=K>239?4:K>223?3:K>191?2:1;if(N+H>z)break;var G,nt,Q;H===1?K<128&&(Z=K):H===2?(G=v[N+1],(G&192)===128&&(Z=(K&31)<<6|G&63,Z<=127&&(Z=null))):H===3?(G=v[N+1],nt=v[N+2],(G&192)===128&&(nt&192)===128&&(Z=(K&15)<<12|(G&63)<<6|nt&63,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):H===4&&(G=v[N+1],nt=v[N+2],Q=v[N+3],(G&192)===128&&(nt&192)===128&&(Q&192)===128&&(Z=(K&15)<<18|(G&63)<<12|(nt&63)<<6|Q&63,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,H=1):Z>65535&&(Z-=65536,V+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|Z&1023),V+=String.fromCharCode(Z),N+=H}return V}function U(v,D,z){return u.decode(v.subarray(D,z))}function X(v,D,z){for(var V=0,N,K;V<D.length;V++){if(N=D.charCodeAt(V),N>55295&&N<57344)if(K)if(N<56320){v[z++]=239,v[z++]=191,v[z++]=189,K=N;continue}else N=K-55296<<10|N-56320|65536,K=null;else{N>56319||V+1===D.length?(v[z++]=239,v[z++]=191,v[z++]=189):K=N;continue}else K&&(v[z++]=239,v[z++]=191,v[z++]=189,K=null);N<128?v[z++]=N:(N<2048?v[z++]=N>>6|192:(N<65536?v[z++]=N>>12|224:(v[z++]=N>>18|240,v[z++]=N>>12&63|128),v[z++]=N>>6&63|128),v[z++]=N&63|128)}return z}}}),od=Qt({"node_modules/rbush/rbush.min.js"(i,e){(function(n,r){typeof i=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self).RBush=r()})(i,function(){function n(m,x,P,k,E){(function T(B,R,j,W,U){for(;W>j;){if(W-j>600){var X=W-j+1,v=R-j+1,D=Math.log(X),z=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*z*(X-z)/X)*(v-X/2<0?-1:1),N=Math.max(j,Math.floor(R-v*z/X+V)),K=Math.min(W,Math.floor(R+(X-v)*z/X+V));T(B,R,N,K,U)}var Z=B[R],H=j,G=W;for(r(B,j,R),U(B[W],Z)>0&&r(B,j,W);H<G;){for(r(B,H,G),H++,G--;U(B[H],Z)<0;)H++;for(;U(B[G],Z)>0;)G--}U(B[j],Z)===0?r(B,j,G):r(B,++G,W),G<=R&&(j=G+1),R<=G&&(W=G-1)}})(m,x,P||0,k||m.length-1,E||s)}function r(m,x,P){var k=m[x];m[x]=m[P],m[P]=k}function s(m,x){return m<x?-1:m>x?1:0}var a=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(m,x,P){if(!P)return x.indexOf(m);for(var k=0;k<x.length;k++)if(P(m,x[k]))return k;return-1}function u(m,x){d(m,0,m.children.length,x,m)}function d(m,x,P,k,E){E||(E=I(null)),E.minX=1/0,E.minY=1/0,E.maxX=-1/0,E.maxY=-1/0;for(var T=x;T<P;T++){var B=m.children[T];_(E,m.leaf?k(B):B)}return E}function _(m,x){return m.minX=Math.min(m.minX,x.minX),m.minY=Math.min(m.minY,x.minY),m.maxX=Math.max(m.maxX,x.maxX),m.maxY=Math.max(m.maxY,x.maxY),m}function f(m,x){return m.minX-x.minX}function g(m,x){return m.minY-x.minY}function w(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function b(m){return m.maxX-m.minX+(m.maxY-m.minY)}function M(m,x){return m.minX<=x.minX&&m.minY<=x.minY&&x.maxX<=m.maxX&&x.maxY<=m.maxY}function C(m,x){return x.minX<=m.maxX&&x.minY<=m.maxY&&x.maxX>=m.minX&&x.maxY>=m.minY}function I(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function A(m,x,P,k,E){for(var T=[x,P];T.length;)if(!((P=T.pop())-(x=T.pop())<=k)){var B=x+Math.ceil((P-x)/k/2)*k;n(m,B,x,P,E),T.push(x,B,B,P)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(m){var x=this.data,P=[];if(!C(m,x))return P;for(var k=this.toBBox,E=[];x;){for(var T=0;T<x.children.length;T++){var B=x.children[T],R=x.leaf?k(B):B;C(m,R)&&(x.leaf?P.push(B):M(m,R)?this._all(B,P):E.push(B))}x=E.pop()}return P},a.prototype.collides=function(m){var x=this.data;if(!C(m,x))return!1;for(var P=[];x;){for(var k=0;k<x.children.length;k++){var E=x.children[k],T=x.leaf?this.toBBox(E):E;if(C(m,T)){if(x.leaf||M(m,T))return!0;P.push(E)}}x=P.pop()}return!1},a.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var x=0;x<m.length;x++)this.insert(m[x]);return this}var P=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===P.height)this._splitRoot(this.data,P);else{if(this.data.height<P.height){var k=this.data;this.data=P,P=k}this._insert(P,this.data.height-P.height-1,!0)}else this.data=P;return this},a.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},a.prototype.clear=function(){return this.data=I([]),this},a.prototype.remove=function(m,x){if(!m)return this;for(var P,k,E,T=this.data,B=this.toBBox(m),R=[],j=[];T||R.length;){if(T||(T=R.pop(),k=R[R.length-1],P=j.pop(),E=!0),T.leaf){var W=l(m,T.children,x);if(W!==-1)return T.children.splice(W,1),R.push(T),this._condense(R),this}E||T.leaf||!M(T,B)?k?(P++,T=k.children[P],E=!1):T=null:(R.push(T),j.push(P),P=0,k=T,T=T.children[0])}return this},a.prototype.toBBox=function(m){return m},a.prototype.compareMinX=function(m,x){return m.minX-x.minX},a.prototype.compareMinY=function(m,x){return m.minY-x.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(m){return this.data=m,this},a.prototype._all=function(m,x){for(var P=[];m;)m.leaf?x.push.apply(x,m.children):P.push.apply(P,m.children),m=P.pop();return x},a.prototype._build=function(m,x,P,k){var E,T=P-x+1,B=this._maxEntries;if(T<=B)return u(E=I(m.slice(x,P+1)),this.toBBox),E;k||(k=Math.ceil(Math.log(T)/Math.log(B)),B=Math.ceil(T/Math.pow(B,k-1))),(E=I([])).leaf=!1,E.height=k;var R=Math.ceil(T/B),j=R*Math.ceil(Math.sqrt(B));A(m,x,P,j,this.compareMinX);for(var W=x;W<=P;W+=j){var U=Math.min(W+j-1,P);A(m,W,U,R,this.compareMinY);for(var X=W;X<=U;X+=R){var v=Math.min(X+R-1,U);E.children.push(this._build(m,X,v,k-1))}}return u(E,this.toBBox),E},a.prototype._chooseSubtree=function(m,x,P,k){for(;k.push(x),!x.leaf&&k.length-1!==P;){for(var E=1/0,T=1/0,B=void 0,R=0;R<x.children.length;R++){var j=x.children[R],W=w(j),U=(X=m,v=j,(Math.max(v.maxX,X.maxX)-Math.min(v.minX,X.minX))*(Math.max(v.maxY,X.maxY)-Math.min(v.minY,X.minY))-W);U<T?(T=U,E=W<E?W:E,B=j):U===T&&W<E&&(E=W,B=j)}x=B||x.children[0]}var X,v;return x},a.prototype._insert=function(m,x,P){var k=P?m:this.toBBox(m),E=[],T=this._chooseSubtree(k,this.data,x,E);for(T.children.push(m),_(T,k);x>=0&&E[x].children.length>this._maxEntries;)this._split(E,x),x--;this._adjustParentBBoxes(k,E,x)},a.prototype._split=function(m,x){var P=m[x],k=P.children.length,E=this._minEntries;this._chooseSplitAxis(P,E,k);var T=this._chooseSplitIndex(P,E,k),B=I(P.children.splice(T,P.children.length-T));B.height=P.height,B.leaf=P.leaf,u(P,this.toBBox),u(B,this.toBBox),x?m[x-1].children.push(B):this._splitRoot(P,B)},a.prototype._splitRoot=function(m,x){this.data=I([m,x]),this.data.height=m.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(m,x,P){for(var k,E,T,B,R,j,W,U=1/0,X=1/0,v=x;v<=P-x;v++){var D=d(m,0,v,this.toBBox),z=d(m,v,P,this.toBBox),V=(E=D,T=z,B=void 0,R=void 0,j=void 0,W=void 0,B=Math.max(E.minX,T.minX),R=Math.max(E.minY,T.minY),j=Math.min(E.maxX,T.maxX),W=Math.min(E.maxY,T.maxY),Math.max(0,j-B)*Math.max(0,W-R)),N=w(D)+w(z);V<U?(U=V,k=v,X=N<X?N:X):V===U&&N<X&&(X=N,k=v)}return k||P-x},a.prototype._chooseSplitAxis=function(m,x,P){var k=m.leaf?this.compareMinX:f,E=m.leaf?this.compareMinY:g;this._allDistMargin(m,x,P,k)<this._allDistMargin(m,x,P,E)&&m.children.sort(k)},a.prototype._allDistMargin=function(m,x,P,k){m.children.sort(k);for(var E=this.toBBox,T=d(m,0,x,E),B=d(m,P-x,P,E),R=b(T)+b(B),j=x;j<P-x;j++){var W=m.children[j];_(T,m.leaf?E(W):W),R+=b(T)}for(var U=P-x-1;U>=x;U--){var X=m.children[U];_(B,m.leaf?E(X):X),R+=b(B)}return R},a.prototype._adjustParentBBoxes=function(m,x,P){for(var k=P;k>=0;k--)_(x[k],m)},a.prototype._condense=function(m){for(var x=m.length-1,P=void 0;x>=0;x--)m[x].children.length===0?x>0?(P=m[x-1].children).splice(P.indexOf(m[x]),1):this.clear():u(m[x],this.toBBox)},a})}}),sd=Qt({"src/types/unitbezier.d.ts"(){}}),ad=Qt({"node_modules/tinyqueue/tinyqueue.js"(i,e){(function(n,r){typeof i=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self,n.TinyQueue=r())})(i,function(){var n=function(a,l){if(a===void 0&&(a=[]),l===void 0&&(l=r),this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};n.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var a=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),a}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(a){for(var l=this,u=l.data,d=l.compare,_=u[a];a>0;){var f=a-1>>1,g=u[f];if(d(_,g)>=0)break;u[a]=g,a=f}u[a]=_},n.prototype._down=function(a){for(var l=this,u=l.data,d=l.compare,_=this.length>>1,f=u[a];a<_;){var g=(a<<1)+1,w=u[g],b=g+1;if(b<this.length&&d(u[b],w)<0&&(g=b,w=u[b]),d(w,f)>=0)break;u[a]=w,a=g}u[a]=f};function r(s,a){return s<a?-1:s>a?1:0}return n})}}),hd=Qt({"node_modules/polylabel/polylabel.js"(i,e){var n=ad();n.default&&(n=n.default),e.exports=r,e.exports.default=r;function r(_,f,g){f=f||1;for(var w,b,M,C,I=0;I<_[0].length;I++){var A=_[0][I];(!I||A[0]<w)&&(w=A[0]),(!I||A[1]<b)&&(b=A[1]),(!I||A[0]>M)&&(M=A[0]),(!I||A[1]>C)&&(C=A[1])}var m=M-w,x=C-b,P=Math.min(m,x),k=P/2;if(P===0){var E=[w,b];return E.distance=0,E}for(var T=new n(void 0,s),B=w;B<M;B+=P)for(var R=b;R<C;R+=P)T.push(new a(B+k,R+k,k,_));var j=u(_),W=new a(w+m/2,b+x/2,0,_);W.d>j.d&&(j=W);for(var U=T.length;T.length;){var X=T.pop();X.d>j.d&&(j=X,g&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,U)),!(X.max-j.d<=f)&&(k=X.h/2,T.push(new a(X.x-k,X.y-k,k,_)),T.push(new a(X.x+k,X.y-k,k,_)),T.push(new a(X.x-k,X.y+k,k,_)),T.push(new a(X.x+k,X.y+k,k,_)),U+=4)}g&&(console.log("num probes: "+U),console.log("best distance: "+j.d));var v=[j.x,j.y];return v.distance=j.d,v}function s(_,f){return f.max-_.max}function a(_,f,g,w){this.x=_,this.y=f,this.h=g,this.d=l(_,f,w),this.max=this.d+this.h*Math.SQRT2}function l(_,f,g){for(var w=!1,b=1/0,M=0;M<g.length;M++)for(var C=g[M],I=0,A=C.length,m=A-1;I<A;m=I++){var x=C[I],P=C[m];x[1]>f!=P[1]>f&&_<(P[0]-x[0])*(f-x[1])/(P[1]-x[1])+x[0]&&(w=!w),b=Math.min(b,d(_,f,x,P))}return b===0?0:(w?1:-1)*Math.sqrt(b)}function u(_){for(var f=0,g=0,w=0,b=_[0],M=0,C=b.length,I=C-1;M<C;I=M++){var A=b[M],m=b[I],x=A[0]*m[1]-m[0]*A[1];g+=(A[0]+m[0])*x,w+=(A[1]+m[1])*x,f+=x*3}return f===0?new a(b[0][0],b[0][1],0,_):new a(g/f,w/f,0,_)}function d(_,f,g,w){var b=g[0],M=g[1],C=w[0]-b,I=w[1]-M;if(C!==0||I!==0){var A=((_-b)*C+(f-M)*I)/(C*C+I*I);A>1?(b=w[0],M=w[1]):A>0&&(b+=C*A,M+=I*A)}return C=_-b,I=f-M,C*C+I*I}}});jt(_e());var Ye=jt(_e()),Bi=jt(_e()),ld=jt(id()),ud=jt(rd()),Et=(i,e,n)=>new Promise((r,s)=>{var a=d=>{try{u(n.next(d))}catch(_){s(_)}},l=d=>{try{u(n.throw(d))}catch(_){s(_)}},u=d=>d.done?r(d.value):Promise.resolve(d.value).then(a,l);u((n=n.apply(i,e)).next())}),Nt=Uint8Array,$e=Uint16Array,Ja=Uint32Array,Qa=new Nt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),th=new Nt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cd=new Nt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eh=function(i,e){for(var n=new $e(31),r=0;r<31;++r)n[r]=e+=1<<i[r-1];for(var s=new Ja(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)s[a]=a-n[r]<<5|r;return[n,s]},ih=eh(Qa,2),nh=ih[0],dd=ih[1];nh[28]=258,dd[258]=28;var fd=eh(th,0),pd=fd[0],rh=new $e(32768);for(ut=0;ut<32768;++ut)ue=(ut&43690)>>>1|(ut&21845)<<1,ue=(ue&52428)>>>2|(ue&13107)<<2,ue=(ue&61680)>>>4|(ue&3855)<<4,rh[ut]=((ue&65280)>>>8|(ue&255)<<8)>>>1;var ue,ut,ki=function(i,e,n){for(var r=i.length,s=0,a=new $e(e);s<r;++s)i[s]&&++a[i[s]-1];var l=new $e(e);for(s=0;s<e;++s)l[s]=l[s-1]+a[s-1]<<1;var u;{u=new $e(1<<e);var d=15-e;for(s=0;s<r;++s)if(i[s])for(var _=s<<4|i[s],f=e-i[s],g=l[i[s]-1]++<<f,w=g|(1<<f)-1;g<=w;++g)u[rh[g]>>>d]=_}return u},Zi=new Nt(288);for(ut=0;ut<144;++ut)Zi[ut]=8;var ut;for(ut=144;ut<256;++ut)Zi[ut]=9;var ut;for(ut=256;ut<280;++ut)Zi[ut]=7;var ut;for(ut=280;ut<288;++ut)Zi[ut]=8;var ut,oh=new Nt(32);for(ut=0;ut<32;++ut)oh[ut]=5;var ut,_d=ki(Zi,9),md=ki(oh,5),xr=function(i){for(var e=i[0],n=1;n<i.length;++n)i[n]>e&&(e=i[n]);return e},Gt=function(i,e,n){var r=e/8|0;return(i[r]|i[r+1]<<8)>>(e&7)&n},wr=function(i,e){var n=e/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(e&7)},gd=function(i){return(i+7)/8|0},vd=function(i,e,n){(n==null||n>i.length)&&(n=i.length);var r=new(i.BYTES_PER_ELEMENT==2?$e:i.BYTES_PER_ELEMENT==4?Ja:Nt)(n-e);return r.set(i.subarray(e,n)),r},yd=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$t=function(i,e,n){var r=new Error(e||yd[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,$t),!n)throw r;return r},eo=function(i,e,n){var r=i.length;if(!r||n&&n.f&&!n.l)return e||new Nt(0);var s=!e||n,a=!n||n.i;n||(n={}),e||(e=new Nt(r*3));var l=function(q){var ht=e.length;if(q>ht){var dt=new Nt(Math.max(ht*2,q));dt.set(e),e=dt}},u=n.f||0,d=n.p||0,_=n.b||0,f=n.l,g=n.d,w=n.m,b=n.n,M=r*8;do{if(!f){u=Gt(i,d,1);var C=Gt(i,d+1,3);if(d+=3,C)if(C==1)f=_d,g=md,w=9,b=5;else if(C==2){var x=Gt(i,d,31)+257,P=Gt(i,d+10,15)+4,k=x+Gt(i,d+5,31)+1;d+=14;for(var E=new Nt(k),T=new Nt(19),B=0;B<P;++B)T[cd[B]]=Gt(i,d+B*3,7);d+=P*3;for(var R=xr(T),j=(1<<R)-1,W=ki(T,R),B=0;B<k;){var U=W[Gt(i,d,j)];d+=U&15;var I=U>>>4;if(I<16)E[B++]=I;else{var X=0,v=0;for(I==16?(v=3+Gt(i,d,3),d+=2,X=E[B-1]):I==17?(v=3+Gt(i,d,7),d+=3):I==18&&(v=11+Gt(i,d,127),d+=7);v--;)E[B++]=X}}var D=E.subarray(0,x),z=E.subarray(x);w=xr(D),b=xr(z),f=ki(D,w),g=ki(z,b)}else $t(1);else{var I=gd(d)+4,A=i[I-4]|i[I-3]<<8,m=I+A;if(m>r){a&&$t(0);break}s&&l(_+A),e.set(i.subarray(I,m),_),n.b=_+=A,n.p=d=m*8,n.f=u;continue}if(d>M){a&&$t(0);break}}s&&l(_+131072);for(var V=(1<<w)-1,N=(1<<b)-1,K=d;;K=d){var X=f[wr(i,d)&V],Z=X>>>4;if(d+=X&15,d>M){a&&$t(0);break}if(X||$t(2),Z<256)e[_++]=Z;else if(Z==256){K=d,f=null;break}else{var H=Z-254;if(Z>264){var B=Z-257,G=Qa[B];H=Gt(i,d,(1<<G)-1)+nh[B],d+=G}var nt=g[wr(i,d)&N],Q=nt>>>4;nt||$t(3),d+=nt&15;var z=pd[Q];if(Q>3){var G=th[Q];z+=wr(i,d)&(1<<G)-1,d+=G}if(d>M){a&&$t(0);break}s&&l(_+131072);for(var et=_+H;_<et;_+=4)e[_]=e[_-z],e[_+1]=e[_+1-z],e[_+2]=e[_+2-z],e[_+3]=e[_+3-z];_=et}}n.l=f,n.p=K,n.b=_,n.f=u,f&&(u=1,n.m=w,n.d=g,n.n=b)}while(!u);return _==e.length?e:vd(e,0,_)},xd=new Nt(0),wd=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&$t(6,"invalid gzip data");var e=i[3],n=10;e&4&&(n+=i[10]|(i[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!i[n++]);return n+(e&2)},bd=function(i){var e=i.length;return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0},Pd=function(i){((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)&&$t(6,"invalid zlib data"),i[1]&32&&$t(6,"invalid zlib data: preset dictionaries not supported")};function Md(i,e){return eo(i,e)}function Ld(i,e){return eo(i.subarray(wd(i),-8),new Nt(bd(i)))}function Cd(i,e){return eo((Pd(i),i.subarray(2,-4)),e)}function Or(i,e){return i[0]==31&&i[1]==139&&i[2]==8?Ld(i):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?Md(i,e):Cd(i,e)}var Sd=typeof TextDecoder<"u"&&new TextDecoder,kd=0;try{Sd.decode(xd,{stream:!0}),kd=1}catch{}var sh=(i,e)=>i*Math.pow(2,e),vi=(i,e)=>Math.floor(i/Math.pow(2,e)),Dn=(i,e)=>sh(i.getUint16(e+1,!0),8)+i.getUint8(e),ah=(i,e)=>sh(i.getUint32(e+2,!0),16)+i.getUint16(e,!0),Td=(i,e,n,r,s)=>{if(i!=r.getUint8(s))return i-r.getUint8(s);const a=Dn(r,s+1);if(e!=a)return e-a;const l=Dn(r,s+4);return n!=l?n-l:0},Ed=(i,e,n,r)=>{const s=hh(i,e|128,n,r);return s?{z:e,x:n,y:r,offset:s[0],length:s[1],is_dir:!0}:null},Rs=(i,e,n,r)=>{const s=hh(i,e,n,r);return s?{z:e,x:n,y:r,offset:s[0],length:s[1],is_dir:!1}:null},hh=(i,e,n,r)=>{let s=0,a=i.byteLength/17-1;for(;s<=a;){const l=a+s>>1,u=Td(e,n,r,i,l*17);if(u>0)s=l+1;else if(u<0)a=l-1;else return[ah(i,l*17+7),i.getUint32(l*17+13,!0)]}return null},Dd=(i,e)=>i.is_dir&&!e.is_dir?1:!i.is_dir&&e.is_dir?-1:i.z!==e.z?i.z-e.z:i.x!==e.x?i.x-e.x:i.y-e.y,lh=(i,e)=>{const n=i.getUint8(e*17);return{z:n&127,x:Dn(i,e*17+1),y:Dn(i,e*17+4),offset:ah(i,e*17+7),length:i.getUint32(e*17+13,!0),is_dir:n>>7===1}},Ns=i=>{const e=[],n=new DataView(i);for(let r=0;r<n.byteLength/17;r++)e.push(lh(n,r));return Id(e)},Id=i=>{i.sort(Dd);const e=new ArrayBuffer(17*i.length),n=new Uint8Array(e);for(let r=0;r<i.length;r++){const s=i[r];let a=s.z;s.is_dir&&(a=a|128),n[r*17]=a,n[r*17+1]=s.x&255,n[r*17+2]=s.x>>8&255,n[r*17+3]=s.x>>16&255,n[r*17+4]=s.y&255,n[r*17+5]=s.y>>8&255,n[r*17+6]=s.y>>16&255,n[r*17+7]=s.offset&255,n[r*17+8]=vi(s.offset,8)&255,n[r*17+9]=vi(s.offset,16)&255,n[r*17+10]=vi(s.offset,24)&255,n[r*17+11]=vi(s.offset,32)&255,n[r*17+12]=vi(s.offset,48)&255,n[r*17+13]=s.length&255,n[r*17+14]=s.length>>8&255,n[r*17+15]=s.length>>16&255,n[r*17+16]=s.length>>24&255}return e},Bd=(i,e)=>{if(i.byteLength<17)return null;const n=i.byteLength/17,r=lh(i,n-1);if(r.is_dir){const s=r.z,a=e.z-s,l=Math.trunc(e.x/(1<<a)),u=Math.trunc(e.y/(1<<a));return{z:s,x:l,y:u}}return null};function zd(i){return Et(this,null,function*(){const e=yield i.getBytes(0,512e3),n=new DataView(e.data),r=n.getUint32(4,!0),s=n.getUint16(8,!0),a=new TextDecoder("utf-8"),l=JSON.parse(a.decode(new DataView(e.data,10,r)));let u=0;l.compression==="gzip"&&(u=2);let d=0;"minzoom"in l&&(d=+l.minzoom);let _=0;"maxzoom"in l&&(_=+l.maxzoom);let f=0,g=0,w=0,b=-180,M=-85,C=180,I=85;if(l.bounds){const m=l.bounds.split(",");b=+m[0],M=+m[1],C=+m[2],I=+m[3]}if(l.center){const m=l.center.split(",");f=+m[0],g=+m[1],w=+m[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:d,maxZoom:_,minLon:b,minLat:M,maxLon:C,maxLat:I,centerZoom:w,centerLon:f,centerLat:g,etag:e.etag}})}function Od(i,e,n,r,s,a,l){return Et(this,null,function*(){let u=yield n.getArrayBuffer(e,i.rootDirectoryOffset,i.rootDirectoryLength,i);i.specVersion===1&&(u=Ns(u));const d=Rs(new DataView(u),r,s,a);if(d){let g=(yield e.getBytes(d.offset,d.length,l)).data;const w=new DataView(g);return w.getUint8(0)==31&&w.getUint8(1)==139&&(g=Or(new Uint8Array(g))),{data:g}}const _=Bd(new DataView(u),{z:r,x:s,y:a});if(_){const f=Ed(new DataView(u),_.z,_.x,_.y);if(f){let g=yield n.getArrayBuffer(e,f.offset,f.length,i);i.specVersion===1&&(g=Ns(g));const w=Rs(new DataView(g),r,s,a);if(w){let M=(yield e.getBytes(w.offset,w.length,l)).data;const C=new DataView(M);return C.getUint8(0)==31&&C.getUint8(1)==139&&(M=Or(new Uint8Array(M))),{data:M}}}}})}var uh={getHeader:zd,getZxy:Od};function Xe(i,e){return(e>>>0)*4294967296+(i>>>0)}function Ad(i,e){const n=e.buf;let r,s;if(s=n[e.pos++],r=(s&112)>>4,s<128||(s=n[e.pos++],r|=(s&127)<<3,s<128)||(s=n[e.pos++],r|=(s&127)<<10,s<128)||(s=n[e.pos++],r|=(s&127)<<17,s<128)||(s=n[e.pos++],r|=(s&127)<<24,s<128)||(s=n[e.pos++],r|=(s&1)<<31,s<128))return Xe(i,r);throw new Error("Expected varint not more than 10 bytes")}function yi(i){const e=i.buf;let n,r;return r=e[i.pos++],n=r&127,r<128||(r=e[i.pos++],n|=(r&127)<<7,r<128)||(r=e[i.pos++],n|=(r&127)<<14,r<128)||(r=e[i.pos++],n|=(r&127)<<21,r<128)?n:(r=e[i.pos],n|=(r&15)<<28,Ad(n,i))}function Fd(i,e,n,r){if(r==0){n==1&&(e[0]=i-1-e[0],e[1]=i-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}function Zd(i,e,n){if(i>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,i)-1||n>Math.pow(2,i)-1)throw Error("tile x/y outside zoom level bounds");let r=0,s=0;for(;s<i;)r+=Math.pow(2,s)*Math.pow(2,s),s++;const a=Math.pow(2,i);let l=0,u=0,d=0;const _=[e,n];let f=a/2;for(;f>0;)l=(_[0]&f)>0?1:0,u=(_[1]&f)>0?1:0,d+=f*f*(3*l^u),Fd(f,_,l,u),f=f/2;return r+d}function ch(i,e){return Et(this,null,function*(){if(e===1||e===0)return i;if(e===2)return Or(new Uint8Array(i));throw Error("Compression method not supported")})}var Rd=127;function Nd(i,e){let n=0,r=i.length-1;for(;n<=r;){const s=r+n>>1,a=e-i[s].tileId;if(a>0)n=s+1;else if(a<0)r=s-1;else return i[s]}return r>=0&&(i[r].runLength===0||e-i[r].tileId<i[r].runLength)?i[r]:null}var jd=class{constructor(i){this.url=i}getKey(){return this.url}getBytes(i,e,n){return Et(this,null,function*(){let r;n||(r=new AbortController,n=r.signal);let s=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+i+"-"+(i+e-1)}});if(s.status===416&&i===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const d=+u.substr(8);s=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(d-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const a=s.headers.get("Content-Length");if(s.status===200&&(!a||+a>e))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function qt(i,e){const n=i.getUint32(e+4,!0),r=i.getUint32(e+0,!0);return n*Math.pow(2,32)+r}function Wd(i,e){const n=new DataView(i),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:qt(n,8),rootDirectoryLength:qt(n,16),jsonMetadataOffset:qt(n,24),jsonMetadataLength:qt(n,32),leafDirectoryOffset:qt(n,40),leafDirectoryLength:qt(n,48),tileDataOffset:qt(n,56),tileDataLength:qt(n,64),numAddressedTiles:qt(n,72),numTileEntries:qt(n,80),numTileContents:qt(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function dh(i){const e={buf:new Uint8Array(i),pos:0},n=yi(e),r=[];let s=0;for(let a=0;a<n;a++){const l=yi(e);r.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let a=0;a<n;a++)r[a].runLength=yi(e);for(let a=0;a<n;a++)r[a].length=yi(e);for(let a=0;a<n;a++){const l=yi(e);l===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=l-1}return r}function Yd(i){const e=new DataView(i);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var He=class extends Error{};function Xd(i,e,n,r){return Et(this,null,function*(){const s=yield i.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Yd(s.data)<3)return[yield uh.getHeader(i)];const l=s.data.slice(0,Rd);let u=s.etag;r&&s.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+i.getKey()),u=void 0);const d=Wd(l,u);if(n){const _=s.data.slice(d.rootDirectoryOffset,d.rootDirectoryOffset+d.rootDirectoryLength),f=i.getKey()+"|"+(d.etag||"")+"|"+d.rootDirectoryOffset+"|"+d.rootDirectoryLength,g=dh(yield e(_,d.internalCompression));return[d,[f,g.length,g]]}return[d,void 0]})}function Ud(i,e,n,r,s){return Et(this,null,function*(){const a=yield i.getBytes(n,r);if(s.etag&&s.etag!==a.etag)throw new He(a.etag);const l=yield e(a.data,s.internalCompression),u=dh(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Vd=class{constructor(i=100,e=!0,n=ch){this.cache=new Map,this.maxCacheEntries=i,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(i,e){return Et(this,null,function*(){const n=i.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const r=new Promise((s,a)=>{Xd(i,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{a(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:r}),r})}getDirectory(i,e,n,r){return Et(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+e+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{Ud(i,this.decompress,e,n,r).then(d=>{l(d),this.prune()}).catch(d=>{u(d)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}getArrayBuffer(i,e,n,r){return Et(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+e+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{i.getBytes(e,n).then(d=>{if(r.etag&&r.etag!==d.etag)throw new He(d.etag);l(d.data),this.cache.has(s),this.prune()}).catch(d=>{u(d)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let i=1/0,e;this.cache.forEach((n,r)=>{n.lastUsed<i&&(i=n.lastUsed,e=r)}),e&&this.cache.delete(e)}}invalidate(i,e){return Et(this,null,function*(){this.cache.delete(i.getKey()),yield this.getHeader(i,e)})}},Hd=class{constructor(i,e,n){typeof i=="string"?this.source=new jd(i):this.source=i,n?this.decompress=n:this.decompress=ch,e?this.cache=e:this.cache=new Vd}getHeader(){return Et(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(i,e,n,r){return Et(this,null,function*(){const s=Zd(i,e,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return uh.getZxy(a,this.source,this.cache,i,e,n,r);if(i<a.minZoom||i>a.maxZoom)return;let l=a.rootDirectoryOffset,u=a.rootDirectoryLength;for(let d=0;d<=3;d++){const _=yield this.cache.getDirectory(this.source,l,u,a),f=Nd(_,s);if(f)if(f.runLength>0){const g=yield this.source.getBytes(a.tileDataOffset+f.offset,f.length,r);if(a.etag&&a.etag!==g.etag)throw new He(g.etag);return{data:yield this.decompress(g.data,a.tileCompression),cacheControl:g.cacheControl,expires:g.expires}}else l=a.leafDirectoryOffset+f.offset,u=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(i,e,n,r){return Et(this,null,function*(){try{return yield this.getZxyAttempt(i,e,n,r)}catch(s){if(s instanceof He)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(i,e,n,r);throw s}})}getMetadataAttempt(){return Et(this,null,function*(){const i=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(i.jsonMetadataOffset,i.jsonMetadataLength);if(i.etag&&i.etag!==e.etag)throw new He(e.etag);const n=yield this.decompress(e.data,i.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return Et(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(i){if(i instanceof He)return this.cache.invalidate(this.source,i.message),yield this.getMetadataAttempt();throw i}})}},Ke;(function(i){i[i.Point=1]="Point",i[i.Line=2]="Line",i[i.Polygon=3]="Polygon"})(Ke||(Ke={}));function Ee(i){return i.x+":"+i.y+":"+i.z}var Gd=(i,e,n)=>{i.pos=e;for(var r=i.readVarint()+i.pos,s=1,a=0,l=0,u=0,d=1/0,_=-1/0,f=1/0,g=-1/0,w=[],b=[];i.pos<r;){if(a<=0){var M=i.readVarint();s=M&7,a=M>>3}if(a--,s===1||s===2)l+=i.readSVarint()*n,u+=i.readSVarint()*n,l<d&&(d=l),l>_&&(_=l),u<f&&(f=u),u>g&&(g=u),s===1&&(b.length>0&&w.push(b),b=[]),b.push(new Bi.default(l,u));else if(s===7)b&&b.push(b[0].clone());else throw new Error("unknown command "+s)}return b&&w.push(b),{geom:w,bbox:{minX:d,minY:f,maxX:_,maxY:g}}};function fh(i,e){let n=new ld.VectorTile(new ud.default(i)),r=new Map;for(let[s,a]of Object.entries(n.layers)){let l=[],u=a;for(let d=0;d<u.length;d++){let _=Gd(u.feature(d)._pbf,u.feature(d)._geometry,e/u.extent),f=0;for(let g of _.geom)f+=g.length;l.push({id:u.feature(d).id,geomType:u.feature(d).type,geom:_.geom,numVertices:f,bbox:_.bbox,props:u.feature(d).properties})}r.set(s,l)}return r}var js=class{constructor(i,e){typeof i=="string"?this.p=new Hd(i):this.p=i,this.controllers=[],this.shouldCancelZooms=e}get(i,e){return ti(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));const n=new AbortController;this.controllers.push([i.z,n]);const r=n.signal;let s=yield this.p.getZxy(i.z,i.x,i.y,r);return s?fh(s.data,e):new Map})}},qd=class{constructor(i,e){this.url=i,this.controllers=[],this.shouldCancelZooms=e}get(i,e){return ti(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));let n=this.url.replace("{z}",i.z.toString()).replace("{x}",i.x.toString()).replace("{y}",i.y.toString());const r=new AbortController;this.controllers.push([i.z,r]);const s=r.signal;return new Promise((a,l)=>{fetch(n,{signal:s}).then(u=>u.arrayBuffer()).then(u=>{let d=fh(u,e);a(d)}).catch(u=>{l(u)})})})}},Ar=6378137,$d=85.0511287798,dn=Ar*Math.PI,Kd=i=>{let e=Math.PI/180,n=Math.max(Math.min($d,i[0]),-85.0511287798),r=Math.sin(n*e);return new Bi.default(Ar*i[1]*e,Ar*Math.log((1+r)/(1-r))/2)};function Ws(i){return i*i}function yn(i,e){return Ws(i.x-e.x)+Ws(i.y-e.y)}function Jd(i,e,n){var r=yn(e,n);if(r===0)return yn(i,e);var s=((i.x-e.x)*(n.x-e.x)+(i.y-e.y)*(n.y-e.y))/r;return s=Math.max(0,Math.min(1,s)),yn(i,new Bi.default(e.x+s*(n.x-e.x),e.y+s*(n.y-e.y)))}function Ys(i,e){for(var n=!1,r=0,s=e.length-1;r<e.length;s=r++){var a=e[r].x,l=e[r].y,u=e[s].x,d=e[s].y,_=l>i.y!=d>i.y&&i.x<(u-a)*(i.y-l)/(d-l)+a;_&&(n=!n)}return n}function Qd(i){for(var e=0,n=0;n<i.length;n++){let r=(n+1)%i.length;e+=i[n].x*i[r].y,e-=i[r].x*i[n].y}return e<0}function tf(i,e){var n=!1;for(let r of e)if(Qd(r))Ys(i,r)&&(n=!1);else{if(n)return!0;Ys(i,r)&&(n=!0)}return n}function ef(i,e){let n=1/0;for(let r of e){let s=Math.sqrt(yn(i,r[0]));s<n&&(n=s)}return n}function nf(i,e){let n=1/0;for(let s of e)for(var r=0;r<s.length-1;r++){let a=Math.sqrt(Jd(i,s[r],s[r+1]));a<n&&(n=a)}return n}var rf=class{constructor(i,e){this.source=i,this.cache=new Map,this.inflight=new Map,this.tileSize=e}queryFeatures(i,e,n,r){let s=Kd([e,i]);var a=new Bi.default((s.x+dn)/(dn*2),1-(s.y+dn)/(dn*2));a.x>1&&(a.x=a.x-Math.floor(a.x));let l=a.mult(1<<n),u=Math.floor(l.x),d=Math.floor(l.y);const _=Ee({z:n,x:u,y:d});let f=[],g=this.cache.get(_);if(g){const w=new Bi.default((l.x-u)*this.tileSize,(l.y-d)*this.tileSize);for(let[b,M]of g.data.entries())for(let C of M)C.geomType==1?ef(w,C.geom)<r&&f.push({feature:C,layerName:b}):C.geomType==2?nf(w,C.geom)<r&&f.push({feature:C,layerName:b}):tf(w,C.geom)&&f.push({feature:C,layerName:b})}return f}get(i){return ti(this,null,function*(){const e=Ee(i);return new Promise((n,r)=>{let s=this.cache.get(e);if(s)s.used=performance.now(),n(s.data);else{let a=this.inflight.get(e);a?a.push([n,r]):(this.inflight.set(e,[]),this.source.get(i,this.tileSize).then(l=>{this.cache.set(e,{used:performance.now(),data:l});let u=this.inflight.get(e);if(u&&u.forEach(d=>d[0](l)),this.inflight.delete(e),n(l),this.cache.size>=64){let d=1/0,_;this.cache.forEach((f,g)=>{f.used<d&&(d=f.used,_=g)}),_&&this.cache.delete(_)}}).catch(l=>{let u=this.inflight.get(e);u&&u.forEach(d=>d[1](l)),this.inflight.delete(e),r(l)}))}})})}},ph=(i,e,n)=>{let r=[];for(let s of i){let a=[];for(let l of s)a.push(l.clone().mult(e).add(n));r.push(a)}return r},fn=(i,e)=>{let n=1<<e;return i<0&&(i=n+i),i>=n&&(i=i%n),i},of=class{constructor(i,e,n){this.tileCache=i,this.maxDataLevel=e,this.levelDiff=n}dataTilesForBounds(i,e){let n=Math.pow(2,i)/Math.pow(2,Math.ceil(i)),r=[];var s=1,a=this.tileCache.tileSize;if(i<this.levelDiff)s=1/(1<<this.levelDiff-i)*n,r.push({data_tile:{z:0,x:0,y:0},origin:new Ye.default(0,0),scale:s,dim:a*s});else if(i<=this.levelDiff+this.maxDataLevel){let d=1<<this.levelDiff,_=256*n,f=Math.ceil(i)-this.levelDiff,g=Math.floor(e.minX/d/_),w=Math.floor(e.minY/d/_),b=Math.floor(e.maxX/d/_),M=Math.floor(e.maxY/d/_);for(var l=g;l<=b;l++)for(var u=w;u<=M;u++){let C=new Ye.default(l*d*_,u*d*_);r.push({data_tile:{z:f,x:fn(l,f),y:fn(u,f)},origin:C,scale:n,dim:a*n})}}else{let d=1<<this.levelDiff;s=(1<<Math.ceil(i)-this.maxDataLevel-this.levelDiff)*n;let _=Math.floor(e.minX/d/256/s),f=Math.floor(e.minY/d/256/s),g=Math.floor(e.maxX/d/256/s),w=Math.floor(e.maxY/d/256/s);for(var l=_;l<=g;l++)for(var u=f;u<=w;u++){let C=new Ye.default(l*d*256*s,u*d*256*s);r.push({data_tile:{z:this.maxDataLevel,x:fn(l,this.maxDataLevel),y:fn(u,this.maxDataLevel)},origin:C,scale:s,dim:a*s})}}return r}dataTileForDisplayTile(i){var e,n=1,r=this.tileCache.tileSize,s;if(i.z<this.levelDiff)e={z:0,x:0,y:0},n=1/(1<<this.levelDiff-i.z),s=new Ye.default(0,0),r=r*n;else if(i.z<=this.levelDiff+this.maxDataLevel){let a=1<<this.levelDiff;e={z:i.z-this.levelDiff,x:Math.floor(i.x/a),y:Math.floor(i.y/a)},s=new Ye.default(e.x*a*256,e.y*a*256)}else{n=1<<i.z-this.maxDataLevel-this.levelDiff;let a=1<<this.levelDiff;e={z:this.maxDataLevel,x:Math.floor(i.x/a/n),y:Math.floor(i.y/a/n)},s=new Ye.default(e.x*a*n*256,e.y*a*n*256),r=r*n}return{data_tile:e,scale:n,origin:s,dim:r}}getBbox(i,e){return ti(this,null,function*(){let n=this.dataTilesForBounds(i,e);return(yield Promise.all(n.map(s=>this.tileCache.get(s.data_tile)))).map((s,a)=>{let l=n[a];return{data:s,z:i,data_tile:l.data_tile,scale:l.scale,dim:l.dim,origin:l.origin}})})}getDisplayTile(i){return ti(this,null,function*(){let e=this.dataTileForDisplayTile(i);return{data:yield this.tileCache.get(e.data_tile),z:i.z,data_tile:e.data_tile,scale:e.scale,origin:e.origin,dim:e.dim}})}queryFeatures(i,e,n){let r=Math.round(n),s=Math.min(r-this.levelDiff,this.maxDataLevel),a=16/(1<<r-s);return this.tileCache.queryFeatures(i,e,s,a)}},sf=i=>{let e=r=>{let s=r.levelDiff===void 0?2:r.levelDiff,a=r.maxDataZoom||14,l;typeof r.url=="string"?r.url.endsWith(".pmtiles")?l=new js(r.url,!0):l=new qd(r.url,!0):l=new js(r.url,!0);let u=new rf(l,256*1<<s);return new of(u,a,s)},n=new Map;if(i.sources)for(const r in i.sources)n.set(r,e(i.sources[r]));else n.set("",e(i));return n},af=jt(_e());function hf(i,e,n,r,s,a,l,u,d){let _=performance.now();i.save(),i.miterLimit=2;for(var f of s){if(f.minzoom&&e<f.minzoom||f.maxzoom&&e>f.maxzoom)continue;let M=n.get(f.dataSource||"");if(M)for(let C of M){var g=C.data.get(f.dataLayer);if(g===void 0)continue;f.symbolizer.before&&f.symbolizer.before(i,C.z);let I=C.origin;C.dim;let A=C.scale;i.save(),i.translate(I.x-l.x,I.y-l.y);for(var w of g){let m=w.geom,x=w.bbox;x.maxX*A+I.x<a.minX||x.minX*A+I.x>a.maxX||x.minY*A+I.y>a.maxY||x.maxY*A+I.y<a.minY||f.filter&&!f.filter(C.z,w)||(A!=1&&(m=ph(m,A,new af.default(0,0))),f.symbolizer.draw(i,m,C.z,w))}i.restore()}}if(r){let M=r.searchBbox(a,1/0);for(var b of M)if(i.save(),i.translate(b.anchor.x-l.x,b.anchor.y-l.y),b.draw(i),i.restore(),d){i.lineWidth=.5,i.strokeStyle=d,i.fillStyle=d,i.globalAlpha=1,i.fillRect(b.anchor.x-l.x-2,b.anchor.y-l.y-2,4,4);for(let C of b.bboxes)i.strokeRect(C.minX-l.x,C.minY-l.y,C.maxX-C.minX,C.maxY-C.minY)}}return i.restore(),performance.now()-_}var lf=jt(_e()),uf=jt(od()),cf=(i,e,n)=>{let r=256,s=e/r,a=Math.floor(n.minX/r),l=Math.floor(n.minY/r),u=Math.floor(n.maxX/r),d=Math.floor(n.maxY/r),_=Math.log2(s),f=[];for(let g=a;g<=u;g++){let w=g%(1<<i);for(let b=l;b<=d;b++)f.push({display:Ee({z:i,x:w,y:b}),key:Ee({z:i-_,x:Math.floor(w/s),y:Math.floor(b/s)})})}return f},df=class{constructor(i,e){this.tree=new uf.default,this.current=new Map,this.dim=i,this.maxLabeledTiles=e}hasPrefix(i){for(let e of this.current.keys())if(e.startsWith(i))return!0;return!1}has(i){return this.current.has(i)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(i,e){let n=new Set;for(let r of this.tree.search(i))r.indexed_label.order<=e&&n.add(r.indexed_label);return n}searchLabel(i,e){let n=new Set;for(let r of i.bboxes)for(let s of this.tree.search(r))s.indexed_label.order<=e&&n.add(s.indexed_label);return n}bboxCollides(i,e){for(let n of this.tree.search(i))if(n.indexed_label.order<=e)return!0;return!1}labelCollides(i,e){for(let n of i.bboxes)for(let r of this.tree.search(n))if(r.indexed_label.order<=e)return!0;return!1}deduplicationCollides(i){if(!i.deduplicationKey||!i.deduplicationDistance)return!1;let e=i.deduplicationDistance,n={minX:i.anchor.x-e,minY:i.anchor.y-e,maxX:i.anchor.x+e,maxY:i.anchor.y+e};for(let r of this.tree.search(n))if(r.indexed_label.deduplicationKey===i.deduplicationKey&&r.indexed_label.anchor.dist(i.anchor)<e)return!0;return!1}makeEntry(i){this.current.get(i)&&console.log("consistency error 1");let e=new Set;this.current.set(i,e)}insert(i,e,n){let r={anchor:i.anchor,bboxes:i.bboxes,draw:i.draw,order:e,tileKey:n,deduplicationKey:i.deduplicationKey,deduplicationDistance:i.deduplicationDistance},s=this.current.get(n);if(!s){let f=new Set;this.current.set(n,f),s=f}s.add(r);var a=!1,l=!1;for(let f of i.bboxes){var u=f;u.indexed_label=r,this.tree.insert(u),f.minX<0&&(a=!0),f.maxX>this.dim&&(l=!0)}if(a||l){var d=a?this.dim:-this.dim,_=[];for(let w of i.bboxes)_.push({minX:w.minX+d,minY:w.minY,maxX:w.maxX+d,maxY:w.maxY});let f={anchor:new lf.default(i.anchor.x+d,i.anchor.y),bboxes:_,draw:i.draw,order:e,tileKey:n},g=this.current.get(n);g&&g.add(f);for(let w of _){var u=w;u.indexed_label=f,this.tree.insert(u)}}}pruneOrNoop(i){let e=i.split(":"),n,r=0,s=0;for(var a of this.current.keys()){let l=a.split(":");if(l[3]===e[3]){s++;let u=Math.sqrt(Math.pow(+l[0]-+e[0],2)+Math.pow(+l[1]-+e[1],2));u>r&&(r=u,n=a)}n&&s>this.maxLabeledTiles&&this.pruneKey(n)}}pruneKey(i){let e=this.current.get(i);if(!e)return;let n=[];for(let r of this.tree.all())e.has(r.indexed_label)&&n.push(r);n.forEach(r=>{this.tree.remove(r)}),this.current.delete(i)}removeLabel(i){let e=[];for(let r of this.tree.all())i==r.indexed_label&&e.push(r);e.forEach(r=>{this.tree.remove(r)});let n=this.current.get(i.tileKey);n&&n.delete(i)}},ff=class{constructor(i,e,n,r,s){this.index=new df(256*1<<i,r),this.z=i,this.scratch=e,this.labelRules=n,this.callback=s}layout(i){let e=performance.now(),n=new Set;for(let[l,u]of i)for(let d of u){let _=Ee(d.data_tile)+":"+l;this.index.has(_)||(this.index.makeEntry(_),n.add(_))}let r=new Set;for(let[l,u]of this.labelRules.entries()){if(u.visible==!1||u.minzoom&&this.z<u.minzoom||u.maxzoom&&this.z>u.maxzoom)continue;let d=u.dataSource||"",_=i.get(d);if(_)for(let f of _){let g=Ee(f.data_tile)+":"+d;if(!n.has(g))continue;let w=f.data.get(u.dataLayer);if(w===void 0)continue;let b=w;u.sort&&b.sort((C,I)=>u.sort?u.sort(C.props,I.props):0);let M={index:this.index,zoom:this.z,scratch:this.scratch,order:l,overzoom:this.z-f.data_tile.z};for(let C of b){if(u.filter&&!u.filter(this.z,C))continue;let I=ph(C.geom,f.scale,f.origin),A=u.symbolizer.place(M,I,C);if(A)for(let m of A){var s=!1;if(!(m.deduplicationKey&&this.index.deduplicationCollides(m))){if(this.index.labelCollides(m,1/0)){if(!this.index.labelCollides(m,l)){let x=this.index.searchLabel(m,1/0);for(let P of x){this.index.removeLabel(P);for(let k of P.bboxes)this.findInvalidatedTiles(r,f.dim,k,g)}this.index.insert(m,l,g),s=!0}}else this.index.insert(m,l,g),s=!0;if(s)for(let x of m.bboxes)(x.maxX>f.origin.x+f.dim||x.minX<f.origin.x||x.minY<f.origin.y||x.maxY>f.origin.y+f.dim)&&this.findInvalidatedTiles(r,f.dim,x,g)}}}}}for(var a of n)this.index.pruneOrNoop(a);return r.size>0&&this.callback&&this.callback(r),performance.now()-e}findInvalidatedTiles(i,e,n,r){let s=cf(this.z,e,n);for(let a of s)a.key!=r&&this.index.hasPrefix(a.key)&&i.add(a.display)}add(i){var e=!0;for(let[n,r]of i)for(let s of r)this.index.has(Ee(s.data_tile)+":"+n)||(e=!1);return e?0:this.layout(i)}},Xs=class{constructor(i,e,n,r){this.labelers=new Map,this.scratch=i,this.labelRules=e,this.maxLabeledTiles=n,this.callback=r}add(i,e){var n=this.labelers.get(i);return n||(n=new ff(i,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(i,n)),n.add(e)}getIndex(i){let e=this.labelers.get(i);if(e)return e.index}},Us={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"},Vs={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function Ti(i,e,n){return Math.min(Math.max(i,n),e)}var xi=class extends Error{constructor(i){super(`Failed to parse color: "${i}"`)}};function pf(i){if(typeof i!="string")throw new xi(i);if(i.trim().toLowerCase()==="transparent")return[0,0,0,0];let e=i.trim();e=xf.test(i)?function(l){const u=l.toLowerCase().trim(),d=_f[function(_){let f=5381,g=_.length;for(;g;)f=33*f^_.charCodeAt(--g);return(f>>>0)%2341}(u)];if(!d)throw new xi(l);return`#${d}`}(i):i;const n=mf.exec(e);if(n){const l=Array.from(n).slice(1);return[...l.slice(0,3).map(u=>parseInt(zi(u,2),16)),parseInt(zi(l[3]||"f",2),16)/255]}const r=gf.exec(e);if(r){const l=Array.from(r).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,16)),parseInt(l[3]||"ff",16)/255]}const s=vf.exec(e);if(s){const l=Array.from(s).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,10)),parseFloat(l[3]||"1")]}const a=yf.exec(e);if(a){const[l,u,d,_]=Array.from(a).slice(1).map(parseFloat);if(Ti(0,100,u)!==u)throw new xi(i);if(Ti(0,100,d)!==d)throw new xi(i);return[...wf(l,u,d),_||1]}throw new xi(i)}var Hs=i=>parseInt(i.replace(/_/g,""),36),_f="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((i,e)=>{const n=Hs(e.substring(0,3)),r=Hs(e.substring(3)).toString(16);let s="";for(let a=0;a<6-r.length;a++)s+="0";return i[n]=`${s}${r}`,i},{}),zi=(i,e)=>Array.from(Array(e)).map(()=>i).join(""),mf=new RegExp(`^#${zi("([a-f0-9])",3)}([a-f0-9])?$`,"i"),gf=new RegExp(`^#${zi("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),vf=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${zi(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),yf=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,xf=/^[a-z]+$/i,Gs=i=>Math.round(255*i),wf=(i,e,n)=>{let r=n/100;if(e===0)return[r,r,r].map(Gs);const s=(i%360+360)%360/60,a=(1-Math.abs(2*r-1))*(e/100),l=a*(1-Math.abs(s%2-1));let u=0,d=0,_=0;s>=0&&s<1?(u=a,d=l):s>=1&&s<2?(u=l,d=a):s>=2&&s<3?(d=a,_=l):s>=3&&s<4?(d=l,_=a):s>=4&&s<5?(u=l,_=a):s>=5&&s<6&&(u=a,_=l);const f=r-a/2;return[u+f,d+f,_+f].map(Gs)};function qs(i){const[e,n,r,s]=pf(i).map((_,f)=>f===3?_:_/255),a=Math.max(e,n,r),l=Math.min(e,n,r),u=(a+l)/2;if(a===l)return[0,0,u,s];const d=a-l;return[60*(e===a?(n-r)/d+(n<r?6:0):n===a?(r-e)/d+2:(e-n)/d+4),u>.5?d/(2-a-l):d/(a+l),u,s]}function bf(i,e,n,r){return`hsla(${(i%360).toFixed()}, ${Ti(0,100,100*e).toFixed()}%, ${Ti(0,100,100*n).toFixed()}%, ${parseFloat(Ti(0,1,r).toFixed(3))})`}var Jt=jt(_e());jt(sd());var Pf=jt(hd()),Ot=class{constructor(i,e){this.str=i??e,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(i,e){return typeof this.str=="function"?this.str(i,e):this.str}},mt=class{constructor(i,e=1){this.value=i??e,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,e){return typeof this.value=="function"?this.value(i,e):this.value}},io=class{constructor(i){var e;this.label_props=(e=i==null?void 0:i.label_props)!=null?e:["name"],this.textTransform=i==null?void 0:i.textTransform}get(i,e){let n,r;typeof this.label_props=="function"?r=this.label_props(i,e):r=this.label_props;for(let a of r)if(e.props.hasOwnProperty(a)&&typeof e.props[a]=="string"){n=e.props[a];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(i,e):s=this.textTransform,n&&s==="uppercase"?n=n.toUpperCase():n&&s==="lowercase"?n=n.toLowerCase():n&&s==="capitalize"&&(n=n.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),n}},no=class{constructor(i){var e,n;i!=null&&i.font?this.font=i.font:(this.family=(e=i==null?void 0:i.fontFamily)!=null?e:"sans-serif",this.size=(n=i==null?void 0:i.fontSize)!=null?n:12,this.weight=i==null?void 0:i.fontWeight,this.style=i==null?void 0:i.fontStyle)}get(i,e){if(this.font)return typeof this.font=="function"?this.font(i,e):this.font;var n="";this.style&&(typeof this.style=="function"?n=this.style(i,e)+" ":n=this.style+" ");var r="";this.weight&&(typeof this.weight=="function"?r=this.weight(i,e)+" ":r=this.weight+" ");var s;typeof this.size=="function"?s=this.size(i,e):s=this.size;var a;return typeof this.family=="function"?a=this.family(i,e):a=this.family,`${n}${r}${s}px ${a}`}},Mf=class{constructor(i,e=[]){this.value=i??e,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,e){return typeof this.value=="function"?this.value(i,e):this.value}},$s=jt(_e()),Lf=(i,e,n)=>{var r=[],s,a,l,u=0,d=0,_=0,f=0,g=0,w=0,b=0,M=0,C=0,I=0,A=0,m=0;if(i.length<2)return[];if(i.length===2)return _=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),[{length:_,beginIndex:0,beginDistance:0,endIndex:2,endDistance:_}];for(f=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),u=1,d=i.length-1;u<d;u++)s=i[u-1],a=i[u],l=i[u+1],w=a.x-s.x,b=a.y-s.y,M=l.x-a.x,C=l.y-a.y,g=Math.sqrt(M*M+C*C),_+=f,I=Math.acos((w*M+b*C)/(f*g)),(I>e||_-m>n)&&(r.push({length:_-m,beginDistance:m,beginIndex:A,endIndex:u+1,endDistance:_}),A=u,m=_),f=g;return u-A>0&&r.push({length:_-m+g,beginIndex:A,beginDistance:m,endIndex:u+1,endDistance:_+g}),r};function Cf(i,e,n,r){let s=[];for(let l of i){let u=Lf(l,Math.PI/45,e);for(let d of u)if(d.length>=e+r){let _=new $s.default(l[d.beginIndex].x,l[d.beginIndex].y),f=l[d.endIndex-1],g=new $s.default((f.x-_.x)/d.length,(f.y-_.y)/d.length);for(var a=r;a<d.length-e;a+=n)s.push({start:_.add(g.mult(a)),end:_.add(g.mult(a+e))})}}return s}function Sf(i,e,n,r){let s=e.x-i.x,a=e.y-i.y,l=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),u=[];for(var d=0;d<n+r;d+=2*r){let _=d*1/l;u.push({x:i.x+_*s,y:i.y+_*a})}return u}function _h(i,e){if(i.length<=e)return[i];let n=e-1,r=i.lastIndexOf(" ",n),s=i.indexOf(" ",n);if(r==-1&&s==-1)return[i];let a,l;return s==-1||r>=0&&n-r<s-n?(a=i.substring(0,r),l=i.substring(r+1,i.length)):(a=i.substring(0,s),l=i.substring(s+1,i.length)),[a,..._h(l,e)]}var mh=5400,Ks;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(Ks||(Ks={}));var Js;(function(i){i[i.N=1]="N",i[i.NE=2]="NE",i[i.E=3]="E",i[i.SE=4]="SE",i[i.S=5]="S",i[i.SW=6]="SW",i[i.W=7]="W",i[i.NW=8]="NW"})(Js||(Js={}));var Tt=class{constructor(i){var e;this.pattern=i.pattern,this.fill=new Ot(i.fill,"black"),this.opacity=new mt(i.opacity,1),this.stroke=new Ot(i.stroke,"black"),this.width=new mt(i.width,0),this.per_feature=(e=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||i.per_feature)!=null?e:!1,this.do_stroke=!1}before(i,e){if(!this.per_feature){i.globalAlpha=this.opacity.get(e),i.fillStyle=this.fill.get(e),i.strokeStyle=this.stroke.get(e);let n=this.width.get(e);n>0&&(this.do_stroke=!0),i.lineWidth=n}if(this.pattern){const n=i.createPattern(this.pattern,"repeat");n&&(i.fillStyle=n)}}draw(i,e,n,r){var s=!1;if(this.per_feature){i.globalAlpha=this.opacity.get(n,r),i.fillStyle=this.fill.get(n,r);var a=this.width.get(n,r);a&&(s=!0,i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a)}let l=()=>{i.fill(),(s||this.do_stroke)&&i.stroke()};var u=0;i.beginPath();for(var d of e){u+d.length>mh&&(l(),u=0,i.beginPath());for(var _=0;_<d.length;_++){let f=d[_];_==0?i.moveTo(f.x,f.y):i.lineTo(f.x,f.y)}u+=d.length}u>0&&l()}};function kf(i,e){let n=0;for(;e[n+1][0]<i;)n++;return n}function Tf(i,e,n){return i*(n-e)+e}function Ef(i,e,n,r){const s=r[e+1][0]-r[e][0],a=i-r[e][0];return s===0?0:(Math.pow(n,a)-1)/(Math.pow(n,s)-1)}function ve(i,e){return n=>{if(e.length<1)return 0;if(n<=e[0][0])return e[0][1];if(n>=e[e.length-1][0])return e[e.length-1][1];const r=kf(n,e),s=Ef(n,r,i,e);return Tf(s,e[r][1],e[r+1][1])}}var re=class{constructor(i){var e;this.color=new Ot(i.color,"black"),this.width=new mt(i.width),this.opacity=new mt(i.opacity),this.dash=i.dash?new Mf(i.dash):null,this.dashColor=new Ot(i.dashColor,"black"),this.dashWidth=new mt(i.dashWidth,1),this.lineCap=new Ot(i.lineCap,"butt"),this.lineJoin=new Ot(i.lineJoin,"miter"),this.skip=!1,this.per_feature=!!((e=this.dash)!=null&&e.per_feature||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||i.per_feature)}before(i,e){this.per_feature||(i.strokeStyle=this.color.get(e),i.lineWidth=this.width.get(e),i.globalAlpha=this.opacity.get(e),i.lineCap=this.lineCap.get(e),i.lineJoin=this.lineJoin.get(e))}draw(i,e,n,r){if(this.skip)return;let s=()=>{this.per_feature&&(i.globalAlpha=this.opacity.get(n,r),i.lineCap=this.lineCap.get(n,r),i.lineJoin=this.lineJoin.get(n,r)),this.dash?(i.save(),this.per_feature?(i.lineWidth=this.dashWidth.get(n,r),i.strokeStyle=this.dashColor.get(n,r),i.setLineDash(this.dash.get(n,r))):i.setLineDash(this.dash.get(n)),i.stroke(),i.restore()):(i.save(),this.per_feature&&(i.lineWidth=this.width.get(n,r),i.strokeStyle=this.color.get(n,r)),i.stroke(),i.restore())};var a=0;i.beginPath();for(var l of e){a+l.length>mh&&(s(),a=0,i.beginPath());for(var u=0;u<l.length;u++){let d=l[u];u==0?i.moveTo(d.x,d.y):i.lineTo(d.x,d.y)}a+=l.length}a>0&&s()}},Fr=class{constructor(i){this.radius=new mt(i.radius,3),this.fill=new Ot(i.fill,"black"),this.stroke=new Ot(i.stroke,"white"),this.width=new mt(i.width,0),this.opacity=new mt(i.opacity)}draw(i,e,n,r){i.globalAlpha=this.opacity.get(n,r);let s=this.radius.get(n,r),a=this.width.get(n,r);a>0&&(i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a,i.beginPath(),i.arc(e[0][0].x,e[0][0].y,s+a/2,0,2*Math.PI),i.stroke()),i.fillStyle=this.fill.get(n,r),i.beginPath(),i.arc(e[0][0].x,e[0][0].y,s,0,2*Math.PI),i.fill()}place(i,e,n){e[0];let r=new Jt.default(e[0][0].x,e[0][0].y),s=this.radius.get(i.zoom,n),a={minX:r.x-s,minY:r.y-s,maxX:r.x+s,maxY:r.y+s};return[{anchor:r,bboxes:[a],draw:u=>{this.draw(u,[[new Jt.default(0,0)]],i.zoom,n)}}]}},Df=class{constructor(i){this.font=new no(i),this.text=new io(i),this.fill=new Ot(i.fill,"black"),this.background=new Ot(i.background,"white"),this.padding=new mt(i.padding,0)}place(i,e,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=i.scratch.measureText(r),l=a.width,u=a.actualBoundingBoxAscent,d=a.actualBoundingBoxDescent;e[0];let _=new Jt.default(e[0][0].x,e[0][0].y),f=this.padding.get(i.zoom,n),g={minX:_.x-l/2-f,minY:_.y-u-f,maxX:_.x+l/2+f,maxY:_.y+d+f};return[{anchor:_,bboxes:[g],draw:b=>{b.globalAlpha=1,b.fillStyle=this.background.get(i.zoom,n),b.fillRect(-l/2-f,-u-f,l+2*f,u+d+2*f),b.fillStyle=this.fill.get(i.zoom,n),b.font=s,b.fillText(r,-l/2,0)}}]}},Qs=class{constructor(i){this.list=i}place(i,e,n){var r=this.list[0].place(i,e,n);if(!r)return;var s=r[0];let a=s.anchor,l=s.bboxes[0],u=l.maxY-l.minY,d=[{draw:s.draw,translate:{x:0,y:0}}],_=[[new Jt.default(e[0][0].x,e[0][0].y+u)]];for(let g=1;g<this.list.length;g++)r=this.list[g].place(i,_,n),r&&(s=r[0],l=gh(l,s.bboxes[0]),d.push({draw:s.draw,translate:{x:0,y:u}}));return[{anchor:a,bboxes:[l],draw:g=>{for(let w of d)g.save(),g.translate(w.translate.x,w.translate.y),w.draw(g),g.restore()}}]}},gh=(i,e)=>({minX:Math.min(i.minX,e.minX),minY:Math.min(i.minY,e.minY),maxX:Math.max(i.maxX,e.maxX),maxY:Math.max(i.maxY,e.maxY)}),ta=class{constructor(i){this.list=i}place(i,e,n){let r=this.list[0];if(!r)return;var s=r.place(i,e,n);if(!s)return;var a=s[0];let l=a.anchor,u=a.bboxes[0],d=[a.draw];for(let f=1;f<this.list.length;f++){if(s=this.list[f].place(i,e,n),!s)return;a=s[0],u=gh(u,a.bboxes[0]),d.push(a.draw)}return[{anchor:l,bboxes:[u],draw:f=>{d.forEach(g=>g(f))}}]}},If=class{constructor(i){this.symbolizer=i}place(i,e,n){let r=e[0][0],s=this.symbolizer.place(i,[[new Jt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=l.maxX-l.minX,d=l.maxY-l.minY,_={minX:r.x-u/2,maxX:r.x+u/2,minY:r.y-d/2,maxY:r.y+d/2};return[{anchor:r,bboxes:[_],draw:g=>{g.translate(-u/2,d/2-l.maxY),a.draw(g,{justify:2})}}]}},ro=class{constructor(i){this.font=new no(i),this.text=new io(i),this.fill=new Ot(i.fill,"black"),this.stroke=new Ot(i.stroke,"black"),this.width=new mt(i.width,0),this.lineHeight=new mt(i.lineHeight,1),this.letterSpacing=new mt(i.letterSpacing,0),this.maxLineCodeUnits=new mt(i.maxLineChars,15),this.justify=i.justify}place(i,e,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=this.letterSpacing.get(i.zoom,n),l=_h(r,this.maxLineCodeUnits.get(i.zoom,n));var u="",d=0;for(let A of l)A.length>d&&(d=A.length,u=A);let _=i.scratch.measureText(u),f=_.width+a*(d-1),g=_.actualBoundingBoxAscent,w=_.actualBoundingBoxDescent,b=(g+w)*this.lineHeight.get(i.zoom,n),M=new Jt.default(e[0][0].x,e[0][0].y),C={minX:M.x,minY:M.y-g,maxX:M.x+f,maxY:M.y+w+(l.length-1)*b};return[{anchor:M,bboxes:[C],draw:(A,m)=>{A.globalAlpha=1,A.font=s,A.fillStyle=this.fill.get(i.zoom,n);let x=this.width.get(i.zoom,n);var P=0;for(let B of l){var k=0;if(this.justify==2||m&&m.justify==2?k=(f-A.measureText(B).width)/2:(this.justify==3||m&&m.justify==3)&&(k=f-A.measureText(B).width),x)if(A.lineWidth=x*2,A.strokeStyle=this.stroke.get(i.zoom,n),a>0){var E=k;for(var T of B)A.strokeText(T,E,P),E+=A.measureText(T).width+a}else A.strokeText(B,k,P);if(a>0){var E=k;for(var T of B)A.fillText(T,E,P),E+=A.measureText(T).width+a}else A.fillText(B,k,P);P+=b}}}]}},wi=class{constructor(i){this.centered=new If(new ro(i))}place(i,e,n){return this.centered.place(i,e,n)}},Bf=class{constructor(i,e){var n,r,s;this.symbolizer=i,this.offsetX=new mt(e.offsetX,0),this.offsetY=new mt(e.offsetY,0),this.justify=(n=e.justify)!=null?n:void 0,this.placements=(r=e.placements)!=null?r:[2,6,8,4,1,3,5,7],this.ddValues=(s=e.ddValues)!=null?s:()=>({})}place(i,e,n){if(n.geomType!==Ke.Point)return;let r=e[0][0],s=this.symbolizer.place(i,[[new Jt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=this.offsetX,d=this.offsetY,_=this.justify,f=this.placements;const{offsetX:g,offsetY:w,justify:b,placements:M}=this.ddValues(i.zoom,n)||{};g&&(u=new mt(g,0)),w&&(d=new mt(w,0)),b&&(_=b),M&&(f=M);const C=u.get(i.zoom,n),I=d.get(i.zoom,n);let A=(E,T)=>({minX:E.x+T.x+l.minX,minY:E.y+T.y+l.minY,maxX:E.x+T.x+l.maxX,maxY:E.y+T.y+l.maxY});var m=new Jt.default(C,I),x;let P=E=>{E.translate(m.x,m.y),a.draw(E,{justify:x})};const k=(E,T)=>{const B=A(E,T);if(!i.index.bboxCollides(B,i.order))return[{anchor:r,bboxes:[B],draw:P}]};for(let E of f){const T=this.computeXAxisOffset(C,l,E),B=this.computeYAxisOffset(I,l,E);return x=this.computeJustify(_,E),m=new Jt.default(T,B),k(r,m)}}computeXAxisOffset(i,e,n){const r=e.maxX,s=r/2;return[1,5].includes(n)?i-s:[8,7,6].includes(n)?i-r:i}computeYAxisOffset(i,e,n){const r=Math.abs(e.minY),s=e.maxY,a=(e.minY+e.maxY)/2;return[3,7].includes(n)?i-a:[8,2,1].includes(n)?i-s:[6,4,5].includes(n)?i+r:i}computeJustify(i,e){return i||([1,5].includes(e)?2:[2,3,4].includes(e)?1:3)}},pn=class{constructor(i){this.symbolizer=new Bf(new ro(i),i)}place(i,e,n){return this.symbolizer.place(i,e,n)}},ea;(function(i){i[i.Above=1]="Above",i[i.Center=2]="Center",i[i.Below=3]="Below"})(ea||(ea={}));var zf=class{constructor(i){var e;this.font=new no(i),this.text=new io(i),this.fill=new Ot(i.fill,"black"),this.stroke=new Ot(i.stroke,"black"),this.width=new mt(i.width,0),this.offset=new mt(i.offset,0),this.position=(e=i.position)!=null?e:1,this.maxLabelCodeUnits=new mt(i.maxLabelChars,40),this.repeatDistance=new mt(i.repeatDistance,250)}place(i,e,n){let r=this.text.get(i.zoom,n);if(!r||r.length>this.maxLabelCodeUnits.get(i.zoom,n))return;let s=20,a=n.bbox;if(a.maxY-a.minY<s&&a.maxX-a.minX<s)return;let l=this.font.get(i.zoom,n);i.scratch.font=l;let u=i.scratch.measureText(r),d=u.width,_=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent;var f=this.repeatDistance.get(i.zoom,n);i.overzoom>4&&(f*=1<<i.overzoom-4);let g=_*2,w=Cf(e,d,f,g);if(w.length==0)return;let b=[];for(let M of w){let C=M.end.x-M.start.x,I=M.end.y-M.start.y,m=Sf(M.start,M.end,d,g/2).map(P=>({minX:P.x-g/2,minY:P.y-g/2,maxX:P.x+g/2,maxY:P.y+g/2})),x=P=>{P.globalAlpha=1,P.rotate(Math.atan2(I,C)),C<0&&(P.scale(-1,-1),P.translate(-d,0));let k=0;this.position===3?k+=_:this.position===2&&(k+=_/2),P.translate(0,k-this.offset.get(i.zoom,n)),P.font=l;let E=this.width.get(i.zoom,n);E&&(P.lineWidth=E,P.strokeStyle=this.stroke.get(i.zoom,n),P.strokeText(r,0,0)),P.fillStyle=this.fill.get(i.zoom,n),P.fillText(r,0,0)};b.push({anchor:M.start,bboxes:m,draw:x,deduplicationKey:r,deduplicationDistance:f})}return b}},br=class{constructor(i){this.symbolizer=new ro(i)}place(i,e,n){let r=n.bbox;if((r.maxY-r.minY)*(r.maxX-r.minX)<2e4)return;let a=this.symbolizer.place(i,[[new Jt.default(0,0)]],n);if(!a||a.length==0)return;let l=a[0],u=l.bboxes[0],d=e[0],_=(0,Pf.default)([d.map(b=>[b.x,b.y])]),f=new Jt.default(_[0],_[1]),g={minX:f.x-(u.maxX-u.minX)/2,minY:f.y-(u.maxY-u.minY)/2,maxX:f.x+(u.maxX-u.minX)/2,maxY:f.y+(u.maxY-u.minY)/2};return[{anchor:f,bboxes:[g],draw:b=>{b.translate(l.anchor.x-(u.maxX-u.minX)/2,l.anchor.y),l.draw(b)}}]}},vh=(i,e)=>{let n=qs(e),r=Jc({},i);for(const[s,a]of Object.entries(i)){let l=qs(a);r[s]=bf(n[0],n[1],l[2],l[3])}return r},ia=(i,e)=>(e&&(i=vh(i,e)),[{dataLayer:"earth",symbolizer:new Tt({fill:i.earth})},{dataLayer:"natural",symbolizer:new Tt({fill:i.glacier}),filter:(n,r)=>r.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.residential}),filter:(n,r)=>r.props.landuse=="residential"||r.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.hospital}),filter:(n,r)=>r.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.cemetery}),filter:(n,r)=>r.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.school}),filter:(n,r)=>r.props.amenity=="school"||r.props.amenity=="kindergarten"||r.props.amenity=="university"||r.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.industrial}),filter:(n,r)=>r.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new Tt({fill:i.wood}),filter:(n,r)=>r.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.grass}),filter:(n,r)=>r.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new Tt({fill:i.park}),filter:(n,r)=>r.props.leisure=="park"},{dataLayer:"water",symbolizer:new Tt({fill:i.water})},{dataLayer:"natural",symbolizer:new Tt({fill:i.sand}),filter:(n,r)=>r.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new Tt({fill:i.buildings})},{dataLayer:"roads",symbolizer:new re({color:i.highwayCasing,width:ve(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new re({color:i.majorRoadCasing,width:ve(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:i.mediumRoadCasing,width:ve(1.4,[[13,3],[17,6],[20,18]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:i.minorRoadCasing,width:ve(1.4,[[14,2],[17,5],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:i.minorRoad,width:ve(1.4,[[14,1],[17,3],[20,13]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:i.mediumRoad,width:ve(1.4,[[13,2],[17,4],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:i.majorRoad,width:ve(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:i.highway,width:ve(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new re({color:i.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new Tt({fill:i.mask})}]),na=(i,e,n,r)=>{e&&(i=vh(i,e));var s=["name"];n&&(s=n);let a=(l,u)=>r?l instanceof pn?new Qs([l,new pn({fill:u,label_props:r})]):new Qs([l,new wi({fill:u,label_props:r})]):l;return[{dataLayer:"places",symbolizer:a(new wi({label_props:s,fill:i.countryLabel,lineHeight:1.5,font:(l,u)=>l<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),i.countryLabel),filter:(l,u)=>u.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:a(new wi({label_props:s,fill:i.stateLabel,font:"300 16px sans-serif"}),i.stateLabel),filter:(l,u)=>u.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",minzoom:7,symbolizer:a(new wi({label_props:s,fill:i.cityLabel,font:(l,u)=>(u==null?void 0:u.props["pmap:rank"])===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new ta([new Fr({radius:2,fill:i.cityLabel}),a(new pn({label_props:s,fill:i.cityLabel,offsetX:2,offsetY:2,font:(l,u)=>(u==null?void 0:u.props["pmap:rank"])===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel)]),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new wi({label_props:s,fill:i.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),i.neighbourhoodLabel),filter:(l,u)=>u.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new br({label_props:s,fill:i.landuseLabel,font:"300 12px sans-serif"}),i.landuseLabel)},{dataLayer:"water",symbolizer:a(new br({label_props:s,fill:i.waterLabel,font:"italic 600 12px sans-serif"}),i.waterLabel)},{dataLayer:"natural",symbolizer:a(new br({label_props:s,fill:i.naturalLabel,font:"italic 300 12px sans-serif"}),i.naturalLabel)},{dataLayer:"roads",symbolizer:a(new zf({label_props:s,fill:i.roadsLabel,font:"500 12px sans-serif"}),i.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new Df({label_props:["ref"],font:"600 9px sans-serif",background:i.highway,padding:2,fill:i.neighbourhoodLabel}),filter:(l,u)=>u.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new ta([new Fr({radius:2,fill:i.poisLabel}),a(new pn({label_props:s,fill:i.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),i.poisLabel)])}]},ra=(i,e,n)=>[{dataSource:i,dataLayer:e,symbolizer:new Fr({opacity:.2,fill:n,radius:4}),filter:(r,s)=>s.geomType==Ke.Point},{dataSource:i,dataLayer:e,symbolizer:new re({opacity:.2,color:n,width:2}),filter:(r,s)=>s.geomType==Ke.Line},{dataSource:i,dataLayer:e,symbolizer:new Tt({opacity:.2,fill:n,stroke:n,width:1}),filter:(r,s)=>s.geomType==Ke.Polygon}],Of=(i,e)=>{var n=[];for(var[r,s]of i)for(var a of s)for(var l of a.data.keys())r===e.dataSource&&l===e.dataLayer||(n=n.concat(ra(r,l,"steelblue")));return n=n.concat(ra(e.dataSource||"",e.dataLayer,"red")),n},Af=jt(_e()),Ff=i=>new Promise((e,n)=>{setTimeout(()=>{e()},i)}),Zf=i=>i.then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e})),Rf=(i={})=>{class e extends L.GridLayer{constructor(r={}){r.noWrap&&!r.bounds&&(r.bounds=[[-90,-180],[90,180]]),r.attribution==null&&(r.attribution='<a href="https://protomaps.com">Protomaps</a> © <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(r);let s=r.dark?Vs:Us;this.paint_rules=r.paint_rules||ia(s,r.shade),this.label_rules=r.label_rules||na(s,r.shade,r.language1,r.language2),this.backgroundColor=r.backgroundColor,this.lastRequestedZ=void 0,this.xray=r.xray,this.tasks=r.tasks||[],this.views=sf(r),this.debug=r.debug;let a=document.createElement("canvas").getContext("2d");this.scratch=a,this.onTilesInvalidated=l=>{l.forEach(u=>{this.rerenderTile(u)})},this.labelers=new Xs(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=r.tileDelay||3,this.lang=r.lang,this.inspector=this.inspect(this)}setDefaultStyle(r,s,a,l){let u=r?Vs:Us;this.paint_rules=ia(u,s),this.label_rules=na(u,s,a,l)}renderTile(r,s,a,l=()=>{}){return ti(this,null,function*(){this.lastRequestedZ=r.z;let u=[];for(const[T,B]of this.views){let R=B.getDisplayTile(r);u.push({key:T,promise:R})}let d=yield Promise.all(u.map(T=>T.promise.then(B=>({status:"fulfilled",value:B,key:T.key}),B=>({status:"rejected",reason:B,key:T.key})))),_=new Map;for(const T of d)T.status==="fulfilled"?_.set(T.key,[T.value]):T.reason.name==="AbortError"||console.error(T.reason);if(s.key!=a||this.lastRequestedZ!==r.z||(yield Promise.all(this.tasks.map(Zf)),s.key!=a)||this.lastRequestedZ!==r.z)return;let f=this.labelers.add(r.z,_);if(s.key!=a||this.lastRequestedZ!==r.z)return;let g=this.labelers.getIndex(r.z);if(!this._map)return;let w=this._map.getCenter().wrap(),b=this._getTiledPixelBounds(w),M=this._pxBoundsToTileRange(b),C=M.getCenter(),I=r.distanceTo(C)*this.tileDelay;if(yield Ff(I),s.key!=a||this.lastRequestedZ!==r.z)return;let A=16,m={minX:256*r.x-A,minY:256*r.y-A,maxX:256*(r.x+1)+A,maxY:256*(r.y+1)+A},x=new Af.default(256*r.x,256*r.y);s.width=this.tile_size,s.height=this.tile_size;let P=s.getContext("2d");P.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),P.clearRect(0,0,256,256),this.backgroundColor&&(P.save(),P.fillStyle=this.backgroundColor,P.fillRect(0,0,256,256),P.restore());var k=0;let E=this.paint_rules;if(this.xray&&(E=Of(_,this.xray)),k=hf(P,r.z,_,this.xray?null:g,E,m,x,!1,this.debug),this.debug){P.save(),P.fillStyle=this.debug,P.font="600 12px sans-serif",P.fillText(r.z+" "+r.x+" "+r.y,4,14),P.font="12px sans-serif";let T=28;for(let[B,R]of _){let j=R[0].data_tile;P.fillText(B+(B?" ":"")+j.z+" "+j.x+" "+j.y,4,T),T+=14}P.font="600 10px sans-serif",k>8&&(P.fillText(k.toFixed()+" ms paint",4,T),T+=14),f>8&&P.fillText(f.toFixed()+" ms layout",4,T),P.strokeStyle=this.debug,P.lineWidth=.5,P.beginPath(),P.moveTo(0,0),P.lineTo(0,256),P.stroke(),P.lineWidth=.5,P.beginPath(),P.moveTo(0,0),P.lineTo(256,0),P.stroke(),P.restore()}l()})}rerenderTile(r){for(let s in this._tiles){let a=this._wrapCoords(this._keyToTileCoords(s));r===this._tileCoordsToKey(a)&&this.renderTile(a,this._tiles[s].el,r)}}clearLayout(){this.labelers=new Xs(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let r in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(r)),a=this._tileCoordsToKey(s);this.renderTile(s,this._tiles[r].el,a)}}createTile(r,s){let a=L.DomUtil.create("canvas","leaflet-tile");a.lang=this.lang;let l=this._tileCoordsToKey(r);return a.key=l,this.renderTile(r,a,l,()=>{s(null,a)}),a}_removeTile(r){let s=this._tiles[r];s&&(s.el.removed=!0,s.el.key=void 0,L.DomUtil.removeClass(s.el,"leaflet-tile-loaded"),s.el.width=s.el.height=0,L.DomUtil.remove(s.el),delete this._tiles[r],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(r)}))}queryFeatures(r,s){let a=new Map;for(var[l,u]of this.views)a.set(l,u.queryFeatures(r,s,this._map.getZoom()));return a}inspect(r){return s=>{let a=["◎","⟍","◻"],l=r._map.wrapLatLng(s.latlng),u=r.queryFeatures(l.lng,l.lat);var d="";let _=!0;for(var[f,g]of u)for(var w of g)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===f&&this.xray.dataLayer===w.layerName))){d=d+`<div style="margin-top:${_?0:.5}em">${a[w.feature.geomType-1]} <b>${f} ${f?"/":""} ${w.layerName}</b> ${w.feature.id||""}</div>`;for(const b in w.feature.props)d=d+`<div style="font-size:0.9em">${b} = ${w.feature.props[b]}</div>`;_=!1}_&&(d="No features."),L.popup().setLatLng(s.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+d+"</div>").openOn(r._map)}}addInspector(r){return r.on("click",this.inspector)}removeInspector(r){return r.off("click",this.inspector)}}return new e(i)};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Nf({L:i,id:e,lat:n,lng:r,zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:d}){const _=i.map(e,{center:[n,r],zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:d});var g=Rf({url:"https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf?key=d23c43b7c56e123d"});return g.addTo(_),_}var Zr={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(i,e){(function(n,r){r(e)})(Xr,function(n){var r="1.9.4";function s(t){var o,h,c,p;for(h=1,c=arguments.length;h<c;h++){p=arguments[h];for(o in p)t[o]=p[o]}return t}var a=Object.create||function(){function t(){}return function(o){return t.prototype=o,new t}}();function l(t,o){var h=Array.prototype.slice;if(t.bind)return t.bind.apply(t,h.call(arguments,1));var c=h.call(arguments,2);return function(){return t.apply(o,c.length?c.concat(h.call(arguments)):arguments)}}var u=0;function d(t){return"_leaflet_id"in t||(t._leaflet_id=++u),t._leaflet_id}function _(t,o,h){var c,p,y,S;return S=function(){c=!1,p&&(y.apply(h,p),p=!1)},y=function(){c?p=arguments:(t.apply(h,arguments),setTimeout(S,o),c=!0)},y}function f(t,o,h){var c=o[1],p=o[0],y=c-p;return t===c&&h?t:((t-p)%y+y)%y+p}function g(){return!1}function w(t,o){if(o===!1)return t;var h=Math.pow(10,o===void 0?6:o);return Math.round(t*h)/h}function b(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function M(t){return b(t).split(/\s+/)}function C(t,o){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?a(t.options):{});for(var h in o)t.options[h]=o[h];return t.options}function I(t,o,h){var c=[];for(var p in t)c.push(encodeURIComponent(h?p.toUpperCase():p)+"="+encodeURIComponent(t[p]));return(!o||o.indexOf("?")===-1?"?":"&")+c.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function m(t,o){return t.replace(A,function(h,c){var p=o[c];if(p===void 0)throw new Error("No value provided for variable "+h);return typeof p=="function"&&(p=p(o)),p})}var x=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function P(t,o){for(var h=0;h<t.length;h++)if(t[h]===o)return h;return-1}var k="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var T=0;function B(t){var o=+new Date,h=Math.max(0,16-(o-T));return T=o+h,window.setTimeout(t,h)}var R=window.requestAnimationFrame||E("RequestAnimationFrame")||B,j=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function W(t,o,h){if(h&&R===B)t.call(o);else return R.call(window,l(t,o))}function U(t){t&&j.call(window,t)}var X={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:d,throttle:_,wrapNum:f,falseFn:g,formatNum:w,trim:b,splitWords:M,setOptions:C,getParamString:I,template:m,isArray:x,indexOf:P,emptyImageUrl:k,requestFn:R,cancelFn:j,requestAnimFrame:W,cancelAnimFrame:U};function v(){}v.extend=function(t){var o=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=o.__super__=this.prototype,c=a(h);c.constructor=o,o.prototype=c;for(var p in this)Object.prototype.hasOwnProperty.call(this,p)&&p!=="prototype"&&p!=="__super__"&&(o[p]=this[p]);return t.statics&&s(o,t.statics),t.includes&&(D(t.includes),s.apply(null,[c].concat(t.includes))),s(c,t),delete c.statics,delete c.includes,c.options&&(c.options=h.options?a(h.options):{},s(c.options,t.options)),c._initHooks=[],c.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var y=0,S=c._initHooks.length;y<S;y++)c._initHooks[y].call(this)}},o},v.include=function(t){var o=this.prototype.options;return s(this.prototype,t),t.options&&(this.prototype.options=o,this.mergeOptions(t.options)),this},v.mergeOptions=function(t){return s(this.prototype.options,t),this},v.addInitHook=function(t){var o=Array.prototype.slice.call(arguments,1),h=typeof t=="function"?t:function(){this[t].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function D(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=x(t)?t:[t];for(var o=0;o<t.length;o++)t[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var z={on:function(t,o,h){if(typeof t=="object")for(var c in t)this._on(c,t[c],o);else{t=M(t);for(var p=0,y=t.length;p<y;p++)this._on(t[p],o,h)}return this},off:function(t,o,h){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var c in t)this._off(c,t[c],o);else{t=M(t);for(var p=arguments.length===1,y=0,S=t.length;y<S;y++)p?this._off(t[y]):this._off(t[y],o,h)}return this},_on:function(t,o,h,c){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(t,o,h)===!1){h===this&&(h=void 0);var p={fn:o,ctx:h};c&&(p.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(p)}},_off:function(t,o,h){var c,p,y;if(this._events&&(c=this._events[t],!!c)){if(arguments.length===1){if(this._firingCount)for(p=0,y=c.length;p<y;p++)c[p].fn=g;delete this._events[t];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var S=this._listens(t,o,h);if(S!==!1){var O=c[S];this._firingCount&&(O.fn=g,this._events[t]=c=c.slice()),c.splice(S,1)}}},fire:function(t,o,h){if(!this.listens(t,h))return this;var c=s({},o,{type:t,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var p=this._events[t];if(p){this._firingCount=this._firingCount+1||1;for(var y=0,S=p.length;y<S;y++){var O=p[y],F=O.fn;O.once&&this.off(t,F,O.ctx),F.call(O.ctx||this,c)}this._firingCount--}}return h&&this._propagateEvent(c),this},listens:function(t,o,h,c){typeof t!="string"&&console.warn('"string" type argument expected');var p=o;typeof o!="function"&&(c=!!o,p=void 0,h=void 0);var y=this._events&&this._events[t];if(y&&y.length&&this._listens(t,p,h)!==!1)return!0;if(c){for(var S in this._eventParents)if(this._eventParents[S].listens(t,o,h,c))return!0}return!1},_listens:function(t,o,h){if(!this._events)return!1;var c=this._events[t]||[];if(!o)return!!c.length;h===this&&(h=void 0);for(var p=0,y=c.length;p<y;p++)if(c[p].fn===o&&c[p].ctx===h)return p;return!1},once:function(t,o,h){if(typeof t=="object")for(var c in t)this._on(c,t[c],o,!0);else{t=M(t);for(var p=0,y=t.length;p<y;p++)this._on(t[p],o,h,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[d(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[d(t)],this},_propagateEvent:function(t){for(var o in this._eventParents)this._eventParents[o].fire(t.type,s({layer:t.target,propagatedFrom:t.target},t),!0)}};z.addEventListener=z.on,z.removeEventListener=z.clearAllEventListeners=z.off,z.addOneTimeEventListener=z.once,z.fireEvent=z.fire,z.hasEventListeners=z.listens;var V=v.extend(z);function N(t,o,h){this.x=h?Math.round(t):t,this.y=h?Math.round(o):o}var K=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};N.prototype={clone:function(){return new N(this.x,this.y)},add:function(t){return this.clone()._add(Z(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(Z(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new N(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new N(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(t){t=Z(t);var o=t.x-this.x,h=t.y-this.y;return Math.sqrt(o*o+h*h)},equals:function(t){return t=Z(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=Z(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function Z(t,o,h){return t instanceof N?t:x(t)?new N(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new N(t.x,t.y):new N(t,o,h)}function H(t,o){if(t)for(var h=o?[t,o]:t,c=0,p=h.length;c<p;c++)this.extend(h[c])}H.prototype={extend:function(t){var o,h;if(!t)return this;if(t instanceof N||typeof t[0]=="number"||"x"in t)o=h=Z(t);else if(t=G(t),o=t.min,h=t.max,!o||!h)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=h.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(t){return Z((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return Z(this.min.x,this.max.y)},getTopRight:function(){return Z(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var o,h;return typeof t[0]=="number"||t instanceof N?t=Z(t):t=G(t),t instanceof H?(o=t.min,h=t.max):o=h=t,o.x>=this.min.x&&h.x<=this.max.x&&o.y>=this.min.y&&h.y<=this.max.y},intersects:function(t){t=G(t);var o=this.min,h=this.max,c=t.min,p=t.max,y=p.x>=o.x&&c.x<=h.x,S=p.y>=o.y&&c.y<=h.y;return y&&S},overlaps:function(t){t=G(t);var o=this.min,h=this.max,c=t.min,p=t.max,y=p.x>o.x&&c.x<h.x,S=p.y>o.y&&c.y<h.y;return y&&S},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var o=this.min,h=this.max,c=Math.abs(o.x-h.x)*t,p=Math.abs(o.y-h.y)*t;return G(Z(o.x-c,o.y-p),Z(h.x+c,h.y+p))},equals:function(t){return t?(t=G(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function G(t,o){return!t||t instanceof H?t:new H(t,o)}function nt(t,o){if(t)for(var h=o?[t,o]:t,c=0,p=h.length;c<p;c++)this.extend(h[c])}nt.prototype={extend:function(t){var o=this._southWest,h=this._northEast,c,p;if(t instanceof et)c=t,p=t;else if(t instanceof nt){if(c=t._southWest,p=t._northEast,!c||!p)return this}else return t?this.extend(q(t)||Q(t)):this;return!o&&!h?(this._southWest=new et(c.lat,c.lng),this._northEast=new et(p.lat,p.lng)):(o.lat=Math.min(c.lat,o.lat),o.lng=Math.min(c.lng,o.lng),h.lat=Math.max(p.lat,h.lat),h.lng=Math.max(p.lng,h.lng)),this},pad:function(t){var o=this._southWest,h=this._northEast,c=Math.abs(o.lat-h.lat)*t,p=Math.abs(o.lng-h.lng)*t;return new nt(new et(o.lat-c,o.lng-p),new et(h.lat+c,h.lng+p))},getCenter:function(){return new et((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new et(this.getNorth(),this.getWest())},getSouthEast:function(){return new et(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof et||"lat"in t?t=q(t):t=Q(t);var o=this._southWest,h=this._northEast,c,p;return t instanceof nt?(c=t.getSouthWest(),p=t.getNorthEast()):c=p=t,c.lat>=o.lat&&p.lat<=h.lat&&c.lng>=o.lng&&p.lng<=h.lng},intersects:function(t){t=Q(t);var o=this._southWest,h=this._northEast,c=t.getSouthWest(),p=t.getNorthEast(),y=p.lat>=o.lat&&c.lat<=h.lat,S=p.lng>=o.lng&&c.lng<=h.lng;return y&&S},overlaps:function(t){t=Q(t);var o=this._southWest,h=this._northEast,c=t.getSouthWest(),p=t.getNorthEast(),y=p.lat>o.lat&&c.lat<h.lat,S=p.lng>o.lng&&c.lng<h.lng;return y&&S},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,o){return t?(t=Q(t),this._southWest.equals(t.getSouthWest(),o)&&this._northEast.equals(t.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(t,o){return t instanceof nt?t:new nt(t,o)}function et(t,o,h){if(isNaN(t)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+o+")");this.lat=+t,this.lng=+o,h!==void 0&&(this.alt=+h)}et.prototype={equals:function(t,o){if(!t)return!1;t=q(t);var h=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return h<=(o===void 0?1e-9:o)},toString:function(t){return"LatLng("+w(this.lat,t)+", "+w(this.lng,t)+")"},distanceTo:function(t){return dt.distance(this,q(t))},wrap:function(){return dt.wrapLatLng(this)},toBounds:function(t){var o=180*t/40075017,h=o/Math.cos(Math.PI/180*this.lat);return Q([this.lat-o,this.lng-h],[this.lat+o,this.lng+h])},clone:function(){return new et(this.lat,this.lng,this.alt)}};function q(t,o,h){return t instanceof et?t:x(t)&&typeof t[0]!="object"?t.length===3?new et(t[0],t[1],t[2]):t.length===2?new et(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new et(t.lat,"lng"in t?t.lng:t.lon,t.alt):o===void 0?null:new et(t,o,h)}var ht={latLngToPoint:function(t,o){var h=this.projection.project(t),c=this.scale(o);return this.transformation._transform(h,c)},pointToLatLng:function(t,o){var h=this.scale(o),c=this.transformation.untransform(t,h);return this.projection.unproject(c)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var o=this.projection.bounds,h=this.scale(t),c=this.transformation.transform(o.min,h),p=this.transformation.transform(o.max,h);return new H(c,p)},infinite:!1,wrapLatLng:function(t){var o=this.wrapLng?f(t.lng,this.wrapLng,!0):t.lng,h=this.wrapLat?f(t.lat,this.wrapLat,!0):t.lat,c=t.alt;return new et(h,o,c)},wrapLatLngBounds:function(t){var o=t.getCenter(),h=this.wrapLatLng(o),c=o.lat-h.lat,p=o.lng-h.lng;if(c===0&&p===0)return t;var y=t.getSouthWest(),S=t.getNorthEast(),O=new et(y.lat-c,y.lng-p),F=new et(S.lat-c,S.lng-p);return new nt(O,F)}},dt=s({},ht,{wrapLng:[-180,180],R:6371e3,distance:function(t,o){var h=Math.PI/180,c=t.lat*h,p=o.lat*h,y=Math.sin((o.lat-t.lat)*h/2),S=Math.sin((o.lng-t.lng)*h/2),O=y*y+Math.cos(c)*Math.cos(p)*S*S,F=2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O));return this.R*F}}),xt=6378137,Mt={R:xt,MAX_LATITUDE:85.0511287798,project:function(t){var o=Math.PI/180,h=this.MAX_LATITUDE,c=Math.max(Math.min(h,t.lat),-h),p=Math.sin(c*o);return new N(this.R*t.lng*o,this.R*Math.log((1+p)/(1-p))/2)},unproject:function(t){var o=180/Math.PI;return new et((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*o,t.x*o/this.R)},bounds:function(){var t=xt*Math.PI;return new H([-t,-t],[t,t])}()};function Lt(t,o,h,c){if(x(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=o,this._c=h,this._d=c}Lt.prototype={transform:function(t,o){return this._transform(t.clone(),o)},_transform:function(t,o){return o=o||1,t.x=o*(this._a*t.x+this._b),t.y=o*(this._c*t.y+this._d),t},untransform:function(t,o){return o=o||1,new N((t.x/o-this._b)/this._a,(t.y/o-this._d)/this._c)}};function Dt(t,o,h,c){return new Lt(t,o,h,c)}var Ct=s({},dt,{code:"EPSG:3857",projection:Mt,transformation:function(){var t=.5/(Math.PI*Mt.R);return Dt(t,.5,-t,.5)}()}),Ft=s({},Ct,{code:"EPSG:900913"});function It(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Bt(t,o){var h="",c,p,y,S,O,F;for(c=0,y=t.length;c<y;c++){for(O=t[c],p=0,S=O.length;p<S;p++)F=O[p],h+=(p?"L":"M")+F.x+" "+F.y;h+=o?J.svg?"z":"x":""}return h||"M0 0"}var St=document.documentElement.style,Zt="ActiveXObject"in window,ye=Zt&&!document.addEventListener,Ri="msLaunchUri"in navigator&&!("documentMode"in document),ei=te("webkit"),Ni=te("android"),ji=te("android 2")||te("android 3"),Wi=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Yi=Ni&&te("Google")&&Wi<537&&!("AudioNode"in window),xe=!!window.opera,so=!Ri&&te("chrome"),ao=te("gecko")&&!ei&&!xe&&!Zt,Ch=!so&&te("safari"),ho=te("phantom"),lo="OTransition"in St,Sh=navigator.platform.indexOf("Win")===0,uo=Zt&&"transition"in St,Zn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ji,co="MozPerspective"in St,kh=!window.L_DISABLE_3D&&(uo||Zn||co)&&!lo&&!ho,ii=typeof orientation<"u"||te("mobile"),Th=ii&&ei,Eh=ii&&Zn,fo=!window.PointerEvent&&window.MSPointerEvent,po=!!(window.PointerEvent||fo),_o="ontouchstart"in window||!!window.TouchEvent,Dh=!window.L_NO_TOUCH&&(_o||po),Ih=ii&&xe,Bh=ii&&ao,zh=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Oh=function(){var t=!1;try{var o=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return t}(),Ah=function(){return!!document.createElement("canvas").getContext}(),Rn=!!(document.createElementNS&&It("svg").createSVGRect),Fh=!!Rn&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Zh=!Rn&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var o=t.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),Rh=navigator.platform.indexOf("Mac")===0,Nh=navigator.platform.indexOf("Linux")===0;function te(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var J={ie:Zt,ielt9:ye,edge:Ri,webkit:ei,android:Ni,android23:ji,androidStock:Yi,opera:xe,chrome:so,gecko:ao,safari:Ch,phantom:ho,opera12:lo,win:Sh,ie3d:uo,webkit3d:Zn,gecko3d:co,any3d:kh,mobile:ii,mobileWebkit:Th,mobileWebkit3d:Eh,msPointer:fo,pointer:po,touch:Dh,touchNative:_o,mobileOpera:Ih,mobileGecko:Bh,retina:zh,passiveEvents:Oh,canvas:Ah,svg:Rn,vml:Zh,inlineSvg:Fh,mac:Rh,linux:Nh},mo=J.msPointer?"MSPointerDown":"pointerdown",go=J.msPointer?"MSPointerMove":"pointermove",vo=J.msPointer?"MSPointerUp":"pointerup",yo=J.msPointer?"MSPointerCancel":"pointercancel",Nn={touchstart:mo,touchmove:go,touchend:vo,touchcancel:yo},xo={touchstart:Vh,touchmove:Xi,touchend:Xi,touchcancel:Xi},Ie={},wo=!1;function jh(t,o,h){return o==="touchstart"&&Uh(),xo[o]?(h=xo[o].bind(this,h),t.addEventListener(Nn[o],h,!1),h):(console.warn("wrong event specified:",o),g)}function Wh(t,o,h){if(!Nn[o]){console.warn("wrong event specified:",o);return}t.removeEventListener(Nn[o],h,!1)}function Yh(t){Ie[t.pointerId]=t}function Xh(t){Ie[t.pointerId]&&(Ie[t.pointerId]=t)}function bo(t){delete Ie[t.pointerId]}function Uh(){wo||(document.addEventListener(mo,Yh,!0),document.addEventListener(go,Xh,!0),document.addEventListener(vo,bo,!0),document.addEventListener(yo,bo,!0),wo=!0)}function Xi(t,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var h in Ie)o.touches.push(Ie[h]);o.changedTouches=[o],t(o)}}function Vh(t,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&Pt(o),Xi(t,o)}function Hh(t){var o={},h,c;for(c in t)h=t[c],o[c]=h&&h.bind?h.bind(t):h;return t=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var Gh=200;function qh(t,o){t.addEventListener("dblclick",o);var h=0,c;function p(y){if(y.detail!==1){c=y.detail;return}if(!(y.pointerType==="mouse"||y.sourceCapabilities&&!y.sourceCapabilities.firesTouchEvents)){var S=So(y);if(!(S.some(function(F){return F instanceof HTMLLabelElement&&F.attributes.for})&&!S.some(function(F){return F instanceof HTMLInputElement||F instanceof HTMLSelectElement}))){var O=Date.now();O-h<=Gh?(c++,c===2&&o(Hh(y))):c=1,h=O}}}return t.addEventListener("click",p),{dblclick:o,simDblclick:p}}function $h(t,o){t.removeEventListener("dblclick",o.dblclick),t.removeEventListener("click",o.simDblclick)}var jn=Hi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ni=Hi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Po=ni==="webkitTransition"||ni==="OTransition"?ni+"End":"transitionend";function Mo(t){return typeof t=="string"?document.getElementById(t):t}function ri(t,o){var h=t.style[o]||t.currentStyle&&t.currentStyle[o];if((!h||h==="auto")&&document.defaultView){var c=document.defaultView.getComputedStyle(t,null);h=c?c[o]:null}return h==="auto"?null:h}function lt(t,o,h){var c=document.createElement(t);return c.className=o||"",h&&h.appendChild(c),c}function ft(t){var o=t.parentNode;o&&o.removeChild(t)}function Ui(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Be(t){var o=t.parentNode;o&&o.lastChild!==t&&o.appendChild(t)}function ze(t){var o=t.parentNode;o&&o.firstChild!==t&&o.insertBefore(t,o.firstChild)}function Wn(t,o){if(t.classList!==void 0)return t.classList.contains(o);var h=Vi(t);return h.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(h)}function ot(t,o){if(t.classList!==void 0)for(var h=M(o),c=0,p=h.length;c<p;c++)t.classList.add(h[c]);else if(!Wn(t,o)){var y=Vi(t);Yn(t,(y?y+" ":"")+o)}}function pt(t,o){t.classList!==void 0?t.classList.remove(o):Yn(t,b((" "+Vi(t)+" ").replace(" "+o+" "," ")))}function Yn(t,o){t.className.baseVal===void 0?t.className=o:t.className.baseVal=o}function Vi(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function Wt(t,o){"opacity"in t.style?t.style.opacity=o:"filter"in t.style&&Kh(t,o)}function Kh(t,o){var h=!1,c="DXImageTransform.Microsoft.Alpha";try{h=t.filters.item(c)}catch{if(o===1)return}o=Math.round(o*100),h?(h.Enabled=o!==100,h.Opacity=o):t.style.filter+=" progid:"+c+"(opacity="+o+")"}function Hi(t){for(var o=document.documentElement.style,h=0;h<t.length;h++)if(t[h]in o)return t[h];return!1}function we(t,o,h){var c=o||new N(0,0);t.style[jn]=(J.ie3d?"translate("+c.x+"px,"+c.y+"px)":"translate3d("+c.x+"px,"+c.y+"px,0)")+(h?" scale("+h+")":"")}function gt(t,o){t._leaflet_pos=o,J.any3d?we(t,o):(t.style.left=o.x+"px",t.style.top=o.y+"px")}function be(t){return t._leaflet_pos||new N(0,0)}var oi,si,Xn;if("onselectstart"in document)oi=function(){rt(window,"selectstart",Pt)},si=function(){ct(window,"selectstart",Pt)};else{var ai=Hi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);oi=function(){if(ai){var t=document.documentElement.style;Xn=t[ai],t[ai]="none"}},si=function(){ai&&(document.documentElement.style[ai]=Xn,Xn=void 0)}}function Un(){rt(window,"dragstart",Pt)}function Vn(){ct(window,"dragstart",Pt)}var Gi,Hn;function Gn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(qi(),Gi=t,Hn=t.style.outlineStyle,t.style.outlineStyle="none",rt(window,"keydown",qi))}function qi(){Gi&&(Gi.style.outlineStyle=Hn,Gi=void 0,Hn=void 0,ct(window,"keydown",qi))}function Lo(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function qn(t){var o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}var Jh={__proto__:null,TRANSFORM:jn,TRANSITION:ni,TRANSITION_END:Po,get:Mo,getStyle:ri,create:lt,remove:ft,empty:Ui,toFront:Be,toBack:ze,hasClass:Wn,addClass:ot,removeClass:pt,setClass:Yn,getClass:Vi,setOpacity:Wt,testProp:Hi,setTransform:we,setPosition:gt,getPosition:be,get disableTextSelection(){return oi},get enableTextSelection(){return si},disableImageDrag:Un,enableImageDrag:Vn,preventOutline:Gn,restoreOutline:qi,getSizedParentNode:Lo,getScale:qn};function rt(t,o,h,c){if(o&&typeof o=="object")for(var p in o)Kn(t,p,o[p],h);else{o=M(o);for(var y=0,S=o.length;y<S;y++)Kn(t,o[y],h,c)}return this}var ee="_leaflet_events";function ct(t,o,h,c){if(arguments.length===1)Co(t),delete t[ee];else if(o&&typeof o=="object")for(var p in o)Jn(t,p,o[p],h);else if(o=M(o),arguments.length===2)Co(t,function(O){return P(o,O)!==-1});else for(var y=0,S=o.length;y<S;y++)Jn(t,o[y],h,c);return this}function Co(t,o){for(var h in t[ee]){var c=h.split(/\d/)[0];(!o||o(c))&&Jn(t,c,null,null,h)}}var $n={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Kn(t,o,h,c){var p=o+d(h)+(c?"_"+d(c):"");if(t[ee]&&t[ee][p])return this;var y=function(O){return h.call(c||t,O||window.event)},S=y;!J.touchNative&&J.pointer&&o.indexOf("touch")===0?y=jh(t,o,y):J.touch&&o==="dblclick"?y=qh(t,y):"addEventListener"in t?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?t.addEventListener($n[o]||o,y,J.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(y=function(O){O=O||window.event,tr(t,O)&&S(O)},t.addEventListener($n[o],y,!1)):t.addEventListener(o,S,!1):t.attachEvent("on"+o,y),t[ee]=t[ee]||{},t[ee][p]=y}function Jn(t,o,h,c,p){p=p||o+d(h)+(c?"_"+d(c):"");var y=t[ee]&&t[ee][p];if(!y)return this;!J.touchNative&&J.pointer&&o.indexOf("touch")===0?Wh(t,o,y):J.touch&&o==="dblclick"?$h(t,y):"removeEventListener"in t?t.removeEventListener($n[o]||o,y,!1):t.detachEvent("on"+o,y),t[ee][p]=null}function Pe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Qn(t){return Kn(t,"wheel",Pe),this}function hi(t){return rt(t,"mousedown touchstart dblclick contextmenu",Pe),t._leaflet_disable_click=!0,this}function Pt(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Me(t){return Pt(t),Pe(t),this}function So(t){if(t.composedPath)return t.composedPath();for(var o=[],h=t.target;h;)o.push(h),h=h.parentNode;return o}function ko(t,o){if(!o)return new N(t.clientX,t.clientY);var h=qn(o),c=h.boundingClientRect;return new N((t.clientX-c.left)/h.x-o.clientLeft,(t.clientY-c.top)/h.y-o.clientTop)}var Qh=J.linux&&J.chrome?window.devicePixelRatio:J.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function To(t){return J.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Qh:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function tr(t,o){var h=o.relatedTarget;if(!h)return!0;try{for(;h&&h!==t;)h=h.parentNode}catch{return!1}return h!==t}var tl={__proto__:null,on:rt,off:ct,stopPropagation:Pe,disableScrollPropagation:Qn,disableClickPropagation:hi,preventDefault:Pt,stop:Me,getPropagationPath:So,getMousePosition:ko,getWheelDelta:To,isExternalTarget:tr,addListener:rt,removeListener:ct},Eo=V.extend({run:function(t,o,h,c){this.stop(),this._el=t,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(c||.5,.2),this._startPos=be(t),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=W(this._animate,this),this._step()},_step:function(t){var o=+new Date-this._startTime,h=this._duration*1e3;o<h?this._runFrame(this._easeOut(o/h),t):(this._runFrame(1),this._complete())},_runFrame:function(t,o){var h=this._startPos.add(this._offset.multiplyBy(t));o&&h._round(),gt(this._el,h),this.fire("step")},_complete:function(){U(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),at=V.extend({options:{crs:Ct,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,o){o=C(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(q(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ni&&J.any3d&&!J.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,Po,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,o,h){if(o=o===void 0?this._zoom:this._limitZoom(o),t=this._limitCenter(q(t),o,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var c=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,h.zoom):this._tryAnimatedPan(t,h.pan);if(c)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o,h.pan&&h.pan.noMoveStart),this},setZoom:function(t,o){return this._loaded?this.setView(this.getCenter(),t,{zoom:o}):(this._zoom=t,this)},zoomIn:function(t,o){return t=t||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,o)},zoomOut:function(t,o){return t=t||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,o)},setZoomAround:function(t,o,h){var c=this.getZoomScale(o),p=this.getSize().divideBy(2),y=t instanceof N?t:this.latLngToContainerPoint(t),S=y.subtract(p).multiplyBy(1-1/c),O=this.containerPointToLatLng(p.add(S));return this.setView(O,o,{zoom:h})},_getBoundsCenterZoom:function(t,o){o=o||{},t=t.getBounds?t.getBounds():Q(t);var h=Z(o.paddingTopLeft||o.padding||[0,0]),c=Z(o.paddingBottomRight||o.padding||[0,0]),p=this.getBoundsZoom(t,!1,h.add(c));if(p=typeof o.maxZoom=="number"?Math.min(o.maxZoom,p):p,p===1/0)return{center:t.getCenter(),zoom:p};var y=c.subtract(h).divideBy(2),S=this.project(t.getSouthWest(),p),O=this.project(t.getNorthEast(),p),F=this.unproject(S.add(O).divideBy(2).add(y),p);return{center:F,zoom:p}},fitBounds:function(t,o){if(t=Q(t),!t.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(t,o);return this.setView(h.center,h.zoom,o)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,o){return this.setView(t,this._zoom,{pan:o})},panBy:function(t,o){if(t=Z(t).round(),o=o||{},!t.x&&!t.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Eo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){ot(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,h,o.duration||.25,o.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,o,h){if(h=h||{},h.animate===!1||!J.any3d)return this.setView(t,o,h);this._stop();var c=this.project(this.getCenter()),p=this.project(t),y=this.getSize(),S=this._zoom;t=q(t),o=o===void 0?S:o;var O=Math.max(y.x,y.y),F=O*this.getZoomScale(S,o),Y=p.distanceTo(c)||1,$=1.42,tt=$*$;function st(vt){var hn=vt?-1:1,Wl=vt?F:O,Yl=F*F-O*O+hn*tt*tt*Y*Y,Xl=2*Wl*tt*Y,cr=Yl/Xl,us=Math.sqrt(cr*cr+1)-cr,Ul=us<1e-9?-18:Math.log(us);return Ul}function kt(vt){return(Math.exp(vt)-Math.exp(-vt))/2}function bt(vt){return(Math.exp(vt)+Math.exp(-vt))/2}function Xt(vt){return kt(vt)/bt(vt)}var zt=st(0);function Ne(vt){return O*(bt(zt)/bt(zt+$*vt))}function Zl(vt){return O*(bt(zt)*Xt(zt+$*vt)-kt(zt))/tt}function Rl(vt){return 1-Math.pow(1-vt,1.5)}var Nl=Date.now(),hs=(st(1)-zt)/$,jl=h.duration?1e3*h.duration:1e3*hs*.8;function ls(){var vt=(Date.now()-Nl)/jl,hn=Rl(vt)*hs;vt<=1?(this._flyToFrame=W(ls,this),this._move(this.unproject(c.add(p.subtract(c).multiplyBy(Zl(hn)/Y)),S),this.getScaleZoom(O/Ne(hn),S),{flyTo:!0})):this._move(t,o)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),ls.call(this),this},flyToBounds:function(t,o){var h=this._getBoundsCenterZoom(t,o);return this.flyTo(h.center,h.zoom,o)},setMaxBounds:function(t){return t=Q(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var o=this.options.minZoom;return this.options.minZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var o=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,o){this._enforcingBounds=!0;var h=this.getCenter(),c=this._limitCenter(h,this._zoom,Q(t));return h.equals(c)||this.panTo(c,o),this._enforcingBounds=!1,this},panInside:function(t,o){o=o||{};var h=Z(o.paddingTopLeft||o.padding||[0,0]),c=Z(o.paddingBottomRight||o.padding||[0,0]),p=this.project(this.getCenter()),y=this.project(t),S=this.getPixelBounds(),O=G([S.min.add(h),S.max.subtract(c)]),F=O.getSize();if(!O.contains(y)){this._enforcingBounds=!0;var Y=y.subtract(O.getCenter()),$=O.extend(y).getSize().subtract(F);p.x+=Y.x<0?-$.x:$.x,p.y+=Y.y<0?-$.y:$.y,this.panTo(this.unproject(p),o),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=s({animate:!1,pan:!0},t===!0?{animate:!0}:t);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),c=o.divideBy(2).round(),p=h.divideBy(2).round(),y=c.subtract(p);return!y.x&&!y.y?this:(t.animate&&t.pan?this.panBy(y):(t.pan&&this._rawPanBy(y),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=s({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,h,t):navigator.geolocation.getCurrentPosition(o,h,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var o=t.code,h=t.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var o=t.coords.latitude,h=t.coords.longitude,c=new et(o,h),p=c.toBounds(t.coords.accuracy*2),y=this._locateOptions;if(y.setView){var S=this.getBoundsZoom(p);this.setView(c,y.maxZoom?Math.min(S,y.maxZoom):S)}var O={latlng:c,bounds:p,timestamp:t.timestamp};for(var F in t.coords)typeof t.coords[F]=="number"&&(O[F]=t.coords[F]);this.fire("locationfound",O)}},addHandler:function(t,o){if(!o)return this;var h=this[t]=new o(this);return this._handlers.push(h),this.options[t]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(U(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ft(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,o){var h="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),c=lt("div",h,o||this._mapPane);return t&&(this._panes[t]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),o=this.unproject(t.getBottomLeft()),h=this.unproject(t.getTopRight());return new nt(o,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,o,h){t=Q(t),h=Z(h||[0,0]);var c=this.getZoom()||0,p=this.getMinZoom(),y=this.getMaxZoom(),S=t.getNorthWest(),O=t.getSouthEast(),F=this.getSize().subtract(h),Y=G(this.project(O,c),this.project(S,c)).getSize(),$=J.any3d?this.options.zoomSnap:1,tt=F.x/Y.x,st=F.y/Y.y,kt=o?Math.max(tt,st):Math.min(tt,st);return c=this.getScaleZoom(kt,c),$&&(c=Math.round(c/($/100))*($/100),c=o?Math.ceil(c/$)*$:Math.floor(c/$)*$),Math.max(p,Math.min(y,c))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new N(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,o){var h=this._getTopLeftPoint(t,o);return new H(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,o){var h=this.options.crs;return o=o===void 0?this._zoom:o,h.scale(t)/h.scale(o)},getScaleZoom:function(t,o){var h=this.options.crs;o=o===void 0?this._zoom:o;var c=h.zoom(t*h.scale(o));return isNaN(c)?1/0:c},project:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(q(t),o)},unproject:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(Z(t),o)},layerPointToLatLng:function(t){var o=Z(t).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(t){var o=this.project(q(t))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(q(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(Q(t))},distance:function(t,o){return this.options.crs.distance(q(t),q(o))},containerPointToLayerPoint:function(t){return Z(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return Z(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var o=this.containerPointToLayerPoint(Z(t));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(t)))},mouseEventToContainerPoint:function(t){return ko(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var o=this._container=Mo(t);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(o,"scroll",this._onScroll,this),this._containerId=d(o)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&J.any3d,ot(t,"leaflet-container"+(J.touch?" leaflet-touch":"")+(J.retina?" leaflet-retina":"")+(J.ielt9?" leaflet-oldie":"")+(J.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=ri(t,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),gt(this._mapPane,new N(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ot(t.markerPane,"leaflet-zoom-hide"),ot(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,o,h){gt(this._mapPane,new N(0,0));var c=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var p=this._zoom!==o;this._moveStart(p,h)._move(t,o)._moveEnd(p),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(t,o){return t&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(t,o,h,c){o===void 0&&(o=this._zoom);var p=this._zoom!==o;return this._zoom=o,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),c?h&&h.pinch&&this.fire("zoom",h):((p||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return U(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){gt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[d(this._container)]=this;var o=t?ct:rt;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),J.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){U(this._resizeRequest),this._resizeRequest=W(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,o){for(var h=[],c,p=o==="mouseout"||o==="mouseover",y=t.target||t.srcElement,S=!1;y;){if(c=this._targets[d(y)],c&&(o==="click"||o==="preclick")&&this._draggableMoved(c)){S=!0;break}if(c&&c.listens(o,!0)&&(p&&!tr(y,t)||(h.push(c),p))||y===this._container)break;y=y.parentNode}return!h.length&&!S&&!p&&this.listens(o,!0)&&(h=[this]),h},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var o=t.target||t.srcElement;if(!(!this._loaded||o._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(o))){var h=t.type;h==="mousedown"&&Gn(o),this._fireDOMEvent(t,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,o,h){if(t.type==="click"){var c=s({},t);c.type="preclick",this._fireDOMEvent(c,c.type,h)}var p=this._findEventTargets(t,o);if(h){for(var y=[],S=0;S<h.length;S++)h[S].listens(o,!0)&&y.push(h[S]);p=y.concat(p)}if(p.length){o==="contextmenu"&&Pt(t);var O=p[0],F={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var Y=O.getLatLng&&(!O._radius||O._radius<=10);F.containerPoint=Y?this.latLngToContainerPoint(O.getLatLng()):this.mouseEventToContainerPoint(t),F.layerPoint=this.containerPointToLayerPoint(F.containerPoint),F.latlng=Y?O.getLatLng():this.layerPointToLatLng(F.layerPoint)}for(S=0;S<p.length;S++)if(p[S].fire(o,F,!0),F.originalEvent._stopped||p[S].options.bubblingMouseEvents===!1&&P(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,o=this._handlers.length;t<o;t++)this._handlers[t].disable()},whenReady:function(t,o){return this._loaded?t.call(o||this,{target:this}):this.on("load",t,o),this},_getMapPanePos:function(){return be(this._mapPane)||new N(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,o){var h=t&&o!==void 0?this._getNewPixelOrigin(t,o):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,o){var h=this.getSize()._divideBy(2);return this.project(t,o)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,o,h){var c=this._getNewPixelOrigin(h,o);return this.project(t,o)._subtract(c)},_latLngBoundsToNewLayerBounds:function(t,o,h){var c=this._getNewPixelOrigin(h,o);return G([this.project(t.getSouthWest(),o)._subtract(c),this.project(t.getNorthWest(),o)._subtract(c),this.project(t.getSouthEast(),o)._subtract(c),this.project(t.getNorthEast(),o)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,o,h){if(!h)return t;var c=this.project(t,o),p=this.getSize().divideBy(2),y=new H(c.subtract(p),c.add(p)),S=this._getBoundsOffset(y,h,o);return Math.abs(S.x)<=1&&Math.abs(S.y)<=1?t:this.unproject(c.add(S),o)},_limitOffset:function(t,o){if(!o)return t;var h=this.getPixelBounds(),c=new H(h.min.add(t),h.max.add(t));return t.add(this._getBoundsOffset(c,o))},_getBoundsOffset:function(t,o,h){var c=G(this.project(o.getNorthEast(),h),this.project(o.getSouthWest(),h)),p=c.min.subtract(t.min),y=c.max.subtract(t.max),S=this._rebound(p.x,-y.x),O=this._rebound(p.y,-y.y);return new N(S,O)},_rebound:function(t,o){return t+o>0?Math.round(t-o)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(o))},_limitZoom:function(t){var o=this.getMinZoom(),h=this.getMaxZoom(),c=J.any3d?this.options.zoomSnap:1;return c&&(t=Math.round(t/c)*c),Math.max(o,Math.min(h,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,o){var h=this._getCenterOffset(t)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,o),!0)},_createAnimProxy:function(){var t=this._proxy=lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(o){var h=jn,c=this._proxy.style[h];we(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),c===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),o=this.getZoom();we(this._proxy,this.project(t,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,o,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var c=this.getZoomScale(o),p=this._getCenterOffset(t)._divideBy(1-1/c);return h.animate!==!0&&!this.getSize().contains(p)?!1:(W(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(t,o,!0)},this),!0)},_animateZoom:function(t,o,h,c){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=o,ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:o,noUpdate:c}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function el(t,o){return new at(t,o)}var Vt=v.extend({options:{position:"topright"},initialize:function(t){C(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var o=this._container=this.onAdd(t),h=this.getPosition(),c=t._controlCorners[h];return ot(o,"leaflet-control"),h.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),li=function(t){return new Vt(t)};at.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},o="leaflet-",h=this._controlContainer=lt("div",o+"control-container",this._container);function c(p,y){var S=o+p+" "+o+y;t[p+y]=lt("div",S,h)}c("top","left"),c("top","right"),c("bottom","left"),c("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ft(this._controlCorners[t]);ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Do=Vt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,o,h,c){return h<c?-1:c<h?1:0}},initialize:function(t,o,h){C(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var c in t)this._addLayer(t[c],c);for(c in o)this._addLayer(o[c],c,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Vt.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,o){return this._addLayer(t,o),this._map?this._update():this},addOverlay:function(t,o){return this._addLayer(t,o,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var o=this._getLayer(d(t));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):pt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",o=this._container=lt("div",t),h=this.options.collapsed;o.setAttribute("aria-haspopup",!0),hi(o),Qn(o);var c=this._section=lt("section",t+"-list");h&&(this._map.on("click",this.collapse,this),rt(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var p=this._layersLink=lt("a",t+"-toggle",o);p.href="#",p.title="Layers",p.setAttribute("role","button"),rt(p,{keydown:function(y){y.keyCode===13&&this._expandSafely()},click:function(y){Pt(y),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=lt("div",t+"-base",c),this._separator=lt("div",t+"-separator",c),this._overlaysList=lt("div",t+"-overlays",c),o.appendChild(c)},_getLayer:function(t){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&d(this._layers[o].layer)===t)return this._layers[o]},_addLayer:function(t,o,h){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:o,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(c,p){return this.options.sortFunction(c.layer,p.layer,c.name,p.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ui(this._baseLayersList),Ui(this._overlaysList),this._layerControlInputs=[];var t,o,h,c,p=0;for(h=0;h<this._layers.length;h++)c=this._layers[h],this._addItem(c),o=o||c.overlay,t=t||!c.overlay,p+=c.overlay?0:1;return this.options.hideSingleBase&&(t=t&&p>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=o&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var o=this._getLayer(d(t.target)),h=o.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;h&&this._map.fire(h,o)},_createRadioElement:function(t,o){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(o?' checked="checked"':"")+"/>",c=document.createElement("div");return c.innerHTML=h,c.firstChild},_addItem:function(t){var o=document.createElement("label"),h=this._map.hasLayer(t.layer),c;t.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=h):c=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(c),c.layerId=d(t.layer),rt(c,"click",this._onInputClick,this);var p=document.createElement("span");p.innerHTML=" "+t.name;var y=document.createElement("span");o.appendChild(y),y.appendChild(c),y.appendChild(p);var S=t.overlay?this._overlaysList:this._baseLayersList;return S.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,o,h,c=[],p=[];this._handlingClick=!0;for(var y=t.length-1;y>=0;y--)o=t[y],h=this._getLayer(o.layerId).layer,o.checked?c.push(h):o.checked||p.push(h);for(y=0;y<p.length;y++)this._map.hasLayer(p[y])&&this._map.removeLayer(p[y]);for(y=0;y<c.length;y++)this._map.hasLayer(c[y])||this._map.addLayer(c[y]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,o,h,c=this._map.getZoom(),p=t.length-1;p>=0;p--)o=t[p],h=this._getLayer(o.layerId).layer,o.disabled=h.options.minZoom!==void 0&&c<h.options.minZoom||h.options.maxZoom!==void 0&&c>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,rt(t,"click",Pt),this.expand();var o=this;setTimeout(function(){ct(t,"click",Pt),o._preventClick=!1})}}),il=function(t,o,h){return new Do(t,o,h)},er=Vt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var o="leaflet-control-zoom",h=lt("div",o+" leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,o+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,o+"-out",h,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,o,h,c,p){var y=lt("a",h,c);return y.innerHTML=t,y.href="#",y.title=o,y.setAttribute("role","button"),y.setAttribute("aria-label",o),hi(y),rt(y,"click",Me),rt(y,"click",p,this),rt(y,"click",this._refocusOnMap,this),y},_updateDisabled:function(){var t=this._map,o="leaflet-disabled";pt(this._zoomInButton,o),pt(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ot(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ot(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});at.mergeOptions({zoomControl:!0}),at.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new er,this.addControl(this.zoomControl))});var nl=function(t){return new er(t)},Io=Vt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var o="leaflet-control-scale",h=lt("div",o),c=this.options;return this._addScales(c,o+"-line",h),t.on(c.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),h},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,o,h){t.metric&&(this._mScale=lt("div",o,h)),t.imperial&&(this._iScale=lt("div",o,h))},_update:function(){var t=this._map,o=t.getSize().y/2,h=t.distance(t.containerPointToLatLng([0,o]),t.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(h)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var o=this._getRoundNum(t),h=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,h,o/t)},_updateImperial:function(t){var o=t*3.2808399,h,c,p;o>5280?(h=o/5280,c=this._getRoundNum(h),this._updateScale(this._iScale,c+" mi",c/h)):(p=this._getRoundNum(o),this._updateScale(this._iScale,p+" ft",p/o))},_updateScale:function(t,o,h){t.style.width=Math.round(this.options.maxWidth*h)+"px",t.innerHTML=o},_getRoundNum:function(t){var o=Math.pow(10,(Math.floor(t)+"").length-1),h=t/o;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,o*h}}),rl=function(t){return new Io(t)},ol='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ir=Vt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(J.inlineSvg?ol+" ":"")+"Leaflet</a>"},initialize:function(t){C(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=lt("div","leaflet-control-attribution"),hi(this._container);for(var o in t._layers)t._layers[o].getAttribution&&this.addAttribution(t._layers[o].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var o in this._attributions)this._attributions[o]&&t.push(o);var h=[];this.options.prefix&&h.push(this.options.prefix),t.length&&h.push(t.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});at.mergeOptions({attributionControl:!0}),at.addInitHook(function(){this.options.attributionControl&&new ir().addTo(this)});var sl=function(t){return new ir(t)};Vt.Layers=Do,Vt.Zoom=er,Vt.Scale=Io,Vt.Attribution=ir,li.layers=il,li.zoom=nl,li.scale=rl,li.attribution=sl;var ie=v.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ie.addTo=function(t,o){return t.addHandler(o,this),this};var al={Events:z},Bo=J.touch?"touchstart mousedown":"mousedown",me=V.extend({options:{clickTolerance:3},initialize:function(t,o,h,c){C(this,c),this._element=t,this._dragStartTarget=o||t,this._preventOutline=h},enable:function(){this._enabled||(rt(this._dragStartTarget,Bo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(me._dragging===this&&this.finishDrag(!0),ct(this._dragStartTarget,Bo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Wn(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){me._dragging===this&&this.finishDrag();return}if(!(me._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(me._dragging=this,this._preventOutline&&Gn(this._element),Un(),oi(),!this._moving)){this.fire("down");var o=t.touches?t.touches[0]:t,h=Lo(this._element);this._startPoint=new N(o.clientX,o.clientY),this._startPos=be(this._element),this._parentScale=qn(h);var c=t.type==="mousedown";rt(document,c?"mousemove":"touchmove",this._onMove,this),rt(document,c?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var o=t.touches&&t.touches.length===1?t.touches[0]:t,h=new N(o.clientX,o.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Pt(t),this._moved||(this.fire("dragstart"),this._moved=!0,ot(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),gt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){pt(document.body,"leaflet-dragging"),this._lastTarget&&(pt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ct(document,"mousemove touchmove",this._onMove,this),ct(document,"mouseup touchend touchcancel",this._onUp,this),Vn(),si();var o=this._moved&&this._moving;this._moving=!1,me._dragging=!1,o&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function zo(t,o,h){var c,p=[1,4,2,8],y,S,O,F,Y,$,tt,st;for(y=0,$=t.length;y<$;y++)t[y]._code=Le(t[y],o);for(O=0;O<4;O++){for(tt=p[O],c=[],y=0,$=t.length,S=$-1;y<$;S=y++)F=t[y],Y=t[S],F._code&tt?Y._code&tt||(st=$i(Y,F,tt,o,h),st._code=Le(st,o),c.push(st)):(Y._code&tt&&(st=$i(Y,F,tt,o,h),st._code=Le(st,o),c.push(st)),c.push(F));t=c}return t}function Oo(t,o){var h,c,p,y,S,O,F,Y,$;if(!t||t.length===0)throw new Error("latlngs not passed");Yt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var tt=q([0,0]),st=Q(t),kt=st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest());kt<1700&&(tt=nr(t));var bt=t.length,Xt=[];for(h=0;h<bt;h++){var zt=q(t[h]);Xt.push(o.project(q([zt.lat-tt.lat,zt.lng-tt.lng])))}for(O=F=Y=0,h=0,c=bt-1;h<bt;c=h++)p=Xt[h],y=Xt[c],S=p.y*y.x-y.y*p.x,F+=(p.x+y.x)*S,Y+=(p.y+y.y)*S,O+=S*3;O===0?$=Xt[0]:$=[F/O,Y/O];var Ne=o.unproject(Z($));return q([Ne.lat+tt.lat,Ne.lng+tt.lng])}function nr(t){for(var o=0,h=0,c=0,p=0;p<t.length;p++){var y=q(t[p]);o+=y.lat,h+=y.lng,c++}return q([o/c,h/c])}var hl={__proto__:null,clipPolygon:zo,polygonCenter:Oo,centroid:nr};function Ao(t,o){if(!o||!t.length)return t.slice();var h=o*o;return t=cl(t,h),t=ul(t,h),t}function Fo(t,o,h){return Math.sqrt(ui(t,o,h,!0))}function ll(t,o,h){return ui(t,o,h)}function ul(t,o){var h=t.length,c=typeof Uint8Array<"u"?Uint8Array:Array,p=new c(h);p[0]=p[h-1]=1,rr(t,p,o,0,h-1);var y,S=[];for(y=0;y<h;y++)p[y]&&S.push(t[y]);return S}function rr(t,o,h,c,p){var y=0,S,O,F;for(O=c+1;O<=p-1;O++)F=ui(t[O],t[c],t[p],!0),F>y&&(S=O,y=F);y>h&&(o[S]=1,rr(t,o,h,c,S),rr(t,o,h,S,p))}function cl(t,o){for(var h=[t[0]],c=1,p=0,y=t.length;c<y;c++)dl(t[c],t[p])>o&&(h.push(t[c]),p=c);return p<y-1&&h.push(t[y-1]),h}var Zo;function Ro(t,o,h,c,p){var y=c?Zo:Le(t,h),S=Le(o,h),O,F,Y;for(Zo=S;;){if(!(y|S))return[t,o];if(y&S)return!1;O=y||S,F=$i(t,o,O,h,p),Y=Le(F,h),O===y?(t=F,y=Y):(o=F,S=Y)}}function $i(t,o,h,c,p){var y=o.x-t.x,S=o.y-t.y,O=c.min,F=c.max,Y,$;return h&8?(Y=t.x+y*(F.y-t.y)/S,$=F.y):h&4?(Y=t.x+y*(O.y-t.y)/S,$=O.y):h&2?(Y=F.x,$=t.y+S*(F.x-t.x)/y):h&1&&(Y=O.x,$=t.y+S*(O.x-t.x)/y),new N(Y,$,p)}function Le(t,o){var h=0;return t.x<o.min.x?h|=1:t.x>o.max.x&&(h|=2),t.y<o.min.y?h|=4:t.y>o.max.y&&(h|=8),h}function dl(t,o){var h=o.x-t.x,c=o.y-t.y;return h*h+c*c}function ui(t,o,h,c){var p=o.x,y=o.y,S=h.x-p,O=h.y-y,F=S*S+O*O,Y;return F>0&&(Y=((t.x-p)*S+(t.y-y)*O)/F,Y>1?(p=h.x,y=h.y):Y>0&&(p+=S*Y,y+=O*Y)),S=t.x-p,O=t.y-y,c?S*S+O*O:new N(p,y)}function Yt(t){return!x(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function No(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Yt(t)}function jo(t,o){var h,c,p,y,S,O,F,Y;if(!t||t.length===0)throw new Error("latlngs not passed");Yt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var $=q([0,0]),tt=Q(t),st=tt.getNorthWest().distanceTo(tt.getSouthWest())*tt.getNorthEast().distanceTo(tt.getNorthWest());st<1700&&($=nr(t));var kt=t.length,bt=[];for(h=0;h<kt;h++){var Xt=q(t[h]);bt.push(o.project(q([Xt.lat-$.lat,Xt.lng-$.lng])))}for(h=0,c=0;h<kt-1;h++)c+=bt[h].distanceTo(bt[h+1])/2;if(c===0)Y=bt[0];else for(h=0,y=0;h<kt-1;h++)if(S=bt[h],O=bt[h+1],p=S.distanceTo(O),y+=p,y>c){F=(y-c)/p,Y=[O.x-F*(O.x-S.x),O.y-F*(O.y-S.y)];break}var zt=o.unproject(Z(Y));return q([zt.lat+$.lat,zt.lng+$.lng])}var fl={__proto__:null,simplify:Ao,pointToSegmentDistance:Fo,closestPointOnSegment:ll,clipSegment:Ro,_getEdgeIntersection:$i,_getBitCode:Le,_sqClosestPointOnSegment:ui,isFlat:Yt,_flat:No,polylineCenter:jo},or={project:function(t){return new N(t.lng,t.lat)},unproject:function(t){return new et(t.y,t.x)},bounds:new H([-180,-90],[180,90])},sr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new H([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var o=Math.PI/180,h=this.R,c=t.lat*o,p=this.R_MINOR/h,y=Math.sqrt(1-p*p),S=y*Math.sin(c),O=Math.tan(Math.PI/4-c/2)/Math.pow((1-S)/(1+S),y/2);return c=-h*Math.log(Math.max(O,1e-10)),new N(t.lng*o*h,c)},unproject:function(t){for(var o=180/Math.PI,h=this.R,c=this.R_MINOR/h,p=Math.sqrt(1-c*c),y=Math.exp(-t.y/h),S=Math.PI/2-2*Math.atan(y),O=0,F=.1,Y;O<15&&Math.abs(F)>1e-7;O++)Y=p*Math.sin(S),Y=Math.pow((1-Y)/(1+Y),p/2),F=Math.PI/2-2*Math.atan(y*Y)-S,S+=F;return new et(S*o,t.x*o/h)}},pl={__proto__:null,LonLat:or,Mercator:sr,SphericalMercator:Mt},_l=s({},dt,{code:"EPSG:3395",projection:sr,transformation:function(){var t=.5/(Math.PI*sr.R);return Dt(t,.5,-t,.5)}()}),Wo=s({},dt,{code:"EPSG:4326",projection:or,transformation:Dt(1/180,1,-1/180,.5)}),ml=s({},ht,{projection:or,transformation:Dt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,o){var h=o.lng-t.lng,c=o.lat-t.lat;return Math.sqrt(h*h+c*c)},infinite:!0});ht.Earth=dt,ht.EPSG3395=_l,ht.EPSG3857=Ct,ht.EPSG900913=Ft,ht.EPSG4326=Wo,ht.Simple=ml;var Ht=V.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[d(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[d(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var o=t.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var h=this.getEvents();o.on(h,this),this.once("remove",function(){o.off(h,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});at.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var o=d(t);return this._layers[o]?this:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=d(t);return this._layers[o]?(this._loaded&&t.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return d(t)in this._layers},eachLayer:function(t,o){for(var h in this._layers)t.call(o,this._layers[h]);return this},_addLayers:function(t){t=t?x(t)?t:[t]:[];for(var o=0,h=t.length;o<h;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[d(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=d(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,h=this._getZoomSpan();for(var c in this._zoomBoundLayers){var p=this._zoomBoundLayers[c].options;t=p.minZoom===void 0?t:Math.min(t,p.minZoom),o=p.maxZoom===void 0?o:Math.max(o,p.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=t===1/0?void 0:t,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Oe=Ht.extend({initialize:function(t,o){C(this,o),this._layers={};var h,c;if(t)for(h=0,c=t.length;h<c;h++)this.addLayer(t[h])},addLayer:function(t){var o=this.getLayerId(t);return this._layers[o]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var o=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(t){var o=typeof t=="number"?t:this.getLayerId(t);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var o=Array.prototype.slice.call(arguments,1),h,c;for(h in this._layers)c=this._layers[h],c[t]&&c[t].apply(c,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,o){for(var h in this._layers)t.call(o,this._layers[h]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return d(t)}}),gl=function(t,o){return new Oe(t,o)},se=Oe.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Oe.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Oe.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new nt;for(var o in this._layers){var h=this._layers[o];t.extend(h.getBounds?h.getBounds():h.getLatLng())}return t}}),vl=function(t,o){return new se(t,o)},Ae=v.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){C(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,o){var h=this._getIconUrl(t);if(!h){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var c=this._createImg(h,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(c,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c},_setIconStyles:function(t,o){var h=this.options,c=h[o+"Size"];typeof c=="number"&&(c=[c,c]);var p=Z(c),y=Z(o==="shadow"&&h.shadowAnchor||h.iconAnchor||p&&p.divideBy(2,!0));t.className="leaflet-marker-"+o+" "+(h.className||""),y&&(t.style.marginLeft=-y.x+"px",t.style.marginTop=-y.y+"px"),p&&(t.style.width=p.x+"px",t.style.height=p.y+"px")},_createImg:function(t,o){return o=o||document.createElement("img"),o.src=t,o},_getIconUrl:function(t){return J.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function yl(t){return new Ae(t)}var ci=Ae.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof ci.imagePath!="string"&&(ci.imagePath=this._detectIconPath()),(this.options.imagePath||ci.imagePath)+Ae.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var o=function(h,c,p){var y=c.exec(h);return y&&y[p]};return t=o(t,/^url\((['"])?(.+)\1\)$/,2),t&&o(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=lt("div","leaflet-default-icon-path",document.body),o=ri(t,"background-image")||ri(t,"backgroundImage");if(document.body.removeChild(t),o=this._stripUrl(o),o)return o;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Yo=ie.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new me(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ot(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var o=this._marker,h=o._map,c=this._marker.options.autoPanSpeed,p=this._marker.options.autoPanPadding,y=be(o._icon),S=h.getPixelBounds(),O=h.getPixelOrigin(),F=G(S.min._subtract(O).add(p),S.max._subtract(O).subtract(p));if(!F.contains(y)){var Y=Z((Math.max(F.max.x,y.x)-F.max.x)/(S.max.x-F.max.x)-(Math.min(F.min.x,y.x)-F.min.x)/(S.min.x-F.min.x),(Math.max(F.max.y,y.y)-F.max.y)/(S.max.y-F.max.y)-(Math.min(F.min.y,y.y)-F.min.y)/(S.min.y-F.min.y)).multiplyBy(c);h.panBy(Y,{animate:!1}),this._draggable._newPos._add(Y),this._draggable._startPos._add(Y),gt(o._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=W(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(U(this._panRequest),this._panRequest=W(this._adjustPan.bind(this,t)))},_onDrag:function(t){var o=this._marker,h=o._shadow,c=be(o._icon),p=o._map.layerPointToLatLng(c);h&&gt(h,c),o._latlng=p,t.latlng=p,t.oldLatLng=this._oldLatLng,o.fire("move",t).fire("drag",t)},_onDragEnd:function(t){U(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ki=Ht.extend({options:{icon:new ci,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,o){C(this,o),this._latlng=q(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var o=this._latlng;return this._latlng=q(t),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=t.icon.createIcon(this._icon),c=!1;h!==this._icon&&(this._icon&&this._removeIcon(),c=!0,t.title&&(h.title=t.title),h.tagName==="IMG"&&(h.alt=t.alt||"")),ot(h,o),t.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(h,"focus",this._panOnFocus,this);var p=t.icon.createShadow(this._shadow),y=!1;p!==this._shadow&&(this._removeShadow(),y=!0),p&&(ot(p,o),p.alt=""),this._shadow=p,t.opacity<1&&this._updateOpacity(),c&&this.getPane().appendChild(this._icon),this._initInteraction(),p&&y&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ct(this._icon,"focus",this._panOnFocus,this),ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ft(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&gt(this._icon,t),this._shadow&&gt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Yo)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Yo(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Wt(this._icon,t),this._shadow&&Wt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var o=this.options.icon.options,h=o.iconSize?Z(o.iconSize):Z(0,0),c=o.iconAnchor?Z(o.iconAnchor):Z(0,0);t.panInside(this._latlng,{paddingTopLeft:c,paddingBottomRight:h.subtract(c)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function xl(t,o){return new Ki(t,o)}var ge=Ht.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return C(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ji=ge.extend({options:{fill:!0,radius:10},initialize:function(t,o){C(this,o),this._latlng=q(t),this._radius=this.options.radius},setLatLng:function(t){var o=this._latlng;return this._latlng=q(t),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var o=t&&t.radius||this._radius;return ge.prototype.setStyle.call(this,t),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,o=this._radiusY||t,h=this._clickTolerance(),c=[t+h,o+h];this._pxBounds=new H(this._point.subtract(c),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function wl(t,o){return new Ji(t,o)}var ar=Ji.extend({initialize:function(t,o,h){if(typeof o=="number"&&(o=s({},h,{radius:o})),C(this,o),this._latlng=q(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new nt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:ge.prototype.setStyle,_project:function(){var t=this._latlng.lng,o=this._latlng.lat,h=this._map,c=h.options.crs;if(c.distance===dt.distance){var p=Math.PI/180,y=this._mRadius/dt.R/p,S=h.project([o+y,t]),O=h.project([o-y,t]),F=S.add(O).divideBy(2),Y=h.unproject(F).lat,$=Math.acos((Math.cos(y*p)-Math.sin(o*p)*Math.sin(Y*p))/(Math.cos(o*p)*Math.cos(Y*p)))/p;(isNaN($)||$===0)&&($=y/Math.cos(Math.PI/180*o)),this._point=F.subtract(h.getPixelOrigin()),this._radius=isNaN($)?0:F.x-h.project([Y,t-$]).x,this._radiusY=F.y-S.y}else{var tt=c.unproject(c.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(tt).x}this._updateBounds()}});function bl(t,o,h){return new ar(t,o,h)}var ae=ge.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,o){C(this,o),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var o=1/0,h=null,c=ui,p,y,S=0,O=this._parts.length;S<O;S++)for(var F=this._parts[S],Y=1,$=F.length;Y<$;Y++){p=F[Y-1],y=F[Y];var tt=c(t,p,y,!0);tt<o&&(o=tt,h=c(t,p,y))}return h&&(h.distance=Math.sqrt(o)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return jo(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,o){return o=o||this._defaultShape(),t=q(t),o.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new nt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Yt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var o=[],h=Yt(t),c=0,p=t.length;c<p;c++)h?(o[c]=q(t[c]),this._bounds.extend(o[c])):o[c]=this._convertLatLngs(t[c]);return o},_project:function(){var t=new H;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),o=new N(t,t);this._rawPxBounds&&(this._pxBounds=new H([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(t,o,h){var c=t[0]instanceof et,p=t.length,y,S;if(c){for(S=[],y=0;y<p;y++)S[y]=this._map.latLngToLayerPoint(t[y]),h.extend(S[y]);o.push(S)}else for(y=0;y<p;y++)this._projectLatlngs(t[y],o,h)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,h,c,p,y,S,O,F;for(h=0,p=0,y=this._rings.length;h<y;h++)for(F=this._rings[h],c=0,S=F.length;c<S-1;c++)O=Ro(F[c],F[c+1],t,c,!0),O&&(o[p]=o[p]||[],o[p].push(O[0]),(O[1]!==F[c+1]||c===S-2)&&(o[p].push(O[1]),p++))}},_simplifyPoints:function(){for(var t=this._parts,o=this.options.smoothFactor,h=0,c=t.length;h<c;h++)t[h]=Ao(t[h],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,o){var h,c,p,y,S,O,F=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(h=0,y=this._parts.length;h<y;h++)for(O=this._parts[h],c=0,S=O.length,p=S-1;c<S;p=c++)if(!(!o&&c===0)&&Fo(t,O[p],O[c])<=F)return!0;return!1}});function Pl(t,o){return new ae(t,o)}ae._flat=No;var Fe=ae.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Oo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var o=ae.prototype._convertLatLngs.call(this,t),h=o.length;return h>=2&&o[0]instanceof et&&o[0].equals(o[h-1])&&o.pop(),o},_setLatLngs:function(t){ae.prototype._setLatLngs.call(this,t),Yt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Yt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,o=this.options.weight,h=new N(o,o);if(t=new H(t.min.subtract(h),t.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var c=0,p=this._rings.length,y;c<p;c++)y=zo(this._rings[c],t,!0),y.length&&this._parts.push(y)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var o=!1,h,c,p,y,S,O,F,Y;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(y=0,F=this._parts.length;y<F;y++)for(h=this._parts[y],S=0,Y=h.length,O=Y-1;S<Y;O=S++)c=h[S],p=h[O],c.y>t.y!=p.y>t.y&&t.x<(p.x-c.x)*(t.y-c.y)/(p.y-c.y)+c.x&&(o=!o);return o||ae.prototype._containsPoint.call(this,t,!0)}});function Ml(t,o){return new Fe(t,o)}var he=se.extend({initialize:function(t,o){C(this,o),this._layers={},t&&this.addData(t)},addData:function(t){var o=x(t)?t:t.features,h,c,p;if(o){for(h=0,c=o.length;h<c;h++)p=o[h],(p.geometries||p.geometry||p.features||p.coordinates)&&this.addData(p);return this}var y=this.options;if(y.filter&&!y.filter(t))return this;var S=Qi(t,y);return S?(S.feature=nn(t),S.defaultOptions=S.options,this.resetStyle(S),y.onEachFeature&&y.onEachFeature(t,S),this.addLayer(S)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=s({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(o){this._setLayerStyle(o,t)},this)},_setLayerStyle:function(t,o){t.setStyle&&(typeof o=="function"&&(o=o(t.feature)),t.setStyle(o))}});function Qi(t,o){var h=t.type==="Feature"?t.geometry:t,c=h?h.coordinates:null,p=[],y=o&&o.pointToLayer,S=o&&o.coordsToLatLng||hr,O,F,Y,$;if(!c&&!h)return null;switch(h.type){case"Point":return O=S(c),Xo(y,t,O,o);case"MultiPoint":for(Y=0,$=c.length;Y<$;Y++)O=S(c[Y]),p.push(Xo(y,t,O,o));return new se(p);case"LineString":case"MultiLineString":return F=tn(c,h.type==="LineString"?0:1,S),new ae(F,o);case"Polygon":case"MultiPolygon":return F=tn(c,h.type==="Polygon"?1:2,S),new Fe(F,o);case"GeometryCollection":for(Y=0,$=h.geometries.length;Y<$;Y++){var tt=Qi({geometry:h.geometries[Y],type:"Feature",properties:t.properties},o);tt&&p.push(tt)}return new se(p);case"FeatureCollection":for(Y=0,$=h.features.length;Y<$;Y++){var st=Qi(h.features[Y],o);st&&p.push(st)}return new se(p);default:throw new Error("Invalid GeoJSON object.")}}function Xo(t,o,h,c){return t?t(o,h):new Ki(h,c&&c.markersInheritOptions&&c)}function hr(t){return new et(t[1],t[0],t[2])}function tn(t,o,h){for(var c=[],p=0,y=t.length,S;p<y;p++)S=o?tn(t[p],o-1,h):(h||hr)(t[p]),c.push(S);return c}function lr(t,o){return t=q(t),t.alt!==void 0?[w(t.lng,o),w(t.lat,o),w(t.alt,o)]:[w(t.lng,o),w(t.lat,o)]}function en(t,o,h,c){for(var p=[],y=0,S=t.length;y<S;y++)p.push(o?en(t[y],Yt(t[y])?0:o-1,h,c):lr(t[y],c));return!o&&h&&p.length>0&&p.push(p[0].slice()),p}function Ze(t,o){return t.feature?s({},t.feature,{geometry:o}):nn(o)}function nn(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var ur={toGeoJSON:function(t){return Ze(this,{type:"Point",coordinates:lr(this.getLatLng(),t)})}};Ki.include(ur),ar.include(ur),Ji.include(ur),ae.include({toGeoJSON:function(t){var o=!Yt(this._latlngs),h=en(this._latlngs,o?1:0,!1,t);return Ze(this,{type:(o?"Multi":"")+"LineString",coordinates:h})}}),Fe.include({toGeoJSON:function(t){var o=!Yt(this._latlngs),h=o&&!Yt(this._latlngs[0]),c=en(this._latlngs,h?2:o?1:0,!0,t);return o||(c=[c]),Ze(this,{type:(h?"Multi":"")+"Polygon",coordinates:c})}}),Oe.include({toMultiPoint:function(t){var o=[];return this.eachLayer(function(h){o.push(h.toGeoJSON(t).geometry.coordinates)}),Ze(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(t){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(t);var h=o==="GeometryCollection",c=[];return this.eachLayer(function(p){if(p.toGeoJSON){var y=p.toGeoJSON(t);if(h)c.push(y.geometry);else{var S=nn(y);S.type==="FeatureCollection"?c.push.apply(c,S.features):c.push(S)}}}),h?Ze(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});function Uo(t,o){return new he(t,o)}var Ll=Uo,rn=Ht.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,o,h){this._url=t,this._bounds=Q(o),C(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Be(this._image),this},bringToBack:function(){return this._map&&ze(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=Q(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",o=this._image=t?this._url:lt("img");if(ot(o,"leaflet-image-layer"),this._zoomAnimated&&ot(o,"leaflet-zoom-animated"),this.options.className&&ot(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=l(this.fire,this,"load"),o.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;we(this._image,h,o)},_reset:function(){var t=this._image,o=new H(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=o.getSize();gt(t,o.min),t.style.width=h.x+"px",t.style.height=h.y+"px"},_updateOpacity:function(){Wt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Cl=function(t,o,h){return new rn(t,o,h)},Vo=rn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",o=this._image=t?this._url:lt("video");if(ot(o,"leaflet-image-layer"),this._zoomAnimated&&ot(o,"leaflet-zoom-animated"),this.options.className&&ot(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=l(this.fire,this,"load"),t){for(var h=o.getElementsByTagName("source"),c=[],p=0;p<h.length;p++)c.push(h[p].src);this._url=h.length>0?c:[o.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var y=0;y<this._url.length;y++){var S=lt("source");S.src=this._url[y],o.appendChild(S)}}});function Sl(t,o,h){return new Vo(t,o,h)}var Ho=rn.extend({_initImage:function(){var t=this._image=this._url;ot(t,"leaflet-image-layer"),this._zoomAnimated&&ot(t,"leaflet-zoom-animated"),this.options.className&&ot(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function kl(t,o,h){return new Ho(t,o,h)}var ne=Ht.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,o){t&&(t instanceof et||x(t))?(this._latlng=q(t),C(this,o)):(C(this,t),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Wt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Wt(this._container,1),this.bringToFront(),this.options.interactive&&(ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Wt(this._container,0),this._removeTimeout=setTimeout(l(ft,void 0,this._container),200)):ft(this._container),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=q(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Be(this._container),this},bringToBack:function(){return this._map&&ze(this._container),this},_prepareOpen:function(t){var o=this._source;if(!o._map)return!1;if(o instanceof se){o=null;var h=this._source._layers;for(var c in h)if(h[c]._map){o=h[c];break}if(!o)return!1;this._source=o}if(!t)if(o.getCenter)t=o.getCenter();else if(o.getLatLng)t=o.getLatLng();else if(o.getBounds)t=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")t.innerHTML=o;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),o=Z(this.options.offset),h=this._getAnchor();this._zoomAnimated?gt(this._container,t.add(h)):o=o.add(t).add(h);var c=this._containerBottom=-o.y,p=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=c+"px",this._container.style.left=p+"px"}},_getAnchor:function(){return[0,0]}});at.include({_initOverlay:function(t,o,h,c){var p=o;return p instanceof t||(p=new t(c).setContent(o)),h&&p.setLatLng(h),p}}),Ht.include({_initOverlay:function(t,o,h,c){var p=h;return p instanceof t?(C(p,c),p._source=this):(p=o&&!c?o:new t(c,this),p.setContent(h)),p}});var on=ne.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,ne.prototype.openOn.call(this,t)},onAdd:function(t){ne.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ge||this._source.on("preclick",Pe))},onRemove:function(t){ne.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ge||this._source.off("preclick",Pe))},getEvents:function(){var t=ne.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=lt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=lt("div",t+"-content-wrapper",o);if(this._contentNode=lt("div",t+"-content",h),hi(o),Qn(this._contentNode),rt(o,"contextmenu",Pe),this._tipContainer=lt("div",t+"-tip-container",o),this._tip=lt("div",t+"-tip",this._tipContainer),this.options.closeButton){var c=this._closeButton=lt("a",t+"-close-button",o);c.setAttribute("role","button"),c.setAttribute("aria-label","Close popup"),c.href="#close",c.innerHTML='<span aria-hidden="true">&#215;</span>',rt(c,"click",function(p){Pt(p),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var h=t.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),o.width=h+1+"px",o.whiteSpace="",o.height="";var c=t.offsetHeight,p=this.options.maxHeight,y="leaflet-popup-scrolled";p&&c>p?(o.height=p+"px",ot(t,y)):pt(t,y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),h=this._getAnchor();gt(this._container,o.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,o=parseInt(ri(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+o,c=this._containerWidth,p=new N(this._containerLeft,-h-this._containerBottom);p._add(be(this._container));var y=t.layerPointToContainerPoint(p),S=Z(this.options.autoPanPadding),O=Z(this.options.autoPanPaddingTopLeft||S),F=Z(this.options.autoPanPaddingBottomRight||S),Y=t.getSize(),$=0,tt=0;y.x+c+F.x>Y.x&&($=y.x+c-Y.x+F.x),y.x-$-O.x<0&&($=y.x-O.x),y.y+h+F.y>Y.y&&(tt=y.y+h-Y.y+F.y),y.y-tt-O.y<0&&(tt=y.y-O.y),($||tt)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([$,tt]))}},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Tl=function(t,o){return new on(t,o)};at.mergeOptions({closePopupOnClick:!0}),at.include({openPopup:function(t,o,h){return this._initOverlay(on,t,o,h).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Ht.include({bindPopup:function(t,o){return this._popup=this._initOverlay(on,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof se||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){Me(t);var o=t.layer||t.target;if(this._popup._source===o&&!(o instanceof ge)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=o,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var sn=ne.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){ne.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){ne.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=ne.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",o=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=lt("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var o,h,c=this._map,p=this._container,y=c.latLngToContainerPoint(c.getCenter()),S=c.layerPointToContainerPoint(t),O=this.options.direction,F=p.offsetWidth,Y=p.offsetHeight,$=Z(this.options.offset),tt=this._getAnchor();O==="top"?(o=F/2,h=Y):O==="bottom"?(o=F/2,h=0):O==="center"?(o=F/2,h=Y/2):O==="right"?(o=0,h=Y/2):O==="left"?(o=F,h=Y/2):S.x<y.x?(O="right",o=0,h=Y/2):(O="left",o=F+($.x+tt.x)*2,h=Y/2),t=t.subtract(Z(o,h,!0)).add($).add(tt),pt(p,"leaflet-tooltip-right"),pt(p,"leaflet-tooltip-left"),pt(p,"leaflet-tooltip-top"),pt(p,"leaflet-tooltip-bottom"),ot(p,"leaflet-tooltip-"+O),gt(p,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Wt(this._container,t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(o)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),El=function(t,o){return new sn(t,o)};at.include({openTooltip:function(t,o,h){return this._initOverlay(sn,t,o,h).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Ht.include({bindTooltip:function(t,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(sn,this._tooltip,t,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var o=t?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[o](h),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof se||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&(rt(o,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),rt(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var o=t.latlng,h,c;this._tooltip.options.sticky&&t.originalEvent&&(h=this._map.mouseEventToContainerPoint(t.originalEvent),c=this._map.containerPointToLayerPoint(h),o=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(o)}});var Go=Ae.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var o=t&&t.tagName==="DIV"?t:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Ui(o),o.appendChild(h.html)):o.innerHTML=h.html!==!1?h.html:"",h.bgPos){var c=Z(h.bgPos);o.style.backgroundPosition=-c.x+"px "+-c.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Dl(t){return new Go(t)}Ae.Default=ci;var di=Ht.extend({options:{tileSize:256,opacity:1,updateWhenIdle:J.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){C(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ft(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Be(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ze(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=_(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof N?t:new N(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var o=this.getPane().children,h=-t(-1/0,1/0),c=0,p=o.length,y;c<p;c++)y=o[c].style.zIndex,o[c]!==this._container&&y&&(h=t(h,+y));isFinite(h)&&(this.options.zIndex=h+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!J.ielt9){Wt(this._container,this.options.opacity);var t=+new Date,o=!1,h=!1;for(var c in this._tiles){var p=this._tiles[c];if(!(!p.current||!p.loaded)){var y=Math.min(1,(t-p.loaded)/200);Wt(p.el,y),y<1?o=!0:(p.active?h=!0:this._onOpaqueTile(p),p.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),o&&(U(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,o=this.options.maxZoom;if(t!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===t?(this._levels[h].el.style.zIndex=o-Math.abs(t-h),this._onUpdateLevel(h)):(ft(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var c=this._levels[t],p=this._map;return c||(c=this._levels[t]={},c.el=lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=o,c.origin=p.project(p.unproject(p.getPixelOrigin()),t).round(),c.zoom=t,this._setZoomTransform(c,p.getCenter(),p.getZoom()),g(c.el.offsetWidth),this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,o,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)o=this._tiles[t],o.retain=o.current;for(t in this._tiles)if(o=this._tiles[t],o.current&&!o.active){var c=o.coords;this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var o in this._tiles)this._tiles[o].coords.z===t&&this._removeTile(o)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ft(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,o,h,c){var p=Math.floor(t/2),y=Math.floor(o/2),S=h-1,O=new N(+p,+y);O.z=+S;var F=this._tileCoordsToKey(O),Y=this._tiles[F];return Y&&Y.active?(Y.retain=!0,!0):(Y&&Y.loaded&&(Y.retain=!0),S>c?this._retainParent(p,y,S,c):!1)},_retainChildren:function(t,o,h,c){for(var p=2*t;p<2*t+2;p++)for(var y=2*o;y<2*o+2;y++){var S=new N(p,y);S.z=h+1;var O=this._tileCoordsToKey(S),F=this._tiles[O];if(F&&F.active){F.retain=!0;continue}else F&&F.loaded&&(F.retain=!0);h+1<c&&this._retainChildren(p,y,h+1,c)}},_resetView:function(t){var o=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var o=this.options;return o.minNativeZoom!==void 0&&t<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<t?o.maxNativeZoom:t},_setView:function(t,o,h,c){var p=Math.round(o);this.options.maxZoom!==void 0&&p>this.options.maxZoom||this.options.minZoom!==void 0&&p<this.options.minZoom?p=void 0:p=this._clampZoom(p);var y=this.options.updateWhenZooming&&p!==this._tileZoom;(!c||y)&&(this._tileZoom=p,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),p!==void 0&&this._update(t),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(t,o)},_setZoomTransforms:function(t,o){for(var h in this._levels)this._setZoomTransform(this._levels[h],t,o)},_setZoomTransform:function(t,o,h){var c=this._map.getZoomScale(h,t.zoom),p=t.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(o,h)).round();J.any3d?we(t.el,p,c):gt(t.el,p)},_resetGrid:function(){var t=this._map,o=t.options.crs,h=this._tileSize=this.getTileSize(),c=this._tileZoom,p=this._map.getPixelWorldBounds(this._tileZoom);p&&(this._globalTileRange=this._pxBoundsToTileRange(p)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,o.wrapLng[0]],c).x/h.x),Math.ceil(t.project([0,o.wrapLng[1]],c).x/h.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([o.wrapLat[0],0],c).y/h.x),Math.ceil(t.project([o.wrapLat[1],0],c).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var o=this._map,h=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),c=o.getZoomScale(h,this._tileZoom),p=o.project(t,this._tileZoom).floor(),y=o.getSize().divideBy(c*2);return new H(p.subtract(y),p.add(y))},_update:function(t){var o=this._map;if(o){var h=this._clampZoom(o.getZoom());if(t===void 0&&(t=o.getCenter()),this._tileZoom!==void 0){var c=this._getTiledPixelBounds(t),p=this._pxBoundsToTileRange(c),y=p.getCenter(),S=[],O=this.options.keepBuffer,F=new H(p.getBottomLeft().subtract([O,-O]),p.getTopRight().add([O,-O]));if(!(isFinite(p.min.x)&&isFinite(p.min.y)&&isFinite(p.max.x)&&isFinite(p.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Y in this._tiles){var $=this._tiles[Y].coords;($.z!==this._tileZoom||!F.contains(new N($.x,$.y)))&&(this._tiles[Y].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(t,h);return}for(var tt=p.min.y;tt<=p.max.y;tt++)for(var st=p.min.x;st<=p.max.x;st++){var kt=new N(st,tt);if(kt.z=this._tileZoom,!!this._isValidTile(kt)){var bt=this._tiles[this._tileCoordsToKey(kt)];bt?bt.current=!0:S.push(kt)}}if(S.sort(function(zt,Ne){return zt.distanceTo(y)-Ne.distanceTo(y)}),S.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Xt=document.createDocumentFragment();for(st=0;st<S.length;st++)this._addTile(S[st],Xt);this._level.el.appendChild(Xt)}}}},_isValidTile:function(t){var o=this._map.options.crs;if(!o.infinite){var h=this._globalTileRange;if(!o.wrapLng&&(t.x<h.min.x||t.x>h.max.x)||!o.wrapLat&&(t.y<h.min.y||t.y>h.max.y))return!1}if(!this.options.bounds)return!0;var c=this._tileCoordsToBounds(t);return Q(this.options.bounds).overlaps(c)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var o=this._map,h=this.getTileSize(),c=t.scaleBy(h),p=c.add(h),y=o.unproject(c,t.z),S=o.unproject(p,t.z);return[y,S]},_tileCoordsToBounds:function(t){var o=this._tileCoordsToNwSe(t),h=new nt(o[0],o[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var o=t.split(":"),h=new N(+o[0],+o[1]);return h.z=+o[2],h},_removeTile:function(t){var o=this._tiles[t];o&&(ft(o.el),delete this._tiles[t],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ot(t,"leaflet-tile");var o=this.getTileSize();t.style.width=o.x+"px",t.style.height=o.y+"px",t.onselectstart=g,t.onmousemove=g,J.ielt9&&this.options.opacity<1&&Wt(t,this.options.opacity)},_addTile:function(t,o){var h=this._getTilePos(t),c=this._tileCoordsToKey(t),p=this.createTile(this._wrapCoords(t),l(this._tileReady,this,t));this._initTile(p),this.createTile.length<2&&W(l(this._tileReady,this,t,null,p)),gt(p,h),this._tiles[c]={el:p,coords:t,current:!0},o.appendChild(p),this.fire("tileloadstart",{tile:p,coords:t})},_tileReady:function(t,o,h){o&&this.fire("tileerror",{error:o,tile:h,coords:t});var c=this._tileCoordsToKey(t);h=this._tiles[c],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Wt(h.el,0),U(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),o||(ot(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),J.ielt9||!this._map._fadeAnimated?W(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var o=new N(this._wrapX?f(t.x,this._wrapX):t.x,this._wrapY?f(t.y,this._wrapY):t.y);return o.z=t.z,o},_pxBoundsToTileRange:function(t){var o=this.getTileSize();return new H(t.min.unscaleBy(o).floor(),t.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Il(t){return new di(t)}var Re=di.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,o){this._url=t,o=C(this,o),o.detectRetina&&J.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,o){return this._url===t&&o===void 0&&(o=!0),this._url=t,o||this.redraw(),this},createTile:function(t,o){var h=document.createElement("img");return rt(h,"load",l(this._tileOnLoad,this,o,h)),rt(h,"error",l(this._tileOnError,this,o,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(t),h},getTileUrl:function(t){var o={r:J.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-t.y;this.options.tms&&(o.y=h),o["-y"]=h}return m(this._url,s(o,this.options))},_tileOnLoad:function(t,o){J.ielt9?setTimeout(l(t,this,null,o),0):t(null,o)},_tileOnError:function(t,o,h){var c=this.options.errorTileUrl;c&&o.getAttribute("src")!==c&&(o.src=c),t(h,o)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,o=this.options.maxZoom,h=this.options.zoomReverse,c=this.options.zoomOffset;return h&&(t=o-t),t+c},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(o=this._tiles[t].el,o.onload=g,o.onerror=g,!o.complete)){o.src=k;var h=this._tiles[t].coords;ft(o),delete this._tiles[t],this.fire("tileabort",{tile:o,coords:h})}},_removeTile:function(t){var o=this._tiles[t];if(o)return o.el.setAttribute("src",k),di.prototype._removeTile.call(this,t)},_tileReady:function(t,o,h){if(!(!this._map||h&&h.getAttribute("src")===k))return di.prototype._tileReady.call(this,t,o,h)}});function qo(t,o){return new Re(t,o)}var $o=Re.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,o){this._url=t;var h=s({},this.defaultWmsParams);for(var c in o)c in this.options||(h[c]=o[c]);o=C(this,o);var p=o.detectRetina&&J.retina?2:1,y=this.getTileSize();h.width=y.x*p,h.height=y.y*p,this.wmsParams=h},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Re.prototype.onAdd.call(this,t)},getTileUrl:function(t){var o=this._tileCoordsToNwSe(t),h=this._crs,c=G(h.project(o[0]),h.project(o[1])),p=c.min,y=c.max,S=(this._wmsVersion>=1.3&&this._crs===Wo?[p.y,p.x,y.y,y.x]:[p.x,p.y,y.x,y.y]).join(","),O=Re.prototype.getTileUrl.call(this,t);return O+I(this.wmsParams,O,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+S},setParams:function(t,o){return s(this.wmsParams,t),o||this.redraw(),this}});function Bl(t,o){return new $o(t,o)}Re.WMS=$o,qo.wms=Bl;var le=Ht.extend({options:{padding:.1},initialize:function(t){C(this,t),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,o){var h=this._map.getZoomScale(o,this._zoom),c=this._map.getSize().multiplyBy(.5+this.options.padding),p=this._map.project(this._center,o),y=c.multiplyBy(-h).add(p).subtract(this._map._getNewPixelOrigin(t,o));J.any3d?we(this._container,y,h):gt(this._container,y)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,o=this._map.getSize(),h=this._map.containerPointToLayerPoint(o.multiplyBy(-t)).round();this._bounds=new H(h,h.add(o.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ko=le.extend({options:{tolerance:0},getEvents:function(){var t=le.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){le.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");rt(t,"mousemove",this._onMouseMove,this),rt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){U(this._redrawRequest),delete this._ctx,ft(this._container),ct(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var o in this._layers)t=this._layers[o],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){le.prototype._update.call(this);var t=this._bounds,o=this._container,h=t.getSize(),c=J.retina?2:1;gt(o,t.min),o.width=c*h.x,o.height=c*h.y,o.style.width=h.x+"px",o.style.height=h.y+"px",J.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){le.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[d(t)]=t;var o=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var o=t._order,h=o.next,c=o.prev;h?h.prev=c:this._drawLast=c,c?c.next=h:this._drawFirst=h,delete t._order,delete this._layers[d(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var o=t.options.dashArray.split(/[, ]+/),h=[],c,p;for(p=0;p<o.length;p++){if(c=Number(o[p]),isNaN(c))return;h.push(c)}t.options._dashArray=h}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||W(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var o=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new H,this._redrawBounds.extend(t._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(t._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var o=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,o=this._redrawBounds;if(this._ctx.save(),o){var h=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)t=c.layer,(!o||t._pxBounds&&t._pxBounds.intersects(o))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,o){if(this._drawing){var h,c,p,y,S=t._parts,O=S.length,F=this._ctx;if(O){for(F.beginPath(),h=0;h<O;h++){for(c=0,p=S[h].length;c<p;c++)y=S[h][c],F[c?"lineTo":"moveTo"](y.x,y.y);o&&F.closePath()}this._fillStroke(F,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var o=t._point,h=this._ctx,c=Math.max(Math.round(t._radius),1),p=(Math.max(Math.round(t._radiusY),1)||c)/c;p!==1&&(h.save(),h.scale(1,p)),h.beginPath(),h.arc(o.x,o.y/p,c,0,Math.PI*2,!1),p!==1&&h.restore(),this._fillStroke(h,t)}},_fillStroke:function(t,o){var h=o.options;h.fill&&(t.globalAlpha=h.fillOpacity,t.fillStyle=h.fillColor||h.color,t.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(t.setLineDash&&t.setLineDash(o.options&&o.options._dashArray||[]),t.globalAlpha=h.opacity,t.lineWidth=h.weight,t.strokeStyle=h.color,t.lineCap=h.lineCap,t.lineJoin=h.lineJoin,t.stroke())},_onClick:function(t){for(var o=this._map.mouseEventToLayerPoint(t),h,c,p=this._drawFirst;p;p=p.next)h=p.layer,h.options.interactive&&h._containsPoint(o)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(h))&&(c=h);this._fireEvent(c?[c]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,o)}},_handleMouseOut:function(t){var o=this._hoveredLayer;o&&(pt(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,o){if(!this._mouseHoverThrottled){for(var h,c,p=this._drawFirst;p;p=p.next)h=p.layer,h.options.interactive&&h._containsPoint(o)&&(c=h);c!==this._hoveredLayer&&(this._handleMouseOut(t),c&&(ot(this._container,"leaflet-interactive"),this._fireEvent([c],t,"mouseover"),this._hoveredLayer=c)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,o,h){this._map._fireDOMEvent(o,h||o.type,t)},_bringToFront:function(t){var o=t._order;if(o){var h=o.next,c=o.prev;if(h)h.prev=c;else return;c?c.next=h:h&&(this._drawFirst=h),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(t)}},_bringToBack:function(t){var o=t._order;if(o){var h=o.next,c=o.prev;if(c)c.next=h;else return;h?h.prev=c:c&&(this._drawLast=c),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(t)}}});function Jo(t){return J.canvas?new Ko(t):null}var fi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),zl={_initContainer:function(){this._container=lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(le.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var o=t._container=fi("shape");ot(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",t._path=fi("path"),o.appendChild(t._path),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){var o=t._container;this._container.appendChild(o),t.options.interactive&&t.addInteractiveTarget(o)},_removePath:function(t){var o=t._container;ft(o),t.removeInteractiveTarget(o),delete this._layers[d(t)]},_updateStyle:function(t){var o=t._stroke,h=t._fill,c=t.options,p=t._container;p.stroked=!!c.stroke,p.filled=!!c.fill,c.stroke?(o||(o=t._stroke=fi("stroke")),p.appendChild(o),o.weight=c.weight+"px",o.color=c.color,o.opacity=c.opacity,c.dashArray?o.dashStyle=x(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=c.lineCap.replace("butt","flat"),o.joinstyle=c.lineJoin):o&&(p.removeChild(o),t._stroke=null),c.fill?(h||(h=t._fill=fi("fill")),p.appendChild(h),h.color=c.fillColor||c.color,h.opacity=c.fillOpacity):h&&(p.removeChild(h),t._fill=null)},_updateCircle:function(t){var o=t._point.round(),h=Math.round(t._radius),c=Math.round(t._radiusY||h);this._setPath(t,t._empty()?"M0 0":"AL "+o.x+","+o.y+" "+h+","+c+" 0,"+65535*360)},_setPath:function(t,o){t._path.v=o},_bringToFront:function(t){Be(t._container)},_bringToBack:function(t){ze(t._container)}},an=J.vml?fi:It,pi=le.extend({_initContainer:function(){this._container=an("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=an("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ft(this._container),ct(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){le.prototype._update.call(this);var t=this._bounds,o=t.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,h.setAttribute("width",o.x),h.setAttribute("height",o.y)),gt(h,t.min),h.setAttribute("viewBox",[t.min.x,t.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(t){var o=t._path=an("path");t.options.className&&ot(o,t.options.className),t.options.interactive&&ot(o,"leaflet-interactive"),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ft(t._path),t.removeInteractiveTarget(t._path),delete this._layers[d(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var o=t._path,h=t.options;o&&(h.stroke?(o.setAttribute("stroke",h.color),o.setAttribute("stroke-opacity",h.opacity),o.setAttribute("stroke-width",h.weight),o.setAttribute("stroke-linecap",h.lineCap),o.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?o.setAttribute("stroke-dasharray",h.dashArray):o.removeAttribute("stroke-dasharray"),h.dashOffset?o.setAttribute("stroke-dashoffset",h.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),h.fill?(o.setAttribute("fill",h.fillColor||h.color),o.setAttribute("fill-opacity",h.fillOpacity),o.setAttribute("fill-rule",h.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(t,o){this._setPath(t,Bt(t._parts,o))},_updateCircle:function(t){var o=t._point,h=Math.max(Math.round(t._radius),1),c=Math.max(Math.round(t._radiusY),1)||h,p="a"+h+","+c+" 0 1,0 ",y=t._empty()?"M0 0":"M"+(o.x-h)+","+o.y+p+h*2+",0 "+p+-h*2+",0 ";this._setPath(t,y)},_setPath:function(t,o){t._path.setAttribute("d",o)},_bringToFront:function(t){Be(t._path)},_bringToBack:function(t){ze(t._path)}});J.vml&&pi.include(zl);function Qo(t){return J.svg||J.vml?new pi(t):null}at.include({getRenderer:function(t){var o=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var o=this._paneRenderers[t];return o===void 0&&(o=this._createRenderer({pane:t}),this._paneRenderers[t]=o),o},_createRenderer:function(t){return this.options.preferCanvas&&Jo(t)||Qo(t)}});var ts=Fe.extend({initialize:function(t,o){Fe.prototype.initialize.call(this,this._boundsToLatLngs(t),o)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=Q(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Ol(t,o){return new ts(t,o)}pi.create=an,pi.pointsToPath=Bt,he.geometryToLayer=Qi,he.coordsToLatLng=hr,he.coordsToLatLngs=tn,he.latLngToCoords=lr,he.latLngsToCoords=en,he.getFeature=Ze,he.asFeature=nn,at.mergeOptions({boxZoom:!0});var es=ie.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ct(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),oi(),Un(),this._startPoint=this._map.mouseEventToContainerPoint(t),rt(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=lt("div","leaflet-zoom-box",this._container),ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var o=new H(this._point,this._startPoint),h=o.getSize();gt(this._box,o.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(ft(this._box),pt(this._container,"leaflet-crosshair")),si(),Vn(),ct(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var o=new nt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});at.addInitHook("addHandler","boxZoom",es),at.mergeOptions({doubleClickZoom:!0});var is=ie.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var o=this._map,h=o.getZoom(),c=o.options.zoomDelta,p=t.originalEvent.shiftKey?h-c:h+c;o.options.doubleClickZoom==="center"?o.setZoom(p):o.setZoomAround(t.containerPoint,p)}});at.addInitHook("addHandler","doubleClickZoom",is),at.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ns=ie.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new me(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pt(this._map._container,"leaflet-grab"),pt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=Q(this._map.options.maxBounds);this._offsetLimit=G(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var o=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(o),this._prunePositions(o)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,o){return t-(t-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;t.x<o.min.x&&(t.x=this._viscousLimit(t.x,o.min.x)),t.y<o.min.y&&(t.y=this._viscousLimit(t.y,o.min.y)),t.x>o.max.x&&(t.x=this._viscousLimit(t.x,o.max.x)),t.y>o.max.y&&(t.y=this._viscousLimit(t.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,o=Math.round(t/2),h=this._initialWorldOffset,c=this._draggable._newPos.x,p=(c-o+h)%t+o-h,y=(c+o+h)%t-o-h,S=Math.abs(p+h)<Math.abs(y+h)?p:y;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=S},_onDragEnd:function(t){var o=this._map,h=o.options,c=!h.inertia||t.noInertia||this._times.length<2;if(o.fire("dragend",t),c)o.fire("moveend");else{this._prunePositions(+new Date);var p=this._lastPos.subtract(this._positions[0]),y=(this._lastTime-this._times[0])/1e3,S=h.easeLinearity,O=p.multiplyBy(S/y),F=O.distanceTo([0,0]),Y=Math.min(h.inertiaMaxSpeed,F),$=O.multiplyBy(Y/F),tt=Y/(h.inertiaDeceleration*S),st=$.multiplyBy(-tt/2).round();!st.x&&!st.y?o.fire("moveend"):(st=o._limitOffset(st,o.options.maxBounds),W(function(){o.panBy(st,{duration:tt,easeLinearity:S,noMoveStart:!0,animate:!0})}))}}});at.addInitHook("addHandler","dragging",ns),at.mergeOptions({keyboard:!0,keyboardPanDelta:80});var rs=ie.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),rt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ct(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,o=document.documentElement,h=t.scrollTop||o.scrollTop,c=t.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(c,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var o=this._panKeys={},h=this.keyCodes,c,p;for(c=0,p=h.left.length;c<p;c++)o[h.left[c]]=[-1*t,0];for(c=0,p=h.right.length;c<p;c++)o[h.right[c]]=[t,0];for(c=0,p=h.down.length;c<p;c++)o[h.down[c]]=[0,t];for(c=0,p=h.up.length;c<p;c++)o[h.up[c]]=[0,-1*t]},_setZoomDelta:function(t){var o=this._zoomKeys={},h=this.keyCodes,c,p;for(c=0,p=h.zoomIn.length;c<p;c++)o[h.zoomIn[c]]=t;for(c=0,p=h.zoomOut.length;c<p;c++)o[h.zoomOut[c]]=-t},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ct(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var o=t.keyCode,h=this._map,c;if(o in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(c=this._panKeys[o],t.shiftKey&&(c=Z(c).multiplyBy(3)),h.options.maxBounds&&(c=h._limitOffset(Z(c),h.options.maxBounds)),h.options.worldCopyJump){var p=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(c)));h.panTo(p)}else h.panBy(c)}else if(o in this._zoomKeys)h.setZoom(h.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Me(t)}}});at.addInitHook("addHandler","keyboard",rs),at.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var os=ie.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ct(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var o=To(t),h=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var c=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),c),Me(t)},_performZoom:function(){var t=this._map,o=t.getZoom(),h=this._map.options.zoomSnap||0;t._stop();var c=this._delta/(this._map.options.wheelPxPerZoomLevel*4),p=4*Math.log(2/(1+Math.exp(-Math.abs(c))))/Math.LN2,y=h?Math.ceil(p/h)*h:p,S=t._limitZoom(o+(this._delta>0?y:-y))-o;this._delta=0,this._startTime=null,S&&(t.options.scrollWheelZoom==="center"?t.setZoom(o+S):t.setZoomAround(this._lastMousePos,o+S))}});at.addInitHook("addHandler","scrollWheelZoom",os);var Al=600;at.mergeOptions({tapHold:J.touchNative&&J.safari&&J.mobile,tapTolerance:15});var ss=ie.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ct(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var o=t.touches[0];this._startPos=this._newPos=new N(o.clientX,o.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",Pt),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Al),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){ct(document,"touchend",Pt),ct(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),ct(document,"touchend touchcancel contextmenu",this._cancel,this),ct(document,"touchmove",this._onMove,this)},_onMove:function(t){var o=t.touches[0];this._newPos=new N(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,o){var h=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});h._simulated=!0,o.target.dispatchEvent(h)}});at.addInitHook("addHandler","tapHold",ss),at.mergeOptions({touchZoom:J.touch,bounceAtZoomLimits:!0});var as=ie.extend({addHooks:function(){ot(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),ct(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(!(!t.touches||t.touches.length!==2||o._animatingZoom||this._zooming)){var h=o.mouseEventToContainerPoint(t.touches[0]),c=o.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(h.add(c)._divideBy(2))),this._startDist=h.distanceTo(c),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),Pt(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var o=this._map,h=o.mouseEventToContainerPoint(t.touches[0]),c=o.mouseEventToContainerPoint(t.touches[1]),p=h.distanceTo(c)/this._startDist;if(this._zoom=o.getScaleZoom(p,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&p<1||this._zoom>o.getMaxZoom()&&p>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,p===1)return}else{var y=h._add(c)._divideBy(2)._subtract(this._centerPoint);if(p===1&&y.x===0&&y.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(y),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),U(this._animRequest);var S=l(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=W(S,this,!0),Pt(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,U(this._animRequest),ct(document,"touchmove",this._onTouchMove,this),ct(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});at.addInitHook("addHandler","touchZoom",as),at.BoxZoom=es,at.DoubleClickZoom=is,at.Drag=ns,at.Keyboard=rs,at.ScrollWheelZoom=os,at.TapHold=ss,at.TouchZoom=as,n.Bounds=H,n.Browser=J,n.CRS=ht,n.Canvas=Ko,n.Circle=ar,n.CircleMarker=Ji,n.Class=v,n.Control=Vt,n.DivIcon=Go,n.DivOverlay=ne,n.DomEvent=tl,n.DomUtil=Jh,n.Draggable=me,n.Evented=V,n.FeatureGroup=se,n.GeoJSON=he,n.GridLayer=di,n.Handler=ie,n.Icon=Ae,n.ImageOverlay=rn,n.LatLng=et,n.LatLngBounds=nt,n.Layer=Ht,n.LayerGroup=Oe,n.LineUtil=fl,n.Map=at,n.Marker=Ki,n.Mixin=al,n.Path=ge,n.Point=N,n.PolyUtil=hl,n.Polygon=Fe,n.Polyline=ae,n.Popup=on,n.PosAnimation=Eo,n.Projection=pl,n.Rectangle=ts,n.Renderer=le,n.SVG=pi,n.SVGOverlay=Ho,n.TileLayer=Re,n.Tooltip=sn,n.Transformation=Lt,n.Util=X,n.VideoOverlay=Vo,n.bind=l,n.bounds=G,n.canvas=Jo,n.circle=bl,n.circleMarker=wl,n.control=li,n.divIcon=Dl,n.extend=s,n.featureGroup=vl,n.geoJSON=Uo,n.geoJson=Ll,n.gridLayer=Il,n.icon=yl,n.imageOverlay=Cl,n.latLng=q,n.latLngBounds=Q,n.layerGroup=gl,n.map=el,n.marker=xl,n.point=Z,n.polygon=Ml,n.polyline=Pl,n.popup=Tl,n.rectangle=Ol,n.setOptions=C,n.stamp=d,n.svg=Qo,n.svgOverlay=kl,n.tileLayer=qo,n.tooltip=El,n.transformation=Dt,n.version=r,n.videoOverlay=Sl;var Fl=window.L;n.noConflict=function(){return window.L=Fl,this},window.L=n})})(Zr,Zr.exports);var yh=Zr.exports;const jf=Ca(yh),oa=Vl({__proto__:null,default:jf},[yh]),Wf="_button_6v7zm_1",Yf="_active_6v7zm_21",Xf="_hiddenOnMobile_6v7zm_26",xn={button:Wf,active:Yf,hiddenOnMobile:Xf};function Uf(i){return i.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}const Vf=({mode:i,currentMode:e,changeMode:n,label:r,hiddenOnTouch:s})=>{let a=xn.button;return s&&(a=`${xn.hiddenOnMobile} ${a}`),e===i&&(a=`${xn.active} ${a}`),_t("button",{id:i,class:a,onClick:()=>{n(i)},children:r||Uf(i)})},Hf=({label:i,onClick:e})=>{let n=xn.button;return _t("button",{id:"clear",class:n,onClick:()=>{e()},children:i})},Gf="_buttons_123u9_1",qf={buttons:Gf},$f=({mode:i,onClear:e,changeMode:n})=>_t("div",{class:qf.buttons,children:[_t(Vf,{label:"Route Snap",mode:"routesnap",currentMode:i,changeMode:n}),_t(Hf,{onClick:e,label:"Clear"})]});function Kf(i,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function Jf(i,e,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return Kf({type:"Polygon",coordinates:i},e,n)}function xh(i,e,n){if(i!==null)for(var r,s,a,l,u,d,_,f=0,g=0,w,b=i.type,M=b==="FeatureCollection",C=b==="Feature",I=M?i.features.length:1,A=0;A<I;A++){_=M?i.features[A].geometry:C?i.geometry:i,w=_?_.type==="GeometryCollection":!1,u=w?_.geometries.length:1;for(var m=0;m<u;m++){var x=0,P=0;if(l=w?_.geometries[m]:_,l!==null){d=l.coordinates;var k=l.type;switch(f=0,k){case null:break;case"Point":if(e(d,g,A,x,P)===!1)return!1;g++,x++;break;case"LineString":case"MultiPoint":for(r=0;r<d.length;r++){if(e(d[r],g,A,x,P)===!1)return!1;g++,k==="MultiPoint"&&x++}k==="LineString"&&x++;break;case"Polygon":case"MultiLineString":for(r=0;r<d.length;r++){for(s=0;s<d[r].length-f;s++){if(e(d[r][s],g,A,x,P)===!1)return!1;g++}k==="MultiLineString"&&x++,k==="Polygon"&&P++}k==="Polygon"&&x++;break;case"MultiPolygon":for(r=0;r<d.length;r++){for(P=0,s=0;s<d[r].length;s++){for(a=0;a<d[r][s].length-f;a++){if(e(d[r][s][a],g,A,x,P)===!1)return!1;g++}P++}x++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(xh(l.geometries[r],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var oo={exports:{}},wh={exports:{}};(function(i,e){(function(n,r){i.exports=r()})(Xr,function(){function n(m,x,P,k,E){(function T(B,R,j,W,U){for(;W>j;){if(W-j>600){var X=W-j+1,v=R-j+1,D=Math.log(X),z=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*z*(X-z)/X)*(v-X/2<0?-1:1),N=Math.max(j,Math.floor(R-v*z/X+V)),K=Math.min(W,Math.floor(R+(X-v)*z/X+V));T(B,R,N,K,U)}var Z=B[R],H=j,G=W;for(r(B,j,R),U(B[W],Z)>0&&r(B,j,W);H<G;){for(r(B,H,G),H++,G--;U(B[H],Z)<0;)H++;for(;U(B[G],Z)>0;)G--}U(B[j],Z)===0?r(B,j,G):r(B,++G,W),G<=R&&(j=G+1),R<=G&&(W=G-1)}})(m,x,P||0,k||m.length-1,E||s)}function r(m,x,P){var k=m[x];m[x]=m[P],m[P]=k}function s(m,x){return m<x?-1:m>x?1:0}var a=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(m,x,P){if(!P)return x.indexOf(m);for(var k=0;k<x.length;k++)if(P(m,x[k]))return k;return-1}function u(m,x){d(m,0,m.children.length,x,m)}function d(m,x,P,k,E){E||(E=I(null)),E.minX=1/0,E.minY=1/0,E.maxX=-1/0,E.maxY=-1/0;for(var T=x;T<P;T++){var B=m.children[T];_(E,m.leaf?k(B):B)}return E}function _(m,x){return m.minX=Math.min(m.minX,x.minX),m.minY=Math.min(m.minY,x.minY),m.maxX=Math.max(m.maxX,x.maxX),m.maxY=Math.max(m.maxY,x.maxY),m}function f(m,x){return m.minX-x.minX}function g(m,x){return m.minY-x.minY}function w(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function b(m){return m.maxX-m.minX+(m.maxY-m.minY)}function M(m,x){return m.minX<=x.minX&&m.minY<=x.minY&&x.maxX<=m.maxX&&x.maxY<=m.maxY}function C(m,x){return x.minX<=m.maxX&&x.minY<=m.maxY&&x.maxX>=m.minX&&x.maxY>=m.minY}function I(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function A(m,x,P,k,E){for(var T=[x,P];T.length;)if(!((P=T.pop())-(x=T.pop())<=k)){var B=x+Math.ceil((P-x)/k/2)*k;n(m,B,x,P,E),T.push(x,B,B,P)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(m){var x=this.data,P=[];if(!C(m,x))return P;for(var k=this.toBBox,E=[];x;){for(var T=0;T<x.children.length;T++){var B=x.children[T],R=x.leaf?k(B):B;C(m,R)&&(x.leaf?P.push(B):M(m,R)?this._all(B,P):E.push(B))}x=E.pop()}return P},a.prototype.collides=function(m){var x=this.data;if(!C(m,x))return!1;for(var P=[];x;){for(var k=0;k<x.children.length;k++){var E=x.children[k],T=x.leaf?this.toBBox(E):E;if(C(m,T)){if(x.leaf||M(m,T))return!0;P.push(E)}}x=P.pop()}return!1},a.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var x=0;x<m.length;x++)this.insert(m[x]);return this}var P=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===P.height)this._splitRoot(this.data,P);else{if(this.data.height<P.height){var k=this.data;this.data=P,P=k}this._insert(P,this.data.height-P.height-1,!0)}else this.data=P;return this},a.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},a.prototype.clear=function(){return this.data=I([]),this},a.prototype.remove=function(m,x){if(!m)return this;for(var P,k,E,T=this.data,B=this.toBBox(m),R=[],j=[];T||R.length;){if(T||(T=R.pop(),k=R[R.length-1],P=j.pop(),E=!0),T.leaf){var W=l(m,T.children,x);if(W!==-1)return T.children.splice(W,1),R.push(T),this._condense(R),this}E||T.leaf||!M(T,B)?k?(P++,T=k.children[P],E=!1):T=null:(R.push(T),j.push(P),P=0,k=T,T=T.children[0])}return this},a.prototype.toBBox=function(m){return m},a.prototype.compareMinX=function(m,x){return m.minX-x.minX},a.prototype.compareMinY=function(m,x){return m.minY-x.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(m){return this.data=m,this},a.prototype._all=function(m,x){for(var P=[];m;)m.leaf?x.push.apply(x,m.children):P.push.apply(P,m.children),m=P.pop();return x},a.prototype._build=function(m,x,P,k){var E,T=P-x+1,B=this._maxEntries;if(T<=B)return u(E=I(m.slice(x,P+1)),this.toBBox),E;k||(k=Math.ceil(Math.log(T)/Math.log(B)),B=Math.ceil(T/Math.pow(B,k-1))),(E=I([])).leaf=!1,E.height=k;var R=Math.ceil(T/B),j=R*Math.ceil(Math.sqrt(B));A(m,x,P,j,this.compareMinX);for(var W=x;W<=P;W+=j){var U=Math.min(W+j-1,P);A(m,W,U,R,this.compareMinY);for(var X=W;X<=U;X+=R){var v=Math.min(X+R-1,U);E.children.push(this._build(m,X,v,k-1))}}return u(E,this.toBBox),E},a.prototype._chooseSubtree=function(m,x,P,k){for(;k.push(x),!x.leaf&&k.length-1!==P;){for(var E=1/0,T=1/0,B=void 0,R=0;R<x.children.length;R++){var j=x.children[R],W=w(j),U=(X=m,v=j,(Math.max(v.maxX,X.maxX)-Math.min(v.minX,X.minX))*(Math.max(v.maxY,X.maxY)-Math.min(v.minY,X.minY))-W);U<T?(T=U,E=W<E?W:E,B=j):U===T&&W<E&&(E=W,B=j)}x=B||x.children[0]}var X,v;return x},a.prototype._insert=function(m,x,P){var k=P?m:this.toBBox(m),E=[],T=this._chooseSubtree(k,this.data,x,E);for(T.children.push(m),_(T,k);x>=0&&E[x].children.length>this._maxEntries;)this._split(E,x),x--;this._adjustParentBBoxes(k,E,x)},a.prototype._split=function(m,x){var P=m[x],k=P.children.length,E=this._minEntries;this._chooseSplitAxis(P,E,k);var T=this._chooseSplitIndex(P,E,k),B=I(P.children.splice(T,P.children.length-T));B.height=P.height,B.leaf=P.leaf,u(P,this.toBBox),u(B,this.toBBox),x?m[x-1].children.push(B):this._splitRoot(P,B)},a.prototype._splitRoot=function(m,x){this.data=I([m,x]),this.data.height=m.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(m,x,P){for(var k,E,T,B,R,j,W,U=1/0,X=1/0,v=x;v<=P-x;v++){var D=d(m,0,v,this.toBBox),z=d(m,v,P,this.toBBox),V=(E=D,T=z,B=void 0,R=void 0,j=void 0,W=void 0,B=Math.max(E.minX,T.minX),R=Math.max(E.minY,T.minY),j=Math.min(E.maxX,T.maxX),W=Math.min(E.maxY,T.maxY),Math.max(0,j-B)*Math.max(0,W-R)),N=w(D)+w(z);V<U?(U=V,k=v,X=N<X?N:X):V===U&&N<X&&(X=N,k=v)}return k||P-x},a.prototype._chooseSplitAxis=function(m,x,P){var k=m.leaf?this.compareMinX:f,E=m.leaf?this.compareMinY:g;this._allDistMargin(m,x,P,k)<this._allDistMargin(m,x,P,E)&&m.children.sort(k)},a.prototype._allDistMargin=function(m,x,P,k){m.children.sort(k);for(var E=this.toBBox,T=d(m,0,x,E),B=d(m,P-x,P,E),R=b(T)+b(B),j=x;j<P-x;j++){var W=m.children[j];_(T,m.leaf?E(W):W),R+=b(T)}for(var U=P-x-1;U>=x;U--){var X=m.children[U];_(B,m.leaf?E(X):X),R+=b(B)}return R},a.prototype._adjustParentBBoxes=function(m,x,P){for(var k=P;k>=0;k--)_(x[k],m)},a.prototype._condense=function(m){for(var x=m.length-1,P=void 0;x>=0;x--)m[x].children.length===0?x>0?(P=m[x-1].children).splice(P.indexOf(m[x]),1):this.clear():u(m[x],this.toBBox)},a})})(wh);var Qf=wh.exports;class tp{constructor(e=[],n=ep){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:r}=this,s=n[e];for(;e>0;){const a=e-1>>1,l=n[a];if(r(s,l)>=0)break;n[e]=l,e=a}n[e]=s}_down(e){const{data:n,compare:r}=this,s=this.length>>1,a=n[e];for(;e<s;){let l=(e<<1)+1,u=n[l];const d=l+1;if(d<this.length&&r(n[d],u)<0&&(l=d,u=n[d]),r(u,a)>=0)break;n[e]=u,e=l}n[e]=a}}function ep(i,e){return i<e?-1:i>e?1:0}const ip=Object.freeze(Object.defineProperty({__proto__:null,default:tp},Symbol.toStringTag,{value:"Module"})),np=Ur(ip);var Fn={exports:{}},rp=function(e,n,r,s){var a=e[0],l=e[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var d=(s-r)/2,_=0,f=d-1;_<d;f=_++){var g=n[r+_*2+0],w=n[r+_*2+1],b=n[r+f*2+0],M=n[r+f*2+1],C=w>l!=M>l&&a<(b-g)*(l-w)/(M-w)+g;C&&(u=!u)}return u},op=function(e,n,r,s){var a=e[0],l=e[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var d=s-r,_=0,f=d-1;_<d;f=_++){var g=n[_+r][0],w=n[_+r][1],b=n[f+r][0],M=n[f+r][1],C=w>l!=M>l&&a<(b-g)*(l-w)/(M-w)+g;C&&(u=!u)}return u},bh=rp,Ph=op;Fn.exports=function(e,n,r,s){return n.length>0&&Array.isArray(n[0])?Ph(e,n,r,s):bh(e,n,r,s)};Fn.exports.nested=Ph;Fn.exports.flat=bh;var sp=Fn.exports,Rr={exports:{}};(function(i,e){(function(n,r){r(e)})(Xr,function(n){const s=33306690738754706e-32;function a(C,I,A,m,x){let P,k,E,T,B=I[0],R=m[0],j=0,W=0;R>B==R>-B?(P=B,B=I[++j]):(P=R,R=m[++W]);let U=0;if(j<C&&W<A)for(R>B==R>-B?(E=P-((k=B+P)-B),B=I[++j]):(E=P-((k=R+P)-R),R=m[++W]),P=k,E!==0&&(x[U++]=E);j<C&&W<A;)R>B==R>-B?(E=P-((k=P+B)-(T=k-P))+(B-T),B=I[++j]):(E=P-((k=P+R)-(T=k-P))+(R-T),R=m[++W]),P=k,E!==0&&(x[U++]=E);for(;j<C;)E=P-((k=P+B)-(T=k-P))+(B-T),B=I[++j],P=k,E!==0&&(x[U++]=E);for(;W<A;)E=P-((k=P+R)-(T=k-P))+(R-T),R=m[++W],P=k,E!==0&&(x[U++]=E);return P===0&&U!==0||(x[U++]=P),U}function l(C){return new Float64Array(C)}const u=33306690738754716e-32,d=22204460492503146e-32,_=11093356479670487e-47,f=l(4),g=l(8),w=l(12),b=l(16),M=l(4);n.orient2d=function(C,I,A,m,x,P){const k=(I-P)*(A-x),E=(C-x)*(m-P),T=k-E;if(k===0||E===0||k>0!=E>0)return T;const B=Math.abs(k+E);return Math.abs(T)>=u*B?T:-function(R,j,W,U,X,v,D){let z,V,N,K,Z,H,G,nt,Q,et,q,ht,dt,xt,Mt,Lt,Dt,Ct;const Ft=R-X,It=W-X,Bt=j-v,St=U-v;Z=(Mt=(nt=Ft-(G=(H=134217729*Ft)-(H-Ft)))*(et=St-(Q=(H=134217729*St)-(H-St)))-((xt=Ft*St)-G*Q-nt*Q-G*et))-(q=Mt-(Dt=(nt=Bt-(G=(H=134217729*Bt)-(H-Bt)))*(et=It-(Q=(H=134217729*It)-(H-It)))-((Lt=Bt*It)-G*Q-nt*Q-G*et))),f[0]=Mt-(q+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+q)-(Z=ht-xt))+(q-Z))-(q=dt-Lt),f[1]=dt-(q+Z)+(Z-Lt),Z=(Ct=ht+q)-ht,f[2]=ht-(Ct-Z)+(q-Z),f[3]=Ct;let Zt=function(ji,Wi){let Yi=Wi[0];for(let xe=1;xe<ji;xe++)Yi+=Wi[xe];return Yi}(4,f),ye=d*D;if(Zt>=ye||-Zt>=ye||(z=R-(Ft+(Z=R-Ft))+(Z-X),N=W-(It+(Z=W-It))+(Z-X),V=j-(Bt+(Z=j-Bt))+(Z-v),K=U-(St+(Z=U-St))+(Z-v),z===0&&V===0&&N===0&&K===0)||(ye=_*D+s*Math.abs(Zt),(Zt+=Ft*K+St*z-(Bt*N+It*V))>=ye||-Zt>=ye))return Zt;Z=(Mt=(nt=z-(G=(H=134217729*z)-(H-z)))*(et=St-(Q=(H=134217729*St)-(H-St)))-((xt=z*St)-G*Q-nt*Q-G*et))-(q=Mt-(Dt=(nt=V-(G=(H=134217729*V)-(H-V)))*(et=It-(Q=(H=134217729*It)-(H-It)))-((Lt=V*It)-G*Q-nt*Q-G*et))),M[0]=Mt-(q+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+q)-(Z=ht-xt))+(q-Z))-(q=dt-Lt),M[1]=dt-(q+Z)+(Z-Lt),Z=(Ct=ht+q)-ht,M[2]=ht-(Ct-Z)+(q-Z),M[3]=Ct;const Ri=a(4,f,4,M,g);Z=(Mt=(nt=Ft-(G=(H=134217729*Ft)-(H-Ft)))*(et=K-(Q=(H=134217729*K)-(H-K)))-((xt=Ft*K)-G*Q-nt*Q-G*et))-(q=Mt-(Dt=(nt=Bt-(G=(H=134217729*Bt)-(H-Bt)))*(et=N-(Q=(H=134217729*N)-(H-N)))-((Lt=Bt*N)-G*Q-nt*Q-G*et))),M[0]=Mt-(q+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+q)-(Z=ht-xt))+(q-Z))-(q=dt-Lt),M[1]=dt-(q+Z)+(Z-Lt),Z=(Ct=ht+q)-ht,M[2]=ht-(Ct-Z)+(q-Z),M[3]=Ct;const ei=a(Ri,g,4,M,w);Z=(Mt=(nt=z-(G=(H=134217729*z)-(H-z)))*(et=K-(Q=(H=134217729*K)-(H-K)))-((xt=z*K)-G*Q-nt*Q-G*et))-(q=Mt-(Dt=(nt=V-(G=(H=134217729*V)-(H-V)))*(et=N-(Q=(H=134217729*N)-(H-N)))-((Lt=V*N)-G*Q-nt*Q-G*et))),M[0]=Mt-(q+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+q)-(Z=ht-xt))+(q-Z))-(q=dt-Lt),M[1]=dt-(q+Z)+(Z-Lt),Z=(Ct=ht+q)-ht,M[2]=ht-(Ct-Z)+(q-Z),M[3]=Ct;const Ni=a(ei,w,4,M,b);return b[Ni-1]}(C,I,A,m,x,P,B)},n.orient2dfast=function(C,I,A,m,x,P){return(I-P)*(A-x)-(C-x)*(m-P)},Object.defineProperty(n,"__esModule",{value:!0})})})(Rr,Rr.exports);var ap=Rr.exports,sa=Qf,wn=np,hp=sp,lp=ap.orient2d;wn.default&&(wn=wn.default);oo.exports=Mh;oo.exports.default=Mh;function Mh(i,e,n){e=Math.max(0,e===void 0?2:e),n=n||0;var r=pp(i),s=new sa(16);s.toBBox=function(m){return{minX:m[0],minY:m[1],maxX:m[0],maxY:m[1]}},s.compareMinX=function(m,x){return m[0]-x[0]},s.compareMinY=function(m,x){return m[1]-x[1]},s.load(i);for(var a=[],l=0,u;l<r.length;l++){var d=r[l];s.remove(d),u=la(d,u),a.push(u)}var _=new sa(16);for(l=0;l<a.length;l++)_.insert(Pr(a[l]));for(var f=e*e,g=n*n;a.length;){var w=a.shift(),b=w.p,M=w.next.p,C=Mr(b,M);if(!(C<g)){var I=C/f;d=up(s,w.prev.p,b,M,w.next.next.p,I,_),d&&Math.min(Mr(d,b),Mr(d,M))<=I&&(a.push(w),a.push(la(d,w)),s.remove(d),_.remove(w),_.insert(Pr(w)),_.insert(Pr(w.next)))}}w=u;var A=[];do A.push(w.p),w=w.next;while(w!==u);return A.push(w.p),A}function up(i,e,n,r,s,a,l){for(var u=new wn([],cp),d=i.data;d;){for(var _=0;_<d.children.length;_++){var f=d.children[_],g=d.leaf?Lr(f,n,r):dp(n,r,f);g>a||u.push({node:f,dist:g})}for(;u.length&&!u.peek().node.children;){var w=u.pop(),b=w.node,M=Lr(b,e,n),C=Lr(b,r,s);if(w.dist<M&&w.dist<C&&ha(n,b,l)&&ha(r,b,l))return b}d=u.pop(),d&&(d=d.node)}return null}function cp(i,e){return i.dist-e.dist}function dp(i,e,n){if(aa(i,n)||aa(e,n))return 0;var r=_n(i[0],i[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var s=_n(i[0],i[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(s===0)return 0;var a=_n(i[0],i[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var l=_n(i[0],i[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return l===0?0:Math.min(r,s,a,l)}function aa(i,e){return i[0]>=e.minX&&i[0]<=e.maxX&&i[1]>=e.minY&&i[1]<=e.maxY}function ha(i,e,n){for(var r=Math.min(i[0],e[0]),s=Math.min(i[1],e[1]),a=Math.max(i[0],e[0]),l=Math.max(i[1],e[1]),u=n.search({minX:r,minY:s,maxX:a,maxY:l}),d=0;d<u.length;d++)if(fp(u[d].p,u[d].next.p,i,e))return!1;return!0}function Ge(i,e,n){return lp(i[0],i[1],e[0],e[1],n[0],n[1])}function fp(i,e,n,r){return i!==r&&e!==n&&Ge(i,e,n)>0!=Ge(i,e,r)>0&&Ge(n,r,i)>0!=Ge(n,r,e)>0}function Pr(i){var e=i.p,n=i.next.p;return i.minX=Math.min(e[0],n[0]),i.minY=Math.min(e[1],n[1]),i.maxX=Math.max(e[0],n[0]),i.maxY=Math.max(e[1],n[1]),i}function pp(i){for(var e=i[0],n=i[0],r=i[0],s=i[0],a=0;a<i.length;a++){var l=i[a];l[0]<e[0]&&(e=l),l[0]>r[0]&&(r=l),l[1]<n[1]&&(n=l),l[1]>s[1]&&(s=l)}var u=[e,n,r,s],d=u.slice();for(a=0;a<i.length;a++)hp(i[a],u)||d.push(i[a]);return mp(d)}function la(i,e){var n={p:i,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function Mr(i,e){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r}function Lr(i,e,n){var r=e[0],s=e[1],a=n[0]-r,l=n[1]-s;if(a!==0||l!==0){var u=((i[0]-r)*a+(i[1]-s)*l)/(a*a+l*l);u>1?(r=n[0],s=n[1]):u>0&&(r+=a*u,s+=l*u)}return a=i[0]-r,l=i[1]-s,a*a+l*l}function _n(i,e,n,r,s,a,l,u){var d=n-i,_=r-e,f=l-s,g=u-a,w=i-s,b=e-a,M=d*d+_*_,C=d*f+_*g,I=f*f+g*g,A=d*w+_*b,m=f*w+g*b,x=M*I-C*C,P,k,E,T,B=x,R=x;x===0?(k=0,B=1,T=m,R=I):(k=C*m-I*A,T=M*m-C*A,k<0?(k=0,T=m,R=I):k>B&&(k=B,T=m+C,R=I)),T<0?(T=0,-A<0?k=0:-A>M?k=B:(k=-A,B=M)):T>R&&(T=R,-A+C<0?k=0:-A+C>M?k=B:(k=-A+C,B=M)),P=k===0?0:k/B,E=T===0?0:T/R;var j=(1-P)*i+P*n,W=(1-P)*e+P*r,U=(1-E)*s+E*l,X=(1-E)*a+E*u,v=U-j,D=X-W;return v*v+D*D}function _p(i,e){return i[0]===e[0]?i[1]-e[1]:i[0]-e[0]}function mp(i){i.sort(_p);for(var e=[],n=0;n<i.length;n++){for(;e.length>=2&&Ge(e[e.length-2],e[e.length-1],i[n])<=0;)e.pop();e.push(i[n])}for(var r=[],s=i.length-1;s>=0;s--){for(;r.length>=2&&Ge(r[r.length-2],r[r.length-1],i[s])<=0;)r.pop();r.push(i[s])}return r.pop(),e.pop(),e.concat(r)}var gp=oo.exports;const vp=Ca(gp);function yp(i,e={}){e.concavity=e.concavity||1/0;const n=[];if(xh(i,s=>{n.push([s[0],s[1]])}),!n.length)return null;const r=vp(n,e.concavity);return r.length>3?Jf([r]):null}var xp=yp;const wp=()=>{console.log("Home.tsx");const i=51.532831,e=-.0969151,n={L:oa,id:"leaflet-map",lng:e,lat:i,zoom:16,minZoom:14,maxZoom:20,tapTolerance:10,maxBounds:[[i-.1,e-.1],[i+.1,e+.1]]},r=Du(null),[s,a]=pr(),[l,u]=pr("static"),[d,_]=pr();Ps(()=>{fetch("./assets/network/network.json").then(w=>{w.json().then(b=>{_(b)})})},[]),Ps(()=>{s||a(Nf(n))},[]);const f=zn(()=>{if(s&&d){const w=Vc(s,oa,d);w.start(),console.log("mode");const b=xp(d);return b&&b.properties&&(b.properties.mode="networkOutline"),console.log(b),w.addFeatures([b]),w}},[s,d]),g=Iu(w=>{f&&(u(w),f.setMode(w))},[f]);return _t("div",{class:dr.home,children:_t("div",{ref:r,class:dr.map,id:n.id,children:[f?_t($f,{mode:l,changeMode:g,onClear:()=>{const w=f.getSnapshot().filter(b=>b.properties.mode==="routesnap");f.removeFeatures(w.map(b=>b.id))}}):null,f?null:_t("div",{class:dr.loading,children:"Loading..."})]})})};console.log("App.tsx");const bp=()=>_t("div",{id:"app",children:[_t(Cu,{}),_t(wp,{})]});let Ce,Mi;const Pp=(i,e)=>{if(Ce=void 0,e&&e.type==="click"){if(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button!==0)return i;const n=e.target.closest("a[href]"),r=n&&n.getAttribute("href");if(!n||n.origin!=location.origin||/^#/.test(r)||!/^(_?self)?$/i.test(n.target)||Mi&&(typeof Mi=="string"?!r.startsWith(Mi):!Mi.test(r)))return i;Ce=!0,e.preventDefault(),e=n.href.replace(location.origin,"")}else typeof e=="string"?Ce=!0:e&&e.url?(Ce=!e.replace,e=e.url):e=location.pathname+location.search;return Ce===!0?history.pushState(null,"",e):Ce===!1&&history.replaceState(null,"",e),e};function Lh(i){const[e,n]=Aa(Pp,i.url||location.pathname+location.search);i.scope&&(Mi=i.scope);const r=Ce===!0,s=zn(()=>{const a=new URL(e,location.origin),l=a.pathname.replace(/\/+$/g,"")||"/";return{url:e,path:l,query:Object.fromEntries(a.searchParams),route:(u,d)=>n({url:u,replace:d}),wasPush:r}},[e]);return Eu(()=>(addEventListener("click",n),addEventListener("popstate",n),()=>{removeEventListener("click",n),removeEventListener("popstate",n)}),[]),Je(Lh.ctx.Provider,{value:s},i.children)}Promise.resolve();Lh.ctx=Yr({});Yr({});const ua=it.__b;it.__b=i=>{i.type&&i.type._forwarded&&i.ref&&(i.props.ref=i.ref,i.ref=null),ua&&ua(i)};const ca=it.__e;it.__e=(i,e,n)=>{if(i&&i.then){let r=e;for(;r=r.__;)if(r.__c&&r.__c.__c)return e.__e==null&&(e.__c.__z=[n.__e],e.__e=n.__e,e.__k=n.__k),e.__k||(e.__k=[]),r.__c.__c(i,e)}ca&&ca(i,e,n)};let da;function Mp(i,e){if(typeof window>"u")return;let n=document.querySelector("script[type=isodata]");e=e||n&&n.parentNode||document.body,!da&&n?Wr(i,e):jr(i,e),da=!0}typeof window<"u"&&Mp(_t(bp,{}),document.getElementById("app"));
