function Yl(n,e){for(var i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=i(s);fetch(s.href,a)}})();var Fi,it,ua,ca,Si,ls,da,Mn={},fa=[],Wl=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function de(n,e){for(var i in e)n[i]=e[i];return n}function pa(n){var e=n.parentNode;e&&e.removeChild(n)}function Qe(n,e,i){var r,s,a,l={};for(a in e)a=="key"?r=e[a]:a=="ref"?s=e[a]:l[a]=e[a];if(arguments.length>2&&(l.children=arguments.length>3?Fi.call(arguments,2):i),typeof n=="function"&&n.defaultProps!=null)for(a in n.defaultProps)l[a]===void 0&&(l[a]=n.defaultProps[a]);return ki(n,l,r,s,null)}function ki(n,e,i,r,s){var a={type:n,props:e,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++ua};return s==null&&it.vnode!=null&&it.vnode(a),a}function Ul(){return{current:null}}function Zi(n){return n.children}function qe(n,e){this.props=n,this.context=e}function Ii(n,e){if(e==null)return n.__?Ii(n.__,n.__.__k.indexOf(n)+1):null;for(var i;e<n.__k.length;e++)if((i=n.__k[e])!=null&&i.__e!=null)return i.__e;return typeof n.type=="function"?Ii(n):null}function _a(n){var e,i;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((i=n.__k[e])!=null&&i.__e!=null){n.__e=n.__c.base=i.__e;break}return _a(n)}}function Sr(n){(!n.__d&&(n.__d=!0)&&Si.push(n)&&!Ln.__r++||ls!==it.debounceRendering)&&((ls=it.debounceRendering)||setTimeout)(Ln)}function Ln(){for(var n;Ln.__r=Si.length;)n=Si.sort(function(e,i){return e.__v.__b-i.__v.__b}),Si=[],n.some(function(e){var i,r,s,a,l,u;e.__d&&(l=(a=(i=e).__v).__e,(u=i.__P)&&(r=[],(s=de({},a)).__v=a.__v+1,Rr(u,a,s,i.__n,u.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Ii(a),a.__h),ya(r,a),a.__e!=l&&_a(a)))})}function ma(n,e,i,r,s,a,l,u,d,_){var f,g,x,b,M,S,B,A=r&&r.__k||fa,m=A.length;for(i.__k=[],f=0;f<e.length;f++)if((b=i.__k[f]=(b=e[f])==null||typeof b=="boolean"?null:typeof b=="string"||typeof b=="number"||typeof b=="bigint"?ki(null,b,null,null,b):Array.isArray(b)?ki(Zi,{children:b},null,null,null):b.__b>0?ki(b.type,b.props,b.key,b.ref?b.ref:null,b.__v):b)!=null){if(b.__=i,b.__b=i.__b+1,(x=A[f])===null||x&&b.key==x.key&&b.type===x.type)A[f]=void 0;else for(g=0;g<m;g++){if((x=A[g])&&b.key==x.key&&b.type===x.type){A[g]=void 0;break}x=null}Rr(n,b,x=x||Mn,s,a,l,u,d,_),M=b.__e,(g=b.ref)&&x.ref!=g&&(B||(B=[]),x.ref&&B.push(x.ref,null,b),B.push(g,b.__c||M,b)),M!=null?(S==null&&(S=M),typeof b.type=="function"&&b.__k===x.__k?b.__d=d=ga(b,d,n):d=va(n,b,x,A,M,d),typeof i.type=="function"&&(i.__d=d)):d&&x.__e==d&&d.parentNode!=n&&(d=Ii(x))}for(i.__e=S,f=m;f--;)A[f]!=null&&wa(A[f],A[f]);if(B)for(f=0;f<B.length;f++)xa(B[f],B[++f],B[++f])}function ga(n,e,i){for(var r,s=n.__k,a=0;s&&a<s.length;a++)(r=s[a])&&(r.__=n,e=typeof r.type=="function"?ga(r,e,i):va(i,r,r,s,r.__e,e));return e}function Cn(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(i){Cn(i,e)}):e.push(n)),e}function va(n,e,i,r,s,a){var l,u,d;if(e.__d!==void 0)l=e.__d,e.__d=void 0;else if(i==null||s!=a||s.parentNode==null)t:if(a==null||a.parentNode!==n)n.appendChild(s),l=null;else{for(u=a,d=0;(u=u.nextSibling)&&d<r.length;d+=1)if(u==s)break t;n.insertBefore(s,a),l=a}return l!==void 0?l:s.nextSibling}function Xl(n,e,i,r,s){var a;for(a in i)a==="children"||a==="key"||a in e||Sn(n,a,null,i[a],r);for(a in e)s&&typeof e[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||i[a]===e[a]||Sn(n,a,e[a],i[a],r)}function us(n,e,i){e[0]==="-"?n.setProperty(e,i):n[e]=i==null?"":typeof i!="number"||Wl.test(e)?i:i+"px"}function Sn(n,e,i,r,s){var a;t:if(e==="style")if(typeof i=="string")n.style.cssText=i;else{if(typeof r=="string"&&(n.style.cssText=r=""),r)for(e in r)i&&e in i||us(n.style,e,"");if(i)for(e in i)r&&i[e]===r[e]||us(n.style,e,i[e])}else if(e[0]==="o"&&e[1]==="n")a=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+a]=i,i?r||n.addEventListener(e,a?ds:cs,a):n.removeEventListener(e,a?ds:cs,a);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=i??"";break t}catch{}typeof i=="function"||(i==null||i===!1&&e.indexOf("-")==-1?n.removeAttribute(e):n.setAttribute(e,i))}}function cs(n){this.l[n.type+!1](it.event?it.event(n):n)}function ds(n){this.l[n.type+!0](it.event?it.event(n):n)}function Rr(n,e,i,r,s,a,l,u,d){var _,f,g,x,b,M,S,B,A,m,w,P,k,T,E,I=e.type;if(e.constructor!==void 0)return null;i.__h!=null&&(d=i.__h,u=e.__e=i.__e,e.__h=null,a=[u]),(_=it.__b)&&_(e);try{t:if(typeof I=="function"){if(B=e.props,A=(_=I.contextType)&&r[_.__c],m=_?A?A.props.value:_.__:r,i.__c?S=(f=e.__c=i.__c).__=f.__E:("prototype"in I&&I.prototype.render?e.__c=f=new I(B,m):(e.__c=f=new qe(B,m),f.constructor=I,f.render=Hl),A&&A.sub(f),f.props=B,f.state||(f.state={}),f.context=m,f.__n=r,g=f.__d=!0,f.__h=[],f._sb=[]),f.__s==null&&(f.__s=f.state),I.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=de({},f.__s)),de(f.__s,I.getDerivedStateFromProps(B,f.__s))),x=f.props,b=f.state,g)I.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(I.getDerivedStateFromProps==null&&B!==x&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(B,m),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(B,f.__s,m)===!1||e.__v===i.__v){for(f.props=B,f.state=f.__s,e.__v!==i.__v&&(f.__d=!1),f.__v=e,e.__e=i.__e,e.__k=i.__k,e.__k.forEach(function(N){N&&(N.__=e)}),w=0;w<f._sb.length;w++)f.__h.push(f._sb[w]);f._sb=[],f.__h.length&&l.push(f);break t}f.componentWillUpdate!=null&&f.componentWillUpdate(B,f.__s,m),f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(x,b,M)})}if(f.context=m,f.props=B,f.__v=e,f.__P=n,P=it.__r,k=0,"prototype"in I&&I.prototype.render){for(f.state=f.__s,f.__d=!1,P&&P(e),_=f.render(f.props,f.state,f.context),T=0;T<f._sb.length;T++)f.__h.push(f._sb[T]);f._sb=[]}else do f.__d=!1,P&&P(e),_=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++k<25);f.state=f.__s,f.getChildContext!=null&&(r=de(de({},r),f.getChildContext())),g||f.getSnapshotBeforeUpdate==null||(M=f.getSnapshotBeforeUpdate(x,b)),E=_!=null&&_.type===Zi&&_.key==null?_.props.children:_,ma(n,Array.isArray(E)?E:[E],e,i,r,s,a,l,u,d),f.base=e.__e,e.__h=null,f.__h.length&&l.push(f),S&&(f.__E=f.__=null),f.__e=!1}else a==null&&e.__v===i.__v?(e.__k=i.__k,e.__e=i.__e):e.__e=Vl(i.__e,e,i,r,s,a,l,d);(_=it.diffed)&&_(e)}catch(N){e.__v=null,(d||a!=null)&&(e.__e=u,e.__h=!!d,a[a.indexOf(u)]=null),it.__e(N,e,i)}}function ya(n,e){it.__c&&it.__c(e,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(r){r.call(i)})}catch(r){it.__e(r,i.__v)}})}function Vl(n,e,i,r,s,a,l,u){var d,_,f,g=i.props,x=e.props,b=e.type,M=0;if(b==="svg"&&(s=!0),a!=null){for(;M<a.length;M++)if((d=a[M])&&"setAttribute"in d==!!b&&(b?d.localName===b:d.nodeType===3)){n=d,a[M]=null;break}}if(n==null){if(b===null)return document.createTextNode(x);n=s?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,x.is&&x),a=null,u=!1}if(b===null)g===x||u&&n.data===x||(n.data=x);else{if(a=a&&Fi.call(n.childNodes),_=(g=i.props||Mn).dangerouslySetInnerHTML,f=x.dangerouslySetInnerHTML,!u){if(a!=null)for(g={},M=0;M<n.attributes.length;M++)g[n.attributes[M].name]=n.attributes[M].value;(f||_)&&(f&&(_&&f.__html==_.__html||f.__html===n.innerHTML)||(n.innerHTML=f&&f.__html||""))}if(Xl(n,x,g,s,u),f)e.__k=[];else if(M=e.props.children,ma(n,Array.isArray(M)?M:[M],e,i,r,s&&b!=="foreignObject",a,l,a?a[0]:i.__k&&Ii(i,0),u),a!=null)for(M=a.length;M--;)a[M]!=null&&pa(a[M]);u||("value"in x&&(M=x.value)!==void 0&&(M!==n.value||b==="progress"&&!M||b==="option"&&M!==g.value)&&Sn(n,"value",M,g.value,!1),"checked"in x&&(M=x.checked)!==void 0&&M!==n.checked&&Sn(n,"checked",M,g.checked,!1))}return n}function xa(n,e,i){try{typeof n=="function"?n(e):n.current=e}catch(r){it.__e(r,i)}}function wa(n,e,i){var r,s;if(it.unmount&&it.unmount(n),(r=n.ref)&&(r.current&&r.current!==n.__e||xa(r,null,e)),(r=n.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){it.__e(a,e)}r.base=r.__P=null,n.__c=void 0}if(r=n.__k)for(s=0;s<r.length;s++)r[s]&&wa(r[s],e,i||typeof n.type!="function");i||n.__e==null||pa(n.__e),n.__=n.__e=n.__d=void 0}function Hl(n,e,i){return this.constructor(n,i)}function jr(n,e,i){var r,s,a;it.__&&it.__(n,e),s=(r=typeof i=="function")?null:i&&i.__k||e.__k,a=[],Rr(e,n=(!r&&i||e).__k=Qe(Zi,null,[n]),s||Mn,Mn,e.ownerSVGElement!==void 0,!r&&i?[i]:s?null:e.firstChild?Fi.call(e.childNodes):null,a,!r&&i?i:s?s.__e:e.firstChild,r),ya(a,n)}function Yr(n,e){jr(n,e,Yr)}function ba(n,e,i){var r,s,a,l=de({},n.props);for(a in e)a=="key"?r=e[a]:a=="ref"?s=e[a]:l[a]=e[a];return arguments.length>2&&(l.children=arguments.length>3?Fi.call(arguments,2):i),ki(n.type,l,r||n.key,s||n.ref,null)}function Wr(n,e){var i={__c:e="__cC"+da++,__:n,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,a;return this.getChildContext||(s=[],(a={})[e]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&s.some(Sr)},this.sub=function(l){s.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){s.splice(s.indexOf(l),1),u&&u.call(l)}}),r.children}};return i.Provider.__=i.Consumer.contextType=i}Fi=fa.slice,it={__e:function(n,e,i,r){for(var s,a,l;e=e.__;)if((s=e.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(n)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(n,r||{}),l=s.__d),l)return s.__E=s}catch(u){n=u}throw n}},ua=0,ca=function(n){return n!=null&&n.constructor===void 0},qe.prototype.setState=function(n,e){var i;i=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=de({},this.state),typeof n=="function"&&(n=n(de({},i),this.props)),n&&de(i,n),n!=null&&this.__v&&(e&&this._sb.push(e),Sr(this))},qe.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Sr(this))},qe.prototype.render=Zi,Si=[],Ln.__r=0,da=0;const Gl=Object.freeze(Object.defineProperty({__proto__:null,Component:qe,Fragment:Zi,cloneElement:ba,createContext:Wr,createElement:Qe,createRef:Ul,h:Qe,hydrate:Yr,get isValidElement(){return ca},get options(){return it},render:jr,toChildArray:Cn},Symbol.toStringTag,{value:"Module"}));var $l=0;function _t(n,e,i,r,s){var a,l,u={};for(l in e)l=="ref"?a=e[l]:u[l]=e[l];var d={type:n,props:u,key:i,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--$l,__source:s,__self:r};if(typeof n=="function"&&(a=n.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return it.vnode&&it.vnode(d),d}var Ur=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pa(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Xr(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var i=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(i,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),i}var ti={};const ql=Xr(Gl);var Kl={};function Ma(n,e){for(var i in e)n[i]=e[i];return n}function Vr(n,e,i){var r=/(?:\?([^#]*))?(#.*)?$/,s=n.match(r),a={},l;if(s&&s[1])for(var u=s[1].split("&"),d=0;d<u.length;d++){var _=u[d].split("=");a[decodeURIComponent(_[0])]=decodeURIComponent(_.slice(1).join("="))}n=kr(n.replace(r,"")),e=kr(e||"");for(var f=Math.max(n.length,e.length),g=0;g<f;g++)if(e[g]&&e[g].charAt(0)===":"){var x=e[g].replace(/(^:|[+*?]+$)/g,""),b=(e[g].match(/[+*?]+$/)||Kl)[0]||"",M=~b.indexOf("+"),S=~b.indexOf("*"),B=n[g]||"";if(!B&&!S&&(b.indexOf("?")<0||M)){l=!1;break}if(a[x]=decodeURIComponent(B),M||S){a[x]=n.slice(g).map(decodeURIComponent).join("/");break}}else if(e[g]!==n[g]){l=!1;break}return i.default!==!0&&l===!1?!1:a}function Jl(n,e){return n.rank<e.rank?1:n.rank>e.rank?-1:n.index-e.index}function Ql(n,e){return n.index=e,n.rank=iu(n),n.props}function kr(n){return n.replace(/(^\/+|\/+$)/g,"").split("/")}function tu(n){return n.charAt(0)==":"?1+"*+?".indexOf(n.charAt(n.length-1))||4:5}function eu(n){return kr(n).map(tu).join("")}function iu(n){return n.props.default?0:eu(n.props.path)}var Nt=null,ke=[],kn=[],nu={};function ru(n,e){e===void 0&&(e="push"),Nt&&Nt[e]?Nt[e](n):typeof history<"u"&&history[e+"State"]&&history[e+"State"](null,null,n)}function zn(){var n;return Nt&&Nt.location?n=Nt.location:Nt&&Nt.getCurrentLocation?n=Nt.getCurrentLocation():n=typeof location<"u"?location:nu,""+(n.pathname||"")+(n.search||"")}function Hr(n,e){return e===void 0&&(e=!1),typeof n!="string"&&n.url&&(e=n.replace,n=n.url),ou(n)&&ru(n,e?"replace":"push"),La(n)}function ou(n){for(var e=ke.length;e--;)if(ke[e].canRoute(n))return!0;return!1}function La(n){for(var e=!1,i=0;i<ke.length;i++)ke[i].routeTo(n)===!0&&(e=!0);for(var r=kn.length;r--;)kn[r](n);return e}function Ca(n){if(!(!n||!n.getAttribute)){var e=n.getAttribute("href"),i=n.getAttribute("target");if(!(!e||!e.match(/^\//g)||i&&!i.match(/^_?self$/i)))return Hr(e)}}function su(n){if(!(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button!==0))return Ca(n.currentTarget||n.target||this),Sa(n)}function Sa(n){return n&&(n.stopImmediatePropagation&&n.stopImmediatePropagation(),n.stopPropagation&&n.stopPropagation(),n.preventDefault()),!1}function au(n){if(!(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button!==0)){var e=n.target;do if(String(e.nodeName).toUpperCase()==="A"&&e.getAttribute("href")){if(e.hasAttribute("native"))return;if(Ca(e))return Sa(n)}while(e=e.parentNode)}}var fs=!1;function hu(){fs||(typeof addEventListener=="function"&&(Nt||addEventListener("popstate",function(){La(zn())}),addEventListener("click",au)),fs=!0)}var se=function(n){function e(i){n.call(this,i),i.history&&(Nt=i.history),this.state={url:i.url||zn()},hu()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.shouldComponentUpdate=function(r){return r.static!==!0?!0:r.url!==this.props.url||r.onChange!==this.props.onChange},e.prototype.canRoute=function(r){var s=Cn(this.props.children);return this.getMatchingChildren(s,r,!1).length>0},e.prototype.routeTo=function(r){this.setState({url:r});var s=this.canRoute(r);return this.updating||this.forceUpdate(),s},e.prototype.componentWillMount=function(){ke.push(this),this.updating=!0},e.prototype.componentDidMount=function(){var r=this;Nt&&(this.unlisten=Nt.listen(function(s){r.routeTo(""+(s.pathname||"")+(s.search||""))})),this.updating=!1},e.prototype.componentWillUnmount=function(){typeof this.unlisten=="function"&&this.unlisten(),ke.splice(ke.indexOf(this),1)},e.prototype.componentWillUpdate=function(){this.updating=!0},e.prototype.componentDidUpdate=function(){this.updating=!1},e.prototype.getMatchingChildren=function(r,s,a){return r.filter(Ql).sort(Jl).map(function(l){var u=Vr(s,l.props.path,l.props);if(u){if(a!==!1){var d={url:s,matches:u};return Ma(d,u),delete d.ref,delete d.key,ba(l,d)}return l}}).filter(Boolean)},e.prototype.render=function(r,s){var a=r.children,l=r.onChange,u=s.url,d=this.getMatchingChildren(Cn(a),u,!0),_=d[0]||null,f=this.previousUrl;return u!==f&&(this.previousUrl=u,typeof l=="function"&&l({router:this,url:u,previous:f,active:d,current:_})),_},e}(qe),ka=function(n){return Qe("a",Ma({onClick:su},n))},Ea=function(n){return Qe(n.component,n)};se.subscribers=kn;se.getCurrentUrl=zn;se.route=Hr;se.Router=se;se.Route=Ea;se.Link=ka;se.exec=Vr;const lu=Object.freeze(Object.defineProperty({__proto__:null,Link:ka,Route:Ea,Router:se,default:se,exec:Vr,getCurrentUrl:zn,route:Hr,subscribers:kn},Symbol.toStringTag,{value:"Module"})),uu=Xr(lu);Object.defineProperty(ti,"__esModule",{value:!0});var Ta=ti.Link=ti.Match=void 0,cu=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Er=ql,Ve=uu;function du(n,e){var i={};for(var r in n)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r]);return i}function fu(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function ps(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function pu(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}var Gr=ti.Match=function(n){pu(e,n);function e(){var i,r,s;fu(this,e);for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];return s=(i=(r=ps(this,n.call.apply(n,[this].concat(l))),r),r.update=function(d){r.nextUrl=d,r.setState({})},i),ps(r,s)}return e.prototype.componentDidMount=function(){Ve.subscribers.push(this.update)},e.prototype.componentWillUnmount=function(){Ve.subscribers.splice(Ve.subscribers.indexOf(this.update)>>>0,1)},e.prototype.render=function(r){var s=this.nextUrl||(0,Ve.getCurrentUrl)(),a=s.replace(/\?.+$/,"");return this.nextUrl=null,r.children({url:s,path:a,matches:(0,Ve.exec)(a,r.path,{})!==!1})},e}(Er.Component),Da=function(e){var i=e.activeClassName,r=e.path,s=du(e,["activeClassName","path"]);return(0,Er.h)(Gr,{path:r||s.href},function(a){var l=a.matches;return(0,Er.h)(Ve.Link,cu({},s,{class:[s.class||s.className,l&&i].filter(Boolean).join(" ")}))})};Ta=ti.Link=Da;ti.default=Gr;Gr.Link=Da;const _u="_header_19max_1",mu="_nav_19max_14",gu="_github_19max_19",vu="_logo_19max_26",yu="_active_19max_66",mi={header:_u,nav:mu,github:gu,logo:vu,active:yu},xu=""+new URL("logo-DQvm3LRv.png",import.meta.url).href,wu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",bu=()=>_t("header",{class:mi.header,children:[_t("div",{class:mi.nav,children:[_t("img",{class:mi.logo,src:xu}),_t("nav",{children:_t(Ta,{activeClassName:mi.active,href:"/",children:"Home"})})]}),_t("div",{class:mi.github,children:_t("a",{href:"https://www.github.com/JamesLMilner/terra-draw",children:_t("img",{src:wu})})})]}),Pu="_home_13jfp_1",Mu="_map_13jfp_7",Lu="_loading_13jfp_75",fr={home:Pu,map:Mu,loading:Lu};var Ni,yt,pr,_s,Bi=0,Ia=[],vn=[],ms=it.__b,gs=it.__r,vs=it.diffed,ys=it.__c,xs=it.unmount;function On(n,e){it.__h&&it.__h(yt,n,Bi||e),Bi=0;var i=yt.__H||(yt.__H={__:[],__h:[]});return n>=i.__.length&&i.__.push({__V:vn}),i.__[n]}function _r(n){return Bi=1,Ba(za,n)}function Ba(n,e,i){var r=On(Ni++,2);if(r.t=n,!r.__c&&(r.__=[za(void 0,e),function(a){var l=r.__N?r.__N[0]:r.__[0],u=r.t(l,a);l!==u&&(r.__N=[u,r.__[1]],r.__c.setState({}))}],r.__c=yt,!yt.u)){yt.u=!0;var s=yt.shouldComponentUpdate;yt.shouldComponentUpdate=function(a,l,u){if(!r.__c.__H)return!0;var d=r.__c.__H.__.filter(function(f){return f.__c});if(d.every(function(f){return!f.__N}))return!s||s.call(this,a,l,u);var _=!1;return d.forEach(function(f){if(f.__N){var g=f.__[0];f.__=f.__N,f.__N=void 0,g!==f.__[0]&&(_=!0)}}),!(!_&&r.__c.props===a)&&(!s||s.call(this,a,l,u))}}return r.__N||r.__}function ws(n,e){var i=On(Ni++,3);!it.__s&&$r(i.__H,e)&&(i.__=n,i.i=e,yt.__H.__h.push(i))}function Cu(n,e){var i=On(Ni++,4);!it.__s&&$r(i.__H,e)&&(i.__=n,i.i=e,yt.__h.push(i))}function Su(n){return Bi=5,zi(function(){return{current:n}},[])}function zi(n,e){var i=On(Ni++,7);return $r(i.__H,e)?(i.__V=n(),i.i=e,i.__h=n,i.__V):i.__}function ku(n,e){return Bi=8,zi(function(){return n},e)}function Eu(){for(var n;n=Ia.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(yn),n.__H.__h.forEach(Tr),n.__H.__h=[]}catch(e){n.__H.__h=[],it.__e(e,n.__v)}}it.__b=function(n){yt=null,ms&&ms(n)},it.__r=function(n){gs&&gs(n),Ni=0;var e=(yt=n.__c).__H;e&&(pr===yt?(e.__h=[],yt.__h=[],e.__.forEach(function(i){i.__N&&(i.__=i.__N),i.__V=vn,i.__N=i.i=void 0})):(e.__h.forEach(yn),e.__h.forEach(Tr),e.__h=[])),pr=yt},it.diffed=function(n){vs&&vs(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(Ia.push(e)!==1&&_s===it.requestAnimationFrame||((_s=it.requestAnimationFrame)||Tu)(Eu)),e.__H.__.forEach(function(i){i.i&&(i.__H=i.i),i.__V!==vn&&(i.__=i.__V),i.i=void 0,i.__V=vn})),pr=yt=null},it.__c=function(n,e){e.some(function(i){try{i.__h.forEach(yn),i.__h=i.__h.filter(function(r){return!r.__||Tr(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],it.__e(r,i.__v)}}),ys&&ys(n,e)},it.unmount=function(n){xs&&xs(n);var e,i=n.__c;i&&i.__H&&(i.__H.__.forEach(function(r){try{yn(r)}catch(s){e=s}}),i.__H=void 0,e&&it.__e(e,i.__v))};var bs=typeof requestAnimationFrame=="function";function Tu(n){var e,i=function(){clearTimeout(r),bs&&cancelAnimationFrame(e),setTimeout(n)},r=setTimeout(i,100);bs&&(e=requestAnimationFrame(i))}function yn(n){var e=yt,i=n.__c;typeof i=="function"&&(n.__c=void 0,i()),yt=e}function Tr(n){var e=yt;n.__c=n.__(),yt=e}function $r(n,e){return!n||n.length!==e.length||e.some(function(i,r){return i!==n[r]})}function za(n,e){return typeof e=="function"?e(n):e}function Kt(){return Kt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)({}).hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Kt.apply(null,arguments)}var pe;(function(n){n.Commit="commit",n.Provisional="provisional",n.Finish="finish"})(pe||(pe={}));const fe={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT:"selectionPoint"},Oa="coordinatePoint",Aa="coordinatePointIds";function mr(n){return!!(n&&typeof n=="object"&&n!==null&&!Array.isArray(n))}function Ps(n){return!!(n&&typeof n=="object"&&"properties"in n&&typeof n.properties=="object"&&n.properties!==null&&"mode"in n.properties)}function Ms(n){return!!function(e){return typeof e=="number"&&!isNaN(new Date(e).valueOf())}(n)}const Du="Feature mode property does not match the mode being added to";var Ie;(function(n){n.Drawing="drawing",n.Select="select",n.Static="static",n.Render="render"})(Ie||(Ie={}));let qr=class{get state(){return this._state}set state(e){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(e){if(typeof e!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=e}registerBehaviors(e){}constructor(e,i=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=Ie.Drawing,this.mode="base",i||this.updateOptions(e)}updateOptions(e){e!=null&&e.styles&&(this.styles=Kt({},this._styles,e.styles)),e!=null&&e.pointerDistance&&(this.pointerDistance=e.pointerDistance),e!=null&&e.validation&&(this.validate=e&&e.validation),e!=null&&e.projection&&(this.projection=e.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(e){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=e.store,this.store.registerOnChange(e.onChange),this.setDoubleClickToZoom=e.setDoubleClickToZoom,this.project=e.project,this.unproject=e.unproject,this.onSelect=e.onSelect,this.onDeselect=e.onDeselect,this.setCursor=e.setCursor,this.onStyleChange=e.onChange,this.onFinish=e.onFinish,this.coordinatePrecision=e.coordinatePrecision,this.registerBehaviors({mode:e.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:e.coordinatePrecision,projection:this.projection})}validateFeature(e){return this.performFeatureValidation(e)}afterFeatureAdded(e){}performFeatureValidation(e){if(this._state==="unregistered")throw new Error("Mode must be registered");const i=function(r,s){let a;if(mr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(mr(r.geometry))if(mr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}}(e,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(e,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pe.Provisional});return{valid:i.valid&&r.valid,reason:r.reason}}return{valid:i.valid,reason:i.reason}}validateModeFeature(e,i){const r=this.performFeatureValidation(e);return r.valid?e.properties.mode!==this.mode?{valid:!1,reason:Du}:i(e):{valid:!1,reason:r.reason}}onFinish(e,i){}onDeselect(e){}onSelect(e){}onKeyDown(e){}onKeyUp(e){}onMouseMove(e){}onClick(e){}onDragStart(e,i){}onDrag(e,i){}onDragEnd(e,i){}getHexColorStylingValue(e,i,r){return this.getStylingValue(e,i,r)}getNumericStylingValue(e,i,r){return this.getStylingValue(e,i,r)}getStylingValue(e,i,r){return e===void 0?i:typeof e=="function"?e(r):e}};class Iu extends qr{constructor(...e){super(...e),this.type=Ie.Select}}function Fa(n,e){const i=_=>_*Math.PI/180,r=i(n[1]),s=i(n[0]),a=i(e[1]),l=a-r,u=i(e[0])-s,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6371e3/1e3}const Za=63710088e-1;function Ei(n){return n%360*Math.PI/180}function Bu(n){return n%(2*Math.PI)*180/Math.PI}function At(n,e=9){const i=Math.pow(10,e);return Math.round(n*i)/i}const Ls=57.29577951308232,Cs=.017453292519943295,En=6378137,wt=(n,e)=>({x:n===0?0:n*Cs*En,y:e===0?0:Math.log(Math.tan(Math.PI/4+e*Cs/2))*En}),Ee=(n,e)=>({lng:n===0?0:Ls*(n/En),lat:e===0?0:(2*Math.atan(Math.exp(e/En))-Math.PI/2)*Ls});function zu(n){let e;if(n.geometry.type==="Polygon")e=n.geometry.coordinates;else{if(n.geometry.type!=="LineString")throw new Error("Self intersects only accepts Polygons and LineStrings");e=[n.geometry.coordinates]}const i=[];for(let a=0;a<e.length;a++)for(let l=0;l<e[a].length-1;l++)for(let u=0;u<e.length;u++)for(let d=0;d<e[u].length-1;d++)s(a,l,u,d);return i.length>0;function r(a){return a<0||a>1}function s(a,l,u,d){const _=e[a][l],f=e[a][l+1],g=e[u][d],x=e[u][d+1],b=function(B,A,m,w){if(cn(B,m)||cn(B,w)||cn(A,m)||cn(w,m))return null;const P=B[0],k=B[1],T=A[0],E=A[1],I=m[0],N=m[1],j=w[0],Y=w[1],X=(P-T)*(N-Y)-(k-E)*(I-j);return X===0?null:[((P*E-k*T)*(I-j)-(P-T)*(I*Y-N*j))/X,((P*E-k*T)*(N-Y)-(k-E)*(I*Y-N*j))/X]}(_,f,g,x);if(b===null)return;let M,S;M=f[0]!==_[0]?(b[0]-_[0])/(f[0]-_[0]):(b[1]-_[1])/(f[1]-_[1]),S=x[0]!==g[0]?(b[0]-g[0])/(x[0]-g[0]):(b[1]-g[1])/(x[1]-g[1]),r(M)||r(S)||(b.toString(),i.push(b))}}function cn(n,e){return n[0]===e[0]&&n[1]===e[1]}function An(n,e){return Ss(n[0])<=e&&Ss(n[1])<=e}function Kr(n){return n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"&&n[0]!==1/0&&n[1]!==1/0&&(i=n[0])>=-180&&i<=180&&(e=n[1])>=-90&&e<=90;var e,i}function Ss(n){let e=1,i=0;for(;Math.round(n*e)/e!==n;)e*=10,i++;return i}const Ou="Feature has holes",Au="Feature has less than 4 coordinates",Fu="Feature has invalid coordinates",Zu="Feature coordinates are not closed";function Nu(n,e){if(n.geometry.type!=="Polygon")return{valid:!1,reason:"Feature is not a Polygon"};if(n.geometry.coordinates.length!==1)return{valid:!1,reason:Ou};if(n.geometry.coordinates[0].length<4)return{valid:!1,reason:Au};for(let s=0;s<n.geometry.coordinates[0].length;s++){if(!Kr(n.geometry.coordinates[0][s]))return{valid:!1,reason:Fu};if(!An(n.geometry.coordinates[0][s],e))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return(i=n.geometry.coordinates[0][0])[0]!==(r=n.geometry.coordinates[0][n.geometry.coordinates[0].length-1])[0]||i[1]!==r[1]?{valid:!1,reason:Zu}:{valid:!0};var i,r}const Te=(n,e)=>{const{x:i,y:r}=n,{x:s,y:a}=e,l=s-i,u=a-r;return Math.sqrt(u*u+l*l)};class Xt{constructor({store:e,mode:i,project:r,unproject:s,pointerDistance:a,coordinatePrecision:l,projection:u}){this.store=void 0,this.mode=void 0,this.project=void 0,this.unproject=void 0,this.pointerDistance=void 0,this.coordinatePrecision=void 0,this.projection=void 0,this.store=e,this.mode=i,this.project=r,this.unproject=s,this.pointerDistance=a,this.coordinatePrecision=l,this.projection=u}}function Na({unproject:n,point:e,pointerDistance:i}){const r=i/2,{x:s,y:a}=e;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[n(s-r,a-r),n(s+r,a-r),n(s+r,a+r),n(s-r,a+r),n(s-r,a-r)].map(l=>[l.lng,l.lat])]}}}class Ru extends Xt{constructor(e){super(e)}create(e){const{containerX:i,containerY:r}=e;return Na({unproject:this.unproject,point:{x:i,y:r},pointerDistance:this.pointerDistance})}}class ju extends Xt{constructor(e){super(e)}measure(e,i){const{x:r,y:s}=this.project(i[0],i[1]);return Te({x:r,y:s},{x:e.containerX,y:e.containerY})}}class Yu extends Xt{constructor(e,i,r){super(e),this.config=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.getSnappableCoordinateFirstClick=s=>this.getSnappable(s,a=>!!(a.properties&&a.properties.mode===this.mode)).coordinate,this.getSnappableCoordinate=(s,a)=>this.getSnappable(s,l=>!!(l.properties&&l.properties.mode===this.mode&&l.id!==a)).coordinate,this.config=e,this.pixelDistance=i,this.clickBoundingBox=r}getSnappable(e,i){const r=this.clickBoundingBox.create(e),s=this.store.search(r,i),a={featureId:void 0,featureCoordinateIndex:void 0,coordinate:void 0,minDist:1/0};return s.forEach(l=>{let u;if(l.geometry.type==="Polygon")u=l.geometry.coordinates[0];else{if(l.geometry.type!=="LineString")return;u=l.geometry.coordinates}u.forEach((d,_)=>{const f=this.pixelDistance.measure(e,d);f<a.minDist&&f<this.pointerDistance&&(a.coordinate=d,a.minDist=f,a.featureId=l.id,a.featureCoordinateIndex=_)})}),a}}function Wu({x:n,y:e},{x:i,y:r}){let s=Math.atan2(r-e,i-n);return s*=180/Math.PI,s>180?s-=360:s<-180&&(s+=360),s}function Uu(n,e){if(n.geometry.type!=="LineString")return{valid:!1,reason:"Feature is not a LineString"};if(n.geometry.coordinates.length<2)return{valid:!1,reason:"Feature has less than 2 coordinates"};for(let i=0;i<n.geometry.coordinates.length;i++){if(!Kr(n.geometry.coordinates[i]))return{valid:!1,reason:"Feature has invalid coordinates"};if(!An(n.geometry.coordinates[i],e))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return{valid:!0}}const Xu="Feature is not a Point",Vu="Feature has invalid coordinates",Hu="Feature has coordinates with excessive precision";function Gu(n,e){return n.geometry.type!=="Point"?{valid:!1,reason:Xu}:Kr(n.geometry.coordinates)?An(n.geometry.coordinates,e)?{valid:!0}:{valid:!1,reason:Hu}:{valid:!1,reason:Vu}}class $u extends Xt{constructor(e){super(e)}createOrUpdate(e){const i=this.store.getGeometryCopy(e),r=this.store.getPropertiesCopy(e);let s;if(i.type==="Polygon")s=i.coordinates[0].slice(0,-1);else{if(i.type!=="LineString")return;s=i.coordinates}const a=this.store.getPropertiesCopy(e);if(a.coordinatePointIds){const l=a.coordinatePointIds,u=l.map(d=>this.store.getGeometryCopy(d).coordinates);if(l.length!==s.length){this.deleteCoordinatePoints(l);const d=this.createPoints(s,r.mode);this.setFeatureCoordinatePoints(e,d)}else s.forEach((d,_)=>{d[0]===u[_][0]&&d[1]===u[_][1]||this.store.updateGeometry([{id:l[_],geometry:{type:"Point",coordinates:d}}])})}else{const l=this.createPoints(s,r.mode);this.setFeatureCoordinatePoints(e,l)}}deletePointsByFeatureIds(e){for(const i of e)this.deleteIfPresent(i)}getUpdated(e,i){const r=this.store.getPropertiesCopy(e);if(r.coordinatePointIds)return r.coordinatePointIds.map((s,a)=>({id:s,geometry:Kt({},this.store.getGeometryCopy(s),{coordinates:i[a]})}))}createPoints(e,i){return this.store.create(e.map(r=>({geometry:{type:"Point",coordinates:r},properties:{mode:i,[Oa]:!0}})))}setFeatureCoordinatePoints(e,i){this.store.updateProperty([{id:e,property:Aa,value:i}])}deleteCoordinatePoints(e){this.store.delete(e)}deleteIfPresent(e){const i=this.store.getPropertiesCopy(e);i.coordinatePointIds&&(this.deleteCoordinatePoints(i.coordinatePointIds),this.setFeatureCoordinatePoints(e,null))}}class qu extends qr{constructor(e){if(!e.modeName)throw new Error("Mode name is required for TerraDrawRenderMode");super(e,!0),this.type=Ie.Render,this.mode="render",this.updateOptions(e)}updateOptions(e){super.updateOptions(e),e!=null&&e.modeName&&(this.mode=e.modeName)}registerBehaviors(e){this.mode=e.mode}start(){this.setStarted()}stop(){this.setStopped()}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(e){return{pointColor:this.getHexColorStylingValue(this.styles.pointColor,"#3f97e0",e),pointWidth:this.getNumericStylingValue(this.styles.pointWidth,6,e),pointOutlineColor:this.getHexColorStylingValue(this.styles.pointOutlineColor,"#ffffff",e),pointOutlineWidth:this.getNumericStylingValue(this.styles.pointOutlineWidth,0,e),polygonFillColor:this.getHexColorStylingValue(this.styles.polygonFillColor,"#3f97e0",e),polygonFillOpacity:this.getNumericStylingValue(this.styles.polygonFillOpacity,.3,e),polygonOutlineColor:this.getHexColorStylingValue(this.styles.polygonOutlineColor,"#3f97e0",e),polygonOutlineWidth:this.getNumericStylingValue(this.styles.polygonOutlineWidth,4,e),lineStringWidth:this.getNumericStylingValue(this.styles.lineStringWidth,4,e),lineStringColor:this.getHexColorStylingValue(this.styles.lineStringColor,"#3f97e0",e),zIndex:this.getNumericStylingValue(this.styles.zIndex,0,e)}}validateFeature(e){const i=super.validateFeature(e);if(i.valid){const r=e,s=Gu(r,this.coordinatePrecision).valid||Nu(r,this.coordinatePrecision).valid||Uu(r,this.coordinatePrecision).valid;return s?{valid:!0}:{valid:s,reason:"Feature is not a valid Point, Polygon or LineString feature"}}return i}}function Tn(n,e){const i=n,r=e,s=Ei(i[1]),a=Ei(r[1]);let l=Ei(r[0]-i[0]);l>Math.PI&&(l-=2*Math.PI),l<-Math.PI&&(l+=2*Math.PI);const u=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=(Bu(Math.atan2(l,u))+360)%360;return d>180?-(360-d):d}function Jr(n,e,i){let r=e;e<0&&(r=-Math.abs(r));const s=r/Za,a=n[0]*Math.PI/180,l=Ei(n[1]),u=Ei(i),d=s*Math.cos(u);let _=l+d;Math.abs(_)>Math.PI/2&&(_=_>0?Math.PI-_:-Math.PI-_);const f=Math.log(Math.tan(_/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),g=Math.abs(f)>1e-11?d/f:Math.cos(l),x=[(180*(a+s*Math.sin(u)/g)/Math.PI+540)%360-180,180*_/Math.PI];return x[0]+=x[0]-n[0]>180?-360:n[0]-x[0]>180?360:0,x}function Ku(n,e,i,r,s){const a=r(n[0],n[1]),l=r(e[0],e[1]),{lng:u,lat:d}=s((a.x+l.x)/2,(a.y+l.y)/2);return[At(u,i),At(d,i)]}function Ju(n,e,i){const r=Jr(n,1e3*Fa(n,e)/2,Tn(n,e));return[At(r[0],i),At(r[1],i)]}function ks({featureCoords:n,precision:e,unproject:i,project:r,projection:s}){const a=[];for(let l=0;l<n.length-1;l++){let u;if(s==="web-mercator")u=Ku(n[l],n[l+1],e,r,i);else{if(s!=="globe")throw new Error("Invalid projection");u=Ju(n[l],n[l+1],e)}a.push(u)}return a}class Qu extends Xt{constructor(e,i,r){super(e),this.config=void 0,this.selectionPointBehavior=void 0,this.coordinatePointBehavior=void 0,this._midPoints=[],this.config=e,this.selectionPointBehavior=i,this.coordinatePointBehavior=r}get ids(){return this._midPoints.concat()}set ids(e){}insert(e,i,r){const s=this.store.getGeometryCopy(i),{midPointFeatureId:a,midPointSegment:l}=this.store.getPropertiesCopy(i),u=this.store.getGeometryCopy(a),d=u.type==="Polygon"?u.coordinates[0]:u.coordinates;d.splice(l+1,0,s.coordinates),u.coordinates=u.type==="Polygon"?[d]:d,this.store.updateGeometry([{id:a,geometry:u}]),this.store.getPropertiesCopy(e)[Aa]&&this.coordinatePointBehavior.createOrUpdate(e),this.store.delete([...this._midPoints,...this.selectionPointBehavior.ids]),this.create(d,a,r),this.selectionPointBehavior.create(d,u.type,a)}create(e,i,r){if(!this.store.has(i))throw new Error("Store does not have feature with this id");this._midPoints=this.store.create(function(s,a,l,u,d,_){return ks({featureCoords:s,precision:l,project:u,unproject:d,projection:_}).map((f,g)=>({geometry:{type:"Point",coordinates:f},properties:a(g)}))}(e,s=>({mode:this.mode,[fe.MID_POINT]:!0,midPointSegment:s,midPointFeatureId:i}),r,this.config.project,this.config.unproject,this.projection))}delete(){this._midPoints.length&&(this.store.delete(this._midPoints),this._midPoints=[])}getUpdated(e){if(this._midPoints.length!==0)return ks({featureCoords:e,precision:this.coordinatePrecision,project:this.config.project,unproject:this.config.unproject,projection:this.config.projection}).map((i,r)=>({id:this._midPoints[r],geometry:{type:"Point",coordinates:i}}))}}class tc extends Xt{constructor(e){super(e),this._selectionPoints=[]}get ids(){return this._selectionPoints.concat()}set ids(e){}create(e,i,r){this._selectionPoints=this.store.create(function(s,a,l){const u=[],d=a==="Polygon"?s.length-1:s.length;for(let _=0;_<d;_++)u.push({geometry:{type:"Point",coordinates:s[_]},properties:l(_)});return u}(e,i,s=>({mode:this.mode,selectionPoint:!0,selectionPointFeatureId:r,index:s})))}delete(){this.ids.length&&(this.store.delete(this.ids),this._selectionPoints=[])}getUpdated(e){if(this._selectionPoints.length!==0)return this._selectionPoints.map((i,r)=>({id:i,geometry:{type:"Point",coordinates:e[r]}}))}getOneUpdated(e,i){if(this._selectionPoints[e]!==void 0)return{id:this._selectionPoints[e],geometry:{type:"Point",coordinates:i}}}}function Ra(n,e){let i=!1;for(let l=0,u=e.length;l<u;l++){const d=e[l];for(let _=0,f=d.length,g=f-1;_<f;g=_++)(s=d[_])[1]>(r=n)[1]!=(a=d[g])[1]>r[1]&&r[0]<(a[0]-s[0])*(r[1]-s[1])/(a[1]-s[1])+s[0]&&(i=!i)}var r,s,a;return i}const ja=(n,e,i)=>{const r=a=>a*a,s=(a,l)=>r(a.x-l.x)+r(a.y-l.y);return Math.sqrt(((a,l,u)=>{const d=s(l,u);if(d===0)return s(a,l);let _=((a.x-l.x)*(u.x-l.x)+(a.y-l.y)*(u.y-l.y))/d;return _=Math.max(0,Math.min(1,_)),s(a,{x:l.x+_*(u.x-l.x),y:l.y+_*(u.y-l.y)})})(n,e,i))};class ec extends Xt{constructor(e,i,r){super(e),this.config=void 0,this.createClickBoundingBox=void 0,this.pixelDistance=void 0,this.config=e,this.createClickBoundingBox=i,this.pixelDistance=r}find(e,i){let r,s,a,l,u=1/0,d=1/0,_=1/0;const f=this.createClickBoundingBox.create(e),g=this.store.search(f);for(let x=0;x<g.length;x++){const b=g[x],M=b.geometry;if(M.type==="Point"){if(b.properties.selectionPoint||b.properties.coordinatePoint||!i&&b.properties[fe.MID_POINT])continue;const S=this.pixelDistance.measure(e,M.coordinates);b.properties[fe.MID_POINT]&&S<this.pointerDistance&&S<_?(_=S,a=b):!b.properties[fe.MID_POINT]&&S<this.pointerDistance&&S<u&&(u=S,r=b)}else if(M.type==="LineString"){if(r)continue;for(let S=0;S<M.coordinates.length-1;S++){const B=M.coordinates[S],A=M.coordinates[S+1],m=ja({x:e.containerX,y:e.containerY},this.project(B[0],B[1]),this.project(A[0],A[1]));m<this.pointerDistance&&m<d&&(d=m,s=b)}}else if(M.type==="Polygon"){if(r||s)continue;Ra([e.lng,e.lat],M.coordinates)&&(l=b)}}return{clickedFeature:r||s||l,clickedMidPoint:a}}}class ic extends Xt{constructor(e,i,r,s,a){super(e),this.config=void 0,this.featuresAtCursorEvent=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.draggedFeatureId=null,this.dragPosition=void 0,this.config=e,this.featuresAtCursorEvent=i,this.selectionPoints=r,this.midPoints=s,this.coordinatePoints=a}startDragging(e,i){this.draggedFeatureId=i,this.dragPosition=[e.lng,e.lat]}stopDragging(){this.draggedFeatureId=null,this.dragPosition=void 0}isDragging(){return this.draggedFeatureId!==null}canDrag(e,i){const{clickedFeature:r}=this.featuresAtCursorEvent.find(e,!0);return!(!r||r.id!==i)}drag(e,i){if(!this.draggedFeatureId)return;const r=this.store.getGeometryCopy(this.draggedFeatureId),s=[e.lng,e.lat];if(r.type==="Polygon"||r.type==="LineString"){let a,l;if(r.type==="Polygon"?(a=r.coordinates[0],l=a.length-1):(a=r.coordinates,l=a.length),!this.dragPosition)return!1;for(let f=0;f<l;f++){const g=a[f];let x,b;if(this.config.projection==="web-mercator"){const M=wt(this.dragPosition[0],this.dragPosition[1]),S=wt(s[0],s[1]),B=wt(g[0],g[1]),A={x:M.x-S.x,y:M.y-S.y},m=B.x-A.x,w=B.y-A.y,{lng:P,lat:k}=Ee(m,w);x=P,b=k}else{const M=[this.dragPosition[0]-s[0],this.dragPosition[1]-s[1]];x=g[0]-M[0],b=g[1]-M[1]}if(x=At(x,this.config.coordinatePrecision),b=At(b,this.config.coordinatePrecision),x>180||x<-180||b>90||b<-90)return!1;a[f]=[x,b]}r.type==="Polygon"&&(a[a.length-1]=[a[0][0],a[0][1]]);const u=this.selectionPoints.getUpdated(a)||[],d=this.midPoints.getUpdated(a)||[],_=this.coordinatePoints.getUpdated(this.draggedFeatureId,a)||[];if(i&&!i({type:"Feature",id:this.draggedFeatureId,geometry:r,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pe.Provisional}).valid)return!1;this.store.updateGeometry([{id:this.draggedFeatureId,geometry:r},...u,...d,..._]),this.dragPosition=[e.lng,e.lat]}else r.type==="Point"&&(this.store.updateGeometry([{id:this.draggedFeatureId,geometry:{type:"Point",coordinates:s}}]),this.dragPosition=[e.lng,e.lat])}}class nc extends Xt{constructor(e,i,r,s,a,l){super(e),this.config=void 0,this.pixelDistance=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.coordinateSnapping=void 0,this.draggedCoordinate={id:null,index:-1},this.config=e,this.pixelDistance=i,this.selectionPoints=r,this.midPoints=s,this.coordinatePoints=a,this.coordinateSnapping=l}getClosestCoordinate(e,i){const r={dist:1/0,index:-1,isFirstOrLastPolygonCoord:!1};let s;if(i.type==="LineString")s=i.coordinates;else{if(i.type!=="Polygon")return r;s=i.coordinates[0]}for(let a=0;a<s.length;a++){const l=this.pixelDistance.measure(e,s[a]);if(l<this.pointerDistance&&l<r.dist){const u=i.type==="Polygon"&&(a===s.length-1||a===0);r.dist=l,r.index=u?0:a,r.isFirstOrLastPolygonCoord=u}}return r}getDraggableIndex(e,i){const r=this.store.getGeometryCopy(i),s=this.getClosestCoordinate(e,r);return s.index===-1?-1:s.index}drag(e,i,r,s){if(this.draggedCoordinate.id===null)return!1;const a=this.draggedCoordinate.index,l=this.store.getGeometryCopy(this.draggedCoordinate.id),u=this.store.getPropertiesCopy(this.draggedCoordinate.id),d=l.type==="LineString"?l.coordinates:l.coordinates[0],_=l.type==="Polygon"&&(a===d.length-1||a===0);let f=[e.lng,e.lat];if(s){let S;S=this.coordinateSnapping.getSnappable(e,B=>!!(B.properties&&B.properties.mode===u.mode&&B.id!==this.draggedCoordinate.id)).coordinate,S&&(f=S)}if(e.lng>180||e.lng<-180||e.lat>90||e.lat<-90)return!1;if(_){const S=d.length-1;d[0]=f,d[S]=f}else d[a]=f;const g=this.selectionPoints.getOneUpdated(a,f),x=g?[g]:[],b=this.midPoints.getUpdated(d)||[],M=this.coordinatePoints.getUpdated(this.draggedCoordinate.id,d)||[];return!(l.type!=="Point"&&!i&&zu({geometry:l})||r&&!r({type:"Feature",id:this.draggedCoordinate.id,geometry:l,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pe.Provisional}).valid||(this.store.updateGeometry([{id:this.draggedCoordinate.id,geometry:l},...x,...b,...M]),0))}isDragging(){return this.draggedCoordinate.id!==null}startDragging(e,i){this.draggedCoordinate={id:e,index:i}}stopDragging(){this.draggedCoordinate={id:null,index:-1}}}function Dn(n){let e=0,i=0,r=0;return(n.geometry.type==="Polygon"?n.geometry.coordinates[0].slice(0,-1):n.geometry.coordinates).forEach(s=>{e+=s[0],i+=s[1],r++},!0),[e/r,i/r]}function Ya(n,e){n[0]+=n[0]-e[0]>180?-360:e[0]-n[0]>180?360:0;const i=Za,r=e[1]*Math.PI/180,s=n[1]*Math.PI/180,a=s-r;let l=Math.abs(n[0]-e[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);const u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),d=Math.abs(u)>1e-11?a/u:Math.cos(r);return Math.sqrt(a*a+d*d*l*l)*i}function In(n){const e=(n.geometry.type==="Polygon"?n.geometry.coordinates[0]:n.geometry.coordinates).map(i=>{const{x:r,y:s}=wt(i[0],i[1]);return[r,s]});return n.geometry.type==="Polygon"?function(i){let r=0,s=0,a=0;const l=i.length;for(let u=0;u<l-1;u++){const[d,_]=i[u],[f,g]=i[u+1],x=d*g-f*_;r+=x,s+=(d+f)*x,a+=(_+g)*x}return r/=2,s/=6*r,a/=6*r,{x:s,y:a}}(e):function(i){const r=i.length;let s=0,a=0;for(let l=0;l<r;l++){const[u,d]=i[l];s+=u,a+=d}return{x:s/r,y:a/r}}(e)}class rc extends Xt{constructor(e,i,r,s){super(e),this.config=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.lastBearing=void 0,this.config=e,this.selectionPoints=i,this.midPoints=r,this.coordinatePoints=s}reset(){this.lastBearing=void 0}rotate(e,i,r){const s=this.store.getGeometryCopy(i);if(s.type!=="Polygon"&&s.type!=="LineString")return;const a=[e.lng,e.lat];let l;const u={type:"Feature",geometry:s,properties:{}};if(this.config.projection==="web-mercator"){if(l=Wu(In(u),wt(e.lng,e.lat)),!this.lastBearing)return void(this.lastBearing=l);((x,b)=>{if(b===0||b===360||b===-360)return x;const M=.017453292519943295*b,S=(x.geometry.type==="Polygon"?x.geometry.coordinates[0]:x.geometry.coordinates).map(([m,w])=>wt(m,w)),B=S.reduce((m,w)=>({x:m.x+w.x,y:m.y+w.y}),{x:0,y:0});B.x/=S.length,B.y/=S.length;const A=S.map(m=>({x:B.x+(m.x-B.x)*Math.cos(M)-(m.y-B.y)*Math.sin(M),y:B.y+(m.x-B.x)*Math.sin(M)+(m.y-B.y)*Math.cos(M)})).map(({x:m,y:w})=>[Ee(m,w).lng,Ee(m,w).lat]);x.geometry.type==="Polygon"?x.geometry.coordinates[0]=A:x.geometry.coordinates=A})(u,-(this.lastBearing-l))}else{if(this.config.projection!=="globe")throw new Error("Unsupported projection");if(l=Tn(Dn({geometry:s}),a),!this.lastBearing)return void(this.lastBearing=l+180);(function(x,b){if(b===0||b===360||b===-360)return x;const M=Dn(x);(x.geometry.type==="Polygon"?x.geometry.coordinates[0]:x.geometry.coordinates).forEach(S=>{const B=Tn(M,S)+b,A=Ya(M,S),m=Jr(M,A,B);S[0]=m[0],S[1]=m[1]})})(u,-(this.lastBearing-(l+180)))}const d=s.type==="Polygon"?s.coordinates[0]:s.coordinates;d.forEach(x=>{x[0]=At(x[0],this.coordinatePrecision),x[1]=At(x[1],this.coordinatePrecision)});const _=this.midPoints.getUpdated(d)||[],f=this.selectionPoints.getUpdated(d)||[],g=this.coordinatePoints.getUpdated(i,d)||[];if(r&&!r({id:i,type:"Feature",geometry:s,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pe.Provisional}))return!1;this.store.updateGeometry([{id:i,geometry:s},...f,..._,...g]),this.projection==="web-mercator"?this.lastBearing=l:this.projection==="globe"&&(this.lastBearing=l+180)}}class oc extends Xt{constructor(e,i,r,s){super(e),this.config=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.lastDistance=void 0,this.config=e,this.selectionPoints=i,this.midPoints=r,this.coordinatePoints=s}reset(){this.lastDistance=void 0}scale(e,i,r){const s=this.store.getGeometryCopy(i);if(s.type!=="Polygon"&&s.type!=="LineString")return;const a=[e.lng,e.lat],l={type:"Feature",geometry:s,properties:{}};let u;const d=In(l);if(this.config.projection==="web-mercator"){const M=wt(e.lng,e.lat);u=Te(d,M)}else{if(this.config.projection!=="globe")throw new Error("Invalid projection");u=Fa(Dn({geometry:s}),a)}if(!this.lastDistance)return void(this.lastDistance=u);const _=1-(this.lastDistance-u)/u;if(this.config.projection==="web-mercator"){const{lng:M,lat:S}=Ee(d.x,d.y);(function(B,A,m){if(A===1)return B;const w=(B.geometry.type==="Polygon"?B.geometry.coordinates[0]:B.geometry.coordinates).map(([T,E])=>wt(T,E)),P=wt(m[0],m[1]),k=w.map(T=>({x:P.x+(T.x-P.x)*A,y:P.y+(T.y-P.y)*A})).map(({x:T,y:E})=>[Ee(T,E).lng,Ee(T,E).lat]);B.geometry.type==="Polygon"?B.geometry.coordinates[0]=k:B.geometry.coordinates=k})(l,_,[M,S])}else this.config.projection==="globe"&&function(M,S,B,A="xy"){S===1||(M.geometry.type==="Polygon"?M.geometry.coordinates[0]:M.geometry.coordinates).forEach(m=>{const w=Ya(B,m),P=Tn(B,m),k=Jr(B,w*S,P);A!=="x"&&A!=="xy"||(m[0]=k[0]),A!=="y"&&A!=="xy"||(m[1]=k[1])})}(l,_,Dn(l));const f=s.type==="Polygon"?s.coordinates[0]:s.coordinates;f.forEach(M=>{M[0]=At(M[0],this.coordinatePrecision),M[1]=At(M[1],this.coordinatePrecision)});const g=this.midPoints.getUpdated(f)||[],x=this.selectionPoints.getUpdated(f)||[],b=this.coordinatePoints.getUpdated(i,f)||[];if(r&&!r({id:i,type:"Feature",geometry:s,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pe.Provisional}))return!1;this.store.updateGeometry([{id:i,geometry:s},...x,...g,...b]),this.lastDistance=u}}class sc extends Xt{constructor(e,i,r,s,a){super(e),this.config=void 0,this.pixelDistance=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.coordinatePoints=void 0,this.minimumScale=1e-4,this.draggedCoordinate={id:null,index:-1},this.boundingBoxMaps={opposite:{0:4,1:5,2:6,3:7,4:0,5:1,6:2,7:3}},this.config=e,this.pixelDistance=i,this.selectionPoints=r,this.midPoints=s,this.coordinatePoints=a}getClosestCoordinate(e,i){const r={dist:1/0,index:-1,isFirstOrLastPolygonCoord:!1};let s;if(i.type==="LineString")s=i.coordinates;else{if(i.type!=="Polygon")return r;s=i.coordinates[0]}for(let a=0;a<s.length;a++){const l=this.pixelDistance.measure(e,s[a]);if(l<this.pointerDistance&&l<r.dist){const u=i.type==="Polygon"&&(a===s.length-1||a===0);r.dist=l,r.index=u?0:a,r.isFirstOrLastPolygonCoord=u}}return r}isValidDragWebMercator(e,i,r){switch(e){case 0:if(i<=0||r>=0)return!1;break;case 1:if(r>=0)return!1;break;case 2:if(i>=0||r>=0)return!1;break;case 3:if(i>=0)return!1;break;case 4:if(i>=0||r<=0)return!1;break;case 5:if(r<=0)return!1;break;case 6:if(i<=0||r<=0)return!1;break;case 7:if(i<=0)return!1}return!0}getSelectedFeatureDataWebMercator(){if(!this.draggedCoordinate.id||this.draggedCoordinate.index===-1)return null;const e=this.getFeature(this.draggedCoordinate.id);if(!e)return null;const i=this.getNormalisedCoordinates(e.geometry);return{boundingBox:this.getBBoxWebMercator(i),feature:e,updatedCoords:i,selectedCoordinate:i[this.draggedCoordinate.index]}}centerWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{feature:r,boundingBox:s,updatedCoords:a,selectedCoordinate:l}=i,u=In(r);if(!u)return null;const d=wt(l[0],l[1]),{closestBBoxIndex:_}=this.getIndexesWebMercator(s,d),f=wt(e.lng,e.lat);return this.scaleWebMercator({closestBBoxIndex:_,updatedCoords:a,webMercatorCursor:f,webMercatorSelected:d,webMercatorOrigin:u}),a}centerFixedWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{feature:r,boundingBox:s,updatedCoords:a,selectedCoordinate:l}=i,u=In(r);if(!u)return null;const d=wt(l[0],l[1]),{closestBBoxIndex:_}=this.getIndexesWebMercator(s,d),f=wt(e.lng,e.lat);return this.scaleFixedWebMercator({closestBBoxIndex:_,updatedCoords:a,webMercatorCursor:f,webMercatorSelected:d,webMercatorOrigin:u}),a}scaleFixedWebMercator({closestBBoxIndex:e,webMercatorOrigin:i,webMercatorSelected:r,webMercatorCursor:s,updatedCoords:a}){if(!this.isValidDragWebMercator(e,i.x-s.x,i.y-s.y))return null;let l=Te(i,s)/Te(i,r);return l<0&&(l=this.minimumScale),this.performWebMercatorScale(a,i.x,i.y,l,l),a}oppositeFixedWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{boundingBox:r,updatedCoords:s,selectedCoordinate:a}=i,l=wt(a[0],a[1]),{oppositeBboxIndex:u,closestBBoxIndex:d}=this.getIndexesWebMercator(r,l),_={x:r[u][0],y:r[u][1]},f=wt(e.lng,e.lat);return this.scaleFixedWebMercator({closestBBoxIndex:d,updatedCoords:s,webMercatorCursor:f,webMercatorSelected:l,webMercatorOrigin:_}),s}oppositeWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{boundingBox:r,updatedCoords:s,selectedCoordinate:a}=i,l=wt(a[0],a[1]),{oppositeBboxIndex:u,closestBBoxIndex:d}=this.getIndexesWebMercator(r,l),_={x:r[u][0],y:r[u][1]},f=wt(e.lng,e.lat);return this.scaleWebMercator({closestBBoxIndex:d,updatedCoords:s,webMercatorCursor:f,webMercatorSelected:l,webMercatorOrigin:_}),s}scaleWebMercator({closestBBoxIndex:e,webMercatorOrigin:i,webMercatorSelected:r,webMercatorCursor:s,updatedCoords:a}){const l=i.x-s.x,u=i.y-s.y;if(!this.isValidDragWebMercator(e,l,u))return null;let d=1;l!==0&&e!==1&&e!==5&&(d=1-(i.x-r.x-l)/l);let _=1;return u!==0&&e!==3&&e!==7&&(_=1-(i.y-r.y-u)/u),this.validateScale(d,_)?(d<0&&(d=this.minimumScale),_<0&&(_=this.minimumScale),this.performWebMercatorScale(a,i.x,i.y,d,_),a):null}getFeature(e){if(this.draggedCoordinate.id===null)return null;const i=this.store.getGeometryCopy(e);return i.type!=="Polygon"&&i.type!=="LineString"?null:{id:e,type:"Feature",geometry:i,properties:{}}}getNormalisedCoordinates(e){return e.type==="Polygon"?e.coordinates[0]:e.coordinates}validateScale(e,i){const r=!isNaN(e)&&i<Number.MAX_SAFE_INTEGER,s=!isNaN(i)&&i<Number.MAX_SAFE_INTEGER;return r&&s}performWebMercatorScale(e,i,r,s,a){e.forEach(l=>{const{x:u,y:d}=wt(l[0],l[1]),_=i+(u-i)*s,f=r+(d-r)*a,{lng:g,lat:x}=Ee(_,f);l[0]=g,l[1]=x})}getBBoxWebMercator(e){const i=[1/0,1/0,-1/0,-1/0];(e=e.map(u=>{const{x:d,y:_}=wt(u[0],u[1]);return[d,_]})).forEach(([u,d])=>{u<i[0]&&(i[0]=u),d<i[1]&&(i[1]=d),u>i[2]&&(i[2]=u),d>i[3]&&(i[3]=d)});const[r,s,a,l]=i;return[[r,l],[(r+a)/2,l],[a,l],[a,l+(s-l)/2],[a,s],[(r+a)/2,s],[r,s],[r,l+(s-l)/2]]}getIndexesWebMercator(e,i){let r,s=1/0;for(let a=0;a<e.length;a++){const l=Te({x:i.x,y:i.y},{x:e[a][0],y:e[a][1]});l<s&&(r=a,s=l)}if(r===void 0)throw new Error("No closest coordinate found");return{oppositeBboxIndex:this.boundingBoxMaps.opposite[r],closestBBoxIndex:r}}isDragging(){return this.draggedCoordinate.id!==null}startDragging(e,i){this.draggedCoordinate={id:e,index:i}}stopDragging(){this.draggedCoordinate={id:null,index:-1}}getDraggableIndex(e,i){const r=this.store.getGeometryCopy(i),s=this.getClosestCoordinate(e,r);return s.index===-1?-1:s.index}drag(e,i,r){if(!this.draggedCoordinate.id)return!1;const s=this.getFeature(this.draggedCoordinate.id);if(!s)return!1;let a=null;if(i==="center"?a=this.centerWebMercatorDrag(e):i==="opposite"?a=this.oppositeWebMercatorDrag(e):i==="center-fixed"?a=this.centerFixedWebMercatorDrag(e):i==="opposite-fixed"&&(a=this.oppositeFixedWebMercatorDrag(e)),!a)return!1;for(let f=0;f<a.length;f++){const g=a[f];if(g[0]=At(g[0],this.coordinatePrecision),g[1]=At(g[1],this.coordinatePrecision),!An(g,this.coordinatePrecision))return!1}const l=this.midPoints.getUpdated(a)||[],u=this.selectionPoints.getUpdated(a)||[],d=this.coordinatePoints.getUpdated(s.id,a)||[],_={type:s.geometry.type,coordinates:s.geometry.type==="Polygon"?[a]:a};return!(r&&!r({id:this.draggedCoordinate.id,type:"Feature",geometry:_,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pe.Provisional}).valid||(this.store.updateGeometry([{id:this.draggedCoordinate.id,geometry:_},...u,...l,...d]),0))}}const ac={deselect:"Escape",delete:"Delete",rotate:["Control","r"],scale:["Control","s"]},Es={pointerOver:"move",dragStart:"move",dragEnd:"move",insertMidpoint:"crosshair"};class hc extends Iu{constructor(e){super(e,!0),this.mode="select",this.allowManualDeselection=!0,this.dragEventThrottle=5,this.dragEventCount=0,this.selected=[],this.flags={},this.keyEvents=ac,this.cursors=Es,this.validations={},this.selectionPoints=void 0,this.midPoints=void 0,this.coordinateSnap=void 0,this.featuresAtMouseEvent=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.dragFeature=void 0,this.dragCoordinate=void 0,this.rotateFeature=void 0,this.scaleFeature=void 0,this.dragCoordinateResizeFeature=void 0,this.coordinatePoints=void 0,this.updateOptions(e)}updateOptions(e){if(super.updateOptions(e),this.cursors=e&&e.cursors?Kt({},this.cursors,e.cursors):Es,(e==null?void 0:e.keyEvents)===null?this.keyEvents={deselect:null,delete:null,rotate:null,scale:null}:e!=null&&e.keyEvents&&(this.keyEvents=Kt({},this.keyEvents,e.keyEvents)),(e==null?void 0:e.dragEventThrottle)!==void 0&&(this.dragEventThrottle=e.dragEventThrottle),(e==null?void 0:e.allowManualDeselection)!==void 0&&(this.allowManualDeselection=e.allowManualDeselection),e!=null&&e.flags){this.flags=Kt({},this.flags,e.flags),this.validations={};for(const i in this.flags){const r=this.flags[i].feature;r&&r.validation&&(this.validations[i]=r.validation)}}}createOrUpdateCoordinatePoint(e){const i=this.store.getPropertiesCopy(e);i.coordinatePointIds&&this.store.delete(i.coordinatePointIds);const r=this.store.getGeometryCopy(e),s=this.store.create(r.coordinates[0].map(a=>({geometry:{type:"Point",coordinates:a},properties:{mode:this.mode,[Oa]:!0}})));this.store.updateProperty([{id:e,property:"coordinatePointIds",value:s}])}selectFeature(e){this.select(e,!1)}setSelecting(){if(this._state!=="started")throw new Error("Mode must be started to move to selecting state");this._state="selecting"}registerBehaviors(e){this.pixelDistance=new ju(e),this.clickBoundingBox=new Ru(e),this.featuresAtMouseEvent=new ec(e,this.clickBoundingBox,this.pixelDistance),this.selectionPoints=new tc(e),this.coordinatePoints=new $u(e),this.midPoints=new Qu(e,this.selectionPoints,this.coordinatePoints),this.coordinateSnap=new Yu(e,this.pixelDistance,this.clickBoundingBox),this.rotateFeature=new rc(e,this.selectionPoints,this.midPoints,this.coordinatePoints),this.scaleFeature=new oc(e,this.selectionPoints,this.midPoints,this.coordinatePoints),this.dragFeature=new ic(e,this.featuresAtMouseEvent,this.selectionPoints,this.midPoints,this.coordinatePoints),this.dragCoordinate=new nc(e,this.pixelDistance,this.selectionPoints,this.midPoints,this.coordinatePoints,this.coordinateSnap),this.dragCoordinateResizeFeature=new sc(e,this.pixelDistance,this.selectionPoints,this.midPoints,this.coordinatePoints)}deselectFeature(){this.deselect()}deselect(){const e=this.selected.filter(i=>this.store.has(i)).map(i=>({id:i,property:fe.SELECTED,value:!1}));this.store.updateProperty(e),this.onDeselect(this.selected[0]),this.selected=[],this.selectionPoints.delete(),this.midPoints.delete()}deleteSelected(){this.store.delete(this.selected),this.selected=[]}onRightClick(e){if(!this.selectionPoints.ids.length)return;let i,r=1/0;if(this.selectionPoints.ids.forEach(x=>{const b=this.store.getGeometryCopy(x),M=this.pixelDistance.measure(e,b.coordinates);M<this.pointerDistance&&M<r&&(r=M,i=this.store.getPropertiesCopy(x))}),!i)return;const s=i.selectionPointFeatureId,a=i.index,l=this.store.getPropertiesCopy(s),u=this.flags[l.mode],d=this.validations[l.mode];if(!(u&&u.feature&&u.feature.coordinates&&u.feature.coordinates.deletable))return;const _=this.store.getGeometryCopy(s);let f;if(_.type==="Polygon"){if(f=_.coordinates[0],f.length<=4)return}else if(_.type==="LineString"&&(f=_.coordinates,f.length<=2))return;if(!f||(_.type!=="Polygon"||a!==0&&a!==f.length-1?f.splice(a,1):(f.shift(),f.pop(),f.push([f[0][0],f[0][1]])),d&&!d({id:s,type:"Feature",geometry:_,properties:l},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pe.Commit}).valid))return;const g=[...this.midPoints.ids,...this.selectionPoints.ids];this.store.delete(g),this.store.updateGeometry([{id:s,geometry:_}]),l.coordinatePointIds&&this.coordinatePoints.createOrUpdate(s),this.selectionPoints.create(f,_.type,s),u&&u.feature&&u.feature.coordinates&&u.feature.coordinates.midpoints&&this.midPoints.create(f,s,this.coordinatePrecision)}select(e,i=!0){if(this.selected[0]===e)return;const{mode:r}=this.store.getPropertiesCopy(e),s=this.flags[r];if(!s||!s.feature)return;const a=this.selected[0];if(a){if(a===e)return;this.deselect()}i&&this.setCursor(this.cursors.pointerOver),this.selected=[e],this.store.updateProperty([{id:e,property:"selected",value:!0}]),this.onSelect(e);const{type:l,coordinates:u}=this.store.getGeometryCopy(e);if(l!=="LineString"&&l!=="Polygon")return;const d=l==="LineString"?u:u[0];d&&s&&s.feature.coordinates&&(this.selectionPoints.create(d,l,e),s.feature.coordinates.midpoints&&this.midPoints.create(d,e,this.coordinatePrecision))}onLeftClick(e){const{clickedFeature:i,clickedMidPoint:r}=this.featuresAtMouseEvent.find(e,this.selected.length>0);if(this.selected.length&&r)this.midPoints.insert(this.selected[0],r.id,this.coordinatePrecision);else if(i&&i.id)this.select(i.id,!0);else if(this.selected.length&&this.allowManualDeselection)return void this.deselect()}start(){this.setStarted(),this.setSelecting()}stop(){this.cleanUp(),this.setStarted(),this.setStopped()}onClick(e){e.button!=="right"?e.button==="left"&&this.onLeftClick(e):this.onRightClick(e)}canScale(e){return this.keyEvents.scale&&this.keyEvents.scale.every(i=>e.heldKeys.includes(i))}canRotate(e){return this.keyEvents.rotate&&this.keyEvents.rotate.every(i=>e.heldKeys.includes(i))}preventDefaultKeyEvent(e){const i=this.canRotate(e),r=this.canScale(e);(i||r)&&e.preventDefault()}onKeyDown(e){this.preventDefaultKeyEvent(e)}onKeyUp(e){if(this.preventDefaultKeyEvent(e),this.keyEvents.delete&&e.key===this.keyEvents.delete){if(!this.selected.length)return;this.onDeselect(this.selected[0]),this.deleteSelected(),this.selectionPoints.delete(),this.midPoints.delete()}else this.keyEvents.deselect&&e.key===this.keyEvents.deselect&&this.cleanUp()}cleanUp(){this.selected.length&&this.deselect()}onDragStart(e,i){if(!this.selected.length)return;const r=this.store.getPropertiesCopy(this.selected[0]),s=this.flags[r.mode];if(!(s&&s.feature&&(s.feature.draggable||s.feature.coordinates&&s.feature.coordinates.draggable||s.feature.coordinates&&s.feature.coordinates.resizable||s.feature.coordinates&&typeof s.feature.coordinates.midpoints=="object"&&s.feature.coordinates.midpoints.draggable)))return;this.dragEventCount=0;const a=this.selected[0],l=this.dragCoordinate.getDraggableIndex(e,a);if(s&&s.feature&&s.feature.coordinates&&(s.feature.coordinates.draggable||s.feature.coordinates.resizable)&&l!==-1)return this.setCursor(this.cursors.dragStart),s.feature.coordinates.resizable?this.dragCoordinateResizeFeature.startDragging(a,l):this.dragCoordinate.startDragging(a,l),void i(!1);if(s&&s.feature&&s.feature.coordinates&&typeof s.feature.coordinates.midpoints=="object"&&s.feature.coordinates.midpoints.draggable){const{clickedMidPoint:u}=this.featuresAtMouseEvent.find(e,this.selected.length>0);if(this.selected.length&&u){this.midPoints.insert(a,u.id,this.coordinatePrecision);const d=this.dragCoordinate.getDraggableIndex(e,a);return this.dragCoordinate.startDragging(a,d),void i(!1)}}return s&&s.feature&&s.feature.draggable&&this.dragFeature.canDrag(e,a)?(this.setCursor(this.cursors.dragStart),this.dragFeature.startDragging(e,a),void i(!1)):void 0}onDrag(e,i){const r=this.selected[0];if(!r)return;const s=this.store.getPropertiesCopy(r),a=this.flags[s.mode],l=(a&&a.feature&&a.feature.selfIntersectable)===!0;if(this.dragEventCount++,this.dragEventCount%this.dragEventThrottle==0)return;const u=this.validations[s.mode];if(a&&a.feature&&a.feature.rotateable&&this.canRotate(e))return i(!1),void this.rotateFeature.rotate(e,r,u);if(a&&a.feature&&a.feature.scaleable&&this.canScale(e))return i(!1),void this.scaleFeature.scale(e,r,u);if(this.dragCoordinateResizeFeature.isDragging()&&a.feature&&a.feature.coordinates&&a.feature.coordinates.resizable){if(this.projection==="globe")throw new Error("Globe is currently unsupported projection for resizable");return i(!1),void this.dragCoordinateResizeFeature.drag(e,a.feature.coordinates.resizable,u)}if(this.dragCoordinate.isDragging()){var d;const _=!!(!((d=a.feature)==null||(d=d.coordinates)==null)&&d.snappable);this.dragCoordinate.drag(e,l,u,_)}else this.dragFeature.isDragging()?this.dragFeature.drag(e,u):i(!0)}onDragEnd(e,i){this.setCursor(this.cursors.dragEnd),this.dragCoordinate.isDragging()?this.onFinish(this.selected[0],{mode:this.mode,action:"dragCoordinate"}):this.dragFeature.isDragging()?this.onFinish(this.selected[0],{mode:this.mode,action:"dragFeature"}):this.dragCoordinateResizeFeature.isDragging()&&this.onFinish(this.selected[0],{mode:this.mode,action:"dragCoordinateResize"}),this.dragCoordinate.stopDragging(),this.dragFeature.stopDragging(),this.dragCoordinateResizeFeature.stopDragging(),this.rotateFeature.reset(),this.scaleFeature.reset(),i(!0)}onMouseMove(e){if(!this.selected.length)return void this.setCursor("unset");if(this.dragFeature.isDragging())return;let i=!1;this.midPoints.ids.forEach(a=>{if(i)return;const l=this.store.getGeometryCopy(a);this.pixelDistance.measure(e,l.coordinates)<this.pointerDistance&&(i=!0)});let r=!1;if(this.selectionPoints.ids.forEach(a=>{const l=this.store.getGeometryCopy(a);this.pixelDistance.measure(e,l.coordinates)<this.pointerDistance&&(i=!1,r=!0)}),i)return void this.setCursor(this.cursors.insertMidpoint);const{clickedFeature:s}=this.featuresAtMouseEvent.find(e,!0);this.setCursor(this.selected.length>0&&(s&&s.id===this.selected[0]||r)?this.cursors.pointerOver:"unset")}styleFeature(e){const i=Kt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});if(e.properties.mode===this.mode&&e.geometry.type==="Point"){if(e.properties.selectionPoint)return i.pointColor=this.getHexColorStylingValue(this.styles.selectionPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.selectionPointOutlineColor,i.pointOutlineColor,e),i.pointWidth=this.getNumericStylingValue(this.styles.selectionPointWidth,i.pointWidth,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.selectionPointOutlineWidth,2,e),i.zIndex=30,i;if(e.properties.midPoint)return i.pointColor=this.getHexColorStylingValue(this.styles.midPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.midPointOutlineColor,i.pointOutlineColor,e),i.pointWidth=this.getNumericStylingValue(this.styles.midPointWidth,4,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.midPointOutlineWidth,2,e),i.zIndex=40,i}else if(e.properties[fe.SELECTED]){if(e.geometry.type==="Polygon")return i.polygonFillColor=this.getHexColorStylingValue(this.styles.selectedPolygonColor,i.polygonFillColor,e),i.polygonOutlineWidth=this.getNumericStylingValue(this.styles.selectedPolygonOutlineWidth,i.polygonOutlineWidth,e),i.polygonOutlineColor=this.getHexColorStylingValue(this.styles.selectedPolygonOutlineColor,i.polygonOutlineColor,e),i.polygonFillOpacity=this.getNumericStylingValue(this.styles.selectedPolygonFillOpacity,i.polygonFillOpacity,e),i.zIndex=10,i;if(e.geometry.type==="LineString")return i.lineStringColor=this.getHexColorStylingValue(this.styles.selectedLineStringColor,i.lineStringColor,e),i.lineStringWidth=this.getNumericStylingValue(this.styles.selectedLineStringWidth,i.lineStringWidth,e),i.zIndex=10,i;if(e.geometry.type==="Point")return i.pointWidth=this.getNumericStylingValue(this.styles.selectedPointWidth,i.pointWidth,e),i.pointColor=this.getHexColorStylingValue(this.styles.selectedPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.selectedPointOutlineColor,i.pointOutlineColor,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.selectedPointOutlineWidth,i.pointOutlineWidth,e),i.zIndex=10,i}return i}}class lc extends qr{constructor(...e){super(...e),this.type=Ie.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return Kt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0})}}function Wa(n,e,i,r,s){for(;r>i;){if(r-i>600){const d=r-i+1,_=e-i+1,f=Math.log(d),g=.5*Math.exp(2*f/3),x=.5*Math.sqrt(f*g*(d-g)/d)*(_-d/2<0?-1:1);Wa(n,e,Math.max(i,Math.floor(e-_*g/d+x)),Math.min(r,Math.floor(e+(d-_)*g/d+x)),s)}const a=n[e];let l=i,u=r;for(gi(n,i,e),s(n[r],a)>0&&gi(n,i,r);l<u;){for(gi(n,l,u),l++,u--;s(n[l],a)<0;)l++;for(;s(n[u],a)>0;)u--}s(n[i],a)===0?gi(n,i,u):(u++,gi(n,u,r)),u<=e&&(i=u+1),e<=u&&(r=u-1)}}function gi(n,e,i){const r=n[e];n[e]=n[i],n[i]=r}function Ye(n,e){Mi(n,0,n.children.length,e,n)}function Mi(n,e,i,r,s){s||(s=He([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=e;a<i;a++){const l=n.children[a];Li(s,n.leaf?r(l):l)}return s}function Li(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function uc(n,e){return n.minX-e.minX}function cc(n,e){return n.minY-e.minY}function gr(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function dn(n){return n.maxX-n.minX+(n.maxY-n.minY)}function dc(n,e){const i=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),s=Math.min(n.maxX,e.maxX),a=Math.min(n.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,a-r)}function vr(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function fn(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function He(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ts(n,e,i,r,s){const a=[e,i];for(;a.length;){if((i=a.pop())-(e=a.pop())<=r)continue;const l=e+Math.ceil((i-e)/r/2)*r;Wa(n,l,e,i,s),a.push(e,l,l,i)}}class fc{constructor(e){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(e){let i=this.data;const r=[];if(!fn(e,i))return r;const s=this.toBBox,a=[];for(;i;){for(let l=0;l<i.children.length;l++){const u=i.children[l],d=i.leaf?s(u):u;fn(e,d)&&(i.leaf?r.push(u):vr(e,d)?this._all(u,r):a.push(u))}i=a.pop()}return r}collides(e){let i=this.data;if(fn(e,i)){const r=[];for(;i;){for(let s=0;s<i.children.length;s++){const a=i.children[s],l=i.leaf?this.toBBox(a):a;if(fn(e,l)){if(i.leaf||vr(e,l))return!0;r.push(a)}}i=r.pop()}}return!1}load(e){if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return}let i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){const r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i}insert(e){this._insert(e,this.data.height-1)}clear(){this.data=He([])}remove(e){let i=this.data;const r=this.toBBox(e),s=[],a=[];let l,u,d=!1;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=a.pop(),d=!0),i.leaf){const _=i.children.indexOf(e);_!==-1&&(i.children.splice(_,1),s.push(i),this._condense(s))}d||i.leaf||!vr(i,r)?u?(l++,i=u.children[l],d=!1):i=null:(s.push(i),a.push(l),l=0,u=i,i=i.children[0])}}toBBox(e){return e}compareMinX(e,i){return e.minX-i.minX}compareMinY(e,i){return e.minY-i.minY}_all(e,i){const r=[];for(;e;)e.leaf?i.push(...e.children):r.push(...e.children),e=r.pop();return i}_build(e,i,r,s){const a=r-i+1;let l,u=this._maxEntries;if(a<=u)return l=He(e.slice(i,r+1)),Ye(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=He([]),l.leaf=!1,l.height=s;const d=Math.ceil(a/u),_=d*Math.ceil(Math.sqrt(u));Ts(e,i,r,_,this.compareMinX);for(let f=i;f<=r;f+=_){const g=Math.min(f+_-1,r);Ts(e,f,g,d,this.compareMinY);for(let x=f;x<=g;x+=d){const b=Math.min(x+d-1,g);l.children.push(this._build(e,x,b,s-1))}}return Ye(l,this.toBBox),l}_chooseSubtree(e,i,r,s){for(;s.push(i),!i.leaf&&s.length-1!==r;){let u,d=1/0,_=1/0;for(let f=0;f<i.children.length;f++){const g=i.children[f],x=gr(g),b=(a=e,l=g,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-x);b<_?(_=b,d=x<d?x:d,u=g):b===_&&x<d&&(d=x,u=g)}i=u||i.children[0]}var a,l;return i}_insert(e,i,r){const s=r?e:this.toBBox(e),a=[],l=this._chooseSubtree(s,this.data,i,a);for(l.children.push(e),Li(l,s);i>=0&&a[i].children.length>this._maxEntries;)this._split(a,i),i--;this._adjustParentBBoxes(s,a,i)}_split(e,i){const r=e[i],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=He(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,Ye(r,this.toBBox),Ye(u,this.toBBox),i?e[i-1].children.push(u):this._splitRoot(r,u)}_splitRoot(e,i){this.data=He([e,i]),this.data.height=e.height+1,this.data.leaf=!1,Ye(this.data,this.toBBox)}_chooseSplitIndex(e,i,r){let s,a=1/0,l=1/0;for(let u=i;u<=r-i;u++){const d=Mi(e,0,u,this.toBBox),_=Mi(e,u,r,this.toBBox),f=dc(d,_),g=gr(d)+gr(_);f<a?(a=f,s=u,l=g<l?g:l):f===a&&g<l&&(l=g,s=u)}return s||r-i}_chooseSplitAxis(e,i,r){const s=e.leaf?this.compareMinX:uc,a=e.leaf?this.compareMinY:cc;this._allDistMargin(e,i,r,s)<this._allDistMargin(e,i,r,a)&&e.children.sort(s)}_allDistMargin(e,i,r,s){e.children.sort(s);const a=this.toBBox,l=Mi(e,0,i,a),u=Mi(e,r-i,r,a);let d=dn(l)+dn(u);for(let _=i;_<r-i;_++){const f=e.children[_];Li(l,e.leaf?a(f):f),d+=dn(l)}for(let _=r-i-1;_>=i;_--){const f=e.children[_];Li(u,e.leaf?a(f):f),d+=dn(u)}return d}_adjustParentBBoxes(e,i,r){for(let s=r;s>=0;s--)Li(i[s],e)}_condense(e){for(let i,r=e.length-1;r>=0;r--)e[r].children.length===0?r>0?(i=e[r-1].children,i.splice(i.indexOf(e[r]),1)):this.clear():Ye(e[r],this.toBBox)}}class pc{constructor(e){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new fc(e&&e.maxEntries?e.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(e,i){this.idToNode.set(e.id,i),this.nodeToId.set(i,e.id)}toBBox(e){const i=[],r=[];let s;if(e.geometry.type==="Polygon")s=e.geometry.coordinates[0];else if(e.geometry.type==="LineString")s=e.geometry.coordinates;else{if(e.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[e.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),i.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...i),minY:a,maxX:Math.max(...i),maxY:l}}insert(e){if(this.idToNode.get(String(e.id)))throw new Error("Feature already exists");const i=this.toBBox(e);this.setMaps(e,i),this.tree.insert(i)}load(e){const i=[],r=new Set;e.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),i.push(a)}),this.tree.load(i)}update(e){this.remove(e.id);const i=this.toBBox(e);this.setMaps(e,i),this.tree.insert(i)}remove(e){const i=this.idToNode.get(e);if(!i)throw new Error(`${e} not inserted into the spatial index`);this.tree.remove(i)}clear(){this.tree.clear()}search(e){return this.tree.search(this.toBBox(e)).map(i=>this.nodeToId.get(i))}collides(e){return this.tree.collides(this.toBBox(e))}}const _c={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=16*Math.random()|0;return(n=="x"?e:3&e|8).toString(16)}),isValidId:n=>typeof n=="string"&&n.length===36};class mc{constructor(e){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new pc,this.tracked=!e||e.tracked!==!1,this.idStrategy=e&&e.idStrategy?e.idStrategy:_c}clone(e){return JSON.parse(JSON.stringify(e))}getId(){return this.idStrategy.getId()}has(e){return!!this.store[e]}load(e,i,r){if(e.length===0)return[];let s=this.clone(e);const a=[],l=[];return s=s.filter(u=>{u.id==null&&(u.id=this.idStrategy.getId());const d=u.id;if(i){const _=i(u);if(!_.valid)return l.push({id:d,valid:!1,reason:_.reason}),!1}if(this.tracked){if(u.properties.createdAt){if(!Ms(u.properties.createdAt))return l.push({id:u.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else u.properties.createdAt=+new Date;if(u.properties.updatedAt){if(!Ms(u.properties.updatedAt))return l.push({id:u.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else u.properties.updatedAt=+new Date}return this.has(d)?(l.push({id:d,valid:!1,reason:`Feature already exists with this id: ${d}`}),!1):(this.store[d]=u,a.push(d),r&&r(u),l.push({id:d,valid:!0}),!0)}),this.spatialIndex.load(s),this._onChange(a,"create"),l}search(e,i){const r=this.spatialIndex.search(e).map(s=>this.store[s]);return this.clone(i?r.filter(i):r)}registerOnChange(e){this._onChange=(i,r)=>{e(i,r)}}getGeometryCopy(e){const i=this.store[e];if(!i)throw new Error(`No feature with this id (${e}), can not get geometry copy`);return this.clone(i.geometry)}getPropertiesCopy(e){const i=this.store[e];if(!i)throw new Error(`No feature with this id (${e}), can not get properties copy`);return this.clone(i.properties)}updateProperty(e){const i=[];e.forEach(({id:r,property:s,value:a})=>{const l=this.store[r];if(!l)throw new Error(`No feature with this (${r}), can not update geometry`);i.push(r),l.properties[s]=a,this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(i,"update")}updateGeometry(e){const i=[];e.forEach(({id:r,geometry:s})=>{i.push(r);const a=this.store[r];if(!a)throw new Error(`No feature with this (${r}), can not update geometry`);a.geometry=this.clone(s),this.spatialIndex.update(a),this.tracked&&(a.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(i,"update")}create(e){const i=[];return e.forEach(({geometry:r,properties:s})=>{let a,l=Kt({},s);this.tracked&&(a=+new Date,s?(l.createdAt=typeof s.createdAt=="number"?s.createdAt:a,l.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:a):l={createdAt:a,updatedAt:a});const u=this.getId(),d={id:u,type:"Feature",geometry:r,properties:l};this.store[u]=d,this.spatialIndex.insert(d),i.push(u)}),this._onChange&&this._onChange([...i],"create"),i}delete(e){e.forEach(i=>{if(!this.store[i])throw new Error("No feature with this id, can not delete");delete this.store[i],this.spatialIndex.remove(i)}),this._onChange&&this._onChange([...e],"delete")}copy(e){return this.clone(this.store[e])}copyAll(){return this.clone(Object.keys(this.store).map(e=>this.store[e]))}copyAllWhere(e){return this.clone(Object.keys(this.store).map(i=>this.store[i]).filter(i=>i.properties&&e(i.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class We{constructor({name:e,callback:i,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=e,this.register=()=>{this.registered||(this.registered=!0,s(i))},this.unregister=()=>{this.register&&(this.registered=!1,r(i))},this.callback=i}}var gc={__proto__:null,TerraDrawBaseAdapter:class{constructor(n){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof n.minPixelDragDistance=="number"?n.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof n.minPixelDragDistanceSelecting=="number"?n.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof n.minPixelDragDistanceDrawing=="number"?n.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof n.coordinatePrecision=="number"?n.coordinatePrecision:9}getButton(n){return n.button===-1?"neither":n.button===0?"left":n.button===1?"middle":n.button===2?"right":"neither"}getMapElementXYPosition(n){const e=this.getMapEventElement(),{left:i,top:r}=e.getBoundingClientRect();return{containerX:n.clientX-i,containerY:n.clientY-r}}getDrawEventFromEvent(n){const e=this.getLngLatFromEvent(n);if(!e)return null;const{lng:i,lat:r}=e,{containerX:s,containerY:a}=this.getMapElementXYPosition(n),l=this.getButton(n),u=Array.from(this._heldKeys);return{lng:At(i,this._coordinatePrecision),lat:At(r,this._coordinatePrecision),containerX:s,containerY:a,button:l,heldKeys:u}}register(n){this._currentModeCallbacks=n,this._listeners=this.getAdapterListeners(),this._listeners.forEach(e=>{e.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new We({name:"pointerdown",callback:n=>{if(!this._currentModeCallbacks||!n.isPrimary)return;const e=this.getDrawEventFromEvent(n);e&&(this._dragState="pre-dragging",this._lastDrawEvent=e)},register:n=>{this.getMapEventElement().addEventListener("pointerdown",n)},unregister:n=>{this.getMapEventElement().removeEventListener("pointerdown",n)}}),new We({name:"pointermove",callback:n=>{if(!this._currentModeCallbacks||!n.isPrimary)return;n.preventDefault();const e=this.getDrawEventFromEvent(n);if(e)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(e),this._lastDrawEvent=e;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const i={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:e.containerX,y:e.containerY},s=this._currentModeCallbacks.getState(),a=Te(i,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(e,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(e,i=>{this.setDraggability.bind(this)(i)})},register:n=>{this.getMapEventElement().addEventListener("pointermove",n)},unregister:n=>{this.getMapEventElement().removeEventListener("pointermove",n)}}),new We({name:"contextmenu",callback:n=>{this._currentModeCallbacks&&n.preventDefault()},register:n=>{this.getMapEventElement().addEventListener("contextmenu",n)},unregister:n=>{this.getMapEventElement().removeEventListener("contextmenu",n)}}),new We({name:"pointerup",callback:n=>{if(!this._currentModeCallbacks||n.target!==this.getMapEventElement()||!n.isPrimary)return;const e=this.getDrawEventFromEvent(n);e&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(e,i=>{this.setDraggability.bind(this)(i)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(e),this._dragState="not-dragging",this.setDraggability(!0))},register:n=>{this.getMapEventElement().addEventListener("pointerup",n)},unregister:n=>{this.getMapEventElement().removeEventListener("pointerup",n)}}),new We({name:"keyup",callback:n=>{this._currentModeCallbacks&&(this._heldKeys.delete(n.key),this._currentModeCallbacks.onKeyUp({key:n.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>n.preventDefault()}))},register:n=>{this.getMapEventElement().addEventListener("keyup",n)},unregister:n=>{this.getMapEventElement().removeEventListener("keyup",n)}}),new We({name:"keydown",callback:n=>{this._currentModeCallbacks&&(this._heldKeys.add(n.key),this._currentModeCallbacks.onKeyDown({key:n.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>n.preventDefault()}))},register:n=>{this.getMapEventElement().addEventListener("keydown",n)},unregister:n=>{this.getMapEventElement().removeEventListener("keydown",n)}})]}unregister(){this._listeners.forEach(n=>{n.unregister()}),this.clear()}}};class vc{constructor(e){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=e.adapter,this._mode=new lc;const i=new Set,r=e.modes.reduce((f,g)=>{if(i.has(g.mode))throw new Error(`There is already a ${g.mode} mode provided`);return i.add(g.mode),f[g.mode]=g,f},{}),s=Object.keys(r);if(s.length===0)throw new Error("No modes provided");s.forEach(f=>{if(r[f].type===Ie.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=f}}),this._modes=Kt({},r,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new mc({tracked:!!e.tracked,idStrategy:e.idStrategy?e.idStrategy:void 0});const a=f=>{const g=[],x=this._store.copyAll().filter(b=>!f.includes(b.id)||(g.push(b),!1));return{changed:g,unchanged:x}},l=(f,g)=>{this._enabled&&this._eventListeners.finish.forEach(x=>{x(f,g)})},u=(f,g)=>{if(!this._enabled)return;this._eventListeners.change.forEach(M=>{M(f,g)});const{changed:x,unchanged:b}=a(f);g==="create"?this._adapter.render({created:x,deletedIds:[],unchanged:b,updated:[]},this.getModeStyles()):g==="update"?this._adapter.render({created:[],deletedIds:[],unchanged:b,updated:x},this.getModeStyles()):g==="delete"?this._adapter.render({created:[],deletedIds:f,unchanged:b,updated:[]},this.getModeStyles()):g==="styling"&&this._adapter.render({created:[],deletedIds:[],unchanged:b,updated:[]},this.getModeStyles())},d=f=>{if(!this._enabled)return;this._eventListeners.select.forEach(b=>{b(f)});const{changed:g,unchanged:x}=a([f]);this._adapter.render({created:[],deletedIds:[],unchanged:x,updated:g},this.getModeStyles())},_=f=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(b=>{b()});const{changed:g,unchanged:x}=a([f]);g&&this._adapter.render({created:[],deletedIds:[],unchanged:x,updated:g},this.getModeStyles())};Object.keys(this._modes).forEach(f=>{this._modes[f].register({mode:f,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:u,onSelect:d,onDeselect:_,onFinish:l,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const e={};return Object.keys(this._modes).forEach(i=>{e[i]=r=>this._instanceSelectMode&&r.properties[fe.SELECTED]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(r):this._modes[i].styleFeature.bind(this._modes[i])(r)}),e}featuresAtLocation({lng:e,lat:i},r){const s=r&&r.pointerDistance!==void 0?r.pointerDistance:30,a=!r||r.ignoreSelectFeatures===void 0||r.ignoreSelectFeatures,l=this._adapter.unproject.bind(this._adapter),u=this._adapter.project.bind(this._adapter),d=u(e,i),_=Na({unproject:l,point:d,pointerDistance:s});return this._store.search(_).filter(f=>{if(a&&(f.properties[fe.MID_POINT]||f.properties[fe.SELECTION_POINT]))return!1;if(f.geometry.type==="Point"){const g=f.geometry.coordinates,x=u(g[0],g[1]);return Te(d,x)<s}if(f.geometry.type==="LineString"){const g=f.geometry.coordinates;for(let x=0;x<g.length-1;x++){const b=g[x],M=g[x+1];if(ja(d,u(b[0],b[1]),u(M[0],M[1]))<s)return!0}return!1}return!!Ra([e,i],f.geometry.coordinates)||void 0})}getSelectMode(){if(this.checkEnabled(),!this._instanceSelectMode)throw new Error("No select mode defined in instance");return this.getMode()!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}setModeStyles(e,i){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].styles=i}updateModeOptions(e,i){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].updateOptions(i)}getSnapshot(){return this._store.copyAll()}getSnapshotFeature(e){if(this._store.has(e))return this._store.copy(e)}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(e){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}setMode(e){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[e],this._mode.start()}removeFeatures(e){this.checkEnabled(),this._store.delete(e)}selectFeature(e){this.getSelectMode().selectFeature(e)}deselectFeature(e){this.getSelectMode().deselectFeature(e)}getFeatureId(){return this._store.getId()}hasFeature(e){return this._store.has(e)}addFeatures(e){return this.checkEnabled(),e.length===0?[]:this._store.load(e,i=>{if(Ps(i)){const r=i.properties.mode,s=this._modes[r];if(!s)return{id:i.id,valid:!1,reason:`${r} mode is not in the list of instantiated modes`};const a=s.validateFeature.bind(s)(i);return{id:i.id,valid:a.valid,reason:a.reason?a.reason:a.valid?void 0:"Feature is invalid"}}return{id:i.id,valid:!1,reason:"Mode property does not exist"}},i=>{if(Ps(i)){const r=this._modes[i.properties.mode];r&&r.afterFeatureAdded&&r.afterFeatureAdded(i)}})}start(){this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(e=>{e()})},getState:()=>this._mode.state,onClick:e=>{this._mode.onClick(e)},onMouseMove:e=>{this._mode.onMouseMove(e)},onKeyDown:e=>{this._mode.onKeyDown(e)},onKeyUp:e=>{this._mode.onKeyUp(e)},onDragStart:(e,i)=>{this._mode.onDragStart(e,i)},onDrag:(e,i)=>{this._mode.onDrag(e,i)},onDragEnd:(e,i)=>{this._mode.onDragEnd(e,i)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}})}getFeaturesAtLngLat(e,i){const{lng:r,lat:s}=e;return this.featuresAtLocation({lng:r,lat:s},i)}getFeaturesAtPointerEvent(e,i){const r=this._adapter.getLngLatFromEvent.bind(this._adapter)(e);return r===null?[]:this.featuresAtLocation(r,i)}stop(){this._enabled=!1,this._adapter.unregister()}on(e,i){const r=this._eventListeners[e];r.includes(i)||r.push(i)}off(e,i){const r=this._eventListeners[e];r.includes(i)&&r.splice(r.indexOf(i),1)}}let yc=class extends gc.TerraDrawBaseAdapter{constructor(e){super(e),this._lib=void 0,this._map=void 0,this._panes={},this._container=void 0,this._layers={},this._lib=e.lib,this._map=e.map,this._container=this._map.getContainer()}createPaneStyleSheet(e,i){const r=document.createElement("style");return r.innerHTML=`.leaflet-${e}-pane {z-index: ${i+600}`,document.getElementsByTagName("head")[0].appendChild(r),this._map.createPane(e),r}clearPanes(){Object.values(this._panes).forEach(e=>{e&&e.remove()}),this._panes={}}clearLayers(){Object.values(this._layers).forEach(e=>{this._map.removeLayer(e)}),this._layers={}}styleGeoJSONLayer(e){return{pointToLayer:(i,r)=>{if(!i.properties)throw new Error("Feature has no properties");if(typeof i.properties.mode!="string")throw new Error("Feature mode is not a string");const s=(0,e[i.properties.mode])(i),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),this._lib.circleMarker(r,{radius:s.pointWidth,stroke:s.pointOutlineWidth||!1,color:s.pointOutlineColor,weight:s.pointOutlineWidth,fillOpacity:.8,fillColor:s.pointColor,pane:a,interactive:!1})},style:i=>{if(!i||!i.properties)return{};const r=i,s=(0,e[r.properties.mode])(r),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),r.geometry.type==="LineString"?{interactive:!1,color:s.lineStringColor,weight:s.lineStringWidth,pane:a}:r.geometry.type==="Polygon"?{interactive:!1,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,weight:s.polygonOutlineWidth,stroke:!0,color:s.polygonOutlineColor,pane:a}:{}}}}getLngLatFromEvent(e){const{containerX:i,containerY:r}=this.getMapElementXYPosition(e),s=this._map.containerPointToLatLng({x:i,y:r});return s.lng===null||isNaN(s.lng)||s.lat===null||isNaN(s.lat)?null:{lng:s.lng,lat:s.lat}}getMapEventElement(){return this._container}setDraggability(e){e?this._map.dragging.enable():this._map.dragging.disable()}project(e,i){const{x:r,y:s}=this._map.latLngToContainerPoint({lng:e,lat:i});return{x:r,y:s}}unproject(e,i){const{lng:r,lat:s}=this._map.containerPointToLatLng({x:e,y:i});return{lng:r,lat:s}}setCursor(e){e==="unset"?this.getMapEventElement().style.removeProperty("cursor"):this.getMapEventElement().style.cursor=e}setDoubleClickToZoom(e){e?this._map.doubleClickZoom.enable():this._map.doubleClickZoom.disable()}render(e,i){if(e.created.forEach(r=>{r.id&&(this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(i)),this._map.addLayer(this._layers[r.id]))}),e.deletedIds.forEach(r=>{this._layers[r]&&(this._map.removeLayer(this._layers[r]),delete this._layers[r])}),e.updated.forEach(r=>{r.id&&(this._layers[r.id]&&this._map.removeLayer(this._layers[r.id]),this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(i)),this._map.addLayer(this._layers[r.id]))}),e.created.length===0&&e.updated.length===0&&e.deletedIds.length===0){const r=[];Object.keys(this._layers).forEach(s=>{r.push(()=>{const a=this._layers[s],l=a.toGeoJSON();this._map.removeLayer(a);const u=this._lib.geoJSON(l,this.styleGeoJSONLayer(i));this._layers[s]=u,u.addTo(this._map),this._map.addLayer(this._layers[s])})}),setTimeout(()=>{r.forEach(s=>s())})}}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers(),this.clearPanes())}register(e){var i;super.register(e),(i=this._currentModeCallbacks)!=null&&i.onReady&&this._currentModeCallbacks.onReady()}getCoordinatePrecision(){return super.getCoordinatePrecision()}unregister(){return super.unregister()}};function Dr(){return Dr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)({}).hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Dr.apply(null,arguments)}var Ir;(function(n){n.Commit="commit",n.Provisional="provisional",n.Finish="finish"})(Ir||(Ir={}));function yr(n){return!!(n&&typeof n=="object"&&n!==null&&!Array.isArray(n))}const xc="Feature mode property does not match the mode being added to";var Br;(function(n){n.Drawing="drawing",n.Select="select",n.Static="static",n.Render="render"})(Br||(Br={}));class wc{get state(){return this._state}set state(e){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(e){if(typeof e!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=e}registerBehaviors(e){}constructor(e,i=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=Br.Drawing,this.mode="base",i||this.updateOptions(e)}updateOptions(e){e!=null&&e.styles&&(this.styles=Dr({},this._styles,e.styles)),e!=null&&e.pointerDistance&&(this.pointerDistance=e.pointerDistance),e!=null&&e.validation&&(this.validate=e&&e.validation),e!=null&&e.projection&&(this.projection=e.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(e){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=e.store,this.store.registerOnChange(e.onChange),this.setDoubleClickToZoom=e.setDoubleClickToZoom,this.project=e.project,this.unproject=e.unproject,this.onSelect=e.onSelect,this.onDeselect=e.onDeselect,this.setCursor=e.setCursor,this.onStyleChange=e.onChange,this.onFinish=e.onFinish,this.coordinatePrecision=e.coordinatePrecision,this.registerBehaviors({mode:e.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:e.coordinatePrecision,projection:this.projection})}validateFeature(e){return this.performFeatureValidation(e)}afterFeatureAdded(e){}performFeatureValidation(e){if(this._state==="unregistered")throw new Error("Mode must be registered");const i=function(r,s){let a;if(yr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(yr(r.geometry))if(yr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}}(e,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(e,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:Ir.Provisional});return{valid:i.valid&&r.valid,reason:r.reason}}return{valid:i.valid,reason:i.reason}}validateModeFeature(e,i){const r=this.performFeatureValidation(e);return r.valid?e.properties.mode!==this.mode?{valid:!1,reason:xc}:i(e):{valid:!1,reason:r.reason}}onFinish(e,i){}onDeselect(e){}onSelect(e){}onKeyDown(e){}onKeyUp(e){}onMouseMove(e){}onClick(e){}onDragStart(e,i){}onDrag(e,i){}onDragEnd(e,i){}getHexColorStylingValue(e,i,r){return this.getStylingValue(e,i,r)}getNumericStylingValue(e,i,r){return this.getStylingValue(e,i,r)}getStylingValue(e,i,r){return e===void 0?i:typeof e=="function"?e(r):e}}var bc={__proto__:null,TerraDrawBaseDrawMode:wc};const Pc=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Mc=1,vi=8;class Lc{constructor(e,i=64,r=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unexpected numItems value: ${e}.`);this.numItems=e,this.nodeSize=Math.min(Math.max(i,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const a=Pc.indexOf(this.ArrayType),l=e*2*this.ArrayType.BYTES_PER_ELEMENT,u=e*this.IndexArrayType.BYTES_PER_ELEMENT,d=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,vi,e),this.coords=new this.ArrayType(this.data,vi+u+d,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(vi+l+u+d),this.ids=new this.IndexArrayType(this.data,vi,e),this.coords=new this.ArrayType(this.data,vi+u+d,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Mc<<4)+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(e,i){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=i,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return zr(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function zr(n,e,i,r,s,a){if(s-r<=i)return;const l=r+s>>1;Ua(n,e,l,r,s,a),zr(n,e,i,r,l-1,1-a),zr(n,e,i,l+1,s,1-a)}function Ua(n,e,i,r,s,a){for(;s>r;){if(s-r>600){const _=s-r+1,f=i-r+1,g=Math.log(_),x=.5*Math.exp(2*g/3),b=.5*Math.sqrt(g*x*(_-x)/_)*(f-_/2<0?-1:1),M=Math.max(r,Math.floor(i-f*x/_+b)),S=Math.min(s,Math.floor(i+(_-f)*x/_+b));Ua(n,e,i,M,S,a)}const l=e[2*i+a];let u=r,d=s;for(yi(n,e,r,i),e[2*s+a]>l&&yi(n,e,r,s);u<d;){for(yi(n,e,u,d),u++,d--;e[2*u+a]<l;)u++;for(;e[2*d+a]>l;)d--}e[2*r+a]===l?yi(n,e,r,d):(d++,yi(n,e,d,s)),d<=i&&(r=d+1),i<=d&&(s=d-1)}}function yi(n,e,i,r){xr(n,i,r),xr(e,2*i,2*r),xr(e,2*i+1,2*r+1)}function xr(n,e,i){const r=n[e];n[e]=n[i],n[i]=r}let Cc=class{constructor(e=[],i=(r,s)=>r<s?-1:r>s?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:r}=this,s=i[e];for(;e>0;){const a=e-1>>1,l=i[a];if(r(s,l)>=0)break;i[e]=l,e=a}i[e]=s}_down(e){const{data:i,compare:r}=this,s=this.length>>1,a=i[e];for(;e<s;){let l=(e<<1)+1;const u=l+1;if(u<this.length&&r(i[u],i[l])<0&&(l=u),r(i[l],a)>=0)break;i[e]=i[l],e=l}i[e]=a}};const Sc=6371,oe=Math.PI/180;function kc(n,e,i,r=1/0,s=1/0){let a=1;const l=[];r===void 0&&(r=1/0),s!==void 0&&(a=Se(s/Sc));const u=new Cc([],Ec);let d={left:0,right:n.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const _=Math.cos(i*oe);for(;d;){const f=d.right,g=d.left;if(f-g<=n.nodeSize)for(let x=g;x<=f;x++){const b=n.ids[x],M=Is(e,i,n.coords[2*x],n.coords[2*x+1],_);u.push({id:b,dist:M})}else{const x=g+f>>1,b=n.coords[2*x],M=n.coords[2*x+1],S=n.ids[x],B=Is(e,i,b,M,_);u.push({id:S,dist:B});const A=(d.axis+1)%2,m={left:g,right:x-1,axis:A,minLng:d.minLng,minLat:d.minLat,maxLng:d.axis===0?b:d.maxLng,maxLat:d.axis===1?M:d.maxLat,dist:0},w={left:x+1,right:f,axis:A,minLng:d.axis===0?b:d.minLng,minLat:d.axis===1?M:d.minLat,maxLng:d.maxLng,maxLat:d.maxLat,dist:0};m.dist=Ds(e,i,_,m),w.dist=Ds(e,i,_,w),u.push(m),u.push(w)}for(;u.length&&u.peek().id!=null;){const x=u.pop();if(x.dist>a||(l.push(x.id),l.length===r))return l}d=u.pop()}return l}function Ds(n,e,i,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(n>=s&&n<=a)return e<l?Se((e-l)*oe):e>u?Se((e-u)*oe):0;const d=Math.min(Se((n-s)*oe),Se((n-a)*oe)),_=Tc(e,d);return _>l&&_<u?xn(d,i,e,_):Math.min(xn(d,i,e,l),xn(d,i,e,u))}function Ec(n,e){return n.dist-e.dist}function Se(n){const e=Math.sin(n/2);return e*e}function xn(n,e,i,r){return e*Math.cos(r*oe)*n+Se((i-r)*oe)}function Is(n,e,i,r,s){const a=Se((n-i)*oe);return xn(a,s,e,r)}function Tc(n,e){const i=1-2*e;return i<=0?n>0?90:-90:Math.atan(Math.tan(n*oe)/i)/oe}class Dc{constructor(e){this.useCache=!0,this.points=[],this.routeCache={},this.useCache=e.useCache||!0,this.network=e.network,this.routeFinder=e.routeFinder,this.network.features.forEach(i=>{i.geometry.coordinates.forEach(r=>{this.points.push(r)})}),this.indexedNetworkPoints=new Lc(this.points.length),this.points.forEach(i=>{this.indexedNetworkPoints.add(i[0],i[1])}),this.indexedNetworkPoints.finish()}getClosestNetworkCoordinate(e){const i=kc(this.indexedNetworkPoints,e[0],e[1],1),r=this.points[i[0]];return r||null}getRoute(e,i){if(this.useCache){const l=`${e}-${i}`;if(this.routeCache[l])return this.routeCache[l]}const r={type:"Feature",geometry:{type:"Point",coordinates:e},properties:{}},s={type:"Feature",geometry:{type:"Point",coordinates:i},properties:{}},a=this.routeFinder.getRoute(r,s);if(this.useCache){const l=`${e}-${i}`;return this.routeCache[l]=a,a}return a}}const{TerraDrawBaseDrawMode:Ic}=bc;class Bc extends Ic{constructor(e){if(super(e),this.mode="routesnap",this.currentCoordinate=0,this.currentPointIds=[],this.routeId=0,this.pixelDistance=(i,r)=>{const{x:s,y:a}=i,{x:l,y:u}=r,d=l-s,_=u-a;return Math.sqrt(_*_+d*d)},this.routing=e.routing,this.maxPoints=e.maxPoints||1,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const i={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?{...i,...e.keyEvents}:i}}measure(e,i){const{x:r,y:s}=this.project(i[0],i[1]);return this.pixelDistance({x:r,y:s},{x:e.containerX,y:e.containerY})}close(){this.currentId&&(this.currentCoordinate=0,this.currentId=void 0,this.currentPointIds=[],this.state==="drawing"&&this.setStarted())}registerBehaviors(e){}start(){this.setStarted(),this.setCursor("crosshair")}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(e){if(this.setCursor("crosshair"),!this.currentId||this.currentCoordinate===0)return;if(this.currentId){const u=this.store.getGeometryCopy(this.currentId);if(this.measure(e,u.coordinates[u.coordinates.length-1])<this.pointerDistance){this.setCursor("pointer"),this.moveLineId&&(this.store.delete([this.moveLineId]),this.moveLineId=void 0);return}}const i=this.store.getGeometryCopy(this.currentId),r=[e.lng,e.lat];let s=this.routing.getClosestNetworkCoordinate(r);if(!s)return;const a=i.coordinates.length-1,l=this.routing.getRoute(i.coordinates[a],s);if(l)if(this.moveLineId)this.store.updateGeometry([{id:this.moveLineId,geometry:l.geometry}]);else{const[u]=this.store.create([{geometry:l.geometry,properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.moveLineId=u}}onClick(e){if(e.button==="right")return;this.setCursor("pointer");const i=[e.lng,e.lat];if(this.currentId){const s=this.store.getGeometryCopy(this.currentId);if(this.measure(e,s.coordinates[s.coordinates.length-1])<this.pointerDistance){this.currentCoordinate===1&&this.store.delete(this.currentPointIds),this.close();return}}else this.routeId++;let r=this.routing.getClosestNetworkCoordinate(i);if(this.currentCoordinate===0){if(r){const[s,a]=this.store.create([{geometry:{type:"LineString",coordinates:[r]},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}},{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentId=s,this.currentPointIds.push(a),this.currentCoordinate++,this.state==="started"&&this.setDrawing()}}else if(this.currentCoordinate===1&&this.currentId&&r){const s=this.store.getGeometryCopy(this.currentId),a=this.routing.getRoute(s.coordinates[0],r);if(a){this.store.updateGeometry([{id:this.currentId,geometry:a==null?void 0:a.geometry}]);const[l]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentCoordinate=2,this.currentPointIds.push(l)}if(this.maxPoints===1){this.close();return}}else if(this.currentCoordinate>1&&this.currentId&&r&&this.currentCoordinate<=this.maxPoints){const s=this.store.getGeometryCopy(this.currentId),a=s.coordinates.length-1,l=this.routing.getRoute(s.coordinates[a],r);if(l){const u={...s,coordinates:[...s.coordinates,...l.geometry.coordinates]};this.store.updateGeometry([{id:this.currentId,geometry:u}]);const[d]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.maxPoints===this.currentCoordinate?this.close():(this.currentCoordinate++,this.currentPointIds.push(d))}}}onKeyDown(){}onKeyUp(e){e.key===this.keyEvents.cancel&&this.cleanUp(),e.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){try{this.currentId&&this.store.delete([this.currentId,...this.currentPointIds])}catch{}this.currentId=void 0,this.moveLineId=void 0,this.currentCoordinate=0,this.state==="drawing"&&this.setStarted()}styleFeature(e){const i={polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#B90E0A",pointOutlineColor:"#ffffff",pointOutlineWidth:2,pointWidth:5,lineStringColor:"#B90E0A",lineStringWidth:4,zIndex:0};return e.type==="Feature"&&e.geometry.type==="LineString"&&e.properties.mode===this.mode?(i.lineStringColor=this.getHexColorStylingValue(this.styles.lineStringColor,"#B90E0A",e),i.zIndex=10,i.lineStringWidth=this.getNumericStylingValue(this.styles.lineStringWidth,4,e),i):(e.type==="Feature"&&e.geometry.type==="Point"&&e.properties.mode===this.mode&&(i.pointColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.routePointOutlineWidth,1,e)),i)}}function Bs(){const n=[[30,60],[190,250],[260,290]],[e,i]=n[Math.floor(Math.random()*n.length)],r=Math.floor(Math.random()*(i-e+1))+e,s=60+Math.random()*20,a=50+Math.random()*10;return zc(r,s,a)}function zc(n,e,i){e/=100,i/=100;const r=l=>(l+n/30)%12,s=e*Math.min(i,1-i),a=l=>Math.round(255*(i-s*Math.max(-1,Math.min(r(l)-3,Math.min(9-r(l),1)))));return`#${[a(0),a(8),a(4)].map(l=>l.toString(16).padStart(2,"0")).join("")}`}function Oc(n,e,i){const r={};return new vc({adapter:new yc({lib:e,map:n,coordinatePrecision:9}),modes:[new qu({modeName:"networkOutline",styles:{polygonOutlineColor:"#d1cfcf",polygonFillColor:"#eeeeee",polygonFillOpacity:.19,polygonOutlineWidth:2}}),new Bc({routing:i,maxPoints:5,styles:{lineStringColor:a=>(r[a.properties.routeId]||(r[a.properties.routeId]=Bs()),r[a.properties.routeId]),routePointColor:a=>(r[a.properties.routeId]||(r[a.properties.routeId]=Bs()),r[a.properties.routeId])}}),new hc({flags:{routesnap:{feature:{coordinates:{}}}}})]})}var Ac=Object.create,Fn=Object.defineProperty,Fc=Object.getOwnPropertyDescriptor,Zc=Object.getOwnPropertyNames,zs=Object.getOwnPropertySymbols,Nc=Object.getPrototypeOf,Xa=Object.prototype.hasOwnProperty,Rc=Object.prototype.propertyIsEnumerable,Os=(n,e,i)=>e in n?Fn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,jc=(n,e)=>{for(var i in e||(e={}))Xa.call(e,i)&&Os(n,i,e[i]);if(zs)for(var i of zs(e))Rc.call(e,i)&&Os(n,i,e[i]);return n},Yc=n=>Fn(n,"__esModule",{value:!0}),Qt=(n,e)=>function(){return e||(0,n[Object.keys(n)[0]])((e={exports:{}}).exports,e),e.exports},Wc=(n,e,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Zc(e))!Xa.call(n,r)&&r!=="default"&&Fn(n,r,{get:()=>e[r],enumerable:!(i=Fc(e,r))||i.enumerable});return n},jt=n=>Wc(Yc(Fn(n!=null?Ac(Nc(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n),ei=(n,e,i)=>new Promise((r,s)=>{var a=d=>{try{u(i.next(d))}catch(_){s(_)}},l=d=>{try{u(i.throw(d))}catch(_){s(_)}},u=d=>d.done?r(d.value):Promise.resolve(d.value).then(a,l);u((i=i.apply(n,e)).next())}),_e=Qt({"node_modules/@mapbox/point-geometry/index.js"(n,e){e.exports=i;function i(r,s){this.x=r,this.y=s}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,a=r.y-this.y;return s*s+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=s,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),a=Math.sin(r),l=s*this.x-a*this.y,u=a*this.x+s*this.y;return this.x=l,this.y=u,this},_rotateAround:function(r,s){var a=Math.cos(r),l=Math.sin(r),u=s.x+a*(this.x-s.x)-l*(this.y-s.y),d=s.y+l*(this.x-s.x)+a*(this.y-s.y);return this.x=u,this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(r){return r instanceof i?r:Array.isArray(r)?new i(r[0],r[1]):r}}}),Va=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(n,e){var i=_e();e.exports=r;function r(d,_,f,g,x){this.properties={},this.extent=f,this.type=0,this._pbf=d,this._geometry=-1,this._keys=g,this._values=x,d.readFields(s,this,_)}function s(d,_,f){d==1?_.id=f.readVarint():d==2?a(f,_):d==3?_.type=f.readVarint():d==4&&(_._geometry=f.pos)}function a(d,_){for(var f=d.readVarint()+d.pos;d.pos<f;){var g=_._keys[d.readVarint()],x=_._values[d.readVarint()];_.properties[g]=x}}r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,f=1,g=0,x=0,b=0,M=[],S;d.pos<_;){if(g<=0){var B=d.readVarint();f=B&7,g=B>>3}if(g--,f===1||f===2)x+=d.readSVarint(),b+=d.readSVarint(),f===1&&(S&&M.push(S),S=[]),S.push(new i(x,b));else if(f===7)S&&S.push(S[0].clone());else throw new Error("unknown command "+f)}return S&&M.push(S),M},r.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,f=1,g=0,x=0,b=0,M=1/0,S=-1/0,B=1/0,A=-1/0;d.pos<_;){if(g<=0){var m=d.readVarint();f=m&7,g=m>>3}if(g--,f===1||f===2)x+=d.readSVarint(),b+=d.readSVarint(),x<M&&(M=x),x>S&&(S=x),b<B&&(B=b),b>A&&(A=b);else if(f!==7)throw new Error("unknown command "+f)}return[M,B,S,A]},r.prototype.toGeoJSON=function(d,_,f){var g=this.extent*Math.pow(2,f),x=this.extent*d,b=this.extent*_,M=this.loadGeometry(),S=r.types[this.type],B,A;function m(k){for(var T=0;T<k.length;T++){var E=k[T],I=180-(E.y+b)*360/g;k[T]=[(E.x+x)*360/g-180,360/Math.PI*Math.atan(Math.exp(I*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(B=0;B<M.length;B++)w[B]=M[B][0];M=w,m(M);break;case 2:for(B=0;B<M.length;B++)m(M[B]);break;case 3:for(M=l(M),B=0;B<M.length;B++)for(A=0;A<M[B].length;A++)m(M[B][A]);break}M.length===1?M=M[0]:S="Multi"+S;var P={type:"Feature",geometry:{type:S,coordinates:M},properties:this.properties};return"id"in this&&(P.id=this.id),P};function l(d){var _=d.length;if(_<=1)return[d];for(var f=[],g,x,b=0;b<_;b++){var M=u(d[b]);M!==0&&(x===void 0&&(x=M<0),x===M<0?(g&&f.push(g),g=[d[b]]):g.push(d[b]))}return g&&f.push(g),f}function u(d){for(var _=0,f=0,g=d.length,x=g-1,b,M;f<g;x=f++)b=d[f],M=d[x],_+=(M.x-b.x)*(b.y+M.y);return _}}}),Ha=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(n,e){var i=Va();e.exports=r;function r(l,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,u),this.length=this._features.length}function s(l,u,d){l===15?u.version=d.readVarint():l===1?u.name=d.readString():l===5?u.extent=d.readVarint():l===2?u._features.push(d.pos):l===3?u._keys.push(d.readString()):l===4&&u._values.push(a(d))}function a(l){for(var u=null,d=l.readVarint()+l.pos;l.pos<d;){var _=l.readVarint()>>3;u=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return u}r.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var u=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,u,this.extent,this._keys,this._values)}}}),Uc=Qt({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(n,e){var i=Ha();e.exports=r;function r(a,l){this.layers=a.readFields(s,{},l)}function s(a,l,u){if(a===3){var d=new i(u,u.readVarint()+u.pos);d.length&&(l[d.name]=d)}}}}),Xc=Qt({"node_modules/@mapbox/vector-tile/index.js"(n,e){e.exports.VectorTile=Uc(),e.exports.VectorTileFeature=Va(),e.exports.VectorTileLayer=Ha()}}),Vc=Qt({"node_modules/ieee754/index.js"(n){n.read=function(e,i,r,s,a){var l,u,d=a*8-s-1,_=(1<<d)-1,f=_>>1,g=-7,x=r?a-1:0,b=r?-1:1,M=e[i+x];for(x+=b,l=M&(1<<-g)-1,M>>=-g,g+=d;g>0;l=l*256+e[i+x],x+=b,g-=8);for(u=l&(1<<-g)-1,l>>=-g,g+=s;g>0;u=u*256+e[i+x],x+=b,g-=8);if(l===0)l=1-f;else{if(l===_)return u?NaN:(M?-1:1)*(1/0);u=u+Math.pow(2,s),l=l-f}return(M?-1:1)*u*Math.pow(2,l-s)},n.write=function(e,i,r,s,a,l){var u,d,_,f=l*8-a-1,g=(1<<f)-1,x=g>>1,b=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=s?0:l-1,S=s?1:-1,B=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(d=isNaN(i)?1:0,u=g):(u=Math.floor(Math.log(i)/Math.LN2),i*(_=Math.pow(2,-u))<1&&(u--,_*=2),u+x>=1?i+=b/_:i+=b*Math.pow(2,1-x),i*_>=2&&(u++,_/=2),u+x>=g?(d=0,u=g):u+x>=1?(d=(i*_-1)*Math.pow(2,a),u=u+x):(d=i*Math.pow(2,x-1)*Math.pow(2,a),u=0));a>=8;e[r+M]=d&255,M+=S,d/=256,a-=8);for(u=u<<a|d,f+=a;f>0;e[r+M]=u&255,M+=S,u/=256,f-=8);e[r+M-S]|=B*128}}}),Hc=Qt({"node_modules/pbf/index.js"(n,e){e.exports=r;var i=Vc();function r(v){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(v)?v:new Uint8Array(v||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=65536*65536,a=1/s,l=12,u=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(v,D,z){for(z=z||this.length;this.pos<z;){var V=this.readVarint(),R=V>>3,K=this.pos;this.type=V&7,v(R,D,this),this.pos===K&&this.skip(V)}return D},readMessage:function(v,D){return this.readFields(v,D,this.readVarint()+this.pos)},readFixed32:function(){var v=I(this.buf,this.pos);return this.pos+=4,v},readSFixed32:function(){var v=j(this.buf,this.pos);return this.pos+=4,v},readFixed64:function(){var v=I(this.buf,this.pos)+I(this.buf,this.pos+4)*s;return this.pos+=8,v},readSFixed64:function(){var v=I(this.buf,this.pos)+j(this.buf,this.pos+4)*s;return this.pos+=8,v},readFloat:function(){var v=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,v},readDouble:function(){var v=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,v},readVarint:function(v){var D=this.buf,z,V;return V=D[this.pos++],z=V&127,V<128||(V=D[this.pos++],z|=(V&127)<<7,V<128)||(V=D[this.pos++],z|=(V&127)<<14,V<128)||(V=D[this.pos++],z|=(V&127)<<21,V<128)?z:(V=D[this.pos],z|=(V&15)<<28,d(z,v,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var v=this.readVarint();return v%2===1?(v+1)/-2:v/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var v=this.readVarint()+this.pos,D=this.pos;return this.pos=v,v-D>=l&&u?X(this.buf,D,v):Y(this.buf,D,v)},readBytes:function(){var v=this.readVarint()+this.pos,D=this.buf.subarray(this.pos,v);return this.pos=v,D},readPackedVarint:function(v,D){if(this.type!==r.Bytes)return v.push(this.readVarint(D));var z=_(this);for(v=v||[];this.pos<z;)v.push(this.readVarint(D));return v},readPackedSVarint:function(v){if(this.type!==r.Bytes)return v.push(this.readSVarint());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readSVarint());return v},readPackedBoolean:function(v){if(this.type!==r.Bytes)return v.push(this.readBoolean());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readBoolean());return v},readPackedFloat:function(v){if(this.type!==r.Bytes)return v.push(this.readFloat());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readFloat());return v},readPackedDouble:function(v){if(this.type!==r.Bytes)return v.push(this.readDouble());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readDouble());return v},readPackedFixed32:function(v){if(this.type!==r.Bytes)return v.push(this.readFixed32());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readFixed32());return v},readPackedSFixed32:function(v){if(this.type!==r.Bytes)return v.push(this.readSFixed32());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readSFixed32());return v},readPackedFixed64:function(v){if(this.type!==r.Bytes)return v.push(this.readFixed64());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readFixed64());return v},readPackedSFixed64:function(v){if(this.type!==r.Bytes)return v.push(this.readSFixed64());var D=_(this);for(v=v||[];this.pos<D;)v.push(this.readSFixed64());return v},skip:function(v){var D=v&7;if(D===r.Varint)for(;this.buf[this.pos++]>127;);else if(D===r.Bytes)this.pos=this.readVarint()+this.pos;else if(D===r.Fixed32)this.pos+=4;else if(D===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+D)},writeTag:function(v,D){this.writeVarint(v<<3|D)},realloc:function(v){for(var D=this.length||16;D<this.pos+v;)D*=2;if(D!==this.length){var z=new Uint8Array(D);z.set(this.buf),this.buf=z,this.length=D}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(v){this.realloc(4),N(this.buf,v,this.pos),this.pos+=4},writeSFixed32:function(v){this.realloc(4),N(this.buf,v,this.pos),this.pos+=4},writeFixed64:function(v){this.realloc(8),N(this.buf,v&-1,this.pos),N(this.buf,Math.floor(v*a),this.pos+4),this.pos+=8},writeSFixed64:function(v){this.realloc(8),N(this.buf,v&-1,this.pos),N(this.buf,Math.floor(v*a),this.pos+4),this.pos+=8},writeVarint:function(v){if(v=+v||0,v>268435455||v<0){g(v,this);return}this.realloc(4),this.buf[this.pos++]=v&127|(v>127?128:0),!(v<=127)&&(this.buf[this.pos++]=(v>>>=7)&127|(v>127?128:0),!(v<=127)&&(this.buf[this.pos++]=(v>>>=7)&127|(v>127?128:0),!(v<=127)&&(this.buf[this.pos++]=v>>>7&127)))},writeSVarint:function(v){this.writeVarint(v<0?-v*2-1:v*2)},writeBoolean:function(v){this.writeVarint(!!v)},writeString:function(v){v=String(v),this.realloc(v.length*4),this.pos++;var D=this.pos;this.pos=U(this.buf,v,this.pos);var z=this.pos-D;z>=128&&M(D,z,this),this.pos=D-1,this.writeVarint(z),this.pos+=z},writeFloat:function(v){this.realloc(4),i.write(this.buf,v,this.pos,!0,23,4),this.pos+=4},writeDouble:function(v){this.realloc(8),i.write(this.buf,v,this.pos,!0,52,8),this.pos+=8},writeBytes:function(v){var D=v.length;this.writeVarint(D),this.realloc(D);for(var z=0;z<D;z++)this.buf[this.pos++]=v[z]},writeRawMessage:function(v,D){this.pos++;var z=this.pos;v(D,this);var V=this.pos-z;V>=128&&M(z,V,this),this.pos=z-1,this.writeVarint(V),this.pos+=V},writeMessage:function(v,D,z){this.writeTag(v,r.Bytes),this.writeRawMessage(D,z)},writePackedVarint:function(v,D){D.length&&this.writeMessage(v,S,D)},writePackedSVarint:function(v,D){D.length&&this.writeMessage(v,B,D)},writePackedBoolean:function(v,D){D.length&&this.writeMessage(v,w,D)},writePackedFloat:function(v,D){D.length&&this.writeMessage(v,A,D)},writePackedDouble:function(v,D){D.length&&this.writeMessage(v,m,D)},writePackedFixed32:function(v,D){D.length&&this.writeMessage(v,P,D)},writePackedSFixed32:function(v,D){D.length&&this.writeMessage(v,k,D)},writePackedFixed64:function(v,D){D.length&&this.writeMessage(v,T,D)},writePackedSFixed64:function(v,D){D.length&&this.writeMessage(v,E,D)},writeBytesField:function(v,D){this.writeTag(v,r.Bytes),this.writeBytes(D)},writeFixed32Field:function(v,D){this.writeTag(v,r.Fixed32),this.writeFixed32(D)},writeSFixed32Field:function(v,D){this.writeTag(v,r.Fixed32),this.writeSFixed32(D)},writeFixed64Field:function(v,D){this.writeTag(v,r.Fixed64),this.writeFixed64(D)},writeSFixed64Field:function(v,D){this.writeTag(v,r.Fixed64),this.writeSFixed64(D)},writeVarintField:function(v,D){this.writeTag(v,r.Varint),this.writeVarint(D)},writeSVarintField:function(v,D){this.writeTag(v,r.Varint),this.writeSVarint(D)},writeStringField:function(v,D){this.writeTag(v,r.Bytes),this.writeString(D)},writeFloatField:function(v,D){this.writeTag(v,r.Fixed32),this.writeFloat(D)},writeDoubleField:function(v,D){this.writeTag(v,r.Fixed64),this.writeDouble(D)},writeBooleanField:function(v,D){this.writeVarintField(v,!!D)}};function d(v,D,z){var V=z.buf,R,K;if(K=V[z.pos++],R=(K&112)>>4,K<128||(K=V[z.pos++],R|=(K&127)<<3,K<128)||(K=V[z.pos++],R|=(K&127)<<10,K<128)||(K=V[z.pos++],R|=(K&127)<<17,K<128)||(K=V[z.pos++],R|=(K&127)<<24,K<128)||(K=V[z.pos++],R|=(K&1)<<31,K<128))return f(v,R,D);throw new Error("Expected varint not more than 10 bytes")}function _(v){return v.type===r.Bytes?v.readVarint()+v.pos:v.pos+1}function f(v,D,z){return z?D*4294967296+(v>>>0):(D>>>0)*4294967296+(v>>>0)}function g(v,D){var z,V;if(v>=0?(z=v%4294967296|0,V=v/4294967296|0):(z=~(-v%4294967296),V=~(-v/4294967296),z^4294967295?z=z+1|0:(z=0,V=V+1|0)),v>=18446744073709552e3||v<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");D.realloc(10),x(z,V,D),b(V,D)}function x(v,D,z){z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos++]=v&127|128,v>>>=7,z.buf[z.pos]=v&127}function b(v,D){var z=(v&7)<<4;D.buf[D.pos++]|=z|((v>>>=3)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127|((v>>>=7)?128:0),v&&(D.buf[D.pos++]=v&127)))))}function M(v,D,z){var V=D<=16383?1:D<=2097151?2:D<=268435455?3:Math.floor(Math.log(D)/(Math.LN2*7));z.realloc(V);for(var R=z.pos-1;R>=v;R--)z.buf[R+V]=z.buf[R]}function S(v,D){for(var z=0;z<v.length;z++)D.writeVarint(v[z])}function B(v,D){for(var z=0;z<v.length;z++)D.writeSVarint(v[z])}function A(v,D){for(var z=0;z<v.length;z++)D.writeFloat(v[z])}function m(v,D){for(var z=0;z<v.length;z++)D.writeDouble(v[z])}function w(v,D){for(var z=0;z<v.length;z++)D.writeBoolean(v[z])}function P(v,D){for(var z=0;z<v.length;z++)D.writeFixed32(v[z])}function k(v,D){for(var z=0;z<v.length;z++)D.writeSFixed32(v[z])}function T(v,D){for(var z=0;z<v.length;z++)D.writeFixed64(v[z])}function E(v,D){for(var z=0;z<v.length;z++)D.writeSFixed64(v[z])}function I(v,D){return(v[D]|v[D+1]<<8|v[D+2]<<16)+v[D+3]*16777216}function N(v,D,z){v[z]=D,v[z+1]=D>>>8,v[z+2]=D>>>16,v[z+3]=D>>>24}function j(v,D){return(v[D]|v[D+1]<<8|v[D+2]<<16)+(v[D+3]<<24)}function Y(v,D,z){for(var V="",R=D;R<z;){var K=v[R],Z=null,H=K>239?4:K>223?3:K>191?2:1;if(R+H>z)break;var G,nt,Q;H===1?K<128&&(Z=K):H===2?(G=v[R+1],(G&192)===128&&(Z=(K&31)<<6|G&63,Z<=127&&(Z=null))):H===3?(G=v[R+1],nt=v[R+2],(G&192)===128&&(nt&192)===128&&(Z=(K&15)<<12|(G&63)<<6|nt&63,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):H===4&&(G=v[R+1],nt=v[R+2],Q=v[R+3],(G&192)===128&&(nt&192)===128&&(Q&192)===128&&(Z=(K&15)<<18|(G&63)<<12|(nt&63)<<6|Q&63,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,H=1):Z>65535&&(Z-=65536,V+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|Z&1023),V+=String.fromCharCode(Z),R+=H}return V}function X(v,D,z){return u.decode(v.subarray(D,z))}function U(v,D,z){for(var V=0,R,K;V<D.length;V++){if(R=D.charCodeAt(V),R>55295&&R<57344)if(K)if(R<56320){v[z++]=239,v[z++]=191,v[z++]=189,K=R;continue}else R=K-55296<<10|R-56320|65536,K=null;else{R>56319||V+1===D.length?(v[z++]=239,v[z++]=191,v[z++]=189):K=R;continue}else K&&(v[z++]=239,v[z++]=191,v[z++]=189,K=null);R<128?v[z++]=R:(R<2048?v[z++]=R>>6|192:(R<65536?v[z++]=R>>12|224:(v[z++]=R>>18|240,v[z++]=R>>12&63|128),v[z++]=R>>6&63|128),v[z++]=R&63|128)}return z}}}),Gc=Qt({"node_modules/rbush/rbush.min.js"(n,e){(function(i,r){typeof n=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(i=i||self).RBush=r()})(n,function(){function i(m,w,P,k,T){(function E(I,N,j,Y,X){for(;Y>j;){if(Y-j>600){var U=Y-j+1,v=N-j+1,D=Math.log(U),z=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*z*(U-z)/U)*(v-U/2<0?-1:1),R=Math.max(j,Math.floor(N-v*z/U+V)),K=Math.min(Y,Math.floor(N+(U-v)*z/U+V));E(I,N,R,K,X)}var Z=I[N],H=j,G=Y;for(r(I,j,N),X(I[Y],Z)>0&&r(I,j,Y);H<G;){for(r(I,H,G),H++,G--;X(I[H],Z)<0;)H++;for(;X(I[G],Z)>0;)G--}X(I[j],Z)===0?r(I,j,G):r(I,++G,Y),G<=N&&(j=G+1),N<=G&&(Y=G-1)}})(m,w,P||0,k||m.length-1,T||s)}function r(m,w,P){var k=m[w];m[w]=m[P],m[P]=k}function s(m,w){return m<w?-1:m>w?1:0}var a=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(m,w,P){if(!P)return w.indexOf(m);for(var k=0;k<w.length;k++)if(P(m,w[k]))return k;return-1}function u(m,w){d(m,0,m.children.length,w,m)}function d(m,w,P,k,T){T||(T=B(null)),T.minX=1/0,T.minY=1/0,T.maxX=-1/0,T.maxY=-1/0;for(var E=w;E<P;E++){var I=m.children[E];_(T,m.leaf?k(I):I)}return T}function _(m,w){return m.minX=Math.min(m.minX,w.minX),m.minY=Math.min(m.minY,w.minY),m.maxX=Math.max(m.maxX,w.maxX),m.maxY=Math.max(m.maxY,w.maxY),m}function f(m,w){return m.minX-w.minX}function g(m,w){return m.minY-w.minY}function x(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function b(m){return m.maxX-m.minX+(m.maxY-m.minY)}function M(m,w){return m.minX<=w.minX&&m.minY<=w.minY&&w.maxX<=m.maxX&&w.maxY<=m.maxY}function S(m,w){return w.minX<=m.maxX&&w.minY<=m.maxY&&w.maxX>=m.minX&&w.maxY>=m.minY}function B(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function A(m,w,P,k,T){for(var E=[w,P];E.length;)if(!((P=E.pop())-(w=E.pop())<=k)){var I=w+Math.ceil((P-w)/k/2)*k;i(m,I,w,P,T),E.push(w,I,I,P)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(m){var w=this.data,P=[];if(!S(m,w))return P;for(var k=this.toBBox,T=[];w;){for(var E=0;E<w.children.length;E++){var I=w.children[E],N=w.leaf?k(I):I;S(m,N)&&(w.leaf?P.push(I):M(m,N)?this._all(I,P):T.push(I))}w=T.pop()}return P},a.prototype.collides=function(m){var w=this.data;if(!S(m,w))return!1;for(var P=[];w;){for(var k=0;k<w.children.length;k++){var T=w.children[k],E=w.leaf?this.toBBox(T):T;if(S(m,E)){if(w.leaf||M(m,E))return!0;P.push(T)}}w=P.pop()}return!1},a.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var w=0;w<m.length;w++)this.insert(m[w]);return this}var P=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===P.height)this._splitRoot(this.data,P);else{if(this.data.height<P.height){var k=this.data;this.data=P,P=k}this._insert(P,this.data.height-P.height-1,!0)}else this.data=P;return this},a.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},a.prototype.clear=function(){return this.data=B([]),this},a.prototype.remove=function(m,w){if(!m)return this;for(var P,k,T,E=this.data,I=this.toBBox(m),N=[],j=[];E||N.length;){if(E||(E=N.pop(),k=N[N.length-1],P=j.pop(),T=!0),E.leaf){var Y=l(m,E.children,w);if(Y!==-1)return E.children.splice(Y,1),N.push(E),this._condense(N),this}T||E.leaf||!M(E,I)?k?(P++,E=k.children[P],T=!1):E=null:(N.push(E),j.push(P),P=0,k=E,E=E.children[0])}return this},a.prototype.toBBox=function(m){return m},a.prototype.compareMinX=function(m,w){return m.minX-w.minX},a.prototype.compareMinY=function(m,w){return m.minY-w.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(m){return this.data=m,this},a.prototype._all=function(m,w){for(var P=[];m;)m.leaf?w.push.apply(w,m.children):P.push.apply(P,m.children),m=P.pop();return w},a.prototype._build=function(m,w,P,k){var T,E=P-w+1,I=this._maxEntries;if(E<=I)return u(T=B(m.slice(w,P+1)),this.toBBox),T;k||(k=Math.ceil(Math.log(E)/Math.log(I)),I=Math.ceil(E/Math.pow(I,k-1))),(T=B([])).leaf=!1,T.height=k;var N=Math.ceil(E/I),j=N*Math.ceil(Math.sqrt(I));A(m,w,P,j,this.compareMinX);for(var Y=w;Y<=P;Y+=j){var X=Math.min(Y+j-1,P);A(m,Y,X,N,this.compareMinY);for(var U=Y;U<=X;U+=N){var v=Math.min(U+N-1,X);T.children.push(this._build(m,U,v,k-1))}}return u(T,this.toBBox),T},a.prototype._chooseSubtree=function(m,w,P,k){for(;k.push(w),!w.leaf&&k.length-1!==P;){for(var T=1/0,E=1/0,I=void 0,N=0;N<w.children.length;N++){var j=w.children[N],Y=x(j),X=(U=m,v=j,(Math.max(v.maxX,U.maxX)-Math.min(v.minX,U.minX))*(Math.max(v.maxY,U.maxY)-Math.min(v.minY,U.minY))-Y);X<E?(E=X,T=Y<T?Y:T,I=j):X===E&&Y<T&&(T=Y,I=j)}w=I||w.children[0]}var U,v;return w},a.prototype._insert=function(m,w,P){var k=P?m:this.toBBox(m),T=[],E=this._chooseSubtree(k,this.data,w,T);for(E.children.push(m),_(E,k);w>=0&&T[w].children.length>this._maxEntries;)this._split(T,w),w--;this._adjustParentBBoxes(k,T,w)},a.prototype._split=function(m,w){var P=m[w],k=P.children.length,T=this._minEntries;this._chooseSplitAxis(P,T,k);var E=this._chooseSplitIndex(P,T,k),I=B(P.children.splice(E,P.children.length-E));I.height=P.height,I.leaf=P.leaf,u(P,this.toBBox),u(I,this.toBBox),w?m[w-1].children.push(I):this._splitRoot(P,I)},a.prototype._splitRoot=function(m,w){this.data=B([m,w]),this.data.height=m.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(m,w,P){for(var k,T,E,I,N,j,Y,X=1/0,U=1/0,v=w;v<=P-w;v++){var D=d(m,0,v,this.toBBox),z=d(m,v,P,this.toBBox),V=(T=D,E=z,I=void 0,N=void 0,j=void 0,Y=void 0,I=Math.max(T.minX,E.minX),N=Math.max(T.minY,E.minY),j=Math.min(T.maxX,E.maxX),Y=Math.min(T.maxY,E.maxY),Math.max(0,j-I)*Math.max(0,Y-N)),R=x(D)+x(z);V<X?(X=V,k=v,U=R<U?R:U):V===X&&R<U&&(U=R,k=v)}return k||P-w},a.prototype._chooseSplitAxis=function(m,w,P){var k=m.leaf?this.compareMinX:f,T=m.leaf?this.compareMinY:g;this._allDistMargin(m,w,P,k)<this._allDistMargin(m,w,P,T)&&m.children.sort(k)},a.prototype._allDistMargin=function(m,w,P,k){m.children.sort(k);for(var T=this.toBBox,E=d(m,0,w,T),I=d(m,P-w,P,T),N=b(E)+b(I),j=w;j<P-w;j++){var Y=m.children[j];_(E,m.leaf?T(Y):Y),N+=b(E)}for(var X=P-w-1;X>=w;X--){var U=m.children[X];_(I,m.leaf?T(U):U),N+=b(I)}return N},a.prototype._adjustParentBBoxes=function(m,w,P){for(var k=P;k>=0;k--)_(w[k],m)},a.prototype._condense=function(m){for(var w=m.length-1,P=void 0;w>=0;w--)m[w].children.length===0?w>0?(P=m[w-1].children).splice(P.indexOf(m[w]),1):this.clear():u(m[w],this.toBBox)},a})}}),$c=Qt({"src/types/unitbezier.d.ts"(){}}),qc=Qt({"node_modules/tinyqueue/tinyqueue.js"(n,e){(function(i,r){typeof n=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(i=i||self,i.TinyQueue=r())})(n,function(){var i=function(a,l){if(a===void 0&&(a=[]),l===void 0&&(l=r),this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};i.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var a=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),a}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(a){for(var l=this,u=l.data,d=l.compare,_=u[a];a>0;){var f=a-1>>1,g=u[f];if(d(_,g)>=0)break;u[a]=g,a=f}u[a]=_},i.prototype._down=function(a){for(var l=this,u=l.data,d=l.compare,_=this.length>>1,f=u[a];a<_;){var g=(a<<1)+1,x=u[g],b=g+1;if(b<this.length&&d(u[b],x)<0&&(g=b,x=u[b]),d(x,f)>=0)break;u[a]=x,a=g}u[a]=f};function r(s,a){return s<a?-1:s>a?1:0}return i})}}),Kc=Qt({"node_modules/polylabel/polylabel.js"(n,e){var i=qc();i.default&&(i=i.default),e.exports=r,e.exports.default=r;function r(_,f,g){f=f||1;for(var x,b,M,S,B=0;B<_[0].length;B++){var A=_[0][B];(!B||A[0]<x)&&(x=A[0]),(!B||A[1]<b)&&(b=A[1]),(!B||A[0]>M)&&(M=A[0]),(!B||A[1]>S)&&(S=A[1])}var m=M-x,w=S-b,P=Math.min(m,w),k=P/2;if(P===0){var T=[x,b];return T.distance=0,T}for(var E=new i(void 0,s),I=x;I<M;I+=P)for(var N=b;N<S;N+=P)E.push(new a(I+k,N+k,k,_));var j=u(_),Y=new a(x+m/2,b+w/2,0,_);Y.d>j.d&&(j=Y);for(var X=E.length;E.length;){var U=E.pop();U.d>j.d&&(j=U,g&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,X)),!(U.max-j.d<=f)&&(k=U.h/2,E.push(new a(U.x-k,U.y-k,k,_)),E.push(new a(U.x+k,U.y-k,k,_)),E.push(new a(U.x-k,U.y+k,k,_)),E.push(new a(U.x+k,U.y+k,k,_)),X+=4)}g&&(console.log("num probes: "+X),console.log("best distance: "+j.d));var v=[j.x,j.y];return v.distance=j.d,v}function s(_,f){return f.max-_.max}function a(_,f,g,x){this.x=_,this.y=f,this.h=g,this.d=l(_,f,x),this.max=this.d+this.h*Math.SQRT2}function l(_,f,g){for(var x=!1,b=1/0,M=0;M<g.length;M++)for(var S=g[M],B=0,A=S.length,m=A-1;B<A;m=B++){var w=S[B],P=S[m];w[1]>f!=P[1]>f&&_<(P[0]-w[0])*(f-w[1])/(P[1]-w[1])+w[0]&&(x=!x),b=Math.min(b,d(_,f,w,P))}return b===0?0:(x?1:-1)*Math.sqrt(b)}function u(_){for(var f=0,g=0,x=0,b=_[0],M=0,S=b.length,B=S-1;M<S;B=M++){var A=b[M],m=b[B],w=A[0]*m[1]-m[0]*A[1];g+=(A[0]+m[0])*w,x+=(A[1]+m[1])*w,f+=w*3}return f===0?new a(b[0][0],b[0][1],0,_):new a(g/f,x/f,0,_)}function d(_,f,g,x){var b=g[0],M=g[1],S=x[0]-b,B=x[1]-M;if(S!==0||B!==0){var A=((_-b)*S+(f-M)*B)/(S*S+B*B);A>1?(b=x[0],M=x[1]):A>0&&(b+=S*A,M+=B*A)}return S=_-b,B=f-M,S*S+B*B}}});jt(_e());var Ue=jt(_e()),Oi=jt(_e()),Jc=jt(Xc()),Qc=jt(Hc()),Tt=(n,e,i)=>new Promise((r,s)=>{var a=d=>{try{u(i.next(d))}catch(_){s(_)}},l=d=>{try{u(i.throw(d))}catch(_){s(_)}},u=d=>d.done?r(d.value):Promise.resolve(d.value).then(a,l);u((i=i.apply(n,e)).next())}),Rt=Uint8Array,Ke=Uint16Array,Ga=Uint32Array,$a=new Rt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qa=new Rt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),td=new Rt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ka=function(n,e){for(var i=new Ke(31),r=0;r<31;++r)i[r]=e+=1<<n[r-1];for(var s=new Ga(i[30]),r=1;r<30;++r)for(var a=i[r];a<i[r+1];++a)s[a]=a-i[r]<<5|r;return[i,s]},Ja=Ka($a,2),Qa=Ja[0],ed=Ja[1];Qa[28]=258,ed[258]=28;var id=Ka(qa,0),nd=id[0],th=new Ke(32768);for(ut=0;ut<32768;++ut)ce=(ut&43690)>>>1|(ut&21845)<<1,ce=(ce&52428)>>>2|(ce&13107)<<2,ce=(ce&61680)>>>4|(ce&3855)<<4,th[ut]=((ce&65280)>>>8|(ce&255)<<8)>>>1;var ce,ut,Ti=function(n,e,i){for(var r=n.length,s=0,a=new Ke(e);s<r;++s)n[s]&&++a[n[s]-1];var l=new Ke(e);for(s=0;s<e;++s)l[s]=l[s-1]+a[s-1]<<1;var u;{u=new Ke(1<<e);var d=15-e;for(s=0;s<r;++s)if(n[s])for(var _=s<<4|n[s],f=e-n[s],g=l[n[s]-1]++<<f,x=g|(1<<f)-1;g<=x;++g)u[th[g]>>>d]=_}return u},Ri=new Rt(288);for(ut=0;ut<144;++ut)Ri[ut]=8;var ut;for(ut=144;ut<256;++ut)Ri[ut]=9;var ut;for(ut=256;ut<280;++ut)Ri[ut]=7;var ut;for(ut=280;ut<288;++ut)Ri[ut]=8;var ut,eh=new Rt(32);for(ut=0;ut<32;++ut)eh[ut]=5;var ut,rd=Ti(Ri,9),od=Ti(eh,5),wr=function(n){for(var e=n[0],i=1;i<n.length;++i)n[i]>e&&(e=n[i]);return e},Gt=function(n,e,i){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&i},br=function(n,e){var i=e/8|0;return(n[i]|n[i+1]<<8|n[i+2]<<16)>>(e&7)},sd=function(n){return(n+7)/8|0},ad=function(n,e,i){(i==null||i>n.length)&&(i=n.length);var r=new(n.BYTES_PER_ELEMENT==2?Ke:n.BYTES_PER_ELEMENT==4?Ga:Rt)(i-e);return r.set(n.subarray(e,i)),r},hd=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],qt=function(n,e,i){var r=new Error(e||hd[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,qt),!i)throw r;return r},Qr=function(n,e,i){var r=n.length;if(!r||i&&i.f&&!i.l)return e||new Rt(0);var s=!e||i,a=!i||i.i;i||(i={}),e||(e=new Rt(r*3));var l=function($){var ht=e.length;if($>ht){var dt=new Rt(Math.max(ht*2,$));dt.set(e),e=dt}},u=i.f||0,d=i.p||0,_=i.b||0,f=i.l,g=i.d,x=i.m,b=i.n,M=r*8;do{if(!f){u=Gt(n,d,1);var S=Gt(n,d+1,3);if(d+=3,S)if(S==1)f=rd,g=od,x=9,b=5;else if(S==2){var w=Gt(n,d,31)+257,P=Gt(n,d+10,15)+4,k=w+Gt(n,d+5,31)+1;d+=14;for(var T=new Rt(k),E=new Rt(19),I=0;I<P;++I)E[td[I]]=Gt(n,d+I*3,7);d+=P*3;for(var N=wr(E),j=(1<<N)-1,Y=Ti(E,N),I=0;I<k;){var X=Y[Gt(n,d,j)];d+=X&15;var B=X>>>4;if(B<16)T[I++]=B;else{var U=0,v=0;for(B==16?(v=3+Gt(n,d,3),d+=2,U=T[I-1]):B==17?(v=3+Gt(n,d,7),d+=3):B==18&&(v=11+Gt(n,d,127),d+=7);v--;)T[I++]=U}}var D=T.subarray(0,w),z=T.subarray(w);x=wr(D),b=wr(z),f=Ti(D,x),g=Ti(z,b)}else qt(1);else{var B=sd(d)+4,A=n[B-4]|n[B-3]<<8,m=B+A;if(m>r){a&&qt(0);break}s&&l(_+A),e.set(n.subarray(B,m),_),i.b=_+=A,i.p=d=m*8,i.f=u;continue}if(d>M){a&&qt(0);break}}s&&l(_+131072);for(var V=(1<<x)-1,R=(1<<b)-1,K=d;;K=d){var U=f[br(n,d)&V],Z=U>>>4;if(d+=U&15,d>M){a&&qt(0);break}if(U||qt(2),Z<256)e[_++]=Z;else if(Z==256){K=d,f=null;break}else{var H=Z-254;if(Z>264){var I=Z-257,G=$a[I];H=Gt(n,d,(1<<G)-1)+Qa[I],d+=G}var nt=g[br(n,d)&R],Q=nt>>>4;nt||qt(3),d+=nt&15;var z=nd[Q];if(Q>3){var G=qa[Q];z+=br(n,d)&(1<<G)-1,d+=G}if(d>M){a&&qt(0);break}s&&l(_+131072);for(var et=_+H;_<et;_+=4)e[_]=e[_-z],e[_+1]=e[_+1-z],e[_+2]=e[_+2-z],e[_+3]=e[_+3-z];_=et}}i.l=f,i.p=K,i.b=_,i.f=u,f&&(u=1,i.m=x,i.d=g,i.n=b)}while(!u);return _==e.length?e:ad(e,0,_)},ld=new Rt(0),ud=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&qt(6,"invalid gzip data");var e=n[3],i=10;e&4&&(i+=n[10]|(n[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!n[i++]);return i+(e&2)},cd=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},dd=function(n){((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&qt(6,"invalid zlib data"),n[1]&32&&qt(6,"invalid zlib data: preset dictionaries not supported")};function fd(n,e){return Qr(n,e)}function pd(n,e){return Qr(n.subarray(ud(n),-8),new Rt(cd(n)))}function _d(n,e){return Qr((dd(n),n.subarray(2,-4)),e)}function Or(n,e){return n[0]==31&&n[1]==139&&n[2]==8?pd(n):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?fd(n,e):_d(n,e)}var md=typeof TextDecoder<"u"&&new TextDecoder,gd=0;try{md.decode(ld,{stream:!0}),gd=1}catch{}var ih=(n,e)=>n*Math.pow(2,e),xi=(n,e)=>Math.floor(n/Math.pow(2,e)),Bn=(n,e)=>ih(n.getUint16(e+1,!0),8)+n.getUint8(e),nh=(n,e)=>ih(n.getUint32(e+2,!0),16)+n.getUint16(e,!0),vd=(n,e,i,r,s)=>{if(n!=r.getUint8(s))return n-r.getUint8(s);const a=Bn(r,s+1);if(e!=a)return e-a;const l=Bn(r,s+4);return i!=l?i-l:0},yd=(n,e,i,r)=>{const s=rh(n,e|128,i,r);return s?{z:e,x:i,y:r,offset:s[0],length:s[1],is_dir:!0}:null},As=(n,e,i,r)=>{const s=rh(n,e,i,r);return s?{z:e,x:i,y:r,offset:s[0],length:s[1],is_dir:!1}:null},rh=(n,e,i,r)=>{let s=0,a=n.byteLength/17-1;for(;s<=a;){const l=a+s>>1,u=vd(e,i,r,n,l*17);if(u>0)s=l+1;else if(u<0)a=l-1;else return[nh(n,l*17+7),n.getUint32(l*17+13,!0)]}return null},xd=(n,e)=>n.is_dir&&!e.is_dir?1:!n.is_dir&&e.is_dir?-1:n.z!==e.z?n.z-e.z:n.x!==e.x?n.x-e.x:n.y-e.y,oh=(n,e)=>{const i=n.getUint8(e*17);return{z:i&127,x:Bn(n,e*17+1),y:Bn(n,e*17+4),offset:nh(n,e*17+7),length:n.getUint32(e*17+13,!0),is_dir:i>>7===1}},Fs=n=>{const e=[],i=new DataView(n);for(let r=0;r<i.byteLength/17;r++)e.push(oh(i,r));return wd(e)},wd=n=>{n.sort(xd);const e=new ArrayBuffer(17*n.length),i=new Uint8Array(e);for(let r=0;r<n.length;r++){const s=n[r];let a=s.z;s.is_dir&&(a=a|128),i[r*17]=a,i[r*17+1]=s.x&255,i[r*17+2]=s.x>>8&255,i[r*17+3]=s.x>>16&255,i[r*17+4]=s.y&255,i[r*17+5]=s.y>>8&255,i[r*17+6]=s.y>>16&255,i[r*17+7]=s.offset&255,i[r*17+8]=xi(s.offset,8)&255,i[r*17+9]=xi(s.offset,16)&255,i[r*17+10]=xi(s.offset,24)&255,i[r*17+11]=xi(s.offset,32)&255,i[r*17+12]=xi(s.offset,48)&255,i[r*17+13]=s.length&255,i[r*17+14]=s.length>>8&255,i[r*17+15]=s.length>>16&255,i[r*17+16]=s.length>>24&255}return e},bd=(n,e)=>{if(n.byteLength<17)return null;const i=n.byteLength/17,r=oh(n,i-1);if(r.is_dir){const s=r.z,a=e.z-s,l=Math.trunc(e.x/(1<<a)),u=Math.trunc(e.y/(1<<a));return{z:s,x:l,y:u}}return null};function Pd(n){return Tt(this,null,function*(){const e=yield n.getBytes(0,512e3),i=new DataView(e.data),r=i.getUint32(4,!0),s=i.getUint16(8,!0),a=new TextDecoder("utf-8"),l=JSON.parse(a.decode(new DataView(e.data,10,r)));let u=0;l.compression==="gzip"&&(u=2);let d=0;"minzoom"in l&&(d=+l.minzoom);let _=0;"maxzoom"in l&&(_=+l.maxzoom);let f=0,g=0,x=0,b=-180,M=-85,S=180,B=85;if(l.bounds){const m=l.bounds.split(",");b=+m[0],M=+m[1],S=+m[2],B=+m[3]}if(l.center){const m=l.center.split(",");f=+m[0],g=+m[1],x=+m[2]}return{specVersion:i.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:d,maxZoom:_,minLon:b,minLat:M,maxLon:S,maxLat:B,centerZoom:x,centerLon:f,centerLat:g,etag:e.etag}})}function Md(n,e,i,r,s,a,l){return Tt(this,null,function*(){let u=yield i.getArrayBuffer(e,n.rootDirectoryOffset,n.rootDirectoryLength,n);n.specVersion===1&&(u=Fs(u));const d=As(new DataView(u),r,s,a);if(d){let g=(yield e.getBytes(d.offset,d.length,l)).data;const x=new DataView(g);return x.getUint8(0)==31&&x.getUint8(1)==139&&(g=Or(new Uint8Array(g))),{data:g}}const _=bd(new DataView(u),{z:r,x:s,y:a});if(_){const f=yd(new DataView(u),_.z,_.x,_.y);if(f){let g=yield i.getArrayBuffer(e,f.offset,f.length,n);n.specVersion===1&&(g=Fs(g));const x=As(new DataView(g),r,s,a);if(x){let M=(yield e.getBytes(x.offset,x.length,l)).data;const S=new DataView(M);return S.getUint8(0)==31&&S.getUint8(1)==139&&(M=Or(new Uint8Array(M))),{data:M}}}}})}var sh={getHeader:Pd,getZxy:Md};function Xe(n,e){return(e>>>0)*4294967296+(n>>>0)}function Ld(n,e){const i=e.buf;let r,s;if(s=i[e.pos++],r=(s&112)>>4,s<128||(s=i[e.pos++],r|=(s&127)<<3,s<128)||(s=i[e.pos++],r|=(s&127)<<10,s<128)||(s=i[e.pos++],r|=(s&127)<<17,s<128)||(s=i[e.pos++],r|=(s&127)<<24,s<128)||(s=i[e.pos++],r|=(s&1)<<31,s<128))return Xe(n,r);throw new Error("Expected varint not more than 10 bytes")}function wi(n){const e=n.buf;let i,r;return r=e[n.pos++],i=r&127,r<128||(r=e[n.pos++],i|=(r&127)<<7,r<128)||(r=e[n.pos++],i|=(r&127)<<14,r<128)||(r=e[n.pos++],i|=(r&127)<<21,r<128)?i:(r=e[n.pos],i|=(r&15)<<28,Ld(i,n))}function Cd(n,e,i,r){if(r==0){i==1&&(e[0]=n-1-e[0],e[1]=n-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}function Sd(n,e,i){if(n>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,n)-1||i>Math.pow(2,n)-1)throw Error("tile x/y outside zoom level bounds");let r=0,s=0;for(;s<n;)r+=Math.pow(2,s)*Math.pow(2,s),s++;const a=Math.pow(2,n);let l=0,u=0,d=0;const _=[e,i];let f=a/2;for(;f>0;)l=(_[0]&f)>0?1:0,u=(_[1]&f)>0?1:0,d+=f*f*(3*l^u),Cd(f,_,l,u),f=f/2;return r+d}function ah(n,e){return Tt(this,null,function*(){if(e===1||e===0)return n;if(e===2)return Or(new Uint8Array(n));throw Error("Compression method not supported")})}var kd=127;function Ed(n,e){let i=0,r=n.length-1;for(;i<=r;){const s=r+i>>1,a=e-n[s].tileId;if(a>0)i=s+1;else if(a<0)r=s-1;else return n[s]}return r>=0&&(n[r].runLength===0||e-n[r].tileId<n[r].runLength)?n[r]:null}var Td=class{constructor(n){this.url=n}getKey(){return this.url}getBytes(n,e,i){return Tt(this,null,function*(){let r;i||(r=new AbortController,i=r.signal);let s=yield fetch(this.url,{signal:i,headers:{Range:"bytes="+n+"-"+(n+e-1)}});if(s.status===416&&n===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const d=+u.substr(8);s=yield fetch(this.url,{signal:i,headers:{Range:"bytes=0-"+(d-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const a=s.headers.get("Content-Length");if(s.status===200&&(!a||+a>e))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function $t(n,e){const i=n.getUint32(e+4,!0),r=n.getUint32(e+0,!0);return i*Math.pow(2,32)+r}function Dd(n,e){const i=new DataView(n),r=i.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:$t(i,8),rootDirectoryLength:$t(i,16),jsonMetadataOffset:$t(i,24),jsonMetadataLength:$t(i,32),leafDirectoryOffset:$t(i,40),leafDirectoryLength:$t(i,48),tileDataOffset:$t(i,56),tileDataLength:$t(i,64),numAddressedTiles:$t(i,72),numTileEntries:$t(i,80),numTileContents:$t(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:e}}function hh(n){const e={buf:new Uint8Array(n),pos:0},i=wi(e),r=[];let s=0;for(let a=0;a<i;a++){const l=wi(e);r.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let a=0;a<i;a++)r[a].runLength=wi(e);for(let a=0;a<i;a++)r[a].length=wi(e);for(let a=0;a<i;a++){const l=wi(e);l===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=l-1}return r}function Id(n){const e=new DataView(n);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Ge=class extends Error{};function Bd(n,e,i,r){return Tt(this,null,function*(){const s=yield n.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Id(s.data)<3)return[yield sh.getHeader(n)];const l=s.data.slice(0,kd);let u=s.etag;r&&s.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+n.getKey()),u=void 0);const d=Dd(l,u);if(i){const _=s.data.slice(d.rootDirectoryOffset,d.rootDirectoryOffset+d.rootDirectoryLength),f=n.getKey()+"|"+(d.etag||"")+"|"+d.rootDirectoryOffset+"|"+d.rootDirectoryLength,g=hh(yield e(_,d.internalCompression));return[d,[f,g.length,g]]}return[d,void 0]})}function zd(n,e,i,r,s){return Tt(this,null,function*(){const a=yield n.getBytes(i,r);if(s.etag&&s.etag!==a.etag)throw new Ge(a.etag);const l=yield e(a.data,s.internalCompression),u=hh(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Od=class{constructor(n=100,e=!0,i=ah){this.cache=new Map,this.maxCacheEntries=n,this.counter=1,this.prefetch=e,this.decompress=i}getHeader(n,e){return Tt(this,null,function*(){const i=n.getKey();if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;const r=new Promise((s,a)=>{Bd(n,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{a(l)})});return this.cache.set(i,{lastUsed:this.counter++,data:r}),r})}getDirectory(n,e,i,r){return Tt(this,null,function*(){const s=n.getKey()+"|"+(r.etag||"")+"|"+e+"|"+i;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{zd(n,this.decompress,e,i,r).then(d=>{l(d),this.prune()}).catch(d=>{u(d)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}getArrayBuffer(n,e,i,r){return Tt(this,null,function*(){const s=n.getKey()+"|"+(r.etag||"")+"|"+e+"|"+i;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{n.getBytes(e,i).then(d=>{if(r.etag&&r.etag!==d.etag)throw new Ge(d.etag);l(d.data),this.cache.has(s),this.prune()}).catch(d=>{u(d)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let n=1/0,e;this.cache.forEach((i,r)=>{i.lastUsed<n&&(n=i.lastUsed,e=r)}),e&&this.cache.delete(e)}}invalidate(n,e){return Tt(this,null,function*(){this.cache.delete(n.getKey()),yield this.getHeader(n,e)})}},Ad=class{constructor(n,e,i){typeof n=="string"?this.source=new Td(n):this.source=n,i?this.decompress=i:this.decompress=ah,e?this.cache=e:this.cache=new Od}getHeader(){return Tt(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(n,e,i,r){return Tt(this,null,function*(){const s=Sd(n,e,i),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return sh.getZxy(a,this.source,this.cache,n,e,i,r);if(n<a.minZoom||n>a.maxZoom)return;let l=a.rootDirectoryOffset,u=a.rootDirectoryLength;for(let d=0;d<=3;d++){const _=yield this.cache.getDirectory(this.source,l,u,a),f=Ed(_,s);if(f)if(f.runLength>0){const g=yield this.source.getBytes(a.tileDataOffset+f.offset,f.length,r);if(a.etag&&a.etag!==g.etag)throw new Ge(g.etag);return{data:yield this.decompress(g.data,a.tileCompression),cacheControl:g.cacheControl,expires:g.expires}}else l=a.leafDirectoryOffset+f.offset,u=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(n,e,i,r){return Tt(this,null,function*(){try{return yield this.getZxyAttempt(n,e,i,r)}catch(s){if(s instanceof Ge)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(n,e,i,r);throw s}})}getMetadataAttempt(){return Tt(this,null,function*(){const n=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(n.jsonMetadataOffset,n.jsonMetadataLength);if(n.etag&&n.etag!==e.etag)throw new Ge(e.etag);const i=yield this.decompress(e.data,n.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(i))})}getMetadata(){return Tt(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(n){if(n instanceof Ge)return this.cache.invalidate(this.source,n.message),yield this.getMetadataAttempt();throw n}})}},Je;(function(n){n[n.Point=1]="Point",n[n.Line=2]="Line",n[n.Polygon=3]="Polygon"})(Je||(Je={}));function De(n){return n.x+":"+n.y+":"+n.z}var Fd=(n,e,i)=>{n.pos=e;for(var r=n.readVarint()+n.pos,s=1,a=0,l=0,u=0,d=1/0,_=-1/0,f=1/0,g=-1/0,x=[],b=[];n.pos<r;){if(a<=0){var M=n.readVarint();s=M&7,a=M>>3}if(a--,s===1||s===2)l+=n.readSVarint()*i,u+=n.readSVarint()*i,l<d&&(d=l),l>_&&(_=l),u<f&&(f=u),u>g&&(g=u),s===1&&(b.length>0&&x.push(b),b=[]),b.push(new Oi.default(l,u));else if(s===7)b&&b.push(b[0].clone());else throw new Error("unknown command "+s)}return b&&x.push(b),{geom:x,bbox:{minX:d,minY:f,maxX:_,maxY:g}}};function lh(n,e){let i=new Jc.VectorTile(new Qc.default(n)),r=new Map;for(let[s,a]of Object.entries(i.layers)){let l=[],u=a;for(let d=0;d<u.length;d++){let _=Fd(u.feature(d)._pbf,u.feature(d)._geometry,e/u.extent),f=0;for(let g of _.geom)f+=g.length;l.push({id:u.feature(d).id,geomType:u.feature(d).type,geom:_.geom,numVertices:f,bbox:_.bbox,props:u.feature(d).properties})}r.set(s,l)}return r}var Zs=class{constructor(n,e){typeof n=="string"?this.p=new Ad(n):this.p=n,this.controllers=[],this.shouldCancelZooms=e}get(n,e){return ei(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=n.z?(a[1].abort(),!1):!0));const i=new AbortController;this.controllers.push([n.z,i]);const r=i.signal;let s=yield this.p.getZxy(n.z,n.x,n.y,r);return s?lh(s.data,e):new Map})}},Zd=class{constructor(n,e){this.url=n,this.controllers=[],this.shouldCancelZooms=e}get(n,e){return ei(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=n.z?(a[1].abort(),!1):!0));let i=this.url.replace("{z}",n.z.toString()).replace("{x}",n.x.toString()).replace("{y}",n.y.toString());const r=new AbortController;this.controllers.push([n.z,r]);const s=r.signal;return new Promise((a,l)=>{fetch(i,{signal:s}).then(u=>u.arrayBuffer()).then(u=>{let d=lh(u,e);a(d)}).catch(u=>{l(u)})})})}},Ar=6378137,Nd=85.0511287798,pn=Ar*Math.PI,Rd=n=>{let e=Math.PI/180,i=Math.max(Math.min(Nd,n[0]),-85.0511287798),r=Math.sin(i*e);return new Oi.default(Ar*n[1]*e,Ar*Math.log((1+r)/(1-r))/2)};function Ns(n){return n*n}function wn(n,e){return Ns(n.x-e.x)+Ns(n.y-e.y)}function jd(n,e,i){var r=wn(e,i);if(r===0)return wn(n,e);var s=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/r;return s=Math.max(0,Math.min(1,s)),wn(n,new Oi.default(e.x+s*(i.x-e.x),e.y+s*(i.y-e.y)))}function Rs(n,e){for(var i=!1,r=0,s=e.length-1;r<e.length;s=r++){var a=e[r].x,l=e[r].y,u=e[s].x,d=e[s].y,_=l>n.y!=d>n.y&&n.x<(u-a)*(n.y-l)/(d-l)+a;_&&(i=!i)}return i}function Yd(n){for(var e=0,i=0;i<n.length;i++){let r=(i+1)%n.length;e+=n[i].x*n[r].y,e-=n[r].x*n[i].y}return e<0}function Wd(n,e){var i=!1;for(let r of e)if(Yd(r))Rs(n,r)&&(i=!1);else{if(i)return!0;Rs(n,r)&&(i=!0)}return i}function Ud(n,e){let i=1/0;for(let r of e){let s=Math.sqrt(wn(n,r[0]));s<i&&(i=s)}return i}function Xd(n,e){let i=1/0;for(let s of e)for(var r=0;r<s.length-1;r++){let a=Math.sqrt(jd(n,s[r],s[r+1]));a<i&&(i=a)}return i}var Vd=class{constructor(n,e){this.source=n,this.cache=new Map,this.inflight=new Map,this.tileSize=e}queryFeatures(n,e,i,r){let s=Rd([e,n]);var a=new Oi.default((s.x+pn)/(pn*2),1-(s.y+pn)/(pn*2));a.x>1&&(a.x=a.x-Math.floor(a.x));let l=a.mult(1<<i),u=Math.floor(l.x),d=Math.floor(l.y);const _=De({z:i,x:u,y:d});let f=[],g=this.cache.get(_);if(g){const x=new Oi.default((l.x-u)*this.tileSize,(l.y-d)*this.tileSize);for(let[b,M]of g.data.entries())for(let S of M)S.geomType==1?Ud(x,S.geom)<r&&f.push({feature:S,layerName:b}):S.geomType==2?Xd(x,S.geom)<r&&f.push({feature:S,layerName:b}):Wd(x,S.geom)&&f.push({feature:S,layerName:b})}return f}get(n){return ei(this,null,function*(){const e=De(n);return new Promise((i,r)=>{let s=this.cache.get(e);if(s)s.used=performance.now(),i(s.data);else{let a=this.inflight.get(e);a?a.push([i,r]):(this.inflight.set(e,[]),this.source.get(n,this.tileSize).then(l=>{this.cache.set(e,{used:performance.now(),data:l});let u=this.inflight.get(e);if(u&&u.forEach(d=>d[0](l)),this.inflight.delete(e),i(l),this.cache.size>=64){let d=1/0,_;this.cache.forEach((f,g)=>{f.used<d&&(d=f.used,_=g)}),_&&this.cache.delete(_)}}).catch(l=>{let u=this.inflight.get(e);u&&u.forEach(d=>d[1](l)),this.inflight.delete(e),r(l)}))}})})}},uh=(n,e,i)=>{let r=[];for(let s of n){let a=[];for(let l of s)a.push(l.clone().mult(e).add(i));r.push(a)}return r},_n=(n,e)=>{let i=1<<e;return n<0&&(n=i+n),n>=i&&(n=n%i),n},Hd=class{constructor(n,e,i){this.tileCache=n,this.maxDataLevel=e,this.levelDiff=i}dataTilesForBounds(n,e){let i=Math.pow(2,n)/Math.pow(2,Math.ceil(n)),r=[];var s=1,a=this.tileCache.tileSize;if(n<this.levelDiff)s=1/(1<<this.levelDiff-n)*i,r.push({data_tile:{z:0,x:0,y:0},origin:new Ue.default(0,0),scale:s,dim:a*s});else if(n<=this.levelDiff+this.maxDataLevel){let d=1<<this.levelDiff,_=256*i,f=Math.ceil(n)-this.levelDiff,g=Math.floor(e.minX/d/_),x=Math.floor(e.minY/d/_),b=Math.floor(e.maxX/d/_),M=Math.floor(e.maxY/d/_);for(var l=g;l<=b;l++)for(var u=x;u<=M;u++){let S=new Ue.default(l*d*_,u*d*_);r.push({data_tile:{z:f,x:_n(l,f),y:_n(u,f)},origin:S,scale:i,dim:a*i})}}else{let d=1<<this.levelDiff;s=(1<<Math.ceil(n)-this.maxDataLevel-this.levelDiff)*i;let _=Math.floor(e.minX/d/256/s),f=Math.floor(e.minY/d/256/s),g=Math.floor(e.maxX/d/256/s),x=Math.floor(e.maxY/d/256/s);for(var l=_;l<=g;l++)for(var u=f;u<=x;u++){let S=new Ue.default(l*d*256*s,u*d*256*s);r.push({data_tile:{z:this.maxDataLevel,x:_n(l,this.maxDataLevel),y:_n(u,this.maxDataLevel)},origin:S,scale:s,dim:a*s})}}return r}dataTileForDisplayTile(n){var e,i=1,r=this.tileCache.tileSize,s;if(n.z<this.levelDiff)e={z:0,x:0,y:0},i=1/(1<<this.levelDiff-n.z),s=new Ue.default(0,0),r=r*i;else if(n.z<=this.levelDiff+this.maxDataLevel){let a=1<<this.levelDiff;e={z:n.z-this.levelDiff,x:Math.floor(n.x/a),y:Math.floor(n.y/a)},s=new Ue.default(e.x*a*256,e.y*a*256)}else{i=1<<n.z-this.maxDataLevel-this.levelDiff;let a=1<<this.levelDiff;e={z:this.maxDataLevel,x:Math.floor(n.x/a/i),y:Math.floor(n.y/a/i)},s=new Ue.default(e.x*a*i*256,e.y*a*i*256),r=r*i}return{data_tile:e,scale:i,origin:s,dim:r}}getBbox(n,e){return ei(this,null,function*(){let i=this.dataTilesForBounds(n,e);return(yield Promise.all(i.map(s=>this.tileCache.get(s.data_tile)))).map((s,a)=>{let l=i[a];return{data:s,z:n,data_tile:l.data_tile,scale:l.scale,dim:l.dim,origin:l.origin}})})}getDisplayTile(n){return ei(this,null,function*(){let e=this.dataTileForDisplayTile(n);return{data:yield this.tileCache.get(e.data_tile),z:n.z,data_tile:e.data_tile,scale:e.scale,origin:e.origin,dim:e.dim}})}queryFeatures(n,e,i){let r=Math.round(i),s=Math.min(r-this.levelDiff,this.maxDataLevel),a=16/(1<<r-s);return this.tileCache.queryFeatures(n,e,s,a)}},Gd=n=>{let e=r=>{let s=r.levelDiff===void 0?2:r.levelDiff,a=r.maxDataZoom||14,l;typeof r.url=="string"?r.url.endsWith(".pmtiles")?l=new Zs(r.url,!0):l=new Zd(r.url,!0):l=new Zs(r.url,!0);let u=new Vd(l,256*1<<s);return new Hd(u,a,s)},i=new Map;if(n.sources)for(const r in n.sources)i.set(r,e(n.sources[r]));else i.set("",e(n));return i},$d=jt(_e());function qd(n,e,i,r,s,a,l,u,d){let _=performance.now();n.save(),n.miterLimit=2;for(var f of s){if(f.minzoom&&e<f.minzoom||f.maxzoom&&e>f.maxzoom)continue;let M=i.get(f.dataSource||"");if(M)for(let S of M){var g=S.data.get(f.dataLayer);if(g===void 0)continue;f.symbolizer.before&&f.symbolizer.before(n,S.z);let B=S.origin;S.dim;let A=S.scale;n.save(),n.translate(B.x-l.x,B.y-l.y);for(var x of g){let m=x.geom,w=x.bbox;w.maxX*A+B.x<a.minX||w.minX*A+B.x>a.maxX||w.minY*A+B.y>a.maxY||w.maxY*A+B.y<a.minY||f.filter&&!f.filter(S.z,x)||(A!=1&&(m=uh(m,A,new $d.default(0,0))),f.symbolizer.draw(n,m,S.z,x))}n.restore()}}if(r){let M=r.searchBbox(a,1/0);for(var b of M)if(n.save(),n.translate(b.anchor.x-l.x,b.anchor.y-l.y),b.draw(n),n.restore(),d){n.lineWidth=.5,n.strokeStyle=d,n.fillStyle=d,n.globalAlpha=1,n.fillRect(b.anchor.x-l.x-2,b.anchor.y-l.y-2,4,4);for(let S of b.bboxes)n.strokeRect(S.minX-l.x,S.minY-l.y,S.maxX-S.minX,S.maxY-S.minY)}}return n.restore(),performance.now()-_}var Kd=jt(_e()),Jd=jt(Gc()),Qd=(n,e,i)=>{let r=256,s=e/r,a=Math.floor(i.minX/r),l=Math.floor(i.minY/r),u=Math.floor(i.maxX/r),d=Math.floor(i.maxY/r),_=Math.log2(s),f=[];for(let g=a;g<=u;g++){let x=g%(1<<n);for(let b=l;b<=d;b++)f.push({display:De({z:n,x,y:b}),key:De({z:n-_,x:Math.floor(x/s),y:Math.floor(b/s)})})}return f},tf=class{constructor(n,e){this.tree=new Jd.default,this.current=new Map,this.dim=n,this.maxLabeledTiles=e}hasPrefix(n){for(let e of this.current.keys())if(e.startsWith(n))return!0;return!1}has(n){return this.current.has(n)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(n,e){let i=new Set;for(let r of this.tree.search(n))r.indexed_label.order<=e&&i.add(r.indexed_label);return i}searchLabel(n,e){let i=new Set;for(let r of n.bboxes)for(let s of this.tree.search(r))s.indexed_label.order<=e&&i.add(s.indexed_label);return i}bboxCollides(n,e){for(let i of this.tree.search(n))if(i.indexed_label.order<=e)return!0;return!1}labelCollides(n,e){for(let i of n.bboxes)for(let r of this.tree.search(i))if(r.indexed_label.order<=e)return!0;return!1}deduplicationCollides(n){if(!n.deduplicationKey||!n.deduplicationDistance)return!1;let e=n.deduplicationDistance,i={minX:n.anchor.x-e,minY:n.anchor.y-e,maxX:n.anchor.x+e,maxY:n.anchor.y+e};for(let r of this.tree.search(i))if(r.indexed_label.deduplicationKey===n.deduplicationKey&&r.indexed_label.anchor.dist(n.anchor)<e)return!0;return!1}makeEntry(n){this.current.get(n)&&console.log("consistency error 1");let e=new Set;this.current.set(n,e)}insert(n,e,i){let r={anchor:n.anchor,bboxes:n.bboxes,draw:n.draw,order:e,tileKey:i,deduplicationKey:n.deduplicationKey,deduplicationDistance:n.deduplicationDistance},s=this.current.get(i);if(!s){let f=new Set;this.current.set(i,f),s=f}s.add(r);var a=!1,l=!1;for(let f of n.bboxes){var u=f;u.indexed_label=r,this.tree.insert(u),f.minX<0&&(a=!0),f.maxX>this.dim&&(l=!0)}if(a||l){var d=a?this.dim:-this.dim,_=[];for(let x of n.bboxes)_.push({minX:x.minX+d,minY:x.minY,maxX:x.maxX+d,maxY:x.maxY});let f={anchor:new Kd.default(n.anchor.x+d,n.anchor.y),bboxes:_,draw:n.draw,order:e,tileKey:i},g=this.current.get(i);g&&g.add(f);for(let x of _){var u=x;u.indexed_label=f,this.tree.insert(u)}}}pruneOrNoop(n){let e=n.split(":"),i,r=0,s=0;for(var a of this.current.keys()){let l=a.split(":");if(l[3]===e[3]){s++;let u=Math.sqrt(Math.pow(+l[0]-+e[0],2)+Math.pow(+l[1]-+e[1],2));u>r&&(r=u,i=a)}i&&s>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(n){let e=this.current.get(n);if(!e)return;let i=[];for(let r of this.tree.all())e.has(r.indexed_label)&&i.push(r);i.forEach(r=>{this.tree.remove(r)}),this.current.delete(n)}removeLabel(n){let e=[];for(let r of this.tree.all())n==r.indexed_label&&e.push(r);e.forEach(r=>{this.tree.remove(r)});let i=this.current.get(n.tileKey);i&&i.delete(n)}},ef=class{constructor(n,e,i,r,s){this.index=new tf(256*1<<n,r),this.z=n,this.scratch=e,this.labelRules=i,this.callback=s}layout(n){let e=performance.now(),i=new Set;for(let[l,u]of n)for(let d of u){let _=De(d.data_tile)+":"+l;this.index.has(_)||(this.index.makeEntry(_),i.add(_))}let r=new Set;for(let[l,u]of this.labelRules.entries()){if(u.visible==!1||u.minzoom&&this.z<u.minzoom||u.maxzoom&&this.z>u.maxzoom)continue;let d=u.dataSource||"",_=n.get(d);if(_)for(let f of _){let g=De(f.data_tile)+":"+d;if(!i.has(g))continue;let x=f.data.get(u.dataLayer);if(x===void 0)continue;let b=x;u.sort&&b.sort((S,B)=>u.sort?u.sort(S.props,B.props):0);let M={index:this.index,zoom:this.z,scratch:this.scratch,order:l,overzoom:this.z-f.data_tile.z};for(let S of b){if(u.filter&&!u.filter(this.z,S))continue;let B=uh(S.geom,f.scale,f.origin),A=u.symbolizer.place(M,B,S);if(A)for(let m of A){var s=!1;if(!(m.deduplicationKey&&this.index.deduplicationCollides(m))){if(this.index.labelCollides(m,1/0)){if(!this.index.labelCollides(m,l)){let w=this.index.searchLabel(m,1/0);for(let P of w){this.index.removeLabel(P);for(let k of P.bboxes)this.findInvalidatedTiles(r,f.dim,k,g)}this.index.insert(m,l,g),s=!0}}else this.index.insert(m,l,g),s=!0;if(s)for(let w of m.bboxes)(w.maxX>f.origin.x+f.dim||w.minX<f.origin.x||w.minY<f.origin.y||w.maxY>f.origin.y+f.dim)&&this.findInvalidatedTiles(r,f.dim,w,g)}}}}}for(var a of i)this.index.pruneOrNoop(a);return r.size>0&&this.callback&&this.callback(r),performance.now()-e}findInvalidatedTiles(n,e,i,r){let s=Qd(this.z,e,i);for(let a of s)a.key!=r&&this.index.hasPrefix(a.key)&&n.add(a.display)}add(n){var e=!0;for(let[i,r]of n)for(let s of r)this.index.has(De(s.data_tile)+":"+i)||(e=!1);return e?0:this.layout(n)}},js=class{constructor(n,e,i,r){this.labelers=new Map,this.scratch=n,this.labelRules=e,this.maxLabeledTiles=i,this.callback=r}add(n,e){var i=this.labelers.get(n);return i||(i=new ef(n,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(n,i)),i.add(e)}getIndex(n){let e=this.labelers.get(n);if(e)return e.index}},Ys={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"},Ws={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function Di(n,e,i){return Math.min(Math.max(n,i),e)}var bi=class extends Error{constructor(e){super(`Failed to parse color: "${e}"`)}};function nf(n){if(typeof n!="string")throw new bi(n);if(n.trim().toLowerCase()==="transparent")return[0,0,0,0];let e=n.trim();e=lf.test(n)?function(l){const u=l.toLowerCase().trim(),d=rf[function(_){let f=5381,g=_.length;for(;g;)f=33*f^_.charCodeAt(--g);return(f>>>0)%2341}(u)];if(!d)throw new bi(l);return`#${d}`}(n):n;const i=of.exec(e);if(i){const l=Array.from(i).slice(1);return[...l.slice(0,3).map(u=>parseInt(Ai(u,2),16)),parseInt(Ai(l[3]||"f",2),16)/255]}const r=sf.exec(e);if(r){const l=Array.from(r).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,16)),parseInt(l[3]||"ff",16)/255]}const s=af.exec(e);if(s){const l=Array.from(s).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,10)),parseFloat(l[3]||"1")]}const a=hf.exec(e);if(a){const[l,u,d,_]=Array.from(a).slice(1).map(parseFloat);if(Di(0,100,u)!==u)throw new bi(n);if(Di(0,100,d)!==d)throw new bi(n);return[...uf(l,u,d),_||1]}throw new bi(n)}var Us=n=>parseInt(n.replace(/_/g,""),36),rf="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((n,e)=>{const i=Us(e.substring(0,3)),r=Us(e.substring(3)).toString(16);let s="";for(let a=0;a<6-r.length;a++)s+="0";return n[i]=`${s}${r}`,n},{}),Ai=(n,e)=>Array.from(Array(e)).map(()=>n).join(""),of=new RegExp(`^#${Ai("([a-f0-9])",3)}([a-f0-9])?$`,"i"),sf=new RegExp(`^#${Ai("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),af=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${Ai(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),hf=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,lf=/^[a-z]+$/i,Xs=n=>Math.round(255*n),uf=(n,e,i)=>{let r=i/100;if(e===0)return[r,r,r].map(Xs);const s=(n%360+360)%360/60,a=(1-Math.abs(2*r-1))*(e/100),l=a*(1-Math.abs(s%2-1));let u=0,d=0,_=0;s>=0&&s<1?(u=a,d=l):s>=1&&s<2?(u=l,d=a):s>=2&&s<3?(d=a,_=l):s>=3&&s<4?(d=l,_=a):s>=4&&s<5?(u=l,_=a):s>=5&&s<6&&(u=a,_=l);const f=r-a/2;return[u+f,d+f,_+f].map(Xs)};function Vs(n){const[e,i,r,s]=nf(n).map((_,f)=>f===3?_:_/255),a=Math.max(e,i,r),l=Math.min(e,i,r),u=(a+l)/2;if(a===l)return[0,0,u,s];const d=a-l;return[60*(e===a?(i-r)/d+(i<r?6:0):i===a?(r-e)/d+2:(e-i)/d+4),u>.5?d/(2-a-l):d/(a+l),u,s]}function cf(n,e,i,r){return`hsla(${(n%360).toFixed()}, ${Di(0,100,100*e).toFixed()}%, ${Di(0,100,100*i).toFixed()}%, ${parseFloat(Di(0,1,r).toFixed(3))})`}var Jt=jt(_e());jt($c());var df=jt(Kc()),Ot=class{constructor(n,e){this.str=n??e,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(n,e){return typeof this.str=="function"?this.str(n,e):this.str}},mt=class{constructor(n,e=1){this.value=n??e,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(n,e){return typeof this.value=="function"?this.value(n,e):this.value}},to=class{constructor(n){var e;this.label_props=(e=n==null?void 0:n.label_props)!=null?e:["name"],this.textTransform=n==null?void 0:n.textTransform}get(n,e){let i,r;typeof this.label_props=="function"?r=this.label_props(n,e):r=this.label_props;for(let a of r)if(e.props.hasOwnProperty(a)&&typeof e.props[a]=="string"){i=e.props[a];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(n,e):s=this.textTransform,i&&s==="uppercase"?i=i.toUpperCase():i&&s==="lowercase"?i=i.toLowerCase():i&&s==="capitalize"&&(i=i.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),i}},eo=class{constructor(n){var e,i;n!=null&&n.font?this.font=n.font:(this.family=(e=n==null?void 0:n.fontFamily)!=null?e:"sans-serif",this.size=(i=n==null?void 0:n.fontSize)!=null?i:12,this.weight=n==null?void 0:n.fontWeight,this.style=n==null?void 0:n.fontStyle)}get(n,e){if(this.font)return typeof this.font=="function"?this.font(n,e):this.font;var i="";this.style&&(typeof this.style=="function"?i=this.style(n,e)+" ":i=this.style+" ");var r="";this.weight&&(typeof this.weight=="function"?r=this.weight(n,e)+" ":r=this.weight+" ");var s;typeof this.size=="function"?s=this.size(n,e):s=this.size;var a;return typeof this.family=="function"?a=this.family(n,e):a=this.family,`${i}${r}${s}px ${a}`}},ff=class{constructor(n,e=[]){this.value=n??e,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(n,e){return typeof this.value=="function"?this.value(n,e):this.value}},Hs=jt(_e()),pf=(n,e,i)=>{var r=[],s,a,l,u=0,d=0,_=0,f=0,g=0,x=0,b=0,M=0,S=0,B=0,A=0,m=0;if(n.length<2)return[];if(n.length===2)return _=Math.sqrt(Math.pow(n[1].x-n[0].x,2)+Math.pow(n[1].y-n[0].y,2)),[{length:_,beginIndex:0,beginDistance:0,endIndex:2,endDistance:_}];for(f=Math.sqrt(Math.pow(n[1].x-n[0].x,2)+Math.pow(n[1].y-n[0].y,2)),u=1,d=n.length-1;u<d;u++)s=n[u-1],a=n[u],l=n[u+1],x=a.x-s.x,b=a.y-s.y,M=l.x-a.x,S=l.y-a.y,g=Math.sqrt(M*M+S*S),_+=f,B=Math.acos((x*M+b*S)/(f*g)),(B>e||_-m>i)&&(r.push({length:_-m,beginDistance:m,beginIndex:A,endIndex:u+1,endDistance:_}),A=u,m=_),f=g;return u-A>0&&r.push({length:_-m+g,beginIndex:A,beginDistance:m,endIndex:u+1,endDistance:_+g}),r};function _f(n,e,i,r){let s=[];for(let l of n){let u=pf(l,Math.PI/45,e);for(let d of u)if(d.length>=e+r){let _=new Hs.default(l[d.beginIndex].x,l[d.beginIndex].y),f=l[d.endIndex-1],g=new Hs.default((f.x-_.x)/d.length,(f.y-_.y)/d.length);for(var a=r;a<d.length-e;a+=i)s.push({start:_.add(g.mult(a)),end:_.add(g.mult(a+e))})}}return s}function mf(n,e,i,r){let s=e.x-n.x,a=e.y-n.y,l=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),u=[];for(var d=0;d<i+r;d+=2*r){let _=d*1/l;u.push({x:n.x+_*s,y:n.y+_*a})}return u}function ch(n,e){if(n.length<=e)return[n];let i=e-1,r=n.lastIndexOf(" ",i),s=n.indexOf(" ",i);if(r==-1&&s==-1)return[n];let a,l;return s==-1||r>=0&&i-r<s-i?(a=n.substring(0,r),l=n.substring(r+1,n.length)):(a=n.substring(0,s),l=n.substring(s+1,n.length)),[a,...ch(l,e)]}var dh=5400,Gs;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=3]="Right"})(Gs||(Gs={}));var $s;(function(n){n[n.N=1]="N",n[n.NE=2]="NE",n[n.E=3]="E",n[n.SE=4]="SE",n[n.S=5]="S",n[n.SW=6]="SW",n[n.W=7]="W",n[n.NW=8]="NW"})($s||($s={}));var Et=class{constructor(n){var e;this.pattern=n.pattern,this.fill=new Ot(n.fill,"black"),this.opacity=new mt(n.opacity,1),this.stroke=new Ot(n.stroke,"black"),this.width=new mt(n.width,0),this.per_feature=(e=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||n.per_feature)!=null?e:!1,this.do_stroke=!1}before(n,e){if(!this.per_feature){n.globalAlpha=this.opacity.get(e),n.fillStyle=this.fill.get(e),n.strokeStyle=this.stroke.get(e);let i=this.width.get(e);i>0&&(this.do_stroke=!0),n.lineWidth=i}if(this.pattern){const i=n.createPattern(this.pattern,"repeat");i&&(n.fillStyle=i)}}draw(n,e,i,r){var s=!1;if(this.per_feature){n.globalAlpha=this.opacity.get(i,r),n.fillStyle=this.fill.get(i,r);var a=this.width.get(i,r);a&&(s=!0,n.strokeStyle=this.stroke.get(i,r),n.lineWidth=a)}let l=()=>{n.fill(),(s||this.do_stroke)&&n.stroke()};var u=0;n.beginPath();for(var d of e){u+d.length>dh&&(l(),u=0,n.beginPath());for(var _=0;_<d.length;_++){let f=d[_];_==0?n.moveTo(f.x,f.y):n.lineTo(f.x,f.y)}u+=d.length}u>0&&l()}};function gf(n,e){let i=0;for(;e[i+1][0]<n;)i++;return i}function vf(n,e,i){return n*(i-e)+e}function yf(n,e,i,r){const s=r[e+1][0]-r[e][0],a=n-r[e][0];return s===0?0:(Math.pow(i,a)-1)/(Math.pow(i,s)-1)}function ve(n,e){return i=>{if(e.length<1)return 0;if(i<=e[0][0])return e[0][1];if(i>=e[e.length-1][0])return e[e.length-1][1];const r=gf(i,e),s=yf(i,r,n,e);return vf(s,e[r][1],e[r+1][1])}}var re=class{constructor(n){var e;this.color=new Ot(n.color,"black"),this.width=new mt(n.width),this.opacity=new mt(n.opacity),this.dash=n.dash?new ff(n.dash):null,this.dashColor=new Ot(n.dashColor,"black"),this.dashWidth=new mt(n.dashWidth,1),this.lineCap=new Ot(n.lineCap,"butt"),this.lineJoin=new Ot(n.lineJoin,"miter"),this.skip=!1,this.per_feature=!!((e=this.dash)!=null&&e.per_feature||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||n.per_feature)}before(n,e){this.per_feature||(n.strokeStyle=this.color.get(e),n.lineWidth=this.width.get(e),n.globalAlpha=this.opacity.get(e),n.lineCap=this.lineCap.get(e),n.lineJoin=this.lineJoin.get(e))}draw(n,e,i,r){if(this.skip)return;let s=()=>{this.per_feature&&(n.globalAlpha=this.opacity.get(i,r),n.lineCap=this.lineCap.get(i,r),n.lineJoin=this.lineJoin.get(i,r)),this.dash?(n.save(),this.per_feature?(n.lineWidth=this.dashWidth.get(i,r),n.strokeStyle=this.dashColor.get(i,r),n.setLineDash(this.dash.get(i,r))):n.setLineDash(this.dash.get(i)),n.stroke(),n.restore()):(n.save(),this.per_feature&&(n.lineWidth=this.width.get(i,r),n.strokeStyle=this.color.get(i,r)),n.stroke(),n.restore())};var a=0;n.beginPath();for(var l of e){a+l.length>dh&&(s(),a=0,n.beginPath());for(var u=0;u<l.length;u++){let d=l[u];u==0?n.moveTo(d.x,d.y):n.lineTo(d.x,d.y)}a+=l.length}a>0&&s()}},Fr=class{constructor(n){this.radius=new mt(n.radius,3),this.fill=new Ot(n.fill,"black"),this.stroke=new Ot(n.stroke,"white"),this.width=new mt(n.width,0),this.opacity=new mt(n.opacity)}draw(n,e,i,r){n.globalAlpha=this.opacity.get(i,r);let s=this.radius.get(i,r),a=this.width.get(i,r);a>0&&(n.strokeStyle=this.stroke.get(i,r),n.lineWidth=a,n.beginPath(),n.arc(e[0][0].x,e[0][0].y,s+a/2,0,2*Math.PI),n.stroke()),n.fillStyle=this.fill.get(i,r),n.beginPath(),n.arc(e[0][0].x,e[0][0].y,s,0,2*Math.PI),n.fill()}place(n,e,i){e[0];let r=new Jt.default(e[0][0].x,e[0][0].y),s=this.radius.get(n.zoom,i),a={minX:r.x-s,minY:r.y-s,maxX:r.x+s,maxY:r.y+s};return[{anchor:r,bboxes:[a],draw:u=>{this.draw(u,[[new Jt.default(0,0)]],n.zoom,i)}}]}},xf=class{constructor(n){this.font=new eo(n),this.text=new to(n),this.fill=new Ot(n.fill,"black"),this.background=new Ot(n.background,"white"),this.padding=new mt(n.padding,0)}place(n,e,i){let r=this.text.get(n.zoom,i);if(!r)return;let s=this.font.get(n.zoom,i);n.scratch.font=s;let a=n.scratch.measureText(r),l=a.width,u=a.actualBoundingBoxAscent,d=a.actualBoundingBoxDescent;e[0];let _=new Jt.default(e[0][0].x,e[0][0].y),f=this.padding.get(n.zoom,i),g={minX:_.x-l/2-f,minY:_.y-u-f,maxX:_.x+l/2+f,maxY:_.y+d+f};return[{anchor:_,bboxes:[g],draw:b=>{b.globalAlpha=1,b.fillStyle=this.background.get(n.zoom,i),b.fillRect(-l/2-f,-u-f,l+2*f,u+d+2*f),b.fillStyle=this.fill.get(n.zoom,i),b.font=s,b.fillText(r,-l/2,0)}}]}},qs=class{constructor(n){this.list=n}place(n,e,i){var r=this.list[0].place(n,e,i);if(!r)return;var s=r[0];let a=s.anchor,l=s.bboxes[0],u=l.maxY-l.minY,d=[{draw:s.draw,translate:{x:0,y:0}}],_=[[new Jt.default(e[0][0].x,e[0][0].y+u)]];for(let g=1;g<this.list.length;g++)r=this.list[g].place(n,_,i),r&&(s=r[0],l=fh(l,s.bboxes[0]),d.push({draw:s.draw,translate:{x:0,y:u}}));return[{anchor:a,bboxes:[l],draw:g=>{for(let x of d)g.save(),g.translate(x.translate.x,x.translate.y),x.draw(g),g.restore()}}]}},fh=(n,e)=>({minX:Math.min(n.minX,e.minX),minY:Math.min(n.minY,e.minY),maxX:Math.max(n.maxX,e.maxX),maxY:Math.max(n.maxY,e.maxY)}),Ks=class{constructor(n){this.list=n}place(n,e,i){let r=this.list[0];if(!r)return;var s=r.place(n,e,i);if(!s)return;var a=s[0];let l=a.anchor,u=a.bboxes[0],d=[a.draw];for(let f=1;f<this.list.length;f++){if(s=this.list[f].place(n,e,i),!s)return;a=s[0],u=fh(u,a.bboxes[0]),d.push(a.draw)}return[{anchor:l,bboxes:[u],draw:f=>{d.forEach(g=>g(f))}}]}},wf=class{constructor(n){this.symbolizer=n}place(n,e,i){let r=e[0][0],s=this.symbolizer.place(n,[[new Jt.default(0,0)]],i);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=l.maxX-l.minX,d=l.maxY-l.minY,_={minX:r.x-u/2,maxX:r.x+u/2,minY:r.y-d/2,maxY:r.y+d/2};return[{anchor:r,bboxes:[_],draw:g=>{g.translate(-u/2,d/2-l.maxY),a.draw(g,{justify:2})}}]}},io=class{constructor(n){this.font=new eo(n),this.text=new to(n),this.fill=new Ot(n.fill,"black"),this.stroke=new Ot(n.stroke,"black"),this.width=new mt(n.width,0),this.lineHeight=new mt(n.lineHeight,1),this.letterSpacing=new mt(n.letterSpacing,0),this.maxLineCodeUnits=new mt(n.maxLineChars,15),this.justify=n.justify}place(n,e,i){let r=this.text.get(n.zoom,i);if(!r)return;let s=this.font.get(n.zoom,i);n.scratch.font=s;let a=this.letterSpacing.get(n.zoom,i),l=ch(r,this.maxLineCodeUnits.get(n.zoom,i));var u="",d=0;for(let A of l)A.length>d&&(d=A.length,u=A);let _=n.scratch.measureText(u),f=_.width+a*(d-1),g=_.actualBoundingBoxAscent,x=_.actualBoundingBoxDescent,b=(g+x)*this.lineHeight.get(n.zoom,i),M=new Jt.default(e[0][0].x,e[0][0].y),S={minX:M.x,minY:M.y-g,maxX:M.x+f,maxY:M.y+x+(l.length-1)*b};return[{anchor:M,bboxes:[S],draw:(A,m)=>{A.globalAlpha=1,A.font=s,A.fillStyle=this.fill.get(n.zoom,i);let w=this.width.get(n.zoom,i);var P=0;for(let I of l){var k=0;if(this.justify==2||m&&m.justify==2?k=(f-A.measureText(I).width)/2:(this.justify==3||m&&m.justify==3)&&(k=f-A.measureText(I).width),w)if(A.lineWidth=w*2,A.strokeStyle=this.stroke.get(n.zoom,i),a>0){var T=k;for(var E of I)A.strokeText(E,T,P),T+=A.measureText(E).width+a}else A.strokeText(I,k,P);if(a>0){var T=k;for(var E of I)A.fillText(E,T,P),T+=A.measureText(E).width+a}else A.fillText(I,k,P);P+=b}}}]}},Pi=class{constructor(n){this.centered=new wf(new io(n))}place(n,e,i){return this.centered.place(n,e,i)}},bf=class{constructor(n,e){var i,r,s;this.symbolizer=n,this.offsetX=new mt(e.offsetX,0),this.offsetY=new mt(e.offsetY,0),this.justify=(i=e.justify)!=null?i:void 0,this.placements=(r=e.placements)!=null?r:[2,6,8,4,1,3,5,7],this.ddValues=(s=e.ddValues)!=null?s:()=>({})}place(n,e,i){if(i.geomType!==Je.Point)return;let r=e[0][0],s=this.symbolizer.place(n,[[new Jt.default(0,0)]],i);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=this.offsetX,d=this.offsetY,_=this.justify,f=this.placements;const{offsetX:g,offsetY:x,justify:b,placements:M}=this.ddValues(n.zoom,i)||{};g&&(u=new mt(g,0)),x&&(d=new mt(x,0)),b&&(_=b),M&&(f=M);const S=u.get(n.zoom,i),B=d.get(n.zoom,i);let A=(T,E)=>({minX:T.x+E.x+l.minX,minY:T.y+E.y+l.minY,maxX:T.x+E.x+l.maxX,maxY:T.y+E.y+l.maxY});var m=new Jt.default(S,B),w;let P=T=>{T.translate(m.x,m.y),a.draw(T,{justify:w})};const k=(T,E)=>{const I=A(T,E);if(!n.index.bboxCollides(I,n.order))return[{anchor:r,bboxes:[I],draw:P}]};for(let T of f){const E=this.computeXAxisOffset(S,l,T),I=this.computeYAxisOffset(B,l,T);return w=this.computeJustify(_,T),m=new Jt.default(E,I),k(r,m)}}computeXAxisOffset(n,e,i){const r=e.maxX,s=r/2;return[1,5].includes(i)?n-s:[8,7,6].includes(i)?n-r:n}computeYAxisOffset(n,e,i){const r=Math.abs(e.minY),s=e.maxY,a=(e.minY+e.maxY)/2;return[3,7].includes(i)?n-a:[8,2,1].includes(i)?n-s:[6,4,5].includes(i)?n+r:n}computeJustify(n,e){return n||([1,5].includes(e)?2:[2,3,4].includes(e)?1:3)}},mn=class{constructor(n){this.symbolizer=new bf(new io(n),n)}place(n,e,i){return this.symbolizer.place(n,e,i)}},Js;(function(n){n[n.Above=1]="Above",n[n.Center=2]="Center",n[n.Below=3]="Below"})(Js||(Js={}));var Pf=class{constructor(n){var e;this.font=new eo(n),this.text=new to(n),this.fill=new Ot(n.fill,"black"),this.stroke=new Ot(n.stroke,"black"),this.width=new mt(n.width,0),this.offset=new mt(n.offset,0),this.position=(e=n.position)!=null?e:1,this.maxLabelCodeUnits=new mt(n.maxLabelChars,40),this.repeatDistance=new mt(n.repeatDistance,250)}place(n,e,i){let r=this.text.get(n.zoom,i);if(!r||r.length>this.maxLabelCodeUnits.get(n.zoom,i))return;let s=20,a=i.bbox;if(a.maxY-a.minY<s&&a.maxX-a.minX<s)return;let l=this.font.get(n.zoom,i);n.scratch.font=l;let u=n.scratch.measureText(r),d=u.width,_=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent;var f=this.repeatDistance.get(n.zoom,i);n.overzoom>4&&(f*=1<<n.overzoom-4);let g=_*2,x=_f(e,d,f,g);if(x.length==0)return;let b=[];for(let M of x){let S=M.end.x-M.start.x,B=M.end.y-M.start.y,m=mf(M.start,M.end,d,g/2).map(P=>({minX:P.x-g/2,minY:P.y-g/2,maxX:P.x+g/2,maxY:P.y+g/2})),w=P=>{P.globalAlpha=1,P.rotate(Math.atan2(B,S)),S<0&&(P.scale(-1,-1),P.translate(-d,0));let k=0;this.position===3?k+=_:this.position===2&&(k+=_/2),P.translate(0,k-this.offset.get(n.zoom,i)),P.font=l;let T=this.width.get(n.zoom,i);T&&(P.lineWidth=T,P.strokeStyle=this.stroke.get(n.zoom,i),P.strokeText(r,0,0)),P.fillStyle=this.fill.get(n.zoom,i),P.fillText(r,0,0)};b.push({anchor:M.start,bboxes:m,draw:w,deduplicationKey:r,deduplicationDistance:f})}return b}},Pr=class{constructor(n){this.symbolizer=new io(n)}place(n,e,i){let r=i.bbox;if((r.maxY-r.minY)*(r.maxX-r.minX)<2e4)return;let a=this.symbolizer.place(n,[[new Jt.default(0,0)]],i);if(!a||a.length==0)return;let l=a[0],u=l.bboxes[0],d=e[0],_=(0,df.default)([d.map(b=>[b.x,b.y])]),f=new Jt.default(_[0],_[1]),g={minX:f.x-(u.maxX-u.minX)/2,minY:f.y-(u.maxY-u.minY)/2,maxX:f.x+(u.maxX-u.minX)/2,maxY:f.y+(u.maxY-u.minY)/2};return[{anchor:f,bboxes:[g],draw:b=>{b.translate(l.anchor.x-(u.maxX-u.minX)/2,l.anchor.y),l.draw(b)}}]}},ph=(n,e)=>{let i=Vs(e),r=jc({},n);for(const[s,a]of Object.entries(n)){let l=Vs(a);r[s]=cf(i[0],i[1],l[2],l[3])}return r},Qs=(n,e)=>(e&&(n=ph(n,e)),[{dataLayer:"earth",symbolizer:new Et({fill:n.earth})},{dataLayer:"natural",symbolizer:new Et({fill:n.glacier}),filter:(i,r)=>r.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new Et({fill:n.residential}),filter:(i,r)=>r.props.landuse=="residential"||r.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new Et({fill:n.hospital}),filter:(i,r)=>r.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new Et({fill:n.cemetery}),filter:(i,r)=>r.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new Et({fill:n.school}),filter:(i,r)=>r.props.amenity=="school"||r.props.amenity=="kindergarten"||r.props.amenity=="university"||r.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new Et({fill:n.industrial}),filter:(i,r)=>r.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new Et({fill:n.wood}),filter:(i,r)=>r.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new Et({fill:n.grass}),filter:(i,r)=>r.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new Et({fill:n.park}),filter:(i,r)=>r.props.leisure=="park"},{dataLayer:"water",symbolizer:new Et({fill:n.water})},{dataLayer:"natural",symbolizer:new Et({fill:n.sand}),filter:(i,r)=>r.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new Et({fill:n.buildings})},{dataLayer:"roads",symbolizer:new re({color:n.highwayCasing,width:ve(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(i,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new re({color:n.majorRoadCasing,width:ve(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(i,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:n.mediumRoadCasing,width:ve(1.4,[[13,3],[17,6],[20,18]])}),filter:(i,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:n.minorRoadCasing,width:ve(1.4,[[14,2],[17,5],[20,15]])}),filter:(i,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:n.minorRoad,width:ve(1.4,[[14,1],[17,3],[20,13]])}),filter:(i,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:n.mediumRoad,width:ve(1.4,[[13,2],[17,4],[20,15]])}),filter:(i,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:n.majorRoad,width:ve(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(i,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:n.highway,width:ve(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(i,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new re({color:n.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new Et({fill:n.mask})}]),ta=(n,e,i,r)=>{e&&(n=ph(n,e));var s=["name"];i&&(s=i);let a=(l,u)=>r?l instanceof mn?new qs([l,new mn({fill:u,label_props:r})]):new qs([l,new Pi({fill:u,label_props:r})]):l;return[{dataLayer:"places",symbolizer:a(new Pi({label_props:s,fill:n.countryLabel,lineHeight:1.5,font:(l,u)=>l<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),n.countryLabel),filter:(l,u)=>u.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:a(new Pi({label_props:s,fill:n.stateLabel,font:"300 16px sans-serif"}),n.stateLabel),filter:(l,u)=>u.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",minzoom:7,symbolizer:a(new Pi({label_props:s,fill:n.cityLabel,font:(l,u)=>(u==null?void 0:u.props["pmap:rank"])===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),n.cityLabel),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new Ks([new Fr({radius:2,fill:n.cityLabel}),a(new mn({label_props:s,fill:n.cityLabel,offsetX:2,offsetY:2,font:(l,u)=>(u==null?void 0:u.props["pmap:rank"])===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),n.cityLabel)]),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new Pi({label_props:s,fill:n.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),n.neighbourhoodLabel),filter:(l,u)=>u.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new Pr({label_props:s,fill:n.landuseLabel,font:"300 12px sans-serif"}),n.landuseLabel)},{dataLayer:"water",symbolizer:a(new Pr({label_props:s,fill:n.waterLabel,font:"italic 600 12px sans-serif"}),n.waterLabel)},{dataLayer:"natural",symbolizer:a(new Pr({label_props:s,fill:n.naturalLabel,font:"italic 300 12px sans-serif"}),n.naturalLabel)},{dataLayer:"roads",symbolizer:a(new Pf({label_props:s,fill:n.roadsLabel,font:"500 12px sans-serif"}),n.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new xf({label_props:["ref"],font:"600 9px sans-serif",background:n.highway,padding:2,fill:n.neighbourhoodLabel}),filter:(l,u)=>u.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new Ks([new Fr({radius:2,fill:n.poisLabel}),a(new mn({label_props:s,fill:n.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),n.poisLabel)])}]},ea=(n,e,i)=>[{dataSource:n,dataLayer:e,symbolizer:new Fr({opacity:.2,fill:i,radius:4}),filter:(r,s)=>s.geomType==Je.Point},{dataSource:n,dataLayer:e,symbolizer:new re({opacity:.2,color:i,width:2}),filter:(r,s)=>s.geomType==Je.Line},{dataSource:n,dataLayer:e,symbolizer:new Et({opacity:.2,fill:i,stroke:i,width:1}),filter:(r,s)=>s.geomType==Je.Polygon}],Mf=(n,e)=>{var i=[];for(var[r,s]of n)for(var a of s)for(var l of a.data.keys())r===e.dataSource&&l===e.dataLayer||(i=i.concat(ea(r,l,"steelblue")));return i=i.concat(ea(e.dataSource||"",e.dataLayer,"red")),i},Lf=jt(_e()),Cf=n=>new Promise((e,i)=>{setTimeout(()=>{e()},n)}),Sf=n=>n.then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e})),kf=(n={})=>{class e extends L.GridLayer{constructor(r={}){r.noWrap&&!r.bounds&&(r.bounds=[[-90,-180],[90,180]]),r.attribution==null&&(r.attribution='<a href="https://protomaps.com">Protomaps</a>  <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(r);let s=r.dark?Ws:Ys;this.paint_rules=r.paint_rules||Qs(s,r.shade),this.label_rules=r.label_rules||ta(s,r.shade,r.language1,r.language2),this.backgroundColor=r.backgroundColor,this.lastRequestedZ=void 0,this.xray=r.xray,this.tasks=r.tasks||[],this.views=Gd(r),this.debug=r.debug;let a=document.createElement("canvas").getContext("2d");this.scratch=a,this.onTilesInvalidated=l=>{l.forEach(u=>{this.rerenderTile(u)})},this.labelers=new js(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=r.tileDelay||3,this.lang=r.lang,this.inspector=this.inspect(this)}setDefaultStyle(r,s,a,l){let u=r?Ws:Ys;this.paint_rules=Qs(u,s),this.label_rules=ta(u,s,a,l)}renderTile(r,s,a,l=()=>{}){return ei(this,null,function*(){this.lastRequestedZ=r.z;let u=[];for(const[E,I]of this.views){let N=I.getDisplayTile(r);u.push({key:E,promise:N})}let d=yield Promise.all(u.map(E=>E.promise.then(I=>({status:"fulfilled",value:I,key:E.key}),I=>({status:"rejected",reason:I,key:E.key})))),_=new Map;for(const E of d)E.status==="fulfilled"?_.set(E.key,[E.value]):E.reason.name==="AbortError"||console.error(E.reason);if(s.key!=a||this.lastRequestedZ!==r.z||(yield Promise.all(this.tasks.map(Sf)),s.key!=a)||this.lastRequestedZ!==r.z)return;let f=this.labelers.add(r.z,_);if(s.key!=a||this.lastRequestedZ!==r.z)return;let g=this.labelers.getIndex(r.z);if(!this._map)return;let x=this._map.getCenter().wrap(),b=this._getTiledPixelBounds(x),M=this._pxBoundsToTileRange(b),S=M.getCenter(),B=r.distanceTo(S)*this.tileDelay;if(yield Cf(B),s.key!=a||this.lastRequestedZ!==r.z)return;let A=16,m={minX:256*r.x-A,minY:256*r.y-A,maxX:256*(r.x+1)+A,maxY:256*(r.y+1)+A},w=new Lf.default(256*r.x,256*r.y);s.width=this.tile_size,s.height=this.tile_size;let P=s.getContext("2d");P.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),P.clearRect(0,0,256,256),this.backgroundColor&&(P.save(),P.fillStyle=this.backgroundColor,P.fillRect(0,0,256,256),P.restore());var k=0;let T=this.paint_rules;if(this.xray&&(T=Mf(_,this.xray)),k=qd(P,r.z,_,this.xray?null:g,T,m,w,!1,this.debug),this.debug){P.save(),P.fillStyle=this.debug,P.font="600 12px sans-serif",P.fillText(r.z+" "+r.x+" "+r.y,4,14),P.font="12px sans-serif";let E=28;for(let[I,N]of _){let j=N[0].data_tile;P.fillText(I+(I?" ":"")+j.z+" "+j.x+" "+j.y,4,E),E+=14}P.font="600 10px sans-serif",k>8&&(P.fillText(k.toFixed()+" ms paint",4,E),E+=14),f>8&&P.fillText(f.toFixed()+" ms layout",4,E),P.strokeStyle=this.debug,P.lineWidth=.5,P.beginPath(),P.moveTo(0,0),P.lineTo(0,256),P.stroke(),P.lineWidth=.5,P.beginPath(),P.moveTo(0,0),P.lineTo(256,0),P.stroke(),P.restore()}l()})}rerenderTile(r){for(let s in this._tiles){let a=this._wrapCoords(this._keyToTileCoords(s));r===this._tileCoordsToKey(a)&&this.renderTile(a,this._tiles[s].el,r)}}clearLayout(){this.labelers=new js(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let r in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(r)),a=this._tileCoordsToKey(s);this.renderTile(s,this._tiles[r].el,a)}}createTile(r,s){let a=L.DomUtil.create("canvas","leaflet-tile");a.lang=this.lang;let l=this._tileCoordsToKey(r);return a.key=l,this.renderTile(r,a,l,()=>{s(null,a)}),a}_removeTile(r){let s=this._tiles[r];s&&(s.el.removed=!0,s.el.key=void 0,L.DomUtil.removeClass(s.el,"leaflet-tile-loaded"),s.el.width=s.el.height=0,L.DomUtil.remove(s.el),delete this._tiles[r],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(r)}))}queryFeatures(r,s){let a=new Map;for(var[l,u]of this.views)a.set(l,u.queryFeatures(r,s,this._map.getZoom()));return a}inspect(r){return s=>{let a=["","",""],l=r._map.wrapLatLng(s.latlng),u=r.queryFeatures(l.lng,l.lat);var d="";let _=!0;for(var[f,g]of u)for(var x of g)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===f&&this.xray.dataLayer===x.layerName))){d=d+`<div style="margin-top:${_?0:.5}em">${a[x.feature.geomType-1]} <b>${f} ${f?"/":""} ${x.layerName}</b> ${x.feature.id||""}</div>`;for(const b in x.feature.props)d=d+`<div style="font-size:0.9em">${b} = ${x.feature.props[b]}</div>`;_=!1}_&&(d="No features."),L.popup().setLatLng(s.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+d+"</div>").openOn(r._map)}}addInspector(r){return r.on("click",this.inspector)}removeInspector(r){return r.off("click",this.inspector)}}return new e(n)};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ef({L:n,id:e,lat:i,lng:r,zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:d}){const _=n.map(e,{center:[i,r],zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:d});return kf({url:"https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf?key=d23c43b7c56e123d"}).addTo(_),_}var Zr={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(i,r){r(e)})(Ur,function(i){var r="1.9.4";function s(t){var o,h,c,p;for(h=1,c=arguments.length;h<c;h++){p=arguments[h];for(o in p)t[o]=p[o]}return t}var a=Object.create||function(){function t(){}return function(o){return t.prototype=o,new t}}();function l(t,o){var h=Array.prototype.slice;if(t.bind)return t.bind.apply(t,h.call(arguments,1));var c=h.call(arguments,2);return function(){return t.apply(o,c.length?c.concat(h.call(arguments)):arguments)}}var u=0;function d(t){return"_leaflet_id"in t||(t._leaflet_id=++u),t._leaflet_id}function _(t,o,h){var c,p,y,C;return C=function(){c=!1,p&&(y.apply(h,p),p=!1)},y=function(){c?p=arguments:(t.apply(h,arguments),setTimeout(C,o),c=!0)},y}function f(t,o,h){var c=o[1],p=o[0],y=c-p;return t===c&&h?t:((t-p)%y+y)%y+p}function g(){return!1}function x(t,o){if(o===!1)return t;var h=Math.pow(10,o===void 0?6:o);return Math.round(t*h)/h}function b(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function M(t){return b(t).split(/\s+/)}function S(t,o){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?a(t.options):{});for(var h in o)t.options[h]=o[h];return t.options}function B(t,o,h){var c=[];for(var p in t)c.push(encodeURIComponent(h?p.toUpperCase():p)+"="+encodeURIComponent(t[p]));return(!o||o.indexOf("?")===-1?"?":"&")+c.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function m(t,o){return t.replace(A,function(h,c){var p=o[c];if(p===void 0)throw new Error("No value provided for variable "+h);return typeof p=="function"&&(p=p(o)),p})}var w=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function P(t,o){for(var h=0;h<t.length;h++)if(t[h]===o)return h;return-1}var k="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var E=0;function I(t){var o=+new Date,h=Math.max(0,16-(o-E));return E=o+h,window.setTimeout(t,h)}var N=window.requestAnimationFrame||T("RequestAnimationFrame")||I,j=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function Y(t,o,h){if(h&&N===I)t.call(o);else return N.call(window,l(t,o))}function X(t){t&&j.call(window,t)}var U={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:d,throttle:_,wrapNum:f,falseFn:g,formatNum:x,trim:b,splitWords:M,setOptions:S,getParamString:B,template:m,isArray:w,indexOf:P,emptyImageUrl:k,requestFn:N,cancelFn:j,requestAnimFrame:Y,cancelAnimFrame:X};function v(){}v.extend=function(t){var o=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=o.__super__=this.prototype,c=a(h);c.constructor=o,o.prototype=c;for(var p in this)Object.prototype.hasOwnProperty.call(this,p)&&p!=="prototype"&&p!=="__super__"&&(o[p]=this[p]);return t.statics&&s(o,t.statics),t.includes&&(D(t.includes),s.apply(null,[c].concat(t.includes))),s(c,t),delete c.statics,delete c.includes,c.options&&(c.options=h.options?a(h.options):{},s(c.options,t.options)),c._initHooks=[],c.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var y=0,C=c._initHooks.length;y<C;y++)c._initHooks[y].call(this)}},o},v.include=function(t){var o=this.prototype.options;return s(this.prototype,t),t.options&&(this.prototype.options=o,this.mergeOptions(t.options)),this},v.mergeOptions=function(t){return s(this.prototype.options,t),this},v.addInitHook=function(t){var o=Array.prototype.slice.call(arguments,1),h=typeof t=="function"?t:function(){this[t].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function D(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=w(t)?t:[t];for(var o=0;o<t.length;o++)t[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var z={on:function(t,o,h){if(typeof t=="object")for(var c in t)this._on(c,t[c],o);else{t=M(t);for(var p=0,y=t.length;p<y;p++)this._on(t[p],o,h)}return this},off:function(t,o,h){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var c in t)this._off(c,t[c],o);else{t=M(t);for(var p=arguments.length===1,y=0,C=t.length;y<C;y++)p?this._off(t[y]):this._off(t[y],o,h)}return this},_on:function(t,o,h,c){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(t,o,h)===!1){h===this&&(h=void 0);var p={fn:o,ctx:h};c&&(p.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(p)}},_off:function(t,o,h){var c,p,y;if(this._events&&(c=this._events[t],!!c)){if(arguments.length===1){if(this._firingCount)for(p=0,y=c.length;p<y;p++)c[p].fn=g;delete this._events[t];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var C=this._listens(t,o,h);if(C!==!1){var O=c[C];this._firingCount&&(O.fn=g,this._events[t]=c=c.slice()),c.splice(C,1)}}},fire:function(t,o,h){if(!this.listens(t,h))return this;var c=s({},o,{type:t,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var p=this._events[t];if(p){this._firingCount=this._firingCount+1||1;for(var y=0,C=p.length;y<C;y++){var O=p[y],F=O.fn;O.once&&this.off(t,F,O.ctx),F.call(O.ctx||this,c)}this._firingCount--}}return h&&this._propagateEvent(c),this},listens:function(t,o,h,c){typeof t!="string"&&console.warn('"string" type argument expected');var p=o;typeof o!="function"&&(c=!!o,p=void 0,h=void 0);var y=this._events&&this._events[t];if(y&&y.length&&this._listens(t,p,h)!==!1)return!0;if(c){for(var C in this._eventParents)if(this._eventParents[C].listens(t,o,h,c))return!0}return!1},_listens:function(t,o,h){if(!this._events)return!1;var c=this._events[t]||[];if(!o)return!!c.length;h===this&&(h=void 0);for(var p=0,y=c.length;p<y;p++)if(c[p].fn===o&&c[p].ctx===h)return p;return!1},once:function(t,o,h){if(typeof t=="object")for(var c in t)this._on(c,t[c],o,!0);else{t=M(t);for(var p=0,y=t.length;p<y;p++)this._on(t[p],o,h,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[d(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[d(t)],this},_propagateEvent:function(t){for(var o in this._eventParents)this._eventParents[o].fire(t.type,s({layer:t.target,propagatedFrom:t.target},t),!0)}};z.addEventListener=z.on,z.removeEventListener=z.clearAllEventListeners=z.off,z.addOneTimeEventListener=z.once,z.fireEvent=z.fire,z.hasEventListeners=z.listens;var V=v.extend(z);function R(t,o,h){this.x=h?Math.round(t):t,this.y=h?Math.round(o):o}var K=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};R.prototype={clone:function(){return new R(this.x,this.y)},add:function(t){return this.clone()._add(Z(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(Z(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new R(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new R(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(t){t=Z(t);var o=t.x-this.x,h=t.y-this.y;return Math.sqrt(o*o+h*h)},equals:function(t){return t=Z(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=Z(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function Z(t,o,h){return t instanceof R?t:w(t)?new R(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new R(t.x,t.y):new R(t,o,h)}function H(t,o){if(t)for(var h=o?[t,o]:t,c=0,p=h.length;c<p;c++)this.extend(h[c])}H.prototype={extend:function(t){var o,h;if(!t)return this;if(t instanceof R||typeof t[0]=="number"||"x"in t)o=h=Z(t);else if(t=G(t),o=t.min,h=t.max,!o||!h)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=h.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(t){return Z((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return Z(this.min.x,this.max.y)},getTopRight:function(){return Z(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var o,h;return typeof t[0]=="number"||t instanceof R?t=Z(t):t=G(t),t instanceof H?(o=t.min,h=t.max):o=h=t,o.x>=this.min.x&&h.x<=this.max.x&&o.y>=this.min.y&&h.y<=this.max.y},intersects:function(t){t=G(t);var o=this.min,h=this.max,c=t.min,p=t.max,y=p.x>=o.x&&c.x<=h.x,C=p.y>=o.y&&c.y<=h.y;return y&&C},overlaps:function(t){t=G(t);var o=this.min,h=this.max,c=t.min,p=t.max,y=p.x>o.x&&c.x<h.x,C=p.y>o.y&&c.y<h.y;return y&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var o=this.min,h=this.max,c=Math.abs(o.x-h.x)*t,p=Math.abs(o.y-h.y)*t;return G(Z(o.x-c,o.y-p),Z(h.x+c,h.y+p))},equals:function(t){return t?(t=G(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function G(t,o){return!t||t instanceof H?t:new H(t,o)}function nt(t,o){if(t)for(var h=o?[t,o]:t,c=0,p=h.length;c<p;c++)this.extend(h[c])}nt.prototype={extend:function(t){var o=this._southWest,h=this._northEast,c,p;if(t instanceof et)c=t,p=t;else if(t instanceof nt){if(c=t._southWest,p=t._northEast,!c||!p)return this}else return t?this.extend($(t)||Q(t)):this;return!o&&!h?(this._southWest=new et(c.lat,c.lng),this._northEast=new et(p.lat,p.lng)):(o.lat=Math.min(c.lat,o.lat),o.lng=Math.min(c.lng,o.lng),h.lat=Math.max(p.lat,h.lat),h.lng=Math.max(p.lng,h.lng)),this},pad:function(t){var o=this._southWest,h=this._northEast,c=Math.abs(o.lat-h.lat)*t,p=Math.abs(o.lng-h.lng)*t;return new nt(new et(o.lat-c,o.lng-p),new et(h.lat+c,h.lng+p))},getCenter:function(){return new et((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new et(this.getNorth(),this.getWest())},getSouthEast:function(){return new et(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof et||"lat"in t?t=$(t):t=Q(t);var o=this._southWest,h=this._northEast,c,p;return t instanceof nt?(c=t.getSouthWest(),p=t.getNorthEast()):c=p=t,c.lat>=o.lat&&p.lat<=h.lat&&c.lng>=o.lng&&p.lng<=h.lng},intersects:function(t){t=Q(t);var o=this._southWest,h=this._northEast,c=t.getSouthWest(),p=t.getNorthEast(),y=p.lat>=o.lat&&c.lat<=h.lat,C=p.lng>=o.lng&&c.lng<=h.lng;return y&&C},overlaps:function(t){t=Q(t);var o=this._southWest,h=this._northEast,c=t.getSouthWest(),p=t.getNorthEast(),y=p.lat>o.lat&&c.lat<h.lat,C=p.lng>o.lng&&c.lng<h.lng;return y&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,o){return t?(t=Q(t),this._southWest.equals(t.getSouthWest(),o)&&this._northEast.equals(t.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(t,o){return t instanceof nt?t:new nt(t,o)}function et(t,o,h){if(isNaN(t)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+o+")");this.lat=+t,this.lng=+o,h!==void 0&&(this.alt=+h)}et.prototype={equals:function(t,o){if(!t)return!1;t=$(t);var h=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return h<=(o===void 0?1e-9:o)},toString:function(t){return"LatLng("+x(this.lat,t)+", "+x(this.lng,t)+")"},distanceTo:function(t){return dt.distance(this,$(t))},wrap:function(){return dt.wrapLatLng(this)},toBounds:function(t){var o=180*t/40075017,h=o/Math.cos(Math.PI/180*this.lat);return Q([this.lat-o,this.lng-h],[this.lat+o,this.lng+h])},clone:function(){return new et(this.lat,this.lng,this.alt)}};function $(t,o,h){return t instanceof et?t:w(t)&&typeof t[0]!="object"?t.length===3?new et(t[0],t[1],t[2]):t.length===2?new et(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new et(t.lat,"lng"in t?t.lng:t.lon,t.alt):o===void 0?null:new et(t,o,h)}var ht={latLngToPoint:function(t,o){var h=this.projection.project(t),c=this.scale(o);return this.transformation._transform(h,c)},pointToLatLng:function(t,o){var h=this.scale(o),c=this.transformation.untransform(t,h);return this.projection.unproject(c)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var o=this.projection.bounds,h=this.scale(t),c=this.transformation.transform(o.min,h),p=this.transformation.transform(o.max,h);return new H(c,p)},infinite:!1,wrapLatLng:function(t){var o=this.wrapLng?f(t.lng,this.wrapLng,!0):t.lng,h=this.wrapLat?f(t.lat,this.wrapLat,!0):t.lat,c=t.alt;return new et(h,o,c)},wrapLatLngBounds:function(t){var o=t.getCenter(),h=this.wrapLatLng(o),c=o.lat-h.lat,p=o.lng-h.lng;if(c===0&&p===0)return t;var y=t.getSouthWest(),C=t.getNorthEast(),O=new et(y.lat-c,y.lng-p),F=new et(C.lat-c,C.lng-p);return new nt(O,F)}},dt=s({},ht,{wrapLng:[-180,180],R:6371e3,distance:function(t,o){var h=Math.PI/180,c=t.lat*h,p=o.lat*h,y=Math.sin((o.lat-t.lat)*h/2),C=Math.sin((o.lng-t.lng)*h/2),O=y*y+Math.cos(c)*Math.cos(p)*C*C,F=2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O));return this.R*F}}),xt=6378137,Mt={R:xt,MAX_LATITUDE:85.0511287798,project:function(t){var o=Math.PI/180,h=this.MAX_LATITUDE,c=Math.max(Math.min(h,t.lat),-h),p=Math.sin(c*o);return new R(this.R*t.lng*o,this.R*Math.log((1+p)/(1-p))/2)},unproject:function(t){var o=180/Math.PI;return new et((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*o,t.x*o/this.R)},bounds:function(){var t=xt*Math.PI;return new H([-t,-t],[t,t])}()};function Lt(t,o,h,c){if(w(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=o,this._c=h,this._d=c}Lt.prototype={transform:function(t,o){return this._transform(t.clone(),o)},_transform:function(t,o){return o=o||1,t.x=o*(this._a*t.x+this._b),t.y=o*(this._c*t.y+this._d),t},untransform:function(t,o){return o=o||1,new R((t.x/o-this._b)/this._a,(t.y/o-this._d)/this._c)}};function Dt(t,o,h,c){return new Lt(t,o,h,c)}var Ct=s({},dt,{code:"EPSG:3857",projection:Mt,transformation:function(){var t=.5/(Math.PI*Mt.R);return Dt(t,.5,-t,.5)}()}),Ft=s({},Ct,{code:"EPSG:900913"});function It(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Bt(t,o){var h="",c,p,y,C,O,F;for(c=0,y=t.length;c<y;c++){for(O=t[c],p=0,C=O.length;p<C;p++)F=O[p],h+=(p?"L":"M")+F.x+" "+F.y;h+=o?J.svg?"z":"x":""}return h||"M0 0"}var St=document.documentElement.style,Zt="ActiveXObject"in window,ye=Zt&&!document.addEventListener,ji="msLaunchUri"in navigator&&!("documentMode"in document),ii=te("webkit"),Yi=te("android"),Wi=te("android 2")||te("android 3"),Ui=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Xi=Yi&&te("Google")&&Ui<537&&!("AudioNode"in window),xe=!!window.opera,ro=!ji&&te("chrome"),oo=te("gecko")&&!ii&&!xe&&!Zt,bh=!ro&&te("safari"),so=te("phantom"),ao="OTransition"in St,Ph=navigator.platform.indexOf("Win")===0,ho=Zt&&"transition"in St,Nn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Wi,lo="MozPerspective"in St,Mh=!window.L_DISABLE_3D&&(ho||Nn||lo)&&!ao&&!so,ni=typeof orientation<"u"||te("mobile"),Lh=ni&&ii,Ch=ni&&Nn,uo=!window.PointerEvent&&window.MSPointerEvent,co=!!(window.PointerEvent||uo),fo="ontouchstart"in window||!!window.TouchEvent,Sh=!window.L_NO_TOUCH&&(fo||co),kh=ni&&xe,Eh=ni&&oo,Th=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Dh=function(){var t=!1;try{var o=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return t}(),Ih=function(){return!!document.createElement("canvas").getContext}(),Rn=!!(document.createElementNS&&It("svg").createSVGRect),Bh=!!Rn&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),zh=!Rn&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var o=t.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),Oh=navigator.platform.indexOf("Mac")===0,Ah=navigator.platform.indexOf("Linux")===0;function te(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var J={ie:Zt,ielt9:ye,edge:ji,webkit:ii,android:Yi,android23:Wi,androidStock:Xi,opera:xe,chrome:ro,gecko:oo,safari:bh,phantom:so,opera12:ao,win:Ph,ie3d:ho,webkit3d:Nn,gecko3d:lo,any3d:Mh,mobile:ni,mobileWebkit:Lh,mobileWebkit3d:Ch,msPointer:uo,pointer:co,touch:Sh,touchNative:fo,mobileOpera:kh,mobileGecko:Eh,retina:Th,passiveEvents:Dh,canvas:Ih,svg:Rn,vml:zh,inlineSvg:Bh,mac:Oh,linux:Ah},po=J.msPointer?"MSPointerDown":"pointerdown",_o=J.msPointer?"MSPointerMove":"pointermove",mo=J.msPointer?"MSPointerUp":"pointerup",go=J.msPointer?"MSPointerCancel":"pointercancel",jn={touchstart:po,touchmove:_o,touchend:mo,touchcancel:go},vo={touchstart:Yh,touchmove:Vi,touchend:Vi,touchcancel:Vi},Be={},yo=!1;function Fh(t,o,h){return o==="touchstart"&&jh(),vo[o]?(h=vo[o].bind(this,h),t.addEventListener(jn[o],h,!1),h):(console.warn("wrong event specified:",o),g)}function Zh(t,o,h){if(!jn[o]){console.warn("wrong event specified:",o);return}t.removeEventListener(jn[o],h,!1)}function Nh(t){Be[t.pointerId]=t}function Rh(t){Be[t.pointerId]&&(Be[t.pointerId]=t)}function xo(t){delete Be[t.pointerId]}function jh(){yo||(document.addEventListener(po,Nh,!0),document.addEventListener(_o,Rh,!0),document.addEventListener(mo,xo,!0),document.addEventListener(go,xo,!0),yo=!0)}function Vi(t,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var h in Be)o.touches.push(Be[h]);o.changedTouches=[o],t(o)}}function Yh(t,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&Pt(o),Vi(t,o)}function Wh(t){var o={},h,c;for(c in t)h=t[c],o[c]=h&&h.bind?h.bind(t):h;return t=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var Uh=200;function Xh(t,o){t.addEventListener("dblclick",o);var h=0,c;function p(y){if(y.detail!==1){c=y.detail;return}if(!(y.pointerType==="mouse"||y.sourceCapabilities&&!y.sourceCapabilities.firesTouchEvents)){var C=Lo(y);if(!(C.some(function(F){return F instanceof HTMLLabelElement&&F.attributes.for})&&!C.some(function(F){return F instanceof HTMLInputElement||F instanceof HTMLSelectElement}))){var O=Date.now();O-h<=Uh?(c++,c===2&&o(Wh(y))):c=1,h=O}}}return t.addEventListener("click",p),{dblclick:o,simDblclick:p}}function Vh(t,o){t.removeEventListener("dblclick",o.dblclick),t.removeEventListener("click",o.simDblclick)}var Yn=$i(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ri=$i(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),wo=ri==="webkitTransition"||ri==="OTransition"?ri+"End":"transitionend";function bo(t){return typeof t=="string"?document.getElementById(t):t}function oi(t,o){var h=t.style[o]||t.currentStyle&&t.currentStyle[o];if((!h||h==="auto")&&document.defaultView){var c=document.defaultView.getComputedStyle(t,null);h=c?c[o]:null}return h==="auto"?null:h}function lt(t,o,h){var c=document.createElement(t);return c.className=o||"",h&&h.appendChild(c),c}function ft(t){var o=t.parentNode;o&&o.removeChild(t)}function Hi(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ze(t){var o=t.parentNode;o&&o.lastChild!==t&&o.appendChild(t)}function Oe(t){var o=t.parentNode;o&&o.firstChild!==t&&o.insertBefore(t,o.firstChild)}function Wn(t,o){if(t.classList!==void 0)return t.classList.contains(o);var h=Gi(t);return h.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(h)}function ot(t,o){if(t.classList!==void 0)for(var h=M(o),c=0,p=h.length;c<p;c++)t.classList.add(h[c]);else if(!Wn(t,o)){var y=Gi(t);Un(t,(y?y+" ":"")+o)}}function pt(t,o){t.classList!==void 0?t.classList.remove(o):Un(t,b((" "+Gi(t)+" ").replace(" "+o+" "," ")))}function Un(t,o){t.className.baseVal===void 0?t.className=o:t.className.baseVal=o}function Gi(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function Yt(t,o){"opacity"in t.style?t.style.opacity=o:"filter"in t.style&&Hh(t,o)}function Hh(t,o){var h=!1,c="DXImageTransform.Microsoft.Alpha";try{h=t.filters.item(c)}catch{if(o===1)return}o=Math.round(o*100),h?(h.Enabled=o!==100,h.Opacity=o):t.style.filter+=" progid:"+c+"(opacity="+o+")"}function $i(t){for(var o=document.documentElement.style,h=0;h<t.length;h++)if(t[h]in o)return t[h];return!1}function we(t,o,h){var c=o||new R(0,0);t.style[Yn]=(J.ie3d?"translate("+c.x+"px,"+c.y+"px)":"translate3d("+c.x+"px,"+c.y+"px,0)")+(h?" scale("+h+")":"")}function gt(t,o){t._leaflet_pos=o,J.any3d?we(t,o):(t.style.left=o.x+"px",t.style.top=o.y+"px")}function be(t){return t._leaflet_pos||new R(0,0)}var si,ai,Xn;if("onselectstart"in document)si=function(){rt(window,"selectstart",Pt)},ai=function(){ct(window,"selectstart",Pt)};else{var hi=$i(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);si=function(){if(hi){var t=document.documentElement.style;Xn=t[hi],t[hi]="none"}},ai=function(){hi&&(document.documentElement.style[hi]=Xn,Xn=void 0)}}function Vn(){rt(window,"dragstart",Pt)}function Hn(){ct(window,"dragstart",Pt)}var qi,Gn;function $n(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(Ki(),qi=t,Gn=t.style.outlineStyle,t.style.outlineStyle="none",rt(window,"keydown",Ki))}function Ki(){qi&&(qi.style.outlineStyle=Gn,qi=void 0,Gn=void 0,ct(window,"keydown",Ki))}function Po(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function qn(t){var o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}var Gh={__proto__:null,TRANSFORM:Yn,TRANSITION:ri,TRANSITION_END:wo,get:bo,getStyle:oi,create:lt,remove:ft,empty:Hi,toFront:ze,toBack:Oe,hasClass:Wn,addClass:ot,removeClass:pt,setClass:Un,getClass:Gi,setOpacity:Yt,testProp:$i,setTransform:we,setPosition:gt,getPosition:be,get disableTextSelection(){return si},get enableTextSelection(){return ai},disableImageDrag:Vn,enableImageDrag:Hn,preventOutline:$n,restoreOutline:Ki,getSizedParentNode:Po,getScale:qn};function rt(t,o,h,c){if(o&&typeof o=="object")for(var p in o)Jn(t,p,o[p],h);else{o=M(o);for(var y=0,C=o.length;y<C;y++)Jn(t,o[y],h,c)}return this}var ee="_leaflet_events";function ct(t,o,h,c){if(arguments.length===1)Mo(t),delete t[ee];else if(o&&typeof o=="object")for(var p in o)Qn(t,p,o[p],h);else if(o=M(o),arguments.length===2)Mo(t,function(O){return P(o,O)!==-1});else for(var y=0,C=o.length;y<C;y++)Qn(t,o[y],h,c);return this}function Mo(t,o){for(var h in t[ee]){var c=h.split(/\d/)[0];(!o||o(c))&&Qn(t,c,null,null,h)}}var Kn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Jn(t,o,h,c){var p=o+d(h)+(c?"_"+d(c):"");if(t[ee]&&t[ee][p])return this;var y=function(O){return h.call(c||t,O||window.event)},C=y;!J.touchNative&&J.pointer&&o.indexOf("touch")===0?y=Fh(t,o,y):J.touch&&o==="dblclick"?y=Xh(t,y):"addEventListener"in t?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?t.addEventListener(Kn[o]||o,y,J.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(y=function(O){O=O||window.event,er(t,O)&&C(O)},t.addEventListener(Kn[o],y,!1)):t.addEventListener(o,C,!1):t.attachEvent("on"+o,y),t[ee]=t[ee]||{},t[ee][p]=y}function Qn(t,o,h,c,p){p=p||o+d(h)+(c?"_"+d(c):"");var y=t[ee]&&t[ee][p];if(!y)return this;!J.touchNative&&J.pointer&&o.indexOf("touch")===0?Zh(t,o,y):J.touch&&o==="dblclick"?Vh(t,y):"removeEventListener"in t?t.removeEventListener(Kn[o]||o,y,!1):t.detachEvent("on"+o,y),t[ee][p]=null}function Pe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function tr(t){return Jn(t,"wheel",Pe),this}function li(t){return rt(t,"mousedown touchstart dblclick contextmenu",Pe),t._leaflet_disable_click=!0,this}function Pt(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Me(t){return Pt(t),Pe(t),this}function Lo(t){if(t.composedPath)return t.composedPath();for(var o=[],h=t.target;h;)o.push(h),h=h.parentNode;return o}function Co(t,o){if(!o)return new R(t.clientX,t.clientY);var h=qn(o),c=h.boundingClientRect;return new R((t.clientX-c.left)/h.x-o.clientLeft,(t.clientY-c.top)/h.y-o.clientTop)}var $h=J.linux&&J.chrome?window.devicePixelRatio:J.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function So(t){return J.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/$h:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function er(t,o){var h=o.relatedTarget;if(!h)return!0;try{for(;h&&h!==t;)h=h.parentNode}catch{return!1}return h!==t}var qh={__proto__:null,on:rt,off:ct,stopPropagation:Pe,disableScrollPropagation:tr,disableClickPropagation:li,preventDefault:Pt,stop:Me,getPropagationPath:Lo,getMousePosition:Co,getWheelDelta:So,isExternalTarget:er,addListener:rt,removeListener:ct},ko=V.extend({run:function(t,o,h,c){this.stop(),this._el=t,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(c||.5,.2),this._startPos=be(t),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Y(this._animate,this),this._step()},_step:function(t){var o=+new Date-this._startTime,h=this._duration*1e3;o<h?this._runFrame(this._easeOut(o/h),t):(this._runFrame(1),this._complete())},_runFrame:function(t,o){var h=this._startPos.add(this._offset.multiplyBy(t));o&&h._round(),gt(this._el,h),this.fire("step")},_complete:function(){X(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),at=V.extend({options:{crs:Ct,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,o){o=S(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView($(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ri&&J.any3d&&!J.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,wo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,o,h){if(o=o===void 0?this._zoom:this._limitZoom(o),t=this._limitCenter($(t),o,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var c=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,h.zoom):this._tryAnimatedPan(t,h.pan);if(c)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o,h.pan&&h.pan.noMoveStart),this},setZoom:function(t,o){return this._loaded?this.setView(this.getCenter(),t,{zoom:o}):(this._zoom=t,this)},zoomIn:function(t,o){return t=t||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,o)},zoomOut:function(t,o){return t=t||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,o)},setZoomAround:function(t,o,h){var c=this.getZoomScale(o),p=this.getSize().divideBy(2),y=t instanceof R?t:this.latLngToContainerPoint(t),C=y.subtract(p).multiplyBy(1-1/c),O=this.containerPointToLatLng(p.add(C));return this.setView(O,o,{zoom:h})},_getBoundsCenterZoom:function(t,o){o=o||{},t=t.getBounds?t.getBounds():Q(t);var h=Z(o.paddingTopLeft||o.padding||[0,0]),c=Z(o.paddingBottomRight||o.padding||[0,0]),p=this.getBoundsZoom(t,!1,h.add(c));if(p=typeof o.maxZoom=="number"?Math.min(o.maxZoom,p):p,p===1/0)return{center:t.getCenter(),zoom:p};var y=c.subtract(h).divideBy(2),C=this.project(t.getSouthWest(),p),O=this.project(t.getNorthEast(),p),F=this.unproject(C.add(O).divideBy(2).add(y),p);return{center:F,zoom:p}},fitBounds:function(t,o){if(t=Q(t),!t.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(t,o);return this.setView(h.center,h.zoom,o)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,o){return this.setView(t,this._zoom,{pan:o})},panBy:function(t,o){if(t=Z(t).round(),o=o||{},!t.x&&!t.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ko,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){ot(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,h,o.duration||.25,o.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,o,h){if(h=h||{},h.animate===!1||!J.any3d)return this.setView(t,o,h);this._stop();var c=this.project(this.getCenter()),p=this.project(t),y=this.getSize(),C=this._zoom;t=$(t),o=o===void 0?C:o;var O=Math.max(y.x,y.y),F=O*this.getZoomScale(C,o),W=p.distanceTo(c)||1,q=1.42,tt=q*q;function st(vt){var un=vt?-1:1,Zl=vt?F:O,Nl=F*F-O*O+un*tt*tt*W*W,Rl=2*Zl*tt*W,dr=Nl/Rl,hs=Math.sqrt(dr*dr+1)-dr,jl=hs<1e-9?-18:Math.log(hs);return jl}function kt(vt){return(Math.exp(vt)-Math.exp(-vt))/2}function bt(vt){return(Math.exp(vt)+Math.exp(-vt))/2}function Ut(vt){return kt(vt)/bt(vt)}var zt=st(0);function je(vt){return O*(bt(zt)/bt(zt+q*vt))}function zl(vt){return O*(bt(zt)*Ut(zt+q*vt)-kt(zt))/tt}function Ol(vt){return 1-Math.pow(1-vt,1.5)}var Al=Date.now(),ss=(st(1)-zt)/q,Fl=h.duration?1e3*h.duration:1e3*ss*.8;function as(){var vt=(Date.now()-Al)/Fl,un=Ol(vt)*ss;vt<=1?(this._flyToFrame=Y(as,this),this._move(this.unproject(c.add(p.subtract(c).multiplyBy(zl(un)/W)),C),this.getScaleZoom(O/je(un),C),{flyTo:!0})):this._move(t,o)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),as.call(this),this},flyToBounds:function(t,o){var h=this._getBoundsCenterZoom(t,o);return this.flyTo(h.center,h.zoom,o)},setMaxBounds:function(t){return t=Q(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var o=this.options.minZoom;return this.options.minZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var o=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,o){this._enforcingBounds=!0;var h=this.getCenter(),c=this._limitCenter(h,this._zoom,Q(t));return h.equals(c)||this.panTo(c,o),this._enforcingBounds=!1,this},panInside:function(t,o){o=o||{};var h=Z(o.paddingTopLeft||o.padding||[0,0]),c=Z(o.paddingBottomRight||o.padding||[0,0]),p=this.project(this.getCenter()),y=this.project(t),C=this.getPixelBounds(),O=G([C.min.add(h),C.max.subtract(c)]),F=O.getSize();if(!O.contains(y)){this._enforcingBounds=!0;var W=y.subtract(O.getCenter()),q=O.extend(y).getSize().subtract(F);p.x+=W.x<0?-q.x:q.x,p.y+=W.y<0?-q.y:q.y,this.panTo(this.unproject(p),o),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=s({animate:!1,pan:!0},t===!0?{animate:!0}:t);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),c=o.divideBy(2).round(),p=h.divideBy(2).round(),y=c.subtract(p);return!y.x&&!y.y?this:(t.animate&&t.pan?this.panBy(y):(t.pan&&this._rawPanBy(y),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=s({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,h,t):navigator.geolocation.getCurrentPosition(o,h,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var o=t.code,h=t.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var o=t.coords.latitude,h=t.coords.longitude,c=new et(o,h),p=c.toBounds(t.coords.accuracy*2),y=this._locateOptions;if(y.setView){var C=this.getBoundsZoom(p);this.setView(c,y.maxZoom?Math.min(C,y.maxZoom):C)}var O={latlng:c,bounds:p,timestamp:t.timestamp};for(var F in t.coords)typeof t.coords[F]=="number"&&(O[F]=t.coords[F]);this.fire("locationfound",O)}},addHandler:function(t,o){if(!o)return this;var h=this[t]=new o(this);return this._handlers.push(h),this.options[t]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(X(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ft(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,o){var h="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),c=lt("div",h,o||this._mapPane);return t&&(this._panes[t]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),o=this.unproject(t.getBottomLeft()),h=this.unproject(t.getTopRight());return new nt(o,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,o,h){t=Q(t),h=Z(h||[0,0]);var c=this.getZoom()||0,p=this.getMinZoom(),y=this.getMaxZoom(),C=t.getNorthWest(),O=t.getSouthEast(),F=this.getSize().subtract(h),W=G(this.project(O,c),this.project(C,c)).getSize(),q=J.any3d?this.options.zoomSnap:1,tt=F.x/W.x,st=F.y/W.y,kt=o?Math.max(tt,st):Math.min(tt,st);return c=this.getScaleZoom(kt,c),q&&(c=Math.round(c/(q/100))*(q/100),c=o?Math.ceil(c/q)*q:Math.floor(c/q)*q),Math.max(p,Math.min(y,c))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,o){var h=this._getTopLeftPoint(t,o);return new H(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,o){var h=this.options.crs;return o=o===void 0?this._zoom:o,h.scale(t)/h.scale(o)},getScaleZoom:function(t,o){var h=this.options.crs;o=o===void 0?this._zoom:o;var c=h.zoom(t*h.scale(o));return isNaN(c)?1/0:c},project:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint($(t),o)},unproject:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(Z(t),o)},layerPointToLatLng:function(t){var o=Z(t).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(t){var o=this.project($(t))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng($(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(Q(t))},distance:function(t,o){return this.options.crs.distance($(t),$(o))},containerPointToLayerPoint:function(t){return Z(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return Z(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var o=this.containerPointToLayerPoint(Z(t));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint($(t)))},mouseEventToContainerPoint:function(t){return Co(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var o=this._container=bo(t);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(o,"scroll",this._onScroll,this),this._containerId=d(o)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&J.any3d,ot(t,"leaflet-container"+(J.touch?" leaflet-touch":"")+(J.retina?" leaflet-retina":"")+(J.ielt9?" leaflet-oldie":"")+(J.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=oi(t,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),gt(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ot(t.markerPane,"leaflet-zoom-hide"),ot(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,o,h){gt(this._mapPane,new R(0,0));var c=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var p=this._zoom!==o;this._moveStart(p,h)._move(t,o)._moveEnd(p),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(t,o){return t&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(t,o,h,c){o===void 0&&(o=this._zoom);var p=this._zoom!==o;return this._zoom=o,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),c?h&&h.pinch&&this.fire("zoom",h):((p||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return X(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){gt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[d(this._container)]=this;var o=t?ct:rt;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),J.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){X(this._resizeRequest),this._resizeRequest=Y(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,o){for(var h=[],c,p=o==="mouseout"||o==="mouseover",y=t.target||t.srcElement,C=!1;y;){if(c=this._targets[d(y)],c&&(o==="click"||o==="preclick")&&this._draggableMoved(c)){C=!0;break}if(c&&c.listens(o,!0)&&(p&&!er(y,t)||(h.push(c),p))||y===this._container)break;y=y.parentNode}return!h.length&&!C&&!p&&this.listens(o,!0)&&(h=[this]),h},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var o=t.target||t.srcElement;if(!(!this._loaded||o._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(o))){var h=t.type;h==="mousedown"&&$n(o),this._fireDOMEvent(t,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,o,h){if(t.type==="click"){var c=s({},t);c.type="preclick",this._fireDOMEvent(c,c.type,h)}var p=this._findEventTargets(t,o);if(h){for(var y=[],C=0;C<h.length;C++)h[C].listens(o,!0)&&y.push(h[C]);p=y.concat(p)}if(p.length){o==="contextmenu"&&Pt(t);var O=p[0],F={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var W=O.getLatLng&&(!O._radius||O._radius<=10);F.containerPoint=W?this.latLngToContainerPoint(O.getLatLng()):this.mouseEventToContainerPoint(t),F.layerPoint=this.containerPointToLayerPoint(F.containerPoint),F.latlng=W?O.getLatLng():this.layerPointToLatLng(F.layerPoint)}for(C=0;C<p.length;C++)if(p[C].fire(o,F,!0),F.originalEvent._stopped||p[C].options.bubblingMouseEvents===!1&&P(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,o=this._handlers.length;t<o;t++)this._handlers[t].disable()},whenReady:function(t,o){return this._loaded?t.call(o||this,{target:this}):this.on("load",t,o),this},_getMapPanePos:function(){return be(this._mapPane)||new R(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,o){var h=t&&o!==void 0?this._getNewPixelOrigin(t,o):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,o){var h=this.getSize()._divideBy(2);return this.project(t,o)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,o,h){var c=this._getNewPixelOrigin(h,o);return this.project(t,o)._subtract(c)},_latLngBoundsToNewLayerBounds:function(t,o,h){var c=this._getNewPixelOrigin(h,o);return G([this.project(t.getSouthWest(),o)._subtract(c),this.project(t.getNorthWest(),o)._subtract(c),this.project(t.getSouthEast(),o)._subtract(c),this.project(t.getNorthEast(),o)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,o,h){if(!h)return t;var c=this.project(t,o),p=this.getSize().divideBy(2),y=new H(c.subtract(p),c.add(p)),C=this._getBoundsOffset(y,h,o);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?t:this.unproject(c.add(C),o)},_limitOffset:function(t,o){if(!o)return t;var h=this.getPixelBounds(),c=new H(h.min.add(t),h.max.add(t));return t.add(this._getBoundsOffset(c,o))},_getBoundsOffset:function(t,o,h){var c=G(this.project(o.getNorthEast(),h),this.project(o.getSouthWest(),h)),p=c.min.subtract(t.min),y=c.max.subtract(t.max),C=this._rebound(p.x,-y.x),O=this._rebound(p.y,-y.y);return new R(C,O)},_rebound:function(t,o){return t+o>0?Math.round(t-o)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(o))},_limitZoom:function(t){var o=this.getMinZoom(),h=this.getMaxZoom(),c=J.any3d?this.options.zoomSnap:1;return c&&(t=Math.round(t/c)*c),Math.max(o,Math.min(h,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,o){var h=this._getCenterOffset(t)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,o),!0)},_createAnimProxy:function(){var t=this._proxy=lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(o){var h=Yn,c=this._proxy.style[h];we(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),c===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),o=this.getZoom();we(this._proxy,this.project(t,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,o,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var c=this.getZoomScale(o),p=this._getCenterOffset(t)._divideBy(1-1/c);return h.animate!==!0&&!this.getSize().contains(p)?!1:(Y(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(t,o,!0)},this),!0)},_animateZoom:function(t,o,h,c){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=o,ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:o,noUpdate:c}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Kh(t,o){return new at(t,o)}var Vt=v.extend({options:{position:"topright"},initialize:function(t){S(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var o=this._container=this.onAdd(t),h=this.getPosition(),c=t._controlCorners[h];return ot(o,"leaflet-control"),h.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),ui=function(t){return new Vt(t)};at.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},o="leaflet-",h=this._controlContainer=lt("div",o+"control-container",this._container);function c(p,y){var C=o+p+" "+o+y;t[p+y]=lt("div",C,h)}c("top","left"),c("top","right"),c("bottom","left"),c("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ft(this._controlCorners[t]);ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Eo=Vt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,o,h,c){return h<c?-1:c<h?1:0}},initialize:function(t,o,h){S(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var c in t)this._addLayer(t[c],c);for(c in o)this._addLayer(o[c],c,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Vt.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,o){return this._addLayer(t,o),this._map?this._update():this},addOverlay:function(t,o){return this._addLayer(t,o,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var o=this._getLayer(d(t));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):pt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",o=this._container=lt("div",t),h=this.options.collapsed;o.setAttribute("aria-haspopup",!0),li(o),tr(o);var c=this._section=lt("section",t+"-list");h&&(this._map.on("click",this.collapse,this),rt(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var p=this._layersLink=lt("a",t+"-toggle",o);p.href="#",p.title="Layers",p.setAttribute("role","button"),rt(p,{keydown:function(y){y.keyCode===13&&this._expandSafely()},click:function(y){Pt(y),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=lt("div",t+"-base",c),this._separator=lt("div",t+"-separator",c),this._overlaysList=lt("div",t+"-overlays",c),o.appendChild(c)},_getLayer:function(t){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&d(this._layers[o].layer)===t)return this._layers[o]},_addLayer:function(t,o,h){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:o,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(c,p){return this.options.sortFunction(c.layer,p.layer,c.name,p.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Hi(this._baseLayersList),Hi(this._overlaysList),this._layerControlInputs=[];var t,o,h,c,p=0;for(h=0;h<this._layers.length;h++)c=this._layers[h],this._addItem(c),o=o||c.overlay,t=t||!c.overlay,p+=c.overlay?0:1;return this.options.hideSingleBase&&(t=t&&p>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=o&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var o=this._getLayer(d(t.target)),h=o.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;h&&this._map.fire(h,o)},_createRadioElement:function(t,o){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(o?' checked="checked"':"")+"/>",c=document.createElement("div");return c.innerHTML=h,c.firstChild},_addItem:function(t){var o=document.createElement("label"),h=this._map.hasLayer(t.layer),c;t.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=h):c=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(c),c.layerId=d(t.layer),rt(c,"click",this._onInputClick,this);var p=document.createElement("span");p.innerHTML=" "+t.name;var y=document.createElement("span");o.appendChild(y),y.appendChild(c),y.appendChild(p);var C=t.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,o,h,c=[],p=[];this._handlingClick=!0;for(var y=t.length-1;y>=0;y--)o=t[y],h=this._getLayer(o.layerId).layer,o.checked?c.push(h):o.checked||p.push(h);for(y=0;y<p.length;y++)this._map.hasLayer(p[y])&&this._map.removeLayer(p[y]);for(y=0;y<c.length;y++)this._map.hasLayer(c[y])||this._map.addLayer(c[y]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,o,h,c=this._map.getZoom(),p=t.length-1;p>=0;p--)o=t[p],h=this._getLayer(o.layerId).layer,o.disabled=h.options.minZoom!==void 0&&c<h.options.minZoom||h.options.maxZoom!==void 0&&c>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,rt(t,"click",Pt),this.expand();var o=this;setTimeout(function(){ct(t,"click",Pt),o._preventClick=!1})}}),Jh=function(t,o,h){return new Eo(t,o,h)},ir=Vt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var o="leaflet-control-zoom",h=lt("div",o+" leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,o+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,o+"-out",h,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,o,h,c,p){var y=lt("a",h,c);return y.innerHTML=t,y.href="#",y.title=o,y.setAttribute("role","button"),y.setAttribute("aria-label",o),li(y),rt(y,"click",Me),rt(y,"click",p,this),rt(y,"click",this._refocusOnMap,this),y},_updateDisabled:function(){var t=this._map,o="leaflet-disabled";pt(this._zoomInButton,o),pt(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ot(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ot(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});at.mergeOptions({zoomControl:!0}),at.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ir,this.addControl(this.zoomControl))});var Qh=function(t){return new ir(t)},To=Vt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var o="leaflet-control-scale",h=lt("div",o),c=this.options;return this._addScales(c,o+"-line",h),t.on(c.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),h},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,o,h){t.metric&&(this._mScale=lt("div",o,h)),t.imperial&&(this._iScale=lt("div",o,h))},_update:function(){var t=this._map,o=t.getSize().y/2,h=t.distance(t.containerPointToLatLng([0,o]),t.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(h)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var o=this._getRoundNum(t),h=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,h,o/t)},_updateImperial:function(t){var o=t*3.2808399,h,c,p;o>5280?(h=o/5280,c=this._getRoundNum(h),this._updateScale(this._iScale,c+" mi",c/h)):(p=this._getRoundNum(o),this._updateScale(this._iScale,p+" ft",p/o))},_updateScale:function(t,o,h){t.style.width=Math.round(this.options.maxWidth*h)+"px",t.innerHTML=o},_getRoundNum:function(t){var o=Math.pow(10,(Math.floor(t)+"").length-1),h=t/o;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,o*h}}),tl=function(t){return new To(t)},el='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',nr=Vt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(J.inlineSvg?el+" ":"")+"Leaflet</a>"},initialize:function(t){S(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=lt("div","leaflet-control-attribution"),li(this._container);for(var o in t._layers)t._layers[o].getAttribution&&this.addAttribution(t._layers[o].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var o in this._attributions)this._attributions[o]&&t.push(o);var h=[];this.options.prefix&&h.push(this.options.prefix),t.length&&h.push(t.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});at.mergeOptions({attributionControl:!0}),at.addInitHook(function(){this.options.attributionControl&&new nr().addTo(this)});var il=function(t){return new nr(t)};Vt.Layers=Eo,Vt.Zoom=ir,Vt.Scale=To,Vt.Attribution=nr,ui.layers=Jh,ui.zoom=Qh,ui.scale=tl,ui.attribution=il;var ie=v.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ie.addTo=function(t,o){return t.addHandler(o,this),this};var nl={Events:z},Do=J.touch?"touchstart mousedown":"mousedown",me=V.extend({options:{clickTolerance:3},initialize:function(t,o,h,c){S(this,c),this._element=t,this._dragStartTarget=o||t,this._preventOutline=h},enable:function(){this._enabled||(rt(this._dragStartTarget,Do,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(me._dragging===this&&this.finishDrag(!0),ct(this._dragStartTarget,Do,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Wn(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){me._dragging===this&&this.finishDrag();return}if(!(me._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(me._dragging=this,this._preventOutline&&$n(this._element),Vn(),si(),!this._moving)){this.fire("down");var o=t.touches?t.touches[0]:t,h=Po(this._element);this._startPoint=new R(o.clientX,o.clientY),this._startPos=be(this._element),this._parentScale=qn(h);var c=t.type==="mousedown";rt(document,c?"mousemove":"touchmove",this._onMove,this),rt(document,c?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var o=t.touches&&t.touches.length===1?t.touches[0]:t,h=new R(o.clientX,o.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Pt(t),this._moved||(this.fire("dragstart"),this._moved=!0,ot(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),gt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){pt(document.body,"leaflet-dragging"),this._lastTarget&&(pt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ct(document,"mousemove touchmove",this._onMove,this),ct(document,"mouseup touchend touchcancel",this._onUp,this),Hn(),ai();var o=this._moved&&this._moving;this._moving=!1,me._dragging=!1,o&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Io(t,o,h){var c,p=[1,4,2,8],y,C,O,F,W,q,tt,st;for(y=0,q=t.length;y<q;y++)t[y]._code=Le(t[y],o);for(O=0;O<4;O++){for(tt=p[O],c=[],y=0,q=t.length,C=q-1;y<q;C=y++)F=t[y],W=t[C],F._code&tt?W._code&tt||(st=Ji(W,F,tt,o,h),st._code=Le(st,o),c.push(st)):(W._code&tt&&(st=Ji(W,F,tt,o,h),st._code=Le(st,o),c.push(st)),c.push(F));t=c}return t}function Bo(t,o){var h,c,p,y,C,O,F,W,q;if(!t||t.length===0)throw new Error("latlngs not passed");Wt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var tt=$([0,0]),st=Q(t),kt=st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest());kt<1700&&(tt=rr(t));var bt=t.length,Ut=[];for(h=0;h<bt;h++){var zt=$(t[h]);Ut.push(o.project($([zt.lat-tt.lat,zt.lng-tt.lng])))}for(O=F=W=0,h=0,c=bt-1;h<bt;c=h++)p=Ut[h],y=Ut[c],C=p.y*y.x-y.y*p.x,F+=(p.x+y.x)*C,W+=(p.y+y.y)*C,O+=C*3;O===0?q=Ut[0]:q=[F/O,W/O];var je=o.unproject(Z(q));return $([je.lat+tt.lat,je.lng+tt.lng])}function rr(t){for(var o=0,h=0,c=0,p=0;p<t.length;p++){var y=$(t[p]);o+=y.lat,h+=y.lng,c++}return $([o/c,h/c])}var rl={__proto__:null,clipPolygon:Io,polygonCenter:Bo,centroid:rr};function zo(t,o){if(!o||!t.length)return t.slice();var h=o*o;return t=al(t,h),t=sl(t,h),t}function Oo(t,o,h){return Math.sqrt(ci(t,o,h,!0))}function ol(t,o,h){return ci(t,o,h)}function sl(t,o){var h=t.length,c=typeof Uint8Array<"u"?Uint8Array:Array,p=new c(h);p[0]=p[h-1]=1,or(t,p,o,0,h-1);var y,C=[];for(y=0;y<h;y++)p[y]&&C.push(t[y]);return C}function or(t,o,h,c,p){var y=0,C,O,F;for(O=c+1;O<=p-1;O++)F=ci(t[O],t[c],t[p],!0),F>y&&(C=O,y=F);y>h&&(o[C]=1,or(t,o,h,c,C),or(t,o,h,C,p))}function al(t,o){for(var h=[t[0]],c=1,p=0,y=t.length;c<y;c++)hl(t[c],t[p])>o&&(h.push(t[c]),p=c);return p<y-1&&h.push(t[y-1]),h}var Ao;function Fo(t,o,h,c,p){var y=c?Ao:Le(t,h),C=Le(o,h),O,F,W;for(Ao=C;;){if(!(y|C))return[t,o];if(y&C)return!1;O=y||C,F=Ji(t,o,O,h,p),W=Le(F,h),O===y?(t=F,y=W):(o=F,C=W)}}function Ji(t,o,h,c,p){var y=o.x-t.x,C=o.y-t.y,O=c.min,F=c.max,W,q;return h&8?(W=t.x+y*(F.y-t.y)/C,q=F.y):h&4?(W=t.x+y*(O.y-t.y)/C,q=O.y):h&2?(W=F.x,q=t.y+C*(F.x-t.x)/y):h&1&&(W=O.x,q=t.y+C*(O.x-t.x)/y),new R(W,q,p)}function Le(t,o){var h=0;return t.x<o.min.x?h|=1:t.x>o.max.x&&(h|=2),t.y<o.min.y?h|=4:t.y>o.max.y&&(h|=8),h}function hl(t,o){var h=o.x-t.x,c=o.y-t.y;return h*h+c*c}function ci(t,o,h,c){var p=o.x,y=o.y,C=h.x-p,O=h.y-y,F=C*C+O*O,W;return F>0&&(W=((t.x-p)*C+(t.y-y)*O)/F,W>1?(p=h.x,y=h.y):W>0&&(p+=C*W,y+=O*W)),C=t.x-p,O=t.y-y,c?C*C+O*O:new R(p,y)}function Wt(t){return!w(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Zo(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Wt(t)}function No(t,o){var h,c,p,y,C,O,F,W;if(!t||t.length===0)throw new Error("latlngs not passed");Wt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var q=$([0,0]),tt=Q(t),st=tt.getNorthWest().distanceTo(tt.getSouthWest())*tt.getNorthEast().distanceTo(tt.getNorthWest());st<1700&&(q=rr(t));var kt=t.length,bt=[];for(h=0;h<kt;h++){var Ut=$(t[h]);bt.push(o.project($([Ut.lat-q.lat,Ut.lng-q.lng])))}for(h=0,c=0;h<kt-1;h++)c+=bt[h].distanceTo(bt[h+1])/2;if(c===0)W=bt[0];else for(h=0,y=0;h<kt-1;h++)if(C=bt[h],O=bt[h+1],p=C.distanceTo(O),y+=p,y>c){F=(y-c)/p,W=[O.x-F*(O.x-C.x),O.y-F*(O.y-C.y)];break}var zt=o.unproject(Z(W));return $([zt.lat+q.lat,zt.lng+q.lng])}var ll={__proto__:null,simplify:zo,pointToSegmentDistance:Oo,closestPointOnSegment:ol,clipSegment:Fo,_getEdgeIntersection:Ji,_getBitCode:Le,_sqClosestPointOnSegment:ci,isFlat:Wt,_flat:Zo,polylineCenter:No},sr={project:function(t){return new R(t.lng,t.lat)},unproject:function(t){return new et(t.y,t.x)},bounds:new H([-180,-90],[180,90])},ar={R:6378137,R_MINOR:6356752314245179e-9,bounds:new H([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var o=Math.PI/180,h=this.R,c=t.lat*o,p=this.R_MINOR/h,y=Math.sqrt(1-p*p),C=y*Math.sin(c),O=Math.tan(Math.PI/4-c/2)/Math.pow((1-C)/(1+C),y/2);return c=-h*Math.log(Math.max(O,1e-10)),new R(t.lng*o*h,c)},unproject:function(t){for(var o=180/Math.PI,h=this.R,c=this.R_MINOR/h,p=Math.sqrt(1-c*c),y=Math.exp(-t.y/h),C=Math.PI/2-2*Math.atan(y),O=0,F=.1,W;O<15&&Math.abs(F)>1e-7;O++)W=p*Math.sin(C),W=Math.pow((1-W)/(1+W),p/2),F=Math.PI/2-2*Math.atan(y*W)-C,C+=F;return new et(C*o,t.x*o/h)}},ul={__proto__:null,LonLat:sr,Mercator:ar,SphericalMercator:Mt},cl=s({},dt,{code:"EPSG:3395",projection:ar,transformation:function(){var t=.5/(Math.PI*ar.R);return Dt(t,.5,-t,.5)}()}),Ro=s({},dt,{code:"EPSG:4326",projection:sr,transformation:Dt(1/180,1,-1/180,.5)}),dl=s({},ht,{projection:sr,transformation:Dt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,o){var h=o.lng-t.lng,c=o.lat-t.lat;return Math.sqrt(h*h+c*c)},infinite:!0});ht.Earth=dt,ht.EPSG3395=cl,ht.EPSG3857=Ct,ht.EPSG900913=Ft,ht.EPSG4326=Ro,ht.Simple=dl;var Ht=V.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[d(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[d(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var o=t.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var h=this.getEvents();o.on(h,this),this.once("remove",function(){o.off(h,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});at.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var o=d(t);return this._layers[o]?this:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=d(t);return this._layers[o]?(this._loaded&&t.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return d(t)in this._layers},eachLayer:function(t,o){for(var h in this._layers)t.call(o,this._layers[h]);return this},_addLayers:function(t){t=t?w(t)?t:[t]:[];for(var o=0,h=t.length;o<h;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[d(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=d(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,h=this._getZoomSpan();for(var c in this._zoomBoundLayers){var p=this._zoomBoundLayers[c].options;t=p.minZoom===void 0?t:Math.min(t,p.minZoom),o=p.maxZoom===void 0?o:Math.max(o,p.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=t===1/0?void 0:t,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ae=Ht.extend({initialize:function(t,o){S(this,o),this._layers={};var h,c;if(t)for(h=0,c=t.length;h<c;h++)this.addLayer(t[h])},addLayer:function(t){var o=this.getLayerId(t);return this._layers[o]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var o=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(t){var o=typeof t=="number"?t:this.getLayerId(t);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var o=Array.prototype.slice.call(arguments,1),h,c;for(h in this._layers)c=this._layers[h],c[t]&&c[t].apply(c,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,o){for(var h in this._layers)t.call(o,this._layers[h]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return d(t)}}),fl=function(t,o){return new Ae(t,o)},ae=Ae.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ae.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ae.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new nt;for(var o in this._layers){var h=this._layers[o];t.extend(h.getBounds?h.getBounds():h.getLatLng())}return t}}),pl=function(t,o){return new ae(t,o)},Fe=v.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){S(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,o){var h=this._getIconUrl(t);if(!h){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var c=this._createImg(h,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(c,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c},_setIconStyles:function(t,o){var h=this.options,c=h[o+"Size"];typeof c=="number"&&(c=[c,c]);var p=Z(c),y=Z(o==="shadow"&&h.shadowAnchor||h.iconAnchor||p&&p.divideBy(2,!0));t.className="leaflet-marker-"+o+" "+(h.className||""),y&&(t.style.marginLeft=-y.x+"px",t.style.marginTop=-y.y+"px"),p&&(t.style.width=p.x+"px",t.style.height=p.y+"px")},_createImg:function(t,o){return o=o||document.createElement("img"),o.src=t,o},_getIconUrl:function(t){return J.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function _l(t){return new Fe(t)}var di=Fe.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof di.imagePath!="string"&&(di.imagePath=this._detectIconPath()),(this.options.imagePath||di.imagePath)+Fe.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var o=function(h,c,p){var y=c.exec(h);return y&&y[p]};return t=o(t,/^url\((['"])?(.+)\1\)$/,2),t&&o(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=lt("div","leaflet-default-icon-path",document.body),o=oi(t,"background-image")||oi(t,"backgroundImage");if(document.body.removeChild(t),o=this._stripUrl(o),o)return o;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),jo=ie.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new me(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ot(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var o=this._marker,h=o._map,c=this._marker.options.autoPanSpeed,p=this._marker.options.autoPanPadding,y=be(o._icon),C=h.getPixelBounds(),O=h.getPixelOrigin(),F=G(C.min._subtract(O).add(p),C.max._subtract(O).subtract(p));if(!F.contains(y)){var W=Z((Math.max(F.max.x,y.x)-F.max.x)/(C.max.x-F.max.x)-(Math.min(F.min.x,y.x)-F.min.x)/(C.min.x-F.min.x),(Math.max(F.max.y,y.y)-F.max.y)/(C.max.y-F.max.y)-(Math.min(F.min.y,y.y)-F.min.y)/(C.min.y-F.min.y)).multiplyBy(c);h.panBy(W,{animate:!1}),this._draggable._newPos._add(W),this._draggable._startPos._add(W),gt(o._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=Y(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(X(this._panRequest),this._panRequest=Y(this._adjustPan.bind(this,t)))},_onDrag:function(t){var o=this._marker,h=o._shadow,c=be(o._icon),p=o._map.layerPointToLatLng(c);h&&gt(h,c),o._latlng=p,t.latlng=p,t.oldLatLng=this._oldLatLng,o.fire("move",t).fire("drag",t)},_onDragEnd:function(t){X(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Qi=Ht.extend({options:{icon:new di,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,o){S(this,o),this._latlng=$(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var o=this._latlng;return this._latlng=$(t),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=t.icon.createIcon(this._icon),c=!1;h!==this._icon&&(this._icon&&this._removeIcon(),c=!0,t.title&&(h.title=t.title),h.tagName==="IMG"&&(h.alt=t.alt||"")),ot(h,o),t.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(h,"focus",this._panOnFocus,this);var p=t.icon.createShadow(this._shadow),y=!1;p!==this._shadow&&(this._removeShadow(),y=!0),p&&(ot(p,o),p.alt=""),this._shadow=p,t.opacity<1&&this._updateOpacity(),c&&this.getPane().appendChild(this._icon),this._initInteraction(),p&&y&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ct(this._icon,"focus",this._panOnFocus,this),ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ft(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&gt(this._icon,t),this._shadow&&gt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),jo)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new jo(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Yt(this._icon,t),this._shadow&&Yt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var o=this.options.icon.options,h=o.iconSize?Z(o.iconSize):Z(0,0),c=o.iconAnchor?Z(o.iconAnchor):Z(0,0);t.panInside(this._latlng,{paddingTopLeft:c,paddingBottomRight:h.subtract(c)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ml(t,o){return new Qi(t,o)}var ge=Ht.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return S(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),tn=ge.extend({options:{fill:!0,radius:10},initialize:function(t,o){S(this,o),this._latlng=$(t),this._radius=this.options.radius},setLatLng:function(t){var o=this._latlng;return this._latlng=$(t),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var o=t&&t.radius||this._radius;return ge.prototype.setStyle.call(this,t),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,o=this._radiusY||t,h=this._clickTolerance(),c=[t+h,o+h];this._pxBounds=new H(this._point.subtract(c),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function gl(t,o){return new tn(t,o)}var hr=tn.extend({initialize:function(t,o,h){if(typeof o=="number"&&(o=s({},h,{radius:o})),S(this,o),this._latlng=$(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new nt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:ge.prototype.setStyle,_project:function(){var t=this._latlng.lng,o=this._latlng.lat,h=this._map,c=h.options.crs;if(c.distance===dt.distance){var p=Math.PI/180,y=this._mRadius/dt.R/p,C=h.project([o+y,t]),O=h.project([o-y,t]),F=C.add(O).divideBy(2),W=h.unproject(F).lat,q=Math.acos((Math.cos(y*p)-Math.sin(o*p)*Math.sin(W*p))/(Math.cos(o*p)*Math.cos(W*p)))/p;(isNaN(q)||q===0)&&(q=y/Math.cos(Math.PI/180*o)),this._point=F.subtract(h.getPixelOrigin()),this._radius=isNaN(q)?0:F.x-h.project([W,t-q]).x,this._radiusY=F.y-C.y}else{var tt=c.unproject(c.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(tt).x}this._updateBounds()}});function vl(t,o,h){return new hr(t,o,h)}var he=ge.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,o){S(this,o),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var o=1/0,h=null,c=ci,p,y,C=0,O=this._parts.length;C<O;C++)for(var F=this._parts[C],W=1,q=F.length;W<q;W++){p=F[W-1],y=F[W];var tt=c(t,p,y,!0);tt<o&&(o=tt,h=c(t,p,y))}return h&&(h.distance=Math.sqrt(o)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return No(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,o){return o=o||this._defaultShape(),t=$(t),o.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new nt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Wt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var o=[],h=Wt(t),c=0,p=t.length;c<p;c++)h?(o[c]=$(t[c]),this._bounds.extend(o[c])):o[c]=this._convertLatLngs(t[c]);return o},_project:function(){var t=new H;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),o=new R(t,t);this._rawPxBounds&&(this._pxBounds=new H([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(t,o,h){var c=t[0]instanceof et,p=t.length,y,C;if(c){for(C=[],y=0;y<p;y++)C[y]=this._map.latLngToLayerPoint(t[y]),h.extend(C[y]);o.push(C)}else for(y=0;y<p;y++)this._projectLatlngs(t[y],o,h)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,h,c,p,y,C,O,F;for(h=0,p=0,y=this._rings.length;h<y;h++)for(F=this._rings[h],c=0,C=F.length;c<C-1;c++)O=Fo(F[c],F[c+1],t,c,!0),O&&(o[p]=o[p]||[],o[p].push(O[0]),(O[1]!==F[c+1]||c===C-2)&&(o[p].push(O[1]),p++))}},_simplifyPoints:function(){for(var t=this._parts,o=this.options.smoothFactor,h=0,c=t.length;h<c;h++)t[h]=zo(t[h],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,o){var h,c,p,y,C,O,F=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(h=0,y=this._parts.length;h<y;h++)for(O=this._parts[h],c=0,C=O.length,p=C-1;c<C;p=c++)if(!(!o&&c===0)&&Oo(t,O[p],O[c])<=F)return!0;return!1}});function yl(t,o){return new he(t,o)}he._flat=Zo;var Ze=he.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var o=he.prototype._convertLatLngs.call(this,t),h=o.length;return h>=2&&o[0]instanceof et&&o[0].equals(o[h-1])&&o.pop(),o},_setLatLngs:function(t){he.prototype._setLatLngs.call(this,t),Wt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Wt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,o=this.options.weight,h=new R(o,o);if(t=new H(t.min.subtract(h),t.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var c=0,p=this._rings.length,y;c<p;c++)y=Io(this._rings[c],t,!0),y.length&&this._parts.push(y)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var o=!1,h,c,p,y,C,O,F,W;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(y=0,F=this._parts.length;y<F;y++)for(h=this._parts[y],C=0,W=h.length,O=W-1;C<W;O=C++)c=h[C],p=h[O],c.y>t.y!=p.y>t.y&&t.x<(p.x-c.x)*(t.y-c.y)/(p.y-c.y)+c.x&&(o=!o);return o||he.prototype._containsPoint.call(this,t,!0)}});function xl(t,o){return new Ze(t,o)}var le=ae.extend({initialize:function(t,o){S(this,o),this._layers={},t&&this.addData(t)},addData:function(t){var o=w(t)?t:t.features,h,c,p;if(o){for(h=0,c=o.length;h<c;h++)p=o[h],(p.geometries||p.geometry||p.features||p.coordinates)&&this.addData(p);return this}var y=this.options;if(y.filter&&!y.filter(t))return this;var C=en(t,y);return C?(C.feature=on(t),C.defaultOptions=C.options,this.resetStyle(C),y.onEachFeature&&y.onEachFeature(t,C),this.addLayer(C)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=s({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(o){this._setLayerStyle(o,t)},this)},_setLayerStyle:function(t,o){t.setStyle&&(typeof o=="function"&&(o=o(t.feature)),t.setStyle(o))}});function en(t,o){var h=t.type==="Feature"?t.geometry:t,c=h?h.coordinates:null,p=[],y=o&&o.pointToLayer,C=o&&o.coordsToLatLng||lr,O,F,W,q;if(!c&&!h)return null;switch(h.type){case"Point":return O=C(c),Yo(y,t,O,o);case"MultiPoint":for(W=0,q=c.length;W<q;W++)O=C(c[W]),p.push(Yo(y,t,O,o));return new ae(p);case"LineString":case"MultiLineString":return F=nn(c,h.type==="LineString"?0:1,C),new he(F,o);case"Polygon":case"MultiPolygon":return F=nn(c,h.type==="Polygon"?1:2,C),new Ze(F,o);case"GeometryCollection":for(W=0,q=h.geometries.length;W<q;W++){var tt=en({geometry:h.geometries[W],type:"Feature",properties:t.properties},o);tt&&p.push(tt)}return new ae(p);case"FeatureCollection":for(W=0,q=h.features.length;W<q;W++){var st=en(h.features[W],o);st&&p.push(st)}return new ae(p);default:throw new Error("Invalid GeoJSON object.")}}function Yo(t,o,h,c){return t?t(o,h):new Qi(h,c&&c.markersInheritOptions&&c)}function lr(t){return new et(t[1],t[0],t[2])}function nn(t,o,h){for(var c=[],p=0,y=t.length,C;p<y;p++)C=o?nn(t[p],o-1,h):(h||lr)(t[p]),c.push(C);return c}function ur(t,o){return t=$(t),t.alt!==void 0?[x(t.lng,o),x(t.lat,o),x(t.alt,o)]:[x(t.lng,o),x(t.lat,o)]}function rn(t,o,h,c){for(var p=[],y=0,C=t.length;y<C;y++)p.push(o?rn(t[y],Wt(t[y])?0:o-1,h,c):ur(t[y],c));return!o&&h&&p.length>0&&p.push(p[0].slice()),p}function Ne(t,o){return t.feature?s({},t.feature,{geometry:o}):on(o)}function on(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var cr={toGeoJSON:function(t){return Ne(this,{type:"Point",coordinates:ur(this.getLatLng(),t)})}};Qi.include(cr),hr.include(cr),tn.include(cr),he.include({toGeoJSON:function(t){var o=!Wt(this._latlngs),h=rn(this._latlngs,o?1:0,!1,t);return Ne(this,{type:(o?"Multi":"")+"LineString",coordinates:h})}}),Ze.include({toGeoJSON:function(t){var o=!Wt(this._latlngs),h=o&&!Wt(this._latlngs[0]),c=rn(this._latlngs,h?2:o?1:0,!0,t);return o||(c=[c]),Ne(this,{type:(h?"Multi":"")+"Polygon",coordinates:c})}}),Ae.include({toMultiPoint:function(t){var o=[];return this.eachLayer(function(h){o.push(h.toGeoJSON(t).geometry.coordinates)}),Ne(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(t){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(t);var h=o==="GeometryCollection",c=[];return this.eachLayer(function(p){if(p.toGeoJSON){var y=p.toGeoJSON(t);if(h)c.push(y.geometry);else{var C=on(y);C.type==="FeatureCollection"?c.push.apply(c,C.features):c.push(C)}}}),h?Ne(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});function Wo(t,o){return new le(t,o)}var wl=Wo,sn=Ht.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,o,h){this._url=t,this._bounds=Q(o),S(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ze(this._image),this},bringToBack:function(){return this._map&&Oe(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=Q(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",o=this._image=t?this._url:lt("img");if(ot(o,"leaflet-image-layer"),this._zoomAnimated&&ot(o,"leaflet-zoom-animated"),this.options.className&&ot(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=l(this.fire,this,"load"),o.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;we(this._image,h,o)},_reset:function(){var t=this._image,o=new H(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=o.getSize();gt(t,o.min),t.style.width=h.x+"px",t.style.height=h.y+"px"},_updateOpacity:function(){Yt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),bl=function(t,o,h){return new sn(t,o,h)},Uo=sn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",o=this._image=t?this._url:lt("video");if(ot(o,"leaflet-image-layer"),this._zoomAnimated&&ot(o,"leaflet-zoom-animated"),this.options.className&&ot(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=l(this.fire,this,"load"),t){for(var h=o.getElementsByTagName("source"),c=[],p=0;p<h.length;p++)c.push(h[p].src);this._url=h.length>0?c:[o.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var y=0;y<this._url.length;y++){var C=lt("source");C.src=this._url[y],o.appendChild(C)}}});function Pl(t,o,h){return new Uo(t,o,h)}var Xo=sn.extend({_initImage:function(){var t=this._image=this._url;ot(t,"leaflet-image-layer"),this._zoomAnimated&&ot(t,"leaflet-zoom-animated"),this.options.className&&ot(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function Ml(t,o,h){return new Xo(t,o,h)}var ne=Ht.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,o){t&&(t instanceof et||w(t))?(this._latlng=$(t),S(this,o)):(S(this,t),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Yt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Yt(this._container,1),this.bringToFront(),this.options.interactive&&(ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Yt(this._container,0),this._removeTimeout=setTimeout(l(ft,void 0,this._container),200)):ft(this._container),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=$(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ze(this._container),this},bringToBack:function(){return this._map&&Oe(this._container),this},_prepareOpen:function(t){var o=this._source;if(!o._map)return!1;if(o instanceof ae){o=null;var h=this._source._layers;for(var c in h)if(h[c]._map){o=h[c];break}if(!o)return!1;this._source=o}if(!t)if(o.getCenter)t=o.getCenter();else if(o.getLatLng)t=o.getLatLng();else if(o.getBounds)t=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")t.innerHTML=o;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),o=Z(this.options.offset),h=this._getAnchor();this._zoomAnimated?gt(this._container,t.add(h)):o=o.add(t).add(h);var c=this._containerBottom=-o.y,p=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=c+"px",this._container.style.left=p+"px"}},_getAnchor:function(){return[0,0]}});at.include({_initOverlay:function(t,o,h,c){var p=o;return p instanceof t||(p=new t(c).setContent(o)),h&&p.setLatLng(h),p}}),Ht.include({_initOverlay:function(t,o,h,c){var p=h;return p instanceof t?(S(p,c),p._source=this):(p=o&&!c?o:new t(c,this),p.setContent(h)),p}});var an=ne.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,ne.prototype.openOn.call(this,t)},onAdd:function(t){ne.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ge||this._source.on("preclick",Pe))},onRemove:function(t){ne.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ge||this._source.off("preclick",Pe))},getEvents:function(){var t=ne.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=lt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=lt("div",t+"-content-wrapper",o);if(this._contentNode=lt("div",t+"-content",h),li(o),tr(this._contentNode),rt(o,"contextmenu",Pe),this._tipContainer=lt("div",t+"-tip-container",o),this._tip=lt("div",t+"-tip",this._tipContainer),this.options.closeButton){var c=this._closeButton=lt("a",t+"-close-button",o);c.setAttribute("role","button"),c.setAttribute("aria-label","Close popup"),c.href="#close",c.innerHTML='<span aria-hidden="true">&#215;</span>',rt(c,"click",function(p){Pt(p),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var h=t.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),o.width=h+1+"px",o.whiteSpace="",o.height="";var c=t.offsetHeight,p=this.options.maxHeight,y="leaflet-popup-scrolled";p&&c>p?(o.height=p+"px",ot(t,y)):pt(t,y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),h=this._getAnchor();gt(this._container,o.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,o=parseInt(oi(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+o,c=this._containerWidth,p=new R(this._containerLeft,-h-this._containerBottom);p._add(be(this._container));var y=t.layerPointToContainerPoint(p),C=Z(this.options.autoPanPadding),O=Z(this.options.autoPanPaddingTopLeft||C),F=Z(this.options.autoPanPaddingBottomRight||C),W=t.getSize(),q=0,tt=0;y.x+c+F.x>W.x&&(q=y.x+c-W.x+F.x),y.x-q-O.x<0&&(q=y.x-O.x),y.y+h+F.y>W.y&&(tt=y.y+h-W.y+F.y),y.y-tt-O.y<0&&(tt=y.y-O.y),(q||tt)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([q,tt]))}},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ll=function(t,o){return new an(t,o)};at.mergeOptions({closePopupOnClick:!0}),at.include({openPopup:function(t,o,h){return this._initOverlay(an,t,o,h).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Ht.include({bindPopup:function(t,o){return this._popup=this._initOverlay(an,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof ae||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){Me(t);var o=t.layer||t.target;if(this._popup._source===o&&!(o instanceof ge)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=o,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var hn=ne.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){ne.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){ne.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=ne.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",o=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=lt("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var o,h,c=this._map,p=this._container,y=c.latLngToContainerPoint(c.getCenter()),C=c.layerPointToContainerPoint(t),O=this.options.direction,F=p.offsetWidth,W=p.offsetHeight,q=Z(this.options.offset),tt=this._getAnchor();O==="top"?(o=F/2,h=W):O==="bottom"?(o=F/2,h=0):O==="center"?(o=F/2,h=W/2):O==="right"?(o=0,h=W/2):O==="left"?(o=F,h=W/2):C.x<y.x?(O="right",o=0,h=W/2):(O="left",o=F+(q.x+tt.x)*2,h=W/2),t=t.subtract(Z(o,h,!0)).add(q).add(tt),pt(p,"leaflet-tooltip-right"),pt(p,"leaflet-tooltip-left"),pt(p,"leaflet-tooltip-top"),pt(p,"leaflet-tooltip-bottom"),ot(p,"leaflet-tooltip-"+O),gt(p,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Yt(this._container,t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(o)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Cl=function(t,o){return new hn(t,o)};at.include({openTooltip:function(t,o,h){return this._initOverlay(hn,t,o,h).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Ht.include({bindTooltip:function(t,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(hn,this._tooltip,t,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var o=t?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[o](h),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof ae||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&(rt(o,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),rt(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var o=t.latlng,h,c;this._tooltip.options.sticky&&t.originalEvent&&(h=this._map.mouseEventToContainerPoint(t.originalEvent),c=this._map.containerPointToLayerPoint(h),o=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(o)}});var Vo=Fe.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var o=t&&t.tagName==="DIV"?t:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Hi(o),o.appendChild(h.html)):o.innerHTML=h.html!==!1?h.html:"",h.bgPos){var c=Z(h.bgPos);o.style.backgroundPosition=-c.x+"px "+-c.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Sl(t){return new Vo(t)}Fe.Default=di;var fi=Ht.extend({options:{tileSize:256,opacity:1,updateWhenIdle:J.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){S(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ft(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ze(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Oe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=_(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof R?t:new R(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var o=this.getPane().children,h=-t(-1/0,1/0),c=0,p=o.length,y;c<p;c++)y=o[c].style.zIndex,o[c]!==this._container&&y&&(h=t(h,+y));isFinite(h)&&(this.options.zIndex=h+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!J.ielt9){Yt(this._container,this.options.opacity);var t=+new Date,o=!1,h=!1;for(var c in this._tiles){var p=this._tiles[c];if(!(!p.current||!p.loaded)){var y=Math.min(1,(t-p.loaded)/200);Yt(p.el,y),y<1?o=!0:(p.active?h=!0:this._onOpaqueTile(p),p.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),o&&(X(this._fadeFrame),this._fadeFrame=Y(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,o=this.options.maxZoom;if(t!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===t?(this._levels[h].el.style.zIndex=o-Math.abs(t-h),this._onUpdateLevel(h)):(ft(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var c=this._levels[t],p=this._map;return c||(c=this._levels[t]={},c.el=lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=o,c.origin=p.project(p.unproject(p.getPixelOrigin()),t).round(),c.zoom=t,this._setZoomTransform(c,p.getCenter(),p.getZoom()),g(c.el.offsetWidth),this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,o,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)o=this._tiles[t],o.retain=o.current;for(t in this._tiles)if(o=this._tiles[t],o.current&&!o.active){var c=o.coords;this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var o in this._tiles)this._tiles[o].coords.z===t&&this._removeTile(o)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ft(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,o,h,c){var p=Math.floor(t/2),y=Math.floor(o/2),C=h-1,O=new R(+p,+y);O.z=+C;var F=this._tileCoordsToKey(O),W=this._tiles[F];return W&&W.active?(W.retain=!0,!0):(W&&W.loaded&&(W.retain=!0),C>c?this._retainParent(p,y,C,c):!1)},_retainChildren:function(t,o,h,c){for(var p=2*t;p<2*t+2;p++)for(var y=2*o;y<2*o+2;y++){var C=new R(p,y);C.z=h+1;var O=this._tileCoordsToKey(C),F=this._tiles[O];if(F&&F.active){F.retain=!0;continue}else F&&F.loaded&&(F.retain=!0);h+1<c&&this._retainChildren(p,y,h+1,c)}},_resetView:function(t){var o=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var o=this.options;return o.minNativeZoom!==void 0&&t<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<t?o.maxNativeZoom:t},_setView:function(t,o,h,c){var p=Math.round(o);this.options.maxZoom!==void 0&&p>this.options.maxZoom||this.options.minZoom!==void 0&&p<this.options.minZoom?p=void 0:p=this._clampZoom(p);var y=this.options.updateWhenZooming&&p!==this._tileZoom;(!c||y)&&(this._tileZoom=p,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),p!==void 0&&this._update(t),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(t,o)},_setZoomTransforms:function(t,o){for(var h in this._levels)this._setZoomTransform(this._levels[h],t,o)},_setZoomTransform:function(t,o,h){var c=this._map.getZoomScale(h,t.zoom),p=t.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(o,h)).round();J.any3d?we(t.el,p,c):gt(t.el,p)},_resetGrid:function(){var t=this._map,o=t.options.crs,h=this._tileSize=this.getTileSize(),c=this._tileZoom,p=this._map.getPixelWorldBounds(this._tileZoom);p&&(this._globalTileRange=this._pxBoundsToTileRange(p)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,o.wrapLng[0]],c).x/h.x),Math.ceil(t.project([0,o.wrapLng[1]],c).x/h.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([o.wrapLat[0],0],c).y/h.x),Math.ceil(t.project([o.wrapLat[1],0],c).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var o=this._map,h=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),c=o.getZoomScale(h,this._tileZoom),p=o.project(t,this._tileZoom).floor(),y=o.getSize().divideBy(c*2);return new H(p.subtract(y),p.add(y))},_update:function(t){var o=this._map;if(o){var h=this._clampZoom(o.getZoom());if(t===void 0&&(t=o.getCenter()),this._tileZoom!==void 0){var c=this._getTiledPixelBounds(t),p=this._pxBoundsToTileRange(c),y=p.getCenter(),C=[],O=this.options.keepBuffer,F=new H(p.getBottomLeft().subtract([O,-O]),p.getTopRight().add([O,-O]));if(!(isFinite(p.min.x)&&isFinite(p.min.y)&&isFinite(p.max.x)&&isFinite(p.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var W in this._tiles){var q=this._tiles[W].coords;(q.z!==this._tileZoom||!F.contains(new R(q.x,q.y)))&&(this._tiles[W].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(t,h);return}for(var tt=p.min.y;tt<=p.max.y;tt++)for(var st=p.min.x;st<=p.max.x;st++){var kt=new R(st,tt);if(kt.z=this._tileZoom,!!this._isValidTile(kt)){var bt=this._tiles[this._tileCoordsToKey(kt)];bt?bt.current=!0:C.push(kt)}}if(C.sort(function(zt,je){return zt.distanceTo(y)-je.distanceTo(y)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ut=document.createDocumentFragment();for(st=0;st<C.length;st++)this._addTile(C[st],Ut);this._level.el.appendChild(Ut)}}}},_isValidTile:function(t){var o=this._map.options.crs;if(!o.infinite){var h=this._globalTileRange;if(!o.wrapLng&&(t.x<h.min.x||t.x>h.max.x)||!o.wrapLat&&(t.y<h.min.y||t.y>h.max.y))return!1}if(!this.options.bounds)return!0;var c=this._tileCoordsToBounds(t);return Q(this.options.bounds).overlaps(c)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var o=this._map,h=this.getTileSize(),c=t.scaleBy(h),p=c.add(h),y=o.unproject(c,t.z),C=o.unproject(p,t.z);return[y,C]},_tileCoordsToBounds:function(t){var o=this._tileCoordsToNwSe(t),h=new nt(o[0],o[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var o=t.split(":"),h=new R(+o[0],+o[1]);return h.z=+o[2],h},_removeTile:function(t){var o=this._tiles[t];o&&(ft(o.el),delete this._tiles[t],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ot(t,"leaflet-tile");var o=this.getTileSize();t.style.width=o.x+"px",t.style.height=o.y+"px",t.onselectstart=g,t.onmousemove=g,J.ielt9&&this.options.opacity<1&&Yt(t,this.options.opacity)},_addTile:function(t,o){var h=this._getTilePos(t),c=this._tileCoordsToKey(t),p=this.createTile(this._wrapCoords(t),l(this._tileReady,this,t));this._initTile(p),this.createTile.length<2&&Y(l(this._tileReady,this,t,null,p)),gt(p,h),this._tiles[c]={el:p,coords:t,current:!0},o.appendChild(p),this.fire("tileloadstart",{tile:p,coords:t})},_tileReady:function(t,o,h){o&&this.fire("tileerror",{error:o,tile:h,coords:t});var c=this._tileCoordsToKey(t);h=this._tiles[c],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Yt(h.el,0),X(this._fadeFrame),this._fadeFrame=Y(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),o||(ot(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),J.ielt9||!this._map._fadeAnimated?Y(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var o=new R(this._wrapX?f(t.x,this._wrapX):t.x,this._wrapY?f(t.y,this._wrapY):t.y);return o.z=t.z,o},_pxBoundsToTileRange:function(t){var o=this.getTileSize();return new H(t.min.unscaleBy(o).floor(),t.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function kl(t){return new fi(t)}var Re=fi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,o){this._url=t,o=S(this,o),o.detectRetina&&J.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,o){return this._url===t&&o===void 0&&(o=!0),this._url=t,o||this.redraw(),this},createTile:function(t,o){var h=document.createElement("img");return rt(h,"load",l(this._tileOnLoad,this,o,h)),rt(h,"error",l(this._tileOnError,this,o,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(t),h},getTileUrl:function(t){var o={r:J.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-t.y;this.options.tms&&(o.y=h),o["-y"]=h}return m(this._url,s(o,this.options))},_tileOnLoad:function(t,o){J.ielt9?setTimeout(l(t,this,null,o),0):t(null,o)},_tileOnError:function(t,o,h){var c=this.options.errorTileUrl;c&&o.getAttribute("src")!==c&&(o.src=c),t(h,o)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,o=this.options.maxZoom,h=this.options.zoomReverse,c=this.options.zoomOffset;return h&&(t=o-t),t+c},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(o=this._tiles[t].el,o.onload=g,o.onerror=g,!o.complete)){o.src=k;var h=this._tiles[t].coords;ft(o),delete this._tiles[t],this.fire("tileabort",{tile:o,coords:h})}},_removeTile:function(t){var o=this._tiles[t];if(o)return o.el.setAttribute("src",k),fi.prototype._removeTile.call(this,t)},_tileReady:function(t,o,h){if(!(!this._map||h&&h.getAttribute("src")===k))return fi.prototype._tileReady.call(this,t,o,h)}});function Ho(t,o){return new Re(t,o)}var Go=Re.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,o){this._url=t;var h=s({},this.defaultWmsParams);for(var c in o)c in this.options||(h[c]=o[c]);o=S(this,o);var p=o.detectRetina&&J.retina?2:1,y=this.getTileSize();h.width=y.x*p,h.height=y.y*p,this.wmsParams=h},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Re.prototype.onAdd.call(this,t)},getTileUrl:function(t){var o=this._tileCoordsToNwSe(t),h=this._crs,c=G(h.project(o[0]),h.project(o[1])),p=c.min,y=c.max,C=(this._wmsVersion>=1.3&&this._crs===Ro?[p.y,p.x,y.y,y.x]:[p.x,p.y,y.x,y.y]).join(","),O=Re.prototype.getTileUrl.call(this,t);return O+B(this.wmsParams,O,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(t,o){return s(this.wmsParams,t),o||this.redraw(),this}});function El(t,o){return new Go(t,o)}Re.WMS=Go,Ho.wms=El;var ue=Ht.extend({options:{padding:.1},initialize:function(t){S(this,t),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,o){var h=this._map.getZoomScale(o,this._zoom),c=this._map.getSize().multiplyBy(.5+this.options.padding),p=this._map.project(this._center,o),y=c.multiplyBy(-h).add(p).subtract(this._map._getNewPixelOrigin(t,o));J.any3d?we(this._container,y,h):gt(this._container,y)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,o=this._map.getSize(),h=this._map.containerPointToLayerPoint(o.multiplyBy(-t)).round();this._bounds=new H(h,h.add(o.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),$o=ue.extend({options:{tolerance:0},getEvents:function(){var t=ue.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ue.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");rt(t,"mousemove",this._onMouseMove,this),rt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){X(this._redrawRequest),delete this._ctx,ft(this._container),ct(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var o in this._layers)t=this._layers[o],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ue.prototype._update.call(this);var t=this._bounds,o=this._container,h=t.getSize(),c=J.retina?2:1;gt(o,t.min),o.width=c*h.x,o.height=c*h.y,o.style.width=h.x+"px",o.style.height=h.y+"px",J.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ue.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[d(t)]=t;var o=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var o=t._order,h=o.next,c=o.prev;h?h.prev=c:this._drawLast=c,c?c.next=h:this._drawFirst=h,delete t._order,delete this._layers[d(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var o=t.options.dashArray.split(/[, ]+/),h=[],c,p;for(p=0;p<o.length;p++){if(c=Number(o[p]),isNaN(c))return;h.push(c)}t.options._dashArray=h}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||Y(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var o=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new H,this._redrawBounds.extend(t._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(t._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var o=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,o=this._redrawBounds;if(this._ctx.save(),o){var h=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)t=c.layer,(!o||t._pxBounds&&t._pxBounds.intersects(o))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,o){if(this._drawing){var h,c,p,y,C=t._parts,O=C.length,F=this._ctx;if(O){for(F.beginPath(),h=0;h<O;h++){for(c=0,p=C[h].length;c<p;c++)y=C[h][c],F[c?"lineTo":"moveTo"](y.x,y.y);o&&F.closePath()}this._fillStroke(F,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var o=t._point,h=this._ctx,c=Math.max(Math.round(t._radius),1),p=(Math.max(Math.round(t._radiusY),1)||c)/c;p!==1&&(h.save(),h.scale(1,p)),h.beginPath(),h.arc(o.x,o.y/p,c,0,Math.PI*2,!1),p!==1&&h.restore(),this._fillStroke(h,t)}},_fillStroke:function(t,o){var h=o.options;h.fill&&(t.globalAlpha=h.fillOpacity,t.fillStyle=h.fillColor||h.color,t.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(t.setLineDash&&t.setLineDash(o.options&&o.options._dashArray||[]),t.globalAlpha=h.opacity,t.lineWidth=h.weight,t.strokeStyle=h.color,t.lineCap=h.lineCap,t.lineJoin=h.lineJoin,t.stroke())},_onClick:function(t){for(var o=this._map.mouseEventToLayerPoint(t),h,c,p=this._drawFirst;p;p=p.next)h=p.layer,h.options.interactive&&h._containsPoint(o)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(h))&&(c=h);this._fireEvent(c?[c]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,o)}},_handleMouseOut:function(t){var o=this._hoveredLayer;o&&(pt(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,o){if(!this._mouseHoverThrottled){for(var h,c,p=this._drawFirst;p;p=p.next)h=p.layer,h.options.interactive&&h._containsPoint(o)&&(c=h);c!==this._hoveredLayer&&(this._handleMouseOut(t),c&&(ot(this._container,"leaflet-interactive"),this._fireEvent([c],t,"mouseover"),this._hoveredLayer=c)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,o,h){this._map._fireDOMEvent(o,h||o.type,t)},_bringToFront:function(t){var o=t._order;if(o){var h=o.next,c=o.prev;if(h)h.prev=c;else return;c?c.next=h:h&&(this._drawFirst=h),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(t)}},_bringToBack:function(t){var o=t._order;if(o){var h=o.next,c=o.prev;if(c)c.next=h;else return;h?h.prev=c:c&&(this._drawLast=c),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(t)}}});function qo(t){return J.canvas?new $o(t):null}var pi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Tl={_initContainer:function(){this._container=lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ue.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var o=t._container=pi("shape");ot(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",t._path=pi("path"),o.appendChild(t._path),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){var o=t._container;this._container.appendChild(o),t.options.interactive&&t.addInteractiveTarget(o)},_removePath:function(t){var o=t._container;ft(o),t.removeInteractiveTarget(o),delete this._layers[d(t)]},_updateStyle:function(t){var o=t._stroke,h=t._fill,c=t.options,p=t._container;p.stroked=!!c.stroke,p.filled=!!c.fill,c.stroke?(o||(o=t._stroke=pi("stroke")),p.appendChild(o),o.weight=c.weight+"px",o.color=c.color,o.opacity=c.opacity,c.dashArray?o.dashStyle=w(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=c.lineCap.replace("butt","flat"),o.joinstyle=c.lineJoin):o&&(p.removeChild(o),t._stroke=null),c.fill?(h||(h=t._fill=pi("fill")),p.appendChild(h),h.color=c.fillColor||c.color,h.opacity=c.fillOpacity):h&&(p.removeChild(h),t._fill=null)},_updateCircle:function(t){var o=t._point.round(),h=Math.round(t._radius),c=Math.round(t._radiusY||h);this._setPath(t,t._empty()?"M0 0":"AL "+o.x+","+o.y+" "+h+","+c+" 0,"+65535*360)},_setPath:function(t,o){t._path.v=o},_bringToFront:function(t){ze(t._container)},_bringToBack:function(t){Oe(t._container)}},ln=J.vml?pi:It,_i=ue.extend({_initContainer:function(){this._container=ln("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ln("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ft(this._container),ct(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ue.prototype._update.call(this);var t=this._bounds,o=t.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,h.setAttribute("width",o.x),h.setAttribute("height",o.y)),gt(h,t.min),h.setAttribute("viewBox",[t.min.x,t.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(t){var o=t._path=ln("path");t.options.className&&ot(o,t.options.className),t.options.interactive&&ot(o,"leaflet-interactive"),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ft(t._path),t.removeInteractiveTarget(t._path),delete this._layers[d(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var o=t._path,h=t.options;o&&(h.stroke?(o.setAttribute("stroke",h.color),o.setAttribute("stroke-opacity",h.opacity),o.setAttribute("stroke-width",h.weight),o.setAttribute("stroke-linecap",h.lineCap),o.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?o.setAttribute("stroke-dasharray",h.dashArray):o.removeAttribute("stroke-dasharray"),h.dashOffset?o.setAttribute("stroke-dashoffset",h.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),h.fill?(o.setAttribute("fill",h.fillColor||h.color),o.setAttribute("fill-opacity",h.fillOpacity),o.setAttribute("fill-rule",h.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(t,o){this._setPath(t,Bt(t._parts,o))},_updateCircle:function(t){var o=t._point,h=Math.max(Math.round(t._radius),1),c=Math.max(Math.round(t._radiusY),1)||h,p="a"+h+","+c+" 0 1,0 ",y=t._empty()?"M0 0":"M"+(o.x-h)+","+o.y+p+h*2+",0 "+p+-h*2+",0 ";this._setPath(t,y)},_setPath:function(t,o){t._path.setAttribute("d",o)},_bringToFront:function(t){ze(t._path)},_bringToBack:function(t){Oe(t._path)}});J.vml&&_i.include(Tl);function Ko(t){return J.svg||J.vml?new _i(t):null}at.include({getRenderer:function(t){var o=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var o=this._paneRenderers[t];return o===void 0&&(o=this._createRenderer({pane:t}),this._paneRenderers[t]=o),o},_createRenderer:function(t){return this.options.preferCanvas&&qo(t)||Ko(t)}});var Jo=Ze.extend({initialize:function(t,o){Ze.prototype.initialize.call(this,this._boundsToLatLngs(t),o)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=Q(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Dl(t,o){return new Jo(t,o)}_i.create=ln,_i.pointsToPath=Bt,le.geometryToLayer=en,le.coordsToLatLng=lr,le.coordsToLatLngs=nn,le.latLngToCoords=ur,le.latLngsToCoords=rn,le.getFeature=Ne,le.asFeature=on,at.mergeOptions({boxZoom:!0});var Qo=ie.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ct(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),si(),Vn(),this._startPoint=this._map.mouseEventToContainerPoint(t),rt(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=lt("div","leaflet-zoom-box",this._container),ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var o=new H(this._point,this._startPoint),h=o.getSize();gt(this._box,o.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(ft(this._box),pt(this._container,"leaflet-crosshair")),ai(),Hn(),ct(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var o=new nt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});at.addInitHook("addHandler","boxZoom",Qo),at.mergeOptions({doubleClickZoom:!0});var ts=ie.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var o=this._map,h=o.getZoom(),c=o.options.zoomDelta,p=t.originalEvent.shiftKey?h-c:h+c;o.options.doubleClickZoom==="center"?o.setZoom(p):o.setZoomAround(t.containerPoint,p)}});at.addInitHook("addHandler","doubleClickZoom",ts),at.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var es=ie.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new me(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pt(this._map._container,"leaflet-grab"),pt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=Q(this._map.options.maxBounds);this._offsetLimit=G(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var o=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(o),this._prunePositions(o)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,o){return t-(t-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;t.x<o.min.x&&(t.x=this._viscousLimit(t.x,o.min.x)),t.y<o.min.y&&(t.y=this._viscousLimit(t.y,o.min.y)),t.x>o.max.x&&(t.x=this._viscousLimit(t.x,o.max.x)),t.y>o.max.y&&(t.y=this._viscousLimit(t.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,o=Math.round(t/2),h=this._initialWorldOffset,c=this._draggable._newPos.x,p=(c-o+h)%t+o-h,y=(c+o+h)%t-o-h,C=Math.abs(p+h)<Math.abs(y+h)?p:y;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(t){var o=this._map,h=o.options,c=!h.inertia||t.noInertia||this._times.length<2;if(o.fire("dragend",t),c)o.fire("moveend");else{this._prunePositions(+new Date);var p=this._lastPos.subtract(this._positions[0]),y=(this._lastTime-this._times[0])/1e3,C=h.easeLinearity,O=p.multiplyBy(C/y),F=O.distanceTo([0,0]),W=Math.min(h.inertiaMaxSpeed,F),q=O.multiplyBy(W/F),tt=W/(h.inertiaDeceleration*C),st=q.multiplyBy(-tt/2).round();!st.x&&!st.y?o.fire("moveend"):(st=o._limitOffset(st,o.options.maxBounds),Y(function(){o.panBy(st,{duration:tt,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});at.addInitHook("addHandler","dragging",es),at.mergeOptions({keyboard:!0,keyboardPanDelta:80});var is=ie.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),rt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ct(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,o=document.documentElement,h=t.scrollTop||o.scrollTop,c=t.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(c,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var o=this._panKeys={},h=this.keyCodes,c,p;for(c=0,p=h.left.length;c<p;c++)o[h.left[c]]=[-1*t,0];for(c=0,p=h.right.length;c<p;c++)o[h.right[c]]=[t,0];for(c=0,p=h.down.length;c<p;c++)o[h.down[c]]=[0,t];for(c=0,p=h.up.length;c<p;c++)o[h.up[c]]=[0,-1*t]},_setZoomDelta:function(t){var o=this._zoomKeys={},h=this.keyCodes,c,p;for(c=0,p=h.zoomIn.length;c<p;c++)o[h.zoomIn[c]]=t;for(c=0,p=h.zoomOut.length;c<p;c++)o[h.zoomOut[c]]=-t},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ct(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var o=t.keyCode,h=this._map,c;if(o in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(c=this._panKeys[o],t.shiftKey&&(c=Z(c).multiplyBy(3)),h.options.maxBounds&&(c=h._limitOffset(Z(c),h.options.maxBounds)),h.options.worldCopyJump){var p=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(c)));h.panTo(p)}else h.panBy(c)}else if(o in this._zoomKeys)h.setZoom(h.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Me(t)}}});at.addInitHook("addHandler","keyboard",is),at.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ns=ie.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ct(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var o=So(t),h=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var c=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),c),Me(t)},_performZoom:function(){var t=this._map,o=t.getZoom(),h=this._map.options.zoomSnap||0;t._stop();var c=this._delta/(this._map.options.wheelPxPerZoomLevel*4),p=4*Math.log(2/(1+Math.exp(-Math.abs(c))))/Math.LN2,y=h?Math.ceil(p/h)*h:p,C=t._limitZoom(o+(this._delta>0?y:-y))-o;this._delta=0,this._startTime=null,C&&(t.options.scrollWheelZoom==="center"?t.setZoom(o+C):t.setZoomAround(this._lastMousePos,o+C))}});at.addInitHook("addHandler","scrollWheelZoom",ns);var Il=600;at.mergeOptions({tapHold:J.touchNative&&J.safari&&J.mobile,tapTolerance:15});var rs=ie.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ct(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var o=t.touches[0];this._startPos=this._newPos=new R(o.clientX,o.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",Pt),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Il),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){ct(document,"touchend",Pt),ct(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),ct(document,"touchend touchcancel contextmenu",this._cancel,this),ct(document,"touchmove",this._onMove,this)},_onMove:function(t){var o=t.touches[0];this._newPos=new R(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,o){var h=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});h._simulated=!0,o.target.dispatchEvent(h)}});at.addInitHook("addHandler","tapHold",rs),at.mergeOptions({touchZoom:J.touch,bounceAtZoomLimits:!0});var os=ie.extend({addHooks:function(){ot(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),ct(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(!(!t.touches||t.touches.length!==2||o._animatingZoom||this._zooming)){var h=o.mouseEventToContainerPoint(t.touches[0]),c=o.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(h.add(c)._divideBy(2))),this._startDist=h.distanceTo(c),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),Pt(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var o=this._map,h=o.mouseEventToContainerPoint(t.touches[0]),c=o.mouseEventToContainerPoint(t.touches[1]),p=h.distanceTo(c)/this._startDist;if(this._zoom=o.getScaleZoom(p,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&p<1||this._zoom>o.getMaxZoom()&&p>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,p===1)return}else{var y=h._add(c)._divideBy(2)._subtract(this._centerPoint);if(p===1&&y.x===0&&y.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(y),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),X(this._animRequest);var C=l(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Y(C,this,!0),Pt(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,X(this._animRequest),ct(document,"touchmove",this._onTouchMove,this),ct(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});at.addInitHook("addHandler","touchZoom",os),at.BoxZoom=Qo,at.DoubleClickZoom=ts,at.Drag=es,at.Keyboard=is,at.ScrollWheelZoom=ns,at.TapHold=rs,at.TouchZoom=os,i.Bounds=H,i.Browser=J,i.CRS=ht,i.Canvas=$o,i.Circle=hr,i.CircleMarker=tn,i.Class=v,i.Control=Vt,i.DivIcon=Vo,i.DivOverlay=ne,i.DomEvent=qh,i.DomUtil=Gh,i.Draggable=me,i.Evented=V,i.FeatureGroup=ae,i.GeoJSON=le,i.GridLayer=fi,i.Handler=ie,i.Icon=Fe,i.ImageOverlay=sn,i.LatLng=et,i.LatLngBounds=nt,i.Layer=Ht,i.LayerGroup=Ae,i.LineUtil=ll,i.Map=at,i.Marker=Qi,i.Mixin=nl,i.Path=ge,i.Point=R,i.PolyUtil=rl,i.Polygon=Ze,i.Polyline=he,i.Popup=an,i.PosAnimation=ko,i.Projection=ul,i.Rectangle=Jo,i.Renderer=ue,i.SVG=_i,i.SVGOverlay=Xo,i.TileLayer=Re,i.Tooltip=hn,i.Transformation=Lt,i.Util=U,i.VideoOverlay=Uo,i.bind=l,i.bounds=G,i.canvas=qo,i.circle=vl,i.circleMarker=gl,i.control=ui,i.divIcon=Sl,i.extend=s,i.featureGroup=pl,i.geoJSON=Wo,i.geoJson=wl,i.gridLayer=kl,i.icon=_l,i.imageOverlay=bl,i.latLng=$,i.latLngBounds=Q,i.layerGroup=fl,i.map=Kh,i.marker=ml,i.point=Z,i.polygon=xl,i.polyline=yl,i.popup=Ll,i.rectangle=Dl,i.setOptions=S,i.stamp=d,i.svg=Ko,i.svgOverlay=Ml,i.tileLayer=Ho,i.tooltip=Cl,i.transformation=Dt,i.version=r,i.videoOverlay=Pl;var Bl=window.L;i.noConflict=function(){return window.L=Bl,this},window.L=i})})(Zr,Zr.exports);var _h=Zr.exports;const Tf=Pa(_h),ia=Yl({__proto__:null,default:Tf},[_h]),Df="_button_6v7zm_1",If="_active_6v7zm_21",Bf="_hiddenOnMobile_6v7zm_26",bn={button:Df,active:If,hiddenOnMobile:Bf};function zf(n){return n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}const Of=({mode:n,currentMode:e,changeMode:i,label:r,hiddenOnTouch:s})=>{let a=bn.button;return s&&(a=`${bn.hiddenOnMobile} ${a}`),e===n&&(a=`${bn.active} ${a}`),_t("button",{id:n,class:a,onClick:()=>{i(n)},children:r||zf(n)})},Af=({label:n,onClick:e})=>_t("button",{id:"clear",class:bn.button,onClick:()=>{e()},children:n}),Ff="_buttons_123u9_1",Zf={buttons:Ff},Nf=({mode:n,onClear:e,changeMode:i})=>_t("div",{class:Zf.buttons,children:[_t(Of,{label:"Route Snap",mode:"routesnap",currentMode:n,changeMode:i}),_t(Af,{onClick:e,label:"Clear"})]});function Rf(n,e,i={}){const r={type:"Feature"};return(i.id===0||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties={},r.geometry=n,r}function jf(n,e,i={}){for(const s of n){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return Rf({type:"Polygon",coordinates:n},e,i)}function mh(n,e,i){if(n!==null)for(var r,s,a,l,u,d,_,f=0,g=0,x,b=n.type,M=b==="FeatureCollection",S=b==="Feature",B=M?n.features.length:1,A=0;A<B;A++){_=M?n.features[A].geometry:S?n.geometry:n,x=_?_.type==="GeometryCollection":!1,u=x?_.geometries.length:1;for(var m=0;m<u;m++){var w=0,P=0;if(l=x?_.geometries[m]:_,l!==null){d=l.coordinates;var k=l.type;switch(f=0,k){case null:break;case"Point":if(e(d,g,A,w,P)===!1)return!1;g++,w++;break;case"LineString":case"MultiPoint":for(r=0;r<d.length;r++){if(e(d[r],g,A,w,P)===!1)return!1;g++,k==="MultiPoint"&&w++}k==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(r=0;r<d.length;r++){for(s=0;s<d[r].length-f;s++){if(e(d[r][s],g,A,w,P)===!1)return!1;g++}k==="MultiLineString"&&w++,k==="Polygon"&&P++}k==="Polygon"&&w++;break;case"MultiPolygon":for(r=0;r<d.length;r++){for(P=0,s=0;s<d[r].length;s++){for(a=0;a<d[r][s].length-f;a++){if(e(d[r][s][a],g,A,w,P)===!1)return!1;g++}P++}w++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(mh(l.geometries[r],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var no={exports:{}},gh={exports:{}};(function(n,e){(function(i,r){n.exports=r()})(Ur,function(){function i(m,w,P,k,T){(function E(I,N,j,Y,X){for(;Y>j;){if(Y-j>600){var U=Y-j+1,v=N-j+1,D=Math.log(U),z=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*z*(U-z)/U)*(v-U/2<0?-1:1),R=Math.max(j,Math.floor(N-v*z/U+V)),K=Math.min(Y,Math.floor(N+(U-v)*z/U+V));E(I,N,R,K,X)}var Z=I[N],H=j,G=Y;for(r(I,j,N),X(I[Y],Z)>0&&r(I,j,Y);H<G;){for(r(I,H,G),H++,G--;X(I[H],Z)<0;)H++;for(;X(I[G],Z)>0;)G--}X(I[j],Z)===0?r(I,j,G):r(I,++G,Y),G<=N&&(j=G+1),N<=G&&(Y=G-1)}})(m,w,P||0,k||m.length-1,T||s)}function r(m,w,P){var k=m[w];m[w]=m[P],m[P]=k}function s(m,w){return m<w?-1:m>w?1:0}var a=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(m,w,P){if(!P)return w.indexOf(m);for(var k=0;k<w.length;k++)if(P(m,w[k]))return k;return-1}function u(m,w){d(m,0,m.children.length,w,m)}function d(m,w,P,k,T){T||(T=B(null)),T.minX=1/0,T.minY=1/0,T.maxX=-1/0,T.maxY=-1/0;for(var E=w;E<P;E++){var I=m.children[E];_(T,m.leaf?k(I):I)}return T}function _(m,w){return m.minX=Math.min(m.minX,w.minX),m.minY=Math.min(m.minY,w.minY),m.maxX=Math.max(m.maxX,w.maxX),m.maxY=Math.max(m.maxY,w.maxY),m}function f(m,w){return m.minX-w.minX}function g(m,w){return m.minY-w.minY}function x(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function b(m){return m.maxX-m.minX+(m.maxY-m.minY)}function M(m,w){return m.minX<=w.minX&&m.minY<=w.minY&&w.maxX<=m.maxX&&w.maxY<=m.maxY}function S(m,w){return w.minX<=m.maxX&&w.minY<=m.maxY&&w.maxX>=m.minX&&w.maxY>=m.minY}function B(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function A(m,w,P,k,T){for(var E=[w,P];E.length;)if(!((P=E.pop())-(w=E.pop())<=k)){var I=w+Math.ceil((P-w)/k/2)*k;i(m,I,w,P,T),E.push(w,I,I,P)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(m){var w=this.data,P=[];if(!S(m,w))return P;for(var k=this.toBBox,T=[];w;){for(var E=0;E<w.children.length;E++){var I=w.children[E],N=w.leaf?k(I):I;S(m,N)&&(w.leaf?P.push(I):M(m,N)?this._all(I,P):T.push(I))}w=T.pop()}return P},a.prototype.collides=function(m){var w=this.data;if(!S(m,w))return!1;for(var P=[];w;){for(var k=0;k<w.children.length;k++){var T=w.children[k],E=w.leaf?this.toBBox(T):T;if(S(m,E)){if(w.leaf||M(m,E))return!0;P.push(T)}}w=P.pop()}return!1},a.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var w=0;w<m.length;w++)this.insert(m[w]);return this}var P=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===P.height)this._splitRoot(this.data,P);else{if(this.data.height<P.height){var k=this.data;this.data=P,P=k}this._insert(P,this.data.height-P.height-1,!0)}else this.data=P;return this},a.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},a.prototype.clear=function(){return this.data=B([]),this},a.prototype.remove=function(m,w){if(!m)return this;for(var P,k,T,E=this.data,I=this.toBBox(m),N=[],j=[];E||N.length;){if(E||(E=N.pop(),k=N[N.length-1],P=j.pop(),T=!0),E.leaf){var Y=l(m,E.children,w);if(Y!==-1)return E.children.splice(Y,1),N.push(E),this._condense(N),this}T||E.leaf||!M(E,I)?k?(P++,E=k.children[P],T=!1):E=null:(N.push(E),j.push(P),P=0,k=E,E=E.children[0])}return this},a.prototype.toBBox=function(m){return m},a.prototype.compareMinX=function(m,w){return m.minX-w.minX},a.prototype.compareMinY=function(m,w){return m.minY-w.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(m){return this.data=m,this},a.prototype._all=function(m,w){for(var P=[];m;)m.leaf?w.push.apply(w,m.children):P.push.apply(P,m.children),m=P.pop();return w},a.prototype._build=function(m,w,P,k){var T,E=P-w+1,I=this._maxEntries;if(E<=I)return u(T=B(m.slice(w,P+1)),this.toBBox),T;k||(k=Math.ceil(Math.log(E)/Math.log(I)),I=Math.ceil(E/Math.pow(I,k-1))),(T=B([])).leaf=!1,T.height=k;var N=Math.ceil(E/I),j=N*Math.ceil(Math.sqrt(I));A(m,w,P,j,this.compareMinX);for(var Y=w;Y<=P;Y+=j){var X=Math.min(Y+j-1,P);A(m,Y,X,N,this.compareMinY);for(var U=Y;U<=X;U+=N){var v=Math.min(U+N-1,X);T.children.push(this._build(m,U,v,k-1))}}return u(T,this.toBBox),T},a.prototype._chooseSubtree=function(m,w,P,k){for(;k.push(w),!w.leaf&&k.length-1!==P;){for(var T=1/0,E=1/0,I=void 0,N=0;N<w.children.length;N++){var j=w.children[N],Y=x(j),X=(U=m,v=j,(Math.max(v.maxX,U.maxX)-Math.min(v.minX,U.minX))*(Math.max(v.maxY,U.maxY)-Math.min(v.minY,U.minY))-Y);X<E?(E=X,T=Y<T?Y:T,I=j):X===E&&Y<T&&(T=Y,I=j)}w=I||w.children[0]}var U,v;return w},a.prototype._insert=function(m,w,P){var k=P?m:this.toBBox(m),T=[],E=this._chooseSubtree(k,this.data,w,T);for(E.children.push(m),_(E,k);w>=0&&T[w].children.length>this._maxEntries;)this._split(T,w),w--;this._adjustParentBBoxes(k,T,w)},a.prototype._split=function(m,w){var P=m[w],k=P.children.length,T=this._minEntries;this._chooseSplitAxis(P,T,k);var E=this._chooseSplitIndex(P,T,k),I=B(P.children.splice(E,P.children.length-E));I.height=P.height,I.leaf=P.leaf,u(P,this.toBBox),u(I,this.toBBox),w?m[w-1].children.push(I):this._splitRoot(P,I)},a.prototype._splitRoot=function(m,w){this.data=B([m,w]),this.data.height=m.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(m,w,P){for(var k,T,E,I,N,j,Y,X=1/0,U=1/0,v=w;v<=P-w;v++){var D=d(m,0,v,this.toBBox),z=d(m,v,P,this.toBBox),V=(T=D,E=z,I=void 0,N=void 0,j=void 0,Y=void 0,I=Math.max(T.minX,E.minX),N=Math.max(T.minY,E.minY),j=Math.min(T.maxX,E.maxX),Y=Math.min(T.maxY,E.maxY),Math.max(0,j-I)*Math.max(0,Y-N)),R=x(D)+x(z);V<X?(X=V,k=v,U=R<U?R:U):V===X&&R<U&&(U=R,k=v)}return k||P-w},a.prototype._chooseSplitAxis=function(m,w,P){var k=m.leaf?this.compareMinX:f,T=m.leaf?this.compareMinY:g;this._allDistMargin(m,w,P,k)<this._allDistMargin(m,w,P,T)&&m.children.sort(k)},a.prototype._allDistMargin=function(m,w,P,k){m.children.sort(k);for(var T=this.toBBox,E=d(m,0,w,T),I=d(m,P-w,P,T),N=b(E)+b(I),j=w;j<P-w;j++){var Y=m.children[j];_(E,m.leaf?T(Y):Y),N+=b(E)}for(var X=P-w-1;X>=w;X--){var U=m.children[X];_(I,m.leaf?T(U):U),N+=b(I)}return N},a.prototype._adjustParentBBoxes=function(m,w,P){for(var k=P;k>=0;k--)_(w[k],m)},a.prototype._condense=function(m){for(var w=m.length-1,P=void 0;w>=0;w--)m[w].children.length===0?w>0?(P=m[w-1].children).splice(P.indexOf(m[w]),1):this.clear():u(m[w],this.toBBox)},a})})(gh);var Yf=gh.exports;class Wf{constructor(e=[],i=Uf){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:r}=this,s=i[e];for(;e>0;){const a=e-1>>1,l=i[a];if(r(s,l)>=0)break;i[e]=l,e=a}i[e]=s}_down(e){const{data:i,compare:r}=this,s=this.length>>1,a=i[e];for(;e<s;){let l=(e<<1)+1,u=i[l];const d=l+1;if(d<this.length&&r(i[d],u)<0&&(l=d,u=i[d]),r(u,a)>=0)break;i[e]=u,e=l}i[e]=a}}function Uf(n,e){return n<e?-1:n>e?1:0}const Xf=Object.freeze(Object.defineProperty({__proto__:null,default:Wf},Symbol.toStringTag,{value:"Module"})),Vf=Xr(Xf);var Zn={exports:{}},Hf=function(e,i,r,s){var a=e[0],l=e[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=i.length);for(var d=(s-r)/2,_=0,f=d-1;_<d;f=_++){var g=i[r+_*2+0],x=i[r+_*2+1],b=i[r+f*2+0],M=i[r+f*2+1],S=x>l!=M>l&&a<(b-g)*(l-x)/(M-x)+g;S&&(u=!u)}return u},Gf=function(e,i,r,s){var a=e[0],l=e[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=i.length);for(var d=s-r,_=0,f=d-1;_<d;f=_++){var g=i[_+r][0],x=i[_+r][1],b=i[f+r][0],M=i[f+r][1],S=x>l!=M>l&&a<(b-g)*(l-x)/(M-x)+g;S&&(u=!u)}return u},vh=Hf,yh=Gf;Zn.exports=function(e,i,r,s){return i.length>0&&Array.isArray(i[0])?yh(e,i,r,s):vh(e,i,r,s)};Zn.exports.nested=yh;Zn.exports.flat=vh;var $f=Zn.exports,Nr={exports:{}};(function(n,e){(function(i,r){r(e)})(Ur,function(i){const s=33306690738754706e-32;function a(S,B,A,m,w){let P,k,T,E,I=B[0],N=m[0],j=0,Y=0;N>I==N>-I?(P=I,I=B[++j]):(P=N,N=m[++Y]);let X=0;if(j<S&&Y<A)for(N>I==N>-I?(T=P-((k=I+P)-I),I=B[++j]):(T=P-((k=N+P)-N),N=m[++Y]),P=k,T!==0&&(w[X++]=T);j<S&&Y<A;)N>I==N>-I?(T=P-((k=P+I)-(E=k-P))+(I-E),I=B[++j]):(T=P-((k=P+N)-(E=k-P))+(N-E),N=m[++Y]),P=k,T!==0&&(w[X++]=T);for(;j<S;)T=P-((k=P+I)-(E=k-P))+(I-E),I=B[++j],P=k,T!==0&&(w[X++]=T);for(;Y<A;)T=P-((k=P+N)-(E=k-P))+(N-E),N=m[++Y],P=k,T!==0&&(w[X++]=T);return P===0&&X!==0||(w[X++]=P),X}function l(S){return new Float64Array(S)}const u=33306690738754716e-32,d=22204460492503146e-32,_=11093356479670487e-47,f=l(4),g=l(8),x=l(12),b=l(16),M=l(4);i.orient2d=function(S,B,A,m,w,P){const k=(B-P)*(A-w),T=(S-w)*(m-P),E=k-T;if(k===0||T===0||k>0!=T>0)return E;const I=Math.abs(k+T);return Math.abs(E)>=u*I?E:-function(N,j,Y,X,U,v,D){let z,V,R,K,Z,H,G,nt,Q,et,$,ht,dt,xt,Mt,Lt,Dt,Ct;const Ft=N-U,It=Y-U,Bt=j-v,St=X-v;Z=(Mt=(nt=Ft-(G=(H=134217729*Ft)-(H-Ft)))*(et=St-(Q=(H=134217729*St)-(H-St)))-((xt=Ft*St)-G*Q-nt*Q-G*et))-($=Mt-(Dt=(nt=Bt-(G=(H=134217729*Bt)-(H-Bt)))*(et=It-(Q=(H=134217729*It)-(H-It)))-((Lt=Bt*It)-G*Q-nt*Q-G*et))),f[0]=Mt-($+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+$)-(Z=ht-xt))+($-Z))-($=dt-Lt),f[1]=dt-($+Z)+(Z-Lt),Z=(Ct=ht+$)-ht,f[2]=ht-(Ct-Z)+($-Z),f[3]=Ct;let Zt=function(Wi,Ui){let Xi=Ui[0];for(let xe=1;xe<Wi;xe++)Xi+=Ui[xe];return Xi}(4,f),ye=d*D;if(Zt>=ye||-Zt>=ye||(z=N-(Ft+(Z=N-Ft))+(Z-U),R=Y-(It+(Z=Y-It))+(Z-U),V=j-(Bt+(Z=j-Bt))+(Z-v),K=X-(St+(Z=X-St))+(Z-v),z===0&&V===0&&R===0&&K===0)||(ye=_*D+s*Math.abs(Zt),(Zt+=Ft*K+St*z-(Bt*R+It*V))>=ye||-Zt>=ye))return Zt;Z=(Mt=(nt=z-(G=(H=134217729*z)-(H-z)))*(et=St-(Q=(H=134217729*St)-(H-St)))-((xt=z*St)-G*Q-nt*Q-G*et))-($=Mt-(Dt=(nt=V-(G=(H=134217729*V)-(H-V)))*(et=It-(Q=(H=134217729*It)-(H-It)))-((Lt=V*It)-G*Q-nt*Q-G*et))),M[0]=Mt-($+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+$)-(Z=ht-xt))+($-Z))-($=dt-Lt),M[1]=dt-($+Z)+(Z-Lt),Z=(Ct=ht+$)-ht,M[2]=ht-(Ct-Z)+($-Z),M[3]=Ct;const ji=a(4,f,4,M,g);Z=(Mt=(nt=Ft-(G=(H=134217729*Ft)-(H-Ft)))*(et=K-(Q=(H=134217729*K)-(H-K)))-((xt=Ft*K)-G*Q-nt*Q-G*et))-($=Mt-(Dt=(nt=Bt-(G=(H=134217729*Bt)-(H-Bt)))*(et=R-(Q=(H=134217729*R)-(H-R)))-((Lt=Bt*R)-G*Q-nt*Q-G*et))),M[0]=Mt-($+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+$)-(Z=ht-xt))+($-Z))-($=dt-Lt),M[1]=dt-($+Z)+(Z-Lt),Z=(Ct=ht+$)-ht,M[2]=ht-(Ct-Z)+($-Z),M[3]=Ct;const ii=a(ji,g,4,M,x);Z=(Mt=(nt=z-(G=(H=134217729*z)-(H-z)))*(et=K-(Q=(H=134217729*K)-(H-K)))-((xt=z*K)-G*Q-nt*Q-G*et))-($=Mt-(Dt=(nt=V-(G=(H=134217729*V)-(H-V)))*(et=R-(Q=(H=134217729*R)-(H-R)))-((Lt=V*R)-G*Q-nt*Q-G*et))),M[0]=Mt-($+Z)+(Z-Dt),Z=(dt=xt-((ht=xt+$)-(Z=ht-xt))+($-Z))-($=dt-Lt),M[1]=dt-($+Z)+(Z-Lt),Z=(Ct=ht+$)-ht,M[2]=ht-(Ct-Z)+($-Z),M[3]=Ct;const Yi=a(ii,x,4,M,b);return b[Yi-1]}(S,B,A,m,w,P,I)},i.orient2dfast=function(S,B,A,m,w,P){return(B-P)*(A-w)-(S-w)*(m-P)},Object.defineProperty(i,"__esModule",{value:!0})})})(Nr,Nr.exports);var qf=Nr.exports,na=Yf,Pn=Vf,Kf=$f,Jf=qf.orient2d;Pn.default&&(Pn=Pn.default);no.exports=xh;no.exports.default=xh;function xh(n,e,i){e=Math.max(0,e===void 0?2:e),i=i||0;var r=np(n),s=new na(16);s.toBBox=function(m){return{minX:m[0],minY:m[1],maxX:m[0],maxY:m[1]}},s.compareMinX=function(m,w){return m[0]-w[0]},s.compareMinY=function(m,w){return m[1]-w[1]},s.load(n);for(var a=[],l=0,u;l<r.length;l++){var d=r[l];s.remove(d),u=sa(d,u),a.push(u)}var _=new na(16);for(l=0;l<a.length;l++)_.insert(Mr(a[l]));for(var f=e*e,g=i*i;a.length;){var x=a.shift(),b=x.p,M=x.next.p,S=Lr(b,M);if(!(S<g)){var B=S/f;d=Qf(s,x.prev.p,b,M,x.next.next.p,B,_),d&&Math.min(Lr(d,b),Lr(d,M))<=B&&(a.push(x),a.push(sa(d,x)),s.remove(d),_.remove(x),_.insert(Mr(x)),_.insert(Mr(x.next)))}}x=u;var A=[];do A.push(x.p),x=x.next;while(x!==u);return A.push(x.p),A}function Qf(n,e,i,r,s,a,l){for(var u=new Pn([],tp),d=n.data;d;){for(var _=0;_<d.children.length;_++){var f=d.children[_],g=d.leaf?Cr(f,i,r):ep(i,r,f);g>a||u.push({node:f,dist:g})}for(;u.length&&!u.peek().node.children;){var x=u.pop(),b=x.node,M=Cr(b,e,i),S=Cr(b,r,s);if(x.dist<M&&x.dist<S&&oa(i,b,l)&&oa(r,b,l))return b}d=u.pop(),d&&(d=d.node)}return null}function tp(n,e){return n.dist-e.dist}function ep(n,e,i){if(ra(n,i)||ra(e,i))return 0;var r=gn(n[0],n[1],e[0],e[1],i.minX,i.minY,i.maxX,i.minY);if(r===0)return 0;var s=gn(n[0],n[1],e[0],e[1],i.minX,i.minY,i.minX,i.maxY);if(s===0)return 0;var a=gn(n[0],n[1],e[0],e[1],i.maxX,i.minY,i.maxX,i.maxY);if(a===0)return 0;var l=gn(n[0],n[1],e[0],e[1],i.minX,i.maxY,i.maxX,i.maxY);return l===0?0:Math.min(r,s,a,l)}function ra(n,e){return n[0]>=e.minX&&n[0]<=e.maxX&&n[1]>=e.minY&&n[1]<=e.maxY}function oa(n,e,i){for(var r=Math.min(n[0],e[0]),s=Math.min(n[1],e[1]),a=Math.max(n[0],e[0]),l=Math.max(n[1],e[1]),u=i.search({minX:r,minY:s,maxX:a,maxY:l}),d=0;d<u.length;d++)if(ip(u[d].p,u[d].next.p,n,e))return!1;return!0}function $e(n,e,i){return Jf(n[0],n[1],e[0],e[1],i[0],i[1])}function ip(n,e,i,r){return n!==r&&e!==i&&$e(n,e,i)>0!=$e(n,e,r)>0&&$e(i,r,n)>0!=$e(i,r,e)>0}function Mr(n){var e=n.p,i=n.next.p;return n.minX=Math.min(e[0],i[0]),n.minY=Math.min(e[1],i[1]),n.maxX=Math.max(e[0],i[0]),n.maxY=Math.max(e[1],i[1]),n}function np(n){for(var e=n[0],i=n[0],r=n[0],s=n[0],a=0;a<n.length;a++){var l=n[a];l[0]<e[0]&&(e=l),l[0]>r[0]&&(r=l),l[1]<i[1]&&(i=l),l[1]>s[1]&&(s=l)}var u=[e,i,r,s],d=u.slice();for(a=0;a<n.length;a++)Kf(n[a],u)||d.push(n[a]);return op(d)}function sa(n,e){var i={p:n,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(i.next=e.next,i.prev=e,e.next.prev=i,e.next=i):(i.prev=i,i.next=i),i}function Lr(n,e){var i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r}function Cr(n,e,i){var r=e[0],s=e[1],a=i[0]-r,l=i[1]-s;if(a!==0||l!==0){var u=((n[0]-r)*a+(n[1]-s)*l)/(a*a+l*l);u>1?(r=i[0],s=i[1]):u>0&&(r+=a*u,s+=l*u)}return a=n[0]-r,l=n[1]-s,a*a+l*l}function gn(n,e,i,r,s,a,l,u){var d=i-n,_=r-e,f=l-s,g=u-a,x=n-s,b=e-a,M=d*d+_*_,S=d*f+_*g,B=f*f+g*g,A=d*x+_*b,m=f*x+g*b,w=M*B-S*S,P,k,T,E,I=w,N=w;w===0?(k=0,I=1,E=m,N=B):(k=S*m-B*A,E=M*m-S*A,k<0?(k=0,E=m,N=B):k>I&&(k=I,E=m+S,N=B)),E<0?(E=0,-A<0?k=0:-A>M?k=I:(k=-A,I=M)):E>N&&(E=N,-A+S<0?k=0:-A+S>M?k=I:(k=-A+S,I=M)),P=k===0?0:k/I,T=E===0?0:E/N;var j=(1-P)*n+P*i,Y=(1-P)*e+P*r,X=(1-T)*s+T*l,U=(1-T)*a+T*u,v=X-j,D=U-Y;return v*v+D*D}function rp(n,e){return n[0]===e[0]?n[1]-e[1]:n[0]-e[0]}function op(n){n.sort(rp);for(var e=[],i=0;i<n.length;i++){for(;e.length>=2&&$e(e[e.length-2],e[e.length-1],n[i])<=0;)e.pop();e.push(n[i])}for(var r=[],s=n.length-1;s>=0;s--){for(;r.length>=2&&$e(r[r.length-2],r[r.length-1],n[s])<=0;)r.pop();r.push(n[s])}return r.pop(),e.pop(),e.concat(r)}var sp=no.exports;const ap=Pa(sp);function hp(n,e={}){e.concavity=e.concavity||1/0;const i=[];if(mh(n,s=>{i.push([s[0],s[1]])}),!i.length)return null;const r=ap(i,e.concavity);return r.length>3?jf([r]):null}var lp=hp;class up{constructor(){this.heap=[],this.insertCounter=0}insert(e,i){const r={key:e,value:i,index:this.insertCounter++};let s=this.heap.length;for(this.heap.push(r);s>0;){const a=s-1>>>1,l=this.heap[a];if(r.key>l.key||r.key===l.key&&r.index>l.index)break;this.heap[s]=l,s=a}this.heap[s]=r}extractMin(){const e=this.heap.length;if(e===0)return null;const i=this.heap[0],r=this.heap.pop();return e>1&&(this.heap[0]=r,this.bubbleDown(0)),i.value}size(){return this.heap.length}bubbleDown(e){const{heap:i}=this,r=i.length,s=i[e],a=s.key,l=s.index;for(;;){const u=1+(e<<1);if(u>=r)break;let d=u,_=i[u].key,f=i[u].index;const g=u+1;if(g<r){const x=i[g].key,b=i[g].index;(x<_||x===_&&b<f)&&(d=g,_=x,f=b)}if(!(_<a||_===a&&f<l))break;i[e]=i[d],e=d}i[e]=s}}const cp=(n,e)=>{const i=_=>_*Math.PI/180,r=i(n[1]),s=i(n[0]),a=i(e[1]),l=a-r,u=i(e[0])-s,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6371e3/1e3};function dp(n){const e=.0033528106647474805,i=e*(2-e),r=Math.PI/180,s=Math.cos(n*r),a=1/(1-i*(1-s*s)),l=Math.sqrt(a),u=6378.137*r,d=u*l*s,_=u*l*a*(1-i);return function(f,g){let x=f[0]-g[0];for(;x<-180;)x+=360;for(;x>180;)x-=360;const b=x*d,M=(f[1]-g[1])*_;return Math.sqrt(b*b+M*M)}}class fp{constructor(e){this.network=void 0,this.distanceMeasurement=void 0,this.adjacencyList=new Map,this.coords=[],this.coordMap=new Map,this.distanceMeasurement=e||cp}coordinateIndex(e){const[i,r]=e;this.coordMap.has(i)||this.coordMap.set(i,new Map);const s=this.coordMap.get(i);if(s.has(r))return s.get(r);const a=this.coords.length;return this.coords.push(e),s.set(r,a),a}buildRouteGraph(e){this.network=e,this.adjacencyList=new Map,this.coords=[],this.coordMap=new Map;for(const i of this.network.features){const r=i.geometry.coordinates;for(let s=0;s<r.length-1;s++){const a=this.coordinateIndex(r[s]),l=this.coordinateIndex(r[s+1]),u=this.distanceMeasurement(r[s],r[s+1]);this.adjacencyList.has(a)||this.adjacencyList.set(a,[]),this.adjacencyList.has(l)||this.adjacencyList.set(l,[]),this.adjacencyList.get(a).push({node:l,distance:u}),this.adjacencyList.get(l).push({node:a,distance:u})}}}getRoute(e,i){if(!this.network)throw new Error("Network not built. Please call buildNetworkGraph(network) first.");const r=this.coordinateIndex(e.geometry.coordinates),s=this.coordinateIndex(i.geometry.coordinates);if(r===s)return null;const a=new up;a.insert(0,r);const l=new Map,u=new Map([[r,0]]);for(;a.size()>0;){const f=a.extractMin();if(f===s){const x=[];let b=f;for(;b!==void 0;)x.unshift(this.coords[b]),b=l.get(b);return{type:"Feature",geometry:{type:"LineString",coordinates:x},properties:{}}}const g=this.adjacencyList.get(f)||[];for(const x of g){var d,_;const b=((d=u.get(f))!=null?d:1/0)+x.distance;if(b<((_=u.get(x.node))!=null?_:1/0)){l.set(x.node,f),u.set(x.node,b);const M=b+this.distanceMeasurement(this.coords[x.node],this.coords[s]);a.insert(M,x.node)}}}return null}}function pp(n){const e=dp(n.features[0].geometry.coordinates[0][1]),i=new fp(e);return i.buildRouteGraph(n),new Dc({network:n,useCache:!0,routeFinder:i})}const _p=()=>{const n=51.532831,e=-.078,i={L:ia,id:"leaflet-map",lng:e,lat:n,zoom:16,minZoom:14,maxZoom:20,tapTolerance:10,maxBounds:[[n-.05,e-.05],[n+.05,e+.05]]},r=Su(null),[s,a]=_r(),[l,u]=_r("static"),[d,_]=_r();ws(()=>{const M=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/public/network.json":"./network.json";fetch(M).then(S=>{S.json().then(B=>{_(B)})})},[]),ws(()=>{s||a(Ef(i))},[]);const f=zi(()=>{if(d)return pp(d)},[d]),g=zi(()=>{if(s&&f&&d){const b=Oc(s,ia,f);b.start();const M=lp(d);return M&&M.properties&&(M.properties.mode="networkOutline"),b.addFeatures([M]),b}},[s,d,f]),x=ku(b=>{g&&(u(b),g.setMode(b))},[g]);return _t("div",{class:fr.home,children:_t("div",{ref:r,class:fr.map,id:i.id,children:[g?_t(Nf,{mode:l,changeMode:x,onClear:()=>{const b=g.getSnapshot().filter(M=>M.properties.mode==="routesnap");g.removeFeatures(b.map(M=>M.id))}}):null,g?null:_t("div",{class:fr.loading,children:"Loading..."})]})})};console.log("App.tsx");const mp=()=>_t("div",{id:"app",children:[_t(bu,{}),_t(_p,{})]});let Ce,Ci;const gp=(n,e)=>{if(Ce=void 0,e&&e.type==="click"){if(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button!==0)return n;const i=e.target.closest("a[href]"),r=i&&i.getAttribute("href");if(!i||i.origin!=location.origin||/^#/.test(r)||!/^(_?self)?$/i.test(i.target)||Ci&&(typeof Ci=="string"?!r.startsWith(Ci):!Ci.test(r)))return n;Ce=!0,e.preventDefault(),e=i.href.replace(location.origin,"")}else typeof e=="string"?Ce=!0:e&&e.url?(Ce=!e.replace,e=e.url):e=location.pathname+location.search;return Ce===!0?history.pushState(null,"",e):Ce===!1&&history.replaceState(null,"",e),e};function wh(n){const[e,i]=Ba(gp,n.url||location.pathname+location.search);n.scope&&(Ci=n.scope);const r=Ce===!0,s=zi(()=>{const a=new URL(e,location.origin),l=a.pathname.replace(/\/+$/g,"")||"/";return{url:e,path:l,query:Object.fromEntries(a.searchParams),route:(u,d)=>i({url:u,replace:d}),wasPush:r}},[e]);return Cu(()=>(addEventListener("click",i),addEventListener("popstate",i),()=>{removeEventListener("click",i),removeEventListener("popstate",i)}),[]),Qe(wh.ctx.Provider,{value:s},n.children)}Promise.resolve();wh.ctx=Wr({});Wr({});const aa=it.__b;it.__b=n=>{n.type&&n.type._forwarded&&n.ref&&(n.props.ref=n.ref,n.ref=null),aa&&aa(n)};const ha=it.__e;it.__e=(n,e,i)=>{if(n&&n.then){let r=e;for(;r=r.__;)if(r.__c&&r.__c.__c)return e.__e==null&&(e.__c.__z=[i.__e],e.__e=i.__e,e.__k=i.__k),e.__k||(e.__k=[]),r.__c.__c(n,e)}ha&&ha(n,e,i)};let la;function vp(n,e){if(typeof window>"u")return;let i=document.querySelector("script[type=isodata]");e=e||i&&i.parentNode||document.body,!la&&i?Yr(n,e):jr(n,e),la=!0}typeof window<"u"&&vp(_t(mp,{}),document.getElementById("app"));
