function Yu(i,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in i)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var Vi,it,Ha,Ga,Ii,Ts,qa,Zn={},Ja=[],Xu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function de(i,t){for(var n in t)i[n]=t[n];return i}function Ka(i){var t=i.parentNode;t&&t.removeChild(i)}function ti(i,t,n){var r,s,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?s=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?Vi.call(arguments,2):n),typeof i=="function"&&i.defaultProps!=null)for(a in i.defaultProps)l[a]===void 0&&(l[a]=i.defaultProps[a]);return Fi(i,l,r,s,null)}function Fi(i,t,n,r,s){var a={type:i,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++Ha};return s==null&&it.vnode!=null&&it.vnode(a),a}function $u(){return{current:null}}function Hi(i){return i.children}function Je(i,t){this.props=i,this.context=t}function Xi(i,t){if(t==null)return i.__?Xi(i.__,i.__.__k.indexOf(i)+1):null;for(var n;t<i.__k.length;t++)if((n=i.__k[t])!=null&&n.__e!=null)return n.__e;return typeof i.type=="function"?Xi(i):null}function Qa(i){var t,n;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,t=0;t<i.__k.length;t++)if((n=i.__k[t])!=null&&n.__e!=null){i.__e=i.__c.base=n.__e;break}return Qa(i)}}function Vr(i){(!i.__d&&(i.__d=!0)&&Ii.push(i)&&!Yn.__r++||Ts!==it.debounceRendering)&&((Ts=it.debounceRendering)||setTimeout)(Yn)}function Yn(){for(var i;Yn.__r=Ii.length;)i=Ii.sort(function(t,n){return t.__v.__b-n.__v.__b}),Ii=[],i.some(function(t){var n,r,s,a,l,u;t.__d&&(l=(a=(n=t).__v).__e,(u=n.__P)&&(r=[],(s=de({},a)).__v=a.__v+1,ao(u,a,s,n.__n,u.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Xi(a),a.__h),nh(r,a),a.__e!=l&&Qa(a)))})}function th(i,t,n,r,s,a,l,u,c,d){var p,_,v,x,P,S,D,k=r&&r.__k||Ja,g=k.length;for(n.__k=[],p=0;p<t.length;p++)if((x=n.__k[p]=(x=t[p])==null||typeof x=="boolean"?null:typeof x=="string"||typeof x=="number"||typeof x=="bigint"?Fi(null,x,null,null,x):Array.isArray(x)?Fi(Hi,{children:x},null,null,null):x.__b>0?Fi(x.type,x.props,x.key,x.ref?x.ref:null,x.__v):x)!=null){if(x.__=n,x.__b=n.__b+1,(v=k[p])===null||v&&x.key==v.key&&x.type===v.type)k[p]=void 0;else for(_=0;_<g;_++){if((v=k[_])&&x.key==v.key&&x.type===v.type){k[_]=void 0;break}v=null}ao(i,x,v=v||Zn,s,a,l,u,c,d),P=x.__e,(_=x.ref)&&v.ref!=_&&(D||(D=[]),v.ref&&D.push(v.ref,null,x),D.push(_,x.__c||P,x)),P!=null?(S==null&&(S=P),typeof x.type=="function"&&x.__k===v.__k?x.__d=c=eh(x,c,i):c=ih(i,x,v,k,P,c),typeof n.type=="function"&&(n.__d=c)):c&&v.__e==c&&c.parentNode!=i&&(c=Xi(v))}for(n.__e=S,p=g;p--;)k[p]!=null&&oh(k[p],k[p]);if(D)for(p=0;p<D.length;p++)rh(D[p],D[++p],D[++p])}function eh(i,t,n){for(var r,s=i.__k,a=0;s&&a<s.length;a++)(r=s[a])&&(r.__=i,t=typeof r.type=="function"?eh(r,t,n):ih(n,r,r,s,r.__e,t));return t}function Xn(i,t){return t=t||[],i==null||typeof i=="boolean"||(Array.isArray(i)?i.some(function(n){Xn(n,t)}):t.push(i)),t}function ih(i,t,n,r,s,a){var l,u,c;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(n==null||s!=a||s.parentNode==null)t:if(a==null||a.parentNode!==i)i.appendChild(s),l=null;else{for(u=a,c=0;(u=u.nextSibling)&&c<r.length;c+=1)if(u==s)break t;i.insertBefore(s,a),l=a}return l!==void 0?l:s.nextSibling}function Uu(i,t,n,r,s){var a;for(a in n)a==="children"||a==="key"||a in t||$n(i,a,null,n[a],r);for(a in t)s&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||$n(i,a,t[a],n[a],r)}function As(i,t,n){t[0]==="-"?i.setProperty(t,n):i[t]=n==null?"":typeof n!="number"||Xu.test(t)?n:n+"px"}function $n(i,t,n,r,s){var a;t:if(t==="style")if(typeof n=="string")i.style.cssText=n;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(t in r)n&&t in n||As(i.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||As(i.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in i?t.toLowerCase().slice(2):t.slice(2),i.l||(i.l={}),i.l[t+a]=n,n?r||i.addEventListener(t,a?Bs:Ds,a):i.removeEventListener(t,a?Bs:Ds,a);else if(t!=="dangerouslySetInnerHTML"){if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in i)try{i[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t.indexOf("-")==-1?i.removeAttribute(t):i.setAttribute(t,n))}}function Ds(i){this.l[i.type+!1](it.event?it.event(i):i)}function Bs(i){this.l[i.type+!0](it.event?it.event(i):i)}function ao(i,t,n,r,s,a,l,u,c){var d,p,_,v,x,P,S,D,k,g,y,M,E,B,C,A=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,u=t.__e=n.__e,t.__h=null,a=[u]),(d=it.__b)&&d(t);try{t:if(typeof A=="function"){if(D=t.props,k=(d=A.contextType)&&r[d.__c],g=d?k?k.props.value:d.__:r,n.__c?S=(p=t.__c=n.__c).__=p.__E:("prototype"in A&&A.prototype.render?t.__c=p=new A(D,g):(t.__c=p=new Je(D,g),p.constructor=A,p.render=Wu),k&&k.sub(p),p.props=D,p.state||(p.state={}),p.context=g,p.__n=r,_=p.__d=!0,p.__h=[],p._sb=[]),p.__s==null&&(p.__s=p.state),A.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=de({},p.__s)),de(p.__s,A.getDerivedStateFromProps(D,p.__s))),v=p.props,x=p.state,_)A.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(A.getDerivedStateFromProps==null&&D!==v&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(D,g),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(D,p.__s,g)===!1||t.__v===n.__v){for(p.props=D,p.state=p.__s,t.__v!==n.__v&&(p.__d=!1),p.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(I){I&&(I.__=t)}),y=0;y<p._sb.length;y++)p.__h.push(p._sb[y]);p._sb=[],p.__h.length&&l.push(p);break t}p.componentWillUpdate!=null&&p.componentWillUpdate(D,p.__s,g),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(v,x,P)})}if(p.context=g,p.props=D,p.__v=t,p.__P=i,M=it.__r,E=0,"prototype"in A&&A.prototype.render){for(p.state=p.__s,p.__d=!1,M&&M(t),d=p.render(p.props,p.state,p.context),B=0;B<p._sb.length;B++)p.__h.push(p._sb[B]);p._sb=[]}else do p.__d=!1,M&&M(t),d=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++E<25);p.state=p.__s,p.getChildContext!=null&&(r=de(de({},r),p.getChildContext())),_||p.getSnapshotBeforeUpdate==null||(P=p.getSnapshotBeforeUpdate(v,x)),C=d!=null&&d.type===Hi&&d.key==null?d.props.children:d,th(i,Array.isArray(C)?C:[C],t,n,r,s,a,l,u,c),p.base=t.__e,t.__h=null,p.__h.length&&l.push(p),S&&(p.__E=p.__=null),p.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=ju(n.__e,t,n,r,s,a,l,c);(d=it.diffed)&&d(t)}catch(I){t.__v=null,(c||a!=null)&&(t.__e=u,t.__h=!!c,a[a.indexOf(u)]=null),it.__e(I,t,n)}}function nh(i,t){it.__c&&it.__c(t,i),i.some(function(n){try{i=n.__h,n.__h=[],i.some(function(r){r.call(n)})}catch(r){it.__e(r,n.__v)}})}function ju(i,t,n,r,s,a,l,u){var c,d,p,_=n.props,v=t.props,x=t.type,P=0;if(x==="svg"&&(s=!0),a!=null){for(;P<a.length;P++)if((c=a[P])&&"setAttribute"in c==!!x&&(x?c.localName===x:c.nodeType===3)){i=c,a[P]=null;break}}if(i==null){if(x===null)return document.createTextNode(v);i=s?document.createElementNS("http://www.w3.org/2000/svg",x):document.createElement(x,v.is&&v),a=null,u=!1}if(x===null)_===v||u&&i.data===v||(i.data=v);else{if(a=a&&Vi.call(i.childNodes),d=(_=n.props||Zn).dangerouslySetInnerHTML,p=v.dangerouslySetInnerHTML,!u){if(a!=null)for(_={},P=0;P<i.attributes.length;P++)_[i.attributes[P].name]=i.attributes[P].value;(p||d)&&(p&&(d&&p.__html==d.__html||p.__html===i.innerHTML)||(i.innerHTML=p&&p.__html||""))}if(Uu(i,v,_,s,u),p)t.__k=[];else if(P=t.props.children,th(i,Array.isArray(P)?P:[P],t,n,r,s&&x!=="foreignObject",a,l,a?a[0]:n.__k&&Xi(n,0),u),a!=null)for(P=a.length;P--;)a[P]!=null&&Ka(a[P]);u||("value"in v&&(P=v.value)!==void 0&&(P!==i.value||x==="progress"&&!P||x==="option"&&P!==_.value)&&$n(i,"value",P,_.value,!1),"checked"in v&&(P=v.checked)!==void 0&&P!==i.checked&&$n(i,"checked",P,_.checked,!1))}return i}function rh(i,t,n){try{typeof i=="function"?i(t):i.current=t}catch(r){it.__e(r,n)}}function oh(i,t,n){var r,s;if(it.unmount&&it.unmount(i),(r=i.ref)&&(r.current&&r.current!==i.__e||rh(r,null,t)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){it.__e(a,t)}r.base=r.__P=null,i.__c=void 0}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&oh(r[s],t,n||typeof i.type!="function");n||i.__e==null||Ka(i.__e),i.__=i.__e=i.__d=void 0}function Wu(i,t,n){return this.constructor(i,n)}function ho(i,t,n){var r,s,a;it.__&&it.__(i,t),s=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],ao(t,i=(!r&&n||t).__k=ti(Hi,null,[i]),s||Zn,Zn,t.ownerSVGElement!==void 0,!r&&n?[n]:s?null:t.firstChild?Vi.call(t.childNodes):null,a,!r&&n?n:s?s.__e:t.firstChild,r),nh(a,i)}function lo(i,t){ho(i,t,lo)}function sh(i,t,n){var r,s,a,l=de({},i.props);for(a in t)a=="key"?r=t[a]:a=="ref"?s=t[a]:l[a]=t[a];return arguments.length>2&&(l.children=arguments.length>3?Vi.call(arguments,2):n),Fi(i.type,l,r||i.key,s||i.ref,null)}function uo(i,t){var n={__c:t="__cC"+qa++,__:i,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,a;return this.getChildContext||(s=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&s.some(Vr)},this.sub=function(l){s.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){s.splice(s.indexOf(l),1),u&&u.call(l)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Vi=Ja.slice,it={__e:function(i,t,n,r){for(var s,a,l;t=t.__;)if((s=t.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(i)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),l=s.__d),l)return s.__E=s}catch(u){i=u}throw i}},Ha=0,Ga=function(i){return i!=null&&i.constructor===void 0},Je.prototype.setState=function(i,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=de({},this.state),typeof i=="function"&&(i=i(de({},n),this.props)),i&&de(n,i),i!=null&&this.__v&&(t&&this._sb.push(t),Vr(this))},Je.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Vr(this))},Je.prototype.render=Hi,Ii=[],Yn.__r=0,qa=0;const Vu=Object.freeze(Object.defineProperty({__proto__:null,Component:Je,Fragment:Hi,cloneElement:sh,createContext:uo,createElement:ti,createRef:$u,h:ti,hydrate:lo,get isValidElement(){return Ga},get options(){return it},render:ho,toChildArray:Xn},Symbol.toStringTag,{value:"Module"}));var Hu=0;function ft(i,t,n,r,s){var a,l,u={};for(l in t)l=="ref"?a=t[l]:u[l]=t[l];var c={type:i,props:u,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Hu,__source:s,__self:r};if(typeof i=="function"&&(a=i.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return it.vnode&&it.vnode(c),c}var co=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ah(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function fo(i){if(i.__esModule)return i;var t=i.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),n}var ei={};const Gu=fo(Vu);var qu={};function hh(i,t){for(var n in t)i[n]=t[n];return i}function po(i,t,n){var r=/(?:\?([^#]*))?(#.*)?$/,s=i.match(r),a={},l;if(s&&s[1])for(var u=s[1].split("&"),c=0;c<u.length;c++){var d=u[c].split("=");a[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}i=Hr(i.replace(r,"")),t=Hr(t||"");for(var p=Math.max(i.length,t.length),_=0;_<p;_++)if(t[_]&&t[_].charAt(0)===":"){var v=t[_].replace(/(^:|[+*?]+$)/g,""),x=(t[_].match(/[+*?]+$/)||qu)[0]||"",P=~x.indexOf("+"),S=~x.indexOf("*"),D=i[_]||"";if(!D&&!S&&(x.indexOf("?")<0||P)){l=!1;break}if(a[v]=decodeURIComponent(D),P||S){a[v]=i.slice(_).map(decodeURIComponent).join("/");break}}else if(t[_]!==i[_]){l=!1;break}return n.default!==!0&&l===!1?!1:a}function Ju(i,t){return i.rank<t.rank?1:i.rank>t.rank?-1:i.index-t.index}function Ku(i,t){return i.index=t,i.rank=ec(i),i.props}function Hr(i){return i.replace(/(^\/+|\/+$)/g,"").split("/")}function Qu(i){return i.charAt(0)==":"?1+"*+?".indexOf(i.charAt(i.length-1))||4:5}function tc(i){return Hr(i).map(Qu).join("")}function ec(i){return i.props.default?0:tc(i.props.path)}var Zt=null,Ce=[],Un=[],ic={};function nc(i,t){t===void 0&&(t="push"),Zt&&Zt[t]?Zt[t](i):typeof history<"u"&&history[t+"State"]&&history[t+"State"](null,null,i)}function qn(){var i;return Zt&&Zt.location?i=Zt.location:Zt&&Zt.getCurrentLocation?i=Zt.getCurrentLocation():i=typeof location<"u"?location:ic,""+(i.pathname||"")+(i.search||"")}function mo(i,t){return t===void 0&&(t=!1),typeof i!="string"&&i.url&&(t=i.replace,i=i.url),rc(i)&&nc(i,t?"replace":"push"),lh(i)}function rc(i){for(var t=Ce.length;t--;)if(Ce[t].canRoute(i))return!0;return!1}function lh(i){for(var t=!1,n=0;n<Ce.length;n++)Ce[n].routeTo(i)===!0&&(t=!0);for(var r=Un.length;r--;)Un[r](i);return t}function uh(i){if(!(!i||!i.getAttribute)){var t=i.getAttribute("href"),n=i.getAttribute("target");if(!(!t||!t.match(/^\//g)||n&&!n.match(/^_?self$/i)))return mo(t)}}function oc(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0))return uh(i.currentTarget||i.target||this),ch(i)}function ch(i){return i&&(i.stopImmediatePropagation&&i.stopImmediatePropagation(),i.stopPropagation&&i.stopPropagation(),i.preventDefault()),!1}function sc(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0)){var t=i.target;do if(String(t.nodeName).toUpperCase()==="A"&&t.getAttribute("href")){if(t.hasAttribute("native"))return;if(uh(t))return ch(i)}while(t=t.parentNode)}}var zs=!1;function ac(){zs||(typeof addEventListener=="function"&&(Zt||addEventListener("popstate",function(){lh(qn())}),addEventListener("click",sc)),zs=!0)}var ae=function(i){function t(n){i.call(this,n),n.history&&(Zt=n.history),this.state={url:n.url||qn()},ac()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.shouldComponentUpdate=function(r){return r.static!==!0?!0:r.url!==this.props.url||r.onChange!==this.props.onChange},t.prototype.canRoute=function(r){var s=Xn(this.props.children);return this.getMatchingChildren(s,r,!1).length>0},t.prototype.routeTo=function(r){this.setState({url:r});var s=this.canRoute(r);return this.updating||this.forceUpdate(),s},t.prototype.componentWillMount=function(){Ce.push(this),this.updating=!0},t.prototype.componentDidMount=function(){var r=this;Zt&&(this.unlisten=Zt.listen(function(s){r.routeTo(""+(s.pathname||"")+(s.search||""))})),this.updating=!1},t.prototype.componentWillUnmount=function(){typeof this.unlisten=="function"&&this.unlisten(),Ce.splice(Ce.indexOf(this),1)},t.prototype.componentWillUpdate=function(){this.updating=!0},t.prototype.componentDidUpdate=function(){this.updating=!1},t.prototype.getMatchingChildren=function(r,s,a){return r.filter(Ku).sort(Ju).map(function(l){var u=po(s,l.props.path,l.props);if(u){if(a!==!1){var c={url:s,matches:u};return hh(c,u),delete c.ref,delete c.key,sh(l,c)}return l}}).filter(Boolean)},t.prototype.render=function(r,s){var a=r.children,l=r.onChange,u=s.url,c=this.getMatchingChildren(Xn(a),u,!0),d=c[0]||null,p=this.previousUrl;return u!==p&&(this.previousUrl=u,typeof l=="function"&&l({router:this,url:u,previous:p,active:c,current:d})),d},t}(Je),fh=function(i){return ti("a",hh({onClick:oc},i))},dh=function(i){return ti(i.component,i)};ae.subscribers=Un;ae.getCurrentUrl=qn;ae.route=mo;ae.Router=ae;ae.Route=dh;ae.Link=fh;ae.exec=po;const hc=Object.freeze(Object.defineProperty({__proto__:null,Link:fh,Route:dh,Router:ae,default:ae,exec:po,getCurrentUrl:qn,route:mo,subscribers:Un},Symbol.toStringTag,{value:"Module"})),lc=fo(hc);Object.defineProperty(ei,"__esModule",{value:!0});var ph=ei.Link=ei.Match=void 0,uc=Object.assign||function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Gr=Gu,We=lc;function cc(i,t){var n={};for(var r in i)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r]);return n}function fc(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function Os(i,t){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:i}function dc(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(i,t):i.__proto__=t)}var _o=ei.Match=function(i){dc(t,i);function t(){var n,r,s;fc(this,t);for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];return s=(n=(r=Os(this,i.call.apply(i,[this].concat(l))),r),r.update=function(c){r.nextUrl=c,r.setState({})},n),Os(r,s)}return t.prototype.componentDidMount=function(){We.subscribers.push(this.update)},t.prototype.componentWillUnmount=function(){We.subscribers.splice(We.subscribers.indexOf(this.update)>>>0,1)},t.prototype.render=function(r){var s=this.nextUrl||(0,We.getCurrentUrl)(),a=s.replace(/\?.+$/,"");return this.nextUrl=null,r.children({url:s,path:a,matches:(0,We.exec)(a,r.path,{})!==!1})},t}(Gr.Component),mh=function(t){var n=t.activeClassName,r=t.path,s=cc(t,["activeClassName","path"]);return(0,Gr.h)(_o,{path:r||s.href},function(a){var l=a.matches;return(0,Gr.h)(We.Link,uc({},s,{class:[s.class||s.className,l&&n].filter(Boolean).join(" ")}))})};ph=ei.Link=mh;ei.default=_o;_o.Link=mh;const pc="_header_19max_1",mc="_nav_19max_14",_c="_github_19max_19",gc="_logo_19max_26",vc="_active_19max_66",yi={header:pc,nav:mc,github:_c,logo:gc,active:vc},yc=""+new URL("logo-DQvm3LRv.png",import.meta.url).href,wc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",xc=()=>ft("header",{class:yi.header,children:[ft("div",{class:yi.nav,children:[ft("img",{class:yi.logo,src:yc}),ft("nav",{children:ft(ph,{activeClassName:yi.active,href:"/",children:"Home"})})]}),ft("div",{class:yi.github,children:ft("a",{href:"https://www.github.com/JamesLMilner/terra-draw",children:ft("img",{src:wc})})})]}),bc="_home_h5ve7_1",Mc="_map_h5ve7_7",Pc="_loading_h5ve7_75",Lc="_routingSelect_h5ve7_85",Ec="_split_h5ve7_97",wi={home:bc,map:Mc,loading:Pc,routingSelect:Lc,split:Ec};var Gi,yt,kr,Is,$i=0,_h=[],Bn=[],Fs=it.__b,Ns=it.__r,Rs=it.diffed,Zs=it.__c,Ys=it.unmount;function Jn(i,t){it.__h&&it.__h(yt,i,$i||t),$i=0;var n=yt.__H||(yt.__H={__:[],__h:[]});return i>=n.__.length&&n.__.push({__V:Bn}),n.__[i]}function xi(i){return $i=1,gh(vh,i)}function gh(i,t,n){var r=Jn(Gi++,2);if(r.t=i,!r.__c&&(r.__=[vh(void 0,t),function(a){var l=r.__N?r.__N[0]:r.__[0],u=r.t(l,a);l!==u&&(r.__N=[u,r.__[1]],r.__c.setState({}))}],r.__c=yt,!yt.u)){yt.u=!0;var s=yt.shouldComponentUpdate;yt.shouldComponentUpdate=function(a,l,u){if(!r.__c.__H)return!0;var c=r.__c.__H.__.filter(function(p){return p.__c});if(c.every(function(p){return!p.__N}))return!s||s.call(this,a,l,u);var d=!1;return c.forEach(function(p){if(p.__N){var _=p.__[0];p.__=p.__N,p.__N=void 0,_!==p.__[0]&&(d=!0)}}),!(!d&&r.__c.props===a)&&(!s||s.call(this,a,l,u))}}return r.__N||r.__}function Xs(i,t){var n=Jn(Gi++,3);!it.__s&&go(n.__H,t)&&(n.__=i,n.i=t,yt.__H.__h.push(n))}function Sc(i,t){var n=Jn(Gi++,4);!it.__s&&go(n.__H,t)&&(n.__=i,n.i=t,yt.__h.push(n))}function kc(i){return $i=5,Ui(function(){return{current:i}},[])}function Ui(i,t){var n=Jn(Gi++,7);return go(n.__H,t)?(n.__V=i(),n.i=t,n.__h=i,n.__V):n.__}function $s(i,t){return $i=8,Ui(function(){return i},t)}function Cc(){for(var i;i=_h.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(zn),i.__H.__h.forEach(qr),i.__H.__h=[]}catch(t){i.__H.__h=[],it.__e(t,i.__v)}}it.__b=function(i){yt=null,Fs&&Fs(i)},it.__r=function(i){Ns&&Ns(i),Gi=0;var t=(yt=i.__c).__H;t&&(kr===yt?(t.__h=[],yt.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=Bn,n.__N=n.i=void 0})):(t.__h.forEach(zn),t.__h.forEach(qr),t.__h=[])),kr=yt},it.diffed=function(i){Rs&&Rs(i);var t=i.__c;t&&t.__H&&(t.__H.__h.length&&(_h.push(t)!==1&&Is===it.requestAnimationFrame||((Is=it.requestAnimationFrame)||Tc)(Cc)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==Bn&&(n.__=n.__V),n.i=void 0,n.__V=Bn})),kr=yt=null},it.__c=function(i,t){t.some(function(n){try{n.__h.forEach(zn),n.__h=n.__h.filter(function(r){return!r.__||qr(r)})}catch(r){t.some(function(s){s.__h&&(s.__h=[])}),t=[],it.__e(r,n.__v)}}),Zs&&Zs(i,t)},it.unmount=function(i){Ys&&Ys(i);var t,n=i.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{zn(r)}catch(s){t=s}}),n.__H=void 0,t&&it.__e(t,n.__v))};var Us=typeof requestAnimationFrame=="function";function Tc(i){var t,n=function(){clearTimeout(r),Us&&cancelAnimationFrame(t),setTimeout(i)},r=setTimeout(n,100);Us&&(t=requestAnimationFrame(n))}function zn(i){var t=yt,n=i.__c;typeof n=="function"&&(i.__c=void 0,n()),yt=t}function qr(i){var t=yt;i.__c=i.__(),yt=t}function go(i,t){return!i||i.length!==t.length||t.some(function(n,r){return n!==i[r]})}function vh(i,t){return typeof t=="function"?t(i):t}function ii(){return ii=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ii.apply(null,arguments)}var Jr;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(Jr||(Jr={}));const xn={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT:"selectionPoint"},js="coordinatePointIds";function Cr(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function Ws(i){return!!(i&&typeof i=="object"&&"properties"in i&&typeof i.properties=="object"&&i.properties!==null&&"mode"in i.properties)}function Vs(i){return!!function(t){return typeof t=="number"&&!isNaN(new Date(t).valueOf())}(i)}const Ac="Feature mode property does not match the mode being added to";var ni;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(ni||(ni={}));let yh=class{get state(){return this._state}set state(t){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(t){if(typeof t!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=t}registerBehaviors(t){}constructor(t,n=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=ni.Drawing,this.mode="base",n||this.updateOptions(t)}updateOptions(t){t!=null&&t.styles&&(this.styles=ii({},this._styles,t.styles)),t!=null&&t.pointerDistance&&(this.pointerDistance=t.pointerDistance),t!=null&&t.validation&&(this.validate=t&&t.validation),t!=null&&t.projection&&(this.projection=t.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(t){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=t.store,this.store.registerOnChange(t.onChange),this.setDoubleClickToZoom=t.setDoubleClickToZoom,this.project=t.project,this.unproject=t.unproject,this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.setCursor=t.setCursor,this.onStyleChange=t.onChange,this.onFinish=t.onFinish,this.coordinatePrecision=t.coordinatePrecision,this.registerBehaviors({mode:t.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:t.coordinatePrecision,projection:this.projection})}validateFeature(t){return this.performFeatureValidation(t)}afterFeatureAdded(t){}performFeatureValidation(t){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=function(r,s){let a;if(Cr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(Cr(r.geometry))if(Cr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}}(t,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(t,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:Jr.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(t,n){const r=this.performFeatureValidation(t);return r.valid?t.properties.mode!==this.mode?{valid:!1,reason:Ac}:n(t):{valid:!1,reason:r.reason}}onFinish(t,n){}onDeselect(t){}onSelect(t){}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){}onClick(t){}onDragStart(t,n){}onDrag(t,n){}onDragEnd(t,n){}getHexColorStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getNumericStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getStylingValue(t,n,r){return t===void 0?n:typeof t=="function"?t(r):t}};function Hs(i,t=9){const n=Math.pow(10,t);return Math.round(i*n)/n}function vo(i,t){return Gs(i[0])<=t&&Gs(i[1])<=t}function yo(i){return i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"&&i[0]!==1/0&&i[1]!==1/0&&(n=i[0])>=-180&&n<=180&&(t=i[1])>=-90&&t<=90;var t,n}function Gs(i){let t=1,n=0;for(;Math.round(i*t)/t!==i;)t*=10,n++;return n}const Dc="Feature has holes",Bc="Feature has less than 4 coordinates",zc="Feature has invalid coordinates",Oc="Feature coordinates are not closed";function Ic(i,t){if(i.geometry.type!=="Polygon")return{valid:!1,reason:"Feature is not a Polygon"};if(i.geometry.coordinates.length!==1)return{valid:!1,reason:Dc};if(i.geometry.coordinates[0].length<4)return{valid:!1,reason:Bc};for(let s=0;s<i.geometry.coordinates[0].length;s++){if(!yo(i.geometry.coordinates[0][s]))return{valid:!1,reason:zc};if(!vo(i.geometry.coordinates[0][s],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return(n=i.geometry.coordinates[0][0])[0]!==(r=i.geometry.coordinates[0][i.geometry.coordinates[0].length-1])[0]||n[1]!==r[1]?{valid:!1,reason:Oc}:{valid:!0};var n,r}const wh=(i,t)=>{const{x:n,y:r}=i,{x:s,y:a}=t,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};function Fc({unproject:i,point:t,pointerDistance:n}){const r=n/2,{x:s,y:a}=t;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[i(s-r,a-r),i(s+r,a-r),i(s+r,a+r),i(s-r,a+r),i(s-r,a-r)].map(l=>[l.lng,l.lat])]}}}function Nc(i,t){if(i.geometry.type!=="LineString")return{valid:!1,reason:"Feature is not a LineString"};if(i.geometry.coordinates.length<2)return{valid:!1,reason:"Feature has less than 2 coordinates"};for(let n=0;n<i.geometry.coordinates.length;n++){if(!yo(i.geometry.coordinates[n]))return{valid:!1,reason:"Feature has invalid coordinates"};if(!vo(i.geometry.coordinates[n],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return{valid:!0}}const Rc="Feature is not a Point",Zc="Feature has invalid coordinates",Yc="Feature has coordinates with excessive precision";function Xc(i,t){return i.geometry.type!=="Point"?{valid:!1,reason:Rc}:yo(i.geometry.coordinates)?vo(i.geometry.coordinates,t)?{valid:!0}:{valid:!1,reason:Yc}:{valid:!1,reason:Zc}}class $c extends yh{constructor(t){if(!t.modeName)throw new Error("Mode name is required for TerraDrawRenderMode");super(t,!0),this.type=ni.Render,this.mode="render",this.updateOptions(t)}updateOptions(t){super.updateOptions(t),t!=null&&t.modeName&&(this.mode=t.modeName)}registerBehaviors(t){this.mode=t.mode}start(){this.setStarted()}stop(){this.setStopped()}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(t){return{pointColor:this.getHexColorStylingValue(this.styles.pointColor,"#3f97e0",t),pointWidth:this.getNumericStylingValue(this.styles.pointWidth,6,t),pointOutlineColor:this.getHexColorStylingValue(this.styles.pointOutlineColor,"#ffffff",t),pointOutlineWidth:this.getNumericStylingValue(this.styles.pointOutlineWidth,0,t),polygonFillColor:this.getHexColorStylingValue(this.styles.polygonFillColor,"#3f97e0",t),polygonFillOpacity:this.getNumericStylingValue(this.styles.polygonFillOpacity,.3,t),polygonOutlineColor:this.getHexColorStylingValue(this.styles.polygonOutlineColor,"#3f97e0",t),polygonOutlineWidth:this.getNumericStylingValue(this.styles.polygonOutlineWidth,4,t),lineStringWidth:this.getNumericStylingValue(this.styles.lineStringWidth,4,t),lineStringColor:this.getHexColorStylingValue(this.styles.lineStringColor,"#3f97e0",t),zIndex:this.getNumericStylingValue(this.styles.zIndex,0,t)}}validateFeature(t){const n=super.validateFeature(t);if(n.valid){const r=t,s=Xc(r,this.coordinatePrecision).valid||Ic(r,this.coordinatePrecision).valid||Nc(r,this.coordinatePrecision).valid;return s?{valid:!0}:{valid:s,reason:"Feature is not a valid Point, Polygon or LineString feature"}}return n}}function Uc(i,t){let n=!1;for(let l=0,u=t.length;l<u;l++){const c=t[l];for(let d=0,p=c.length,_=p-1;d<p;_=d++)(s=c[d])[1]>(r=i)[1]!=(a=c[_])[1]>r[1]&&r[0]<(a[0]-s[0])*(r[1]-s[1])/(a[1]-s[1])+s[0]&&(n=!n)}var r,s,a;return n}const jc=(i,t,n)=>{const r=a=>a*a,s=(a,l)=>r(a.x-l.x)+r(a.y-l.y);return Math.sqrt(((a,l,u)=>{const c=s(l,u);if(c===0)return s(a,l);let d=((a.x-l.x)*(u.x-l.x)+(a.y-l.y)*(u.y-l.y))/c;return d=Math.max(0,Math.min(1,d)),s(a,{x:l.x+d*(u.x-l.x),y:l.y+d*(u.y-l.y)})})(i,t,n))};class Wc extends yh{constructor(...t){super(...t),this.type=ni.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return ii({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0})}}function xh(i,t,n,r,s){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,p=Math.log(c),_=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*_*(c-_)/c)*(d-c/2<0?-1:1);xh(i,t,Math.max(n,Math.floor(t-d*_/c+v)),Math.min(r,Math.floor(t+(c-d)*_/c+v)),s)}const a=i[t];let l=n,u=r;for(bi(i,n,t),s(i[r],a)>0&&bi(i,n,r);l<u;){for(bi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?bi(i,n,u):(u++,bi(i,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}function bi(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}function Ze(i,t){Ai(i,0,i.children.length,t,i)}function Ai(i,t,n,r,s){s||(s=Ve([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<n;a++){const l=i.children[a];Di(s,i.leaf?r(l):l)}return s}function Di(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Vc(i,t){return i.minX-t.minX}function Hc(i,t){return i.minY-t.minY}function Tr(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function bn(i){return i.maxX-i.minX+(i.maxY-i.minY)}function Gc(i,t){const n=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function Ar(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Mn(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function Ve(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function qs(i,t,n,r,s){const a=[t,n];for(;a.length;){if((n=a.pop())-(t=a.pop())<=r)continue;const l=t+Math.ceil((n-t)/r/2)*r;xh(i,l,t,n,s),a.push(t,l,l,n)}}let qc=class{constructor(t){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(t){let n=this.data;const r=[];if(!Mn(t,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],c=n.leaf?s(u):u;Mn(t,c)&&(n.leaf?r.push(u):Ar(t,c)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(t){let n=this.data;if(Mn(t,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(Mn(t,l)){if(n.leaf||Ar(t,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(t){if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(t){this._insert(t,this.data.height-1)}clear(){this.data=Ve([])}remove(t){let n=this.data;const r=this.toBBox(t),s=[],a=[];let l,u,c=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),c=!0),n.leaf){const d=n.children.indexOf(t);d!==-1&&(n.children.splice(d,1),s.push(n),this._condense(s))}c||n.leaf||!Ar(n,r)?u?(l++,n=u.children[l],c=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=Ve(t.slice(n,r+1)),Ze(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=Ve([]),l.leaf=!1,l.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));qs(t,n,r,d,this.compareMinX);for(let p=n;p<=r;p+=d){const _=Math.min(p+d-1,r);qs(t,p,_,c,this.compareMinY);for(let v=p;v<=_;v+=c){const x=Math.min(v+c-1,_);l.children.push(this._build(t,v,x,s-1))}}return Ze(l,this.toBBox),l}_chooseSubtree(t,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,c=1/0,d=1/0;for(let p=0;p<n.children.length;p++){const _=n.children[p],v=Tr(_),x=(a=t,l=_,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-v);x<d?(d=x,c=v<c?v:c,u=_):x===d&&v<c&&(c=v,u=_)}n=u||n.children[0]}var a,l;return n}_insert(t,n,r){const s=r?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(t),Di(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(t,n){const r=t[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=Ve(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,Ze(r,this.toBBox),Ze(u,this.toBBox),n?t[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(t,n){this.data=Ve([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Ze(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const c=Ai(t,0,u,this.toBBox),d=Ai(t,u,r,this.toBBox),p=Gc(c,d),_=Tr(c)+Tr(d);p<a?(a=p,s=u,l=_<l?_:l):p===a&&_<l&&(l=_,s=u)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:Vc,a=t.leaf?this.compareMinY:Hc;this._allDistMargin(t,n,r,s)<this._allDistMargin(t,n,r,a)&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const a=this.toBBox,l=Ai(t,0,n,a),u=Ai(t,r-n,r,a);let c=bn(l)+bn(u);for(let d=n;d<r-n;d++){const p=t.children[d];Di(l,t.leaf?a(p):p),c+=bn(l)}for(let d=r-n-1;d>=n;d--){const p=t.children[d];Di(u,t.leaf?a(p):p),c+=bn(u)}return c}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Di(n[s],t)}_condense(t){for(let n,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(n=t[r-1].children,n.splice(n.indexOf(t[r]),1)):this.clear():Ze(t[r],this.toBBox)}},Jc=class{constructor(t){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new qc(t&&t.maxEntries?t.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(t,n){this.idToNode.set(t.id,n),this.nodeToId.set(n,t.id)}toBBox(t){const n=[],r=[];let s;if(t.geometry.type==="Polygon")s=t.geometry.coordinates[0];else if(t.geometry.type==="LineString")s=t.geometry.coordinates;else{if(t.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[t.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(t){if(this.idToNode.get(String(t.id)))throw new Error("Feature already exists");const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}load(t){const n=[],r=new Set;t.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(t){this.remove(t.id);const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}remove(t){const n=this.idToNode.get(t);if(!n)throw new Error(`${t} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(t){return this.tree.search(this.toBBox(t)).map(n=>this.nodeToId.get(n))}collides(t){return this.tree.collides(this.toBBox(t))}};const Kc={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=16*Math.random()|0;return(i=="x"?t:3&t|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36};let Qc=class{constructor(t){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new Jc,this.tracked=!t||t.tracked!==!1,this.idStrategy=t&&t.idStrategy?t.idStrategy:Kc}clone(t){return JSON.parse(JSON.stringify(t))}getId(){return this.idStrategy.getId()}has(t){return!!this.store[t]}load(t,n,r){if(t.length===0)return[];let s=this.clone(t);const a=[],l=[];return s=s.filter(u=>{u.id==null&&(u.id=this.idStrategy.getId());const c=u.id;if(n){const d=n(u);if(!d.valid)return l.push({id:c,valid:!1,reason:d.reason}),!1}if(this.tracked){if(u.properties.createdAt){if(!Vs(u.properties.createdAt))return l.push({id:u.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else u.properties.createdAt=+new Date;if(u.properties.updatedAt){if(!Vs(u.properties.updatedAt))return l.push({id:u.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else u.properties.updatedAt=+new Date}return this.has(c)?(l.push({id:c,valid:!1,reason:`Feature already exists with this id: ${c}`}),!1):(this.store[c]=u,a.push(c),r&&r(u),l.push({id:c,valid:!0}),!0)}),this.spatialIndex.load(s),this._onChange(a,"create"),l}search(t,n){const r=this.spatialIndex.search(t).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(t){this._onChange=(n,r)=>{t(n,r)}}getGeometryCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get properties copy`);return this.clone(n.properties)}updateProperty(t){const n=[];t.forEach(({id:r,property:s,value:a})=>{const l=this.store[r];if(!l)throw new Error(`No feature with this (${r}), can not update geometry`);n.push(r),l.properties[s]=a,this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}updateGeometry(t){const n=[];t.forEach(({id:r,geometry:s})=>{n.push(r);const a=this.store[r];if(!a)throw new Error(`No feature with this (${r}), can not update geometry`);a.geometry=this.clone(s),this.spatialIndex.update(a),this.tracked&&(a.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}create(t){const n=[];return t.forEach(({geometry:r,properties:s})=>{let a,l=ii({},s);this.tracked&&(a=+new Date,s?(l.createdAt=typeof s.createdAt=="number"?s.createdAt:a,l.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:a):l={createdAt:a,updatedAt:a});const u=this.getId(),c={id:u,type:"Feature",geometry:r,properties:l};this.store[u]=c,this.spatialIndex.insert(c),n.push(u)}),this._onChange&&this._onChange([...n],"create"),n}delete(t){t.forEach(n=>{if(!this.store[n])throw new Error(`No feature with id ${n}, can not delete`);delete this.store[n],this.spatialIndex.remove(n)}),this._onChange&&this._onChange([...t],"delete")}copy(t){return this.clone(this.store[t])}copyAll(){return this.clone(Object.keys(this.store).map(t=>this.store[t]))}copyAllWhere(t){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&t(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}},Ye=class{constructor({name:t,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=t,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}};var tf={__proto__:null,TerraDrawBaseAdapter:class{constructor(i){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const t=this.getMapEventElement(),{left:n,top:r}=t.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i){const t=this.getLngLatFromEvent(i);if(!t)return null;const{lng:n,lat:r}=t,{containerX:s,containerY:a}=this.getMapElementXYPosition(i),l=this.getButton(i),u=Array.from(this._heldKeys);return{lng:Hs(n,this._coordinatePrecision),lat:Hs(r,this._coordinatePrecision),containerX:s,containerY:a,button:l,heldKeys:u}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(t=>{t.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new Ye({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t)},register:i=>{this.getMapEventElement().addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerdown",i)}}),new Ye({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const t=this.getDrawEventFromEvent(i);if(t)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:t.containerX,y:t.containerY},s=this._currentModeCallbacks.getState(),a=wh(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(t,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement().addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointermove",i)}}),new Ye({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&i.preventDefault()},register:i=>{this.getMapEventElement().addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement().removeEventListener("contextmenu",i)}}),new Ye({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement()||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(t,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(t),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement().addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerup",i)}}),new Ye({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keyup",i)}}),new Ye({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear()}}};class ef{constructor(t){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=t.adapter,this._mode=new Wc;const n=new Set,r=t.modes.reduce((p,_)=>{if(n.has(_.mode))throw new Error(`There is already a ${_.mode} mode provided`);return n.add(_.mode),p[_.mode]=_,p},{}),s=Object.keys(r);if(s.length===0)throw new Error("No modes provided");s.forEach(p=>{if(r[p].type===ni.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=p}}),this._modes=ii({},r,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new Qc({tracked:!!t.tracked,idStrategy:t.idStrategy?t.idStrategy:void 0});const a=p=>{const _=[],v=this._store.copyAll().filter(x=>!p.includes(x.id)||(_.push(x),!1));return{changed:_,unchanged:v}},l=(p,_)=>{this._enabled&&this._eventListeners.finish.forEach(v=>{v(p,_)})},u=(p,_)=>{if(!this._enabled)return;this._eventListeners.change.forEach(P=>{P(p,_)});const{changed:v,unchanged:x}=a(p);_==="create"?this._adapter.render({created:v,deletedIds:[],unchanged:x,updated:[]},this.getModeStyles()):_==="update"?this._adapter.render({created:[],deletedIds:[],unchanged:x,updated:v},this.getModeStyles()):_==="delete"?this._adapter.render({created:[],deletedIds:p,unchanged:x,updated:[]},this.getModeStyles()):_==="styling"&&this._adapter.render({created:[],deletedIds:[],unchanged:x,updated:[]},this.getModeStyles())},c=p=>{if(!this._enabled)return;this._eventListeners.select.forEach(x=>{x(p)});const{changed:_,unchanged:v}=a([p]);this._adapter.render({created:[],deletedIds:[],unchanged:v,updated:_},this.getModeStyles())},d=p=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(x=>{x()});const{changed:_,unchanged:v}=a([p]);_&&this._adapter.render({created:[],deletedIds:[],unchanged:v,updated:_},this.getModeStyles())};Object.keys(this._modes).forEach(p=>{this._modes[p].register({mode:p,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:u,onSelect:c,onDeselect:d,onFinish:l,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const t={};return Object.keys(this._modes).forEach(n=>{t[n]=r=>this._instanceSelectMode&&r.properties[xn.SELECTED]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(r):this._modes[n].styleFeature.bind(this._modes[n])(r)}),t}featuresAtLocation({lng:t,lat:n},r){const s=r&&r.pointerDistance!==void 0?r.pointerDistance:30,a=!r||r.ignoreSelectFeatures===void 0||r.ignoreSelectFeatures,l=this._adapter.unproject.bind(this._adapter),u=this._adapter.project.bind(this._adapter),c=u(t,n),d=Fc({unproject:l,point:c,pointerDistance:s});return this._store.search(d).filter(p=>{if(a&&(p.properties[xn.MID_POINT]||p.properties[xn.SELECTION_POINT]))return!1;if(p.geometry.type==="Point"){const _=p.geometry.coordinates,v=u(_[0],_[1]);return wh(c,v)<s}if(p.geometry.type==="LineString"){const _=p.geometry.coordinates;for(let v=0;v<_.length-1;v++){const x=_[v],P=_[v+1];if(jc(c,u(x[0],x[1]),u(P[0],P[1]))<s)return!0}return!1}return!!Uc([t,n],p.geometry.coordinates)||void 0})}getSelectMode(){if(this.checkEnabled(),!this._instanceSelectMode)throw new Error("No select mode defined in instance");return this.getMode()!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}setModeStyles(t,n){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._modes[t].styles=n}updateModeOptions(t,n){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._modes[t].updateOptions(n)}getSnapshot(){return this._store.copyAll()}getSnapshotFeature(t){if(this._store.has(t))return this._store.copy(t)}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(t){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}setMode(t){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[t],this._mode.start()}removeFeatures(t){this.checkEnabled();const n=[];t.forEach(r=>{if(!this._store.has(r))throw new Error(`No feature with id ${r}, can not delete`);const s=this._store.copy(r);s.properties[xn.SELECTED]&&this.deselectFeature(r),s.properties[js]&&n.push(...s.properties[js])}),this._store.delete([...t,...n])}selectFeature(t){this.getSelectMode().selectFeature(t)}deselectFeature(t){this.getSelectMode().deselectFeature(t)}getFeatureId(){return this._store.getId()}hasFeature(t){return this._store.has(t)}addFeatures(t){return this.checkEnabled(),t.length===0?[]:this._store.load(t,n=>{if(Ws(n)){const r=n.properties.mode,s=this._modes[r];if(!s)return{id:n.id,valid:!1,reason:`${r} mode is not in the list of instantiated modes`};const a=s.validateFeature.bind(s)(n);return{id:n.id,valid:a.valid,reason:a.reason?a.reason:a.valid?void 0:"Feature is invalid"}}return{id:n.id,valid:!1,reason:"Mode property does not exist"}},n=>{if(Ws(n)){const r=this._modes[n.properties.mode];r&&r.afterFeatureAdded&&r.afterFeatureAdded(n)}})}start(){this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(t=>{t()})},getState:()=>this._mode.state,onClick:t=>{this._mode.onClick(t)},onMouseMove:t=>{this._mode.onMouseMove(t)},onKeyDown:t=>{this._mode.onKeyDown(t)},onKeyUp:t=>{this._mode.onKeyUp(t)},onDragStart:(t,n)=>{this._mode.onDragStart(t,n)},onDrag:(t,n)=>{this._mode.onDrag(t,n)},onDragEnd:(t,n)=>{this._mode.onDragEnd(t,n)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}})}getFeaturesAtLngLat(t,n){const{lng:r,lat:s}=t;return this.featuresAtLocation({lng:r,lat:s},n)}getFeaturesAtPointerEvent(t,n){const r=this._adapter.getLngLatFromEvent.bind(this._adapter)(t);return r===null?[]:this.featuresAtLocation(r,n)}stop(){this._enabled=!1,this._adapter.unregister()}on(t,n){const r=this._eventListeners[t];r.includes(n)||r.push(n)}off(t,n){const r=this._eventListeners[t];r.includes(n)&&r.splice(r.indexOf(n),1)}}let nf=class extends tf.TerraDrawBaseAdapter{constructor(t){super(t),this._lib=void 0,this._map=void 0,this._panes={},this._container=void 0,this._layers={},this._lib=t.lib,this._map=t.map,this._container=this._map.getContainer()}createPaneStyleSheet(t,n){const r=document.createElement("style");return r.innerHTML=`.leaflet-${t}-pane {z-index: ${n+600}`,document.getElementsByTagName("head")[0].appendChild(r),this._map.createPane(t),r}clearPanes(){Object.values(this._panes).forEach(t=>{t&&t.remove()}),this._panes={}}clearLayers(){Object.values(this._layers).forEach(t=>{this._map.removeLayer(t)}),this._layers={}}styleGeoJSONLayer(t){return{pointToLayer:(n,r)=>{if(!n.properties)throw new Error("Feature has no properties");if(typeof n.properties.mode!="string")throw new Error("Feature mode is not a string");const s=(0,t[n.properties.mode])(n),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),this._lib.circleMarker(r,{radius:s.pointWidth,stroke:s.pointOutlineWidth||!1,color:s.pointOutlineColor,weight:s.pointOutlineWidth,fillOpacity:.8,fillColor:s.pointColor,pane:a,interactive:!1})},style:n=>{if(!n||!n.properties)return{};const r=n,s=(0,t[r.properties.mode])(r),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),r.geometry.type==="LineString"?{interactive:!1,color:s.lineStringColor,weight:s.lineStringWidth,pane:a}:r.geometry.type==="Polygon"?{interactive:!1,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,weight:s.polygonOutlineWidth,stroke:!0,color:s.polygonOutlineColor,pane:a}:{}}}}getLngLatFromEvent(t){const{containerX:n,containerY:r}=this.getMapElementXYPosition(t),s=this._map.containerPointToLatLng({x:n,y:r});return s.lng===null||isNaN(s.lng)||s.lat===null||isNaN(s.lat)?null:{lng:s.lng,lat:s.lat}}getMapEventElement(){return this._container}setDraggability(t){t?this._map.dragging.enable():this._map.dragging.disable()}project(t,n){const{x:r,y:s}=this._map.latLngToContainerPoint({lng:t,lat:n});return{x:r,y:s}}unproject(t,n){const{lng:r,lat:s}=this._map.containerPointToLatLng({x:t,y:n});return{lng:r,lat:s}}setCursor(t){t==="unset"?this.getMapEventElement().style.removeProperty("cursor"):this.getMapEventElement().style.cursor=t}setDoubleClickToZoom(t){t?this._map.doubleClickZoom.enable():this._map.doubleClickZoom.disable()}render(t,n){if(t.created.forEach(r=>{r.id&&(this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),t.deletedIds.forEach(r=>{this._layers[r]&&(this._map.removeLayer(this._layers[r]),delete this._layers[r])}),t.updated.forEach(r=>{r.id&&(this._layers[r.id]&&this._map.removeLayer(this._layers[r.id]),this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),t.created.length===0&&t.updated.length===0&&t.deletedIds.length===0){const r=[];Object.keys(this._layers).forEach(s=>{r.push(()=>{const a=this._layers[s],l=a.toGeoJSON();this._map.removeLayer(a);const u=this._lib.geoJSON(l,this.styleGeoJSONLayer(n));this._layers[s]=u,u.addTo(this._map),this._map.addLayer(this._layers[s])})}),setTimeout(()=>{r.forEach(s=>s())})}}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers(),this.clearPanes())}register(t){var n;super.register(t),(n=this._currentModeCallbacks)!=null&&n.onReady&&this._currentModeCallbacks.onReady()}getCoordinatePrecision(){return super.getCoordinatePrecision()}unregister(){return super.unregister()}};function jn(){return jn=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},jn.apply(null,arguments)}var Kr;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(Kr||(Kr={}));const rf={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT:"selectionPoint"};function Dr(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function Js(i){return!!function(t){return typeof t=="number"&&!isNaN(new Date(t).valueOf())}(i)}const of="Feature mode property does not match the mode being added to";var Wn;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(Wn||(Wn={}));let bh=class{get state(){return this._state}set state(t){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(t){if(typeof t!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=t}registerBehaviors(t){}constructor(t,n=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=Wn.Drawing,this.mode="base",n||this.updateOptions(t)}updateOptions(t){t!=null&&t.styles&&(this.styles=jn({},this._styles,t.styles)),t!=null&&t.pointerDistance&&(this.pointerDistance=t.pointerDistance),t!=null&&t.validation&&(this.validate=t&&t.validation),t!=null&&t.projection&&(this.projection=t.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(t){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=t.store,this.store.registerOnChange(t.onChange),this.setDoubleClickToZoom=t.setDoubleClickToZoom,this.project=t.project,this.unproject=t.unproject,this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.setCursor=t.setCursor,this.onStyleChange=t.onChange,this.onFinish=t.onFinish,this.coordinatePrecision=t.coordinatePrecision,this.registerBehaviors({mode:t.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:t.coordinatePrecision,projection:this.projection})}validateFeature(t){return this.performFeatureValidation(t)}afterFeatureAdded(t){}performFeatureValidation(t){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=function(r,s){let a;if(Dr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(Dr(r.geometry))if(Dr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}}(t,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(t,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:Kr.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(t,n){const r=this.performFeatureValidation(t);return r.valid?t.properties.mode!==this.mode?{valid:!1,reason:of}:n(t):{valid:!1,reason:r.reason}}onFinish(t,n){}onDeselect(t){}onSelect(t){}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){}onClick(t){}onDragStart(t,n){}onDrag(t,n){}onDragEnd(t,n){}getHexColorStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getNumericStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getStylingValue(t,n,r){return t===void 0?n:typeof t=="function"?t(r):t}},sf=class extends bh{constructor(...t){super(...t),this.type=Wn.Select}};function Ks(i,t=9){const n=Math.pow(10,t);return Math.round(i*n)/n}const af=(i,t)=>{const{x:n,y:r}=i,{x:s,y:a}=t,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};function Mh(i,t,n,r,s){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,p=Math.log(c),_=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*_*(c-_)/c)*(d-c/2<0?-1:1);Mh(i,t,Math.max(n,Math.floor(t-d*_/c+v)),Math.min(r,Math.floor(t+(c-d)*_/c+v)),s)}const a=i[t];let l=n,u=r;for(Mi(i,n,t),s(i[r],a)>0&&Mi(i,n,r);l<u;){for(Mi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?Mi(i,n,u):(u++,Mi(i,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}function Mi(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}function Xe(i,t){Bi(i,0,i.children.length,t,i)}function Bi(i,t,n,r,s){s||(s=He([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<n;a++){const l=i.children[a];zi(s,i.leaf?r(l):l)}return s}function zi(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function hf(i,t){return i.minX-t.minX}function lf(i,t){return i.minY-t.minY}function Br(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Pn(i){return i.maxX-i.minX+(i.maxY-i.minY)}function uf(i,t){const n=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function zr(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Ln(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function He(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Qs(i,t,n,r,s){const a=[t,n];for(;a.length;){if((n=a.pop())-(t=a.pop())<=r)continue;const l=t+Math.ceil((n-t)/r/2)*r;Mh(i,l,t,n,s),a.push(t,l,l,n)}}class cf{constructor(t){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(t){let n=this.data;const r=[];if(!Ln(t,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],c=n.leaf?s(u):u;Ln(t,c)&&(n.leaf?r.push(u):zr(t,c)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(t){let n=this.data;if(Ln(t,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(Ln(t,l)){if(n.leaf||zr(t,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(t){if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(t){this._insert(t,this.data.height-1)}clear(){this.data=He([])}remove(t){let n=this.data;const r=this.toBBox(t),s=[],a=[];let l,u,c=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),c=!0),n.leaf){const d=n.children.indexOf(t);d!==-1&&(n.children.splice(d,1),s.push(n),this._condense(s))}c||n.leaf||!zr(n,r)?u?(l++,n=u.children[l],c=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=He(t.slice(n,r+1)),Xe(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=He([]),l.leaf=!1,l.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));Qs(t,n,r,d,this.compareMinX);for(let p=n;p<=r;p+=d){const _=Math.min(p+d-1,r);Qs(t,p,_,c,this.compareMinY);for(let v=p;v<=_;v+=c){const x=Math.min(v+c-1,_);l.children.push(this._build(t,v,x,s-1))}}return Xe(l,this.toBBox),l}_chooseSubtree(t,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,c=1/0,d=1/0;for(let p=0;p<n.children.length;p++){const _=n.children[p],v=Br(_),x=(a=t,l=_,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-v);x<d?(d=x,c=v<c?v:c,u=_):x===d&&v<c&&(c=v,u=_)}n=u||n.children[0]}var a,l;return n}_insert(t,n,r){const s=r?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(t),zi(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(t,n){const r=t[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=He(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,Xe(r,this.toBBox),Xe(u,this.toBBox),n?t[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(t,n){this.data=He([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Xe(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const c=Bi(t,0,u,this.toBBox),d=Bi(t,u,r,this.toBBox),p=uf(c,d),_=Br(c)+Br(d);p<a?(a=p,s=u,l=_<l?_:l):p===a&&_<l&&(l=_,s=u)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:hf,a=t.leaf?this.compareMinY:lf;this._allDistMargin(t,n,r,s)<this._allDistMargin(t,n,r,a)&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const a=this.toBBox,l=Bi(t,0,n,a),u=Bi(t,r-n,r,a);let c=Pn(l)+Pn(u);for(let d=n;d<r-n;d++){const p=t.children[d];zi(l,t.leaf?a(p):p),c+=Pn(l)}for(let d=r-n-1;d>=n;d--){const p=t.children[d];zi(u,t.leaf?a(p):p),c+=Pn(u)}return c}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)zi(n[s],t)}_condense(t){for(let n,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(n=t[r-1].children,n.splice(n.indexOf(t[r]),1)):this.clear():Xe(t[r],this.toBBox)}}class ff{constructor(t){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new cf(t&&t.maxEntries?t.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(t,n){this.idToNode.set(t.id,n),this.nodeToId.set(n,t.id)}toBBox(t){const n=[],r=[];let s;if(t.geometry.type==="Polygon")s=t.geometry.coordinates[0];else if(t.geometry.type==="LineString")s=t.geometry.coordinates;else{if(t.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[t.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(t){if(this.idToNode.get(String(t.id)))throw new Error("Feature already exists");const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}load(t){const n=[],r=new Set;t.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(t){this.remove(t.id);const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}remove(t){const n=this.idToNode.get(t);if(!n)throw new Error(`${t} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(t){return this.tree.search(this.toBBox(t)).map(n=>this.nodeToId.get(n))}collides(t){return this.tree.collides(this.toBBox(t))}}const df={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=16*Math.random()|0;return(i=="x"?t:3&t|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36};class pf{constructor(t){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new ff,this.tracked=!t||t.tracked!==!1,this.idStrategy=t&&t.idStrategy?t.idStrategy:df}clone(t){return JSON.parse(JSON.stringify(t))}getId(){return this.idStrategy.getId()}has(t){return!!this.store[t]}load(t,n,r){if(t.length===0)return[];let s=this.clone(t);const a=[],l=[];return s=s.filter(u=>{u.id==null&&(u.id=this.idStrategy.getId());const c=u.id;if(n){const d=n(u);if(!d.valid)return l.push({id:c,valid:!1,reason:d.reason}),!1}if(this.tracked){if(u.properties.createdAt){if(!Js(u.properties.createdAt))return l.push({id:u.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else u.properties.createdAt=+new Date;if(u.properties.updatedAt){if(!Js(u.properties.updatedAt))return l.push({id:u.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else u.properties.updatedAt=+new Date}return this.has(c)?(l.push({id:c,valid:!1,reason:`Feature already exists with this id: ${c}`}),!1):(this.store[c]=u,a.push(c),r&&r(u),l.push({id:c,valid:!0}),!0)}),this.spatialIndex.load(s),this._onChange(a,"create"),l}search(t,n){const r=this.spatialIndex.search(t).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(t){this._onChange=(n,r)=>{t(n,r)}}getGeometryCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get properties copy`);return this.clone(n.properties)}updateProperty(t){const n=[];t.forEach(({id:r,property:s,value:a})=>{const l=this.store[r];if(!l)throw new Error(`No feature with this (${r}), can not update geometry`);n.push(r),l.properties[s]=a,this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}updateGeometry(t){const n=[];t.forEach(({id:r,geometry:s})=>{n.push(r);const a=this.store[r];if(!a)throw new Error(`No feature with this (${r}), can not update geometry`);a.geometry=this.clone(s),this.spatialIndex.update(a),this.tracked&&(a.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}create(t){const n=[];return t.forEach(({geometry:r,properties:s})=>{let a,l=jn({},s);this.tracked&&(a=+new Date,s?(l.createdAt=typeof s.createdAt=="number"?s.createdAt:a,l.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:a):l={createdAt:a,updatedAt:a});const u=this.getId(),c={id:u,type:"Feature",geometry:r,properties:l};this.store[u]=c,this.spatialIndex.insert(c),n.push(u)}),this._onChange&&this._onChange([...n],"create"),n}delete(t){t.forEach(n=>{if(!this.store[n])throw new Error(`No feature with id ${n}, can not delete`);delete this.store[n],this.spatialIndex.remove(n)}),this._onChange&&this._onChange([...t],"delete")}copy(t){return this.clone(this.store[t])}copyAll(){return this.clone(Object.keys(this.store).map(t=>this.store[t]))}copyAllWhere(t){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&t(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class $e{constructor({name:t,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=t,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}}var Ph={__proto__:null,GeoJSONStore:pf,TerraDrawBaseDrawMode:bh,TerraDrawBaseSelectMode:sf,TerraDrawBaseAdapter:class{constructor(i){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const t=this.getMapEventElement(),{left:n,top:r}=t.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i){const t=this.getLngLatFromEvent(i);if(!t)return null;const{lng:n,lat:r}=t,{containerX:s,containerY:a}=this.getMapElementXYPosition(i),l=this.getButton(i),u=Array.from(this._heldKeys);return{lng:Ks(n,this._coordinatePrecision),lat:Ks(r,this._coordinatePrecision),containerX:s,containerY:a,button:l,heldKeys:u}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(t=>{t.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new $e({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t)},register:i=>{this.getMapEventElement().addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerdown",i)}}),new $e({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const t=this.getDrawEventFromEvent(i);if(t)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:t.containerX,y:t.containerY},s=this._currentModeCallbacks.getState(),a=af(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(t,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement().addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointermove",i)}}),new $e({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&i.preventDefault()},register:i=>{this.getMapEventElement().addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement().removeEventListener("contextmenu",i)}}),new $e({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement()||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(t,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(t),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement().addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerup",i)}}),new $e({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keyup",i)}}),new $e({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear()}},getDefaultStyling:()=>({polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0}),SELECT_PROPERTIES:rf};const mf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],_f=1,Pi=8;class gf{constructor(t,n=64,r=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=t,this.nodeSize=Math.min(Math.max(n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=mf.indexOf(this.ArrayType),l=t*2*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,Pi,t),this.coords=new this.ArrayType(this.data,Pi+u+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Pi+l+u+c),this.ids=new this.IndexArrayType(this.data,Pi,t),this.coords=new this.ArrayType(this.data,Pi+u+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(_f<<4)+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Qr(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function Qr(i,t,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;Lh(i,t,l,r,s,a),Qr(i,t,n,r,l-1,1-a),Qr(i,t,n,l+1,s,1-a)}function Lh(i,t,n,r,s,a){for(;s>r;){if(s-r>600){const d=s-r+1,p=n-r+1,_=Math.log(d),v=.5*Math.exp(2*_/3),x=.5*Math.sqrt(_*v*(d-v)/d)*(p-d/2<0?-1:1),P=Math.max(r,Math.floor(n-p*v/d+x)),S=Math.min(s,Math.floor(n+(d-p)*v/d+x));Lh(i,t,n,P,S,a)}const l=t[2*n+a];let u=r,c=s;for(Li(i,t,r,n),t[2*s+a]>l&&Li(i,t,r,s);u<c;){for(Li(i,t,u,c),u++,c--;t[2*u+a]<l;)u++;for(;t[2*c+a]>l;)c--}t[2*r+a]===l?Li(i,t,r,c):(c++,Li(i,t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function Li(i,t,n,r){Or(i,n,r),Or(t,2*n,2*r),Or(t,2*n+1,2*r+1)}function Or(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}let vf=class{constructor(t=[],n=(r,s)=>r<s?-1:r>s?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=(t<<1)+1;const u=l+1;if(u<this.length&&r(n[u],n[l])<0&&(l=u),r(n[l],a)>=0)break;n[t]=n[l],t=l}n[t]=a}};const yf=6371,se=Math.PI/180;function wf(i,t,n,r=1/0,s=1/0){let a=1;const l=[];r===void 0&&(r=1/0),s!==void 0&&(a=Se(s/yf));const u=new vf([],xf);let c={left:0,right:i.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const d=Math.cos(n*se);for(;c;){const p=c.right,_=c.left;if(p-_<=i.nodeSize)for(let v=_;v<=p;v++){const x=i.ids[v],P=ea(t,n,i.coords[2*v],i.coords[2*v+1],d);u.push({id:x,dist:P})}else{const v=_+p>>1,x=i.coords[2*v],P=i.coords[2*v+1],S=i.ids[v],D=ea(t,n,x,P,d);u.push({id:S,dist:D});const k=(c.axis+1)%2,g={left:_,right:v-1,axis:k,minLng:c.minLng,minLat:c.minLat,maxLng:c.axis===0?x:c.maxLng,maxLat:c.axis===1?P:c.maxLat,dist:0},y={left:v+1,right:p,axis:k,minLng:c.axis===0?x:c.minLng,minLat:c.axis===1?P:c.minLat,maxLng:c.maxLng,maxLat:c.maxLat,dist:0};g.dist=ta(t,n,d,g),y.dist=ta(t,n,d,y),u.push(g),u.push(y)}for(;u.length&&u.peek().id!=null;){const v=u.pop();if(v.dist>a||(l.push(v.id),l.length===r))return l}c=u.pop()}return l}function ta(i,t,n,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(i>=s&&i<=a)return t<l?Se((t-l)*se):t>u?Se((t-u)*se):0;const c=Math.min(Se((i-s)*se),Se((i-a)*se)),d=bf(t,c);return d>l&&d<u?On(c,n,t,d):Math.min(On(c,n,t,l),On(c,n,t,u))}function xf(i,t){return i.dist-t.dist}function Se(i){const t=Math.sin(i/2);return t*t}function On(i,t,n,r){return t*Math.cos(r*se)*i+Se((n-r)*se)}function ea(i,t,n,r,s){const a=Se((i-n)*se);return On(a,s,t,r)}function bf(i,t){const n=1-2*t;return n<=0?i>0?90:-90:Math.atan(Math.tan(i*se)/n)/se}class Mf{constructor(t){this.useCache=!0,this.points=[],this.routeCache={},this.useCache=t.useCache||!0,this.network=t.network,this.routeFinder=t.routeFinder,this.initialise()}initialise(){this.network.features.forEach(t=>{t.geometry.coordinates.forEach(n=>{this.points.push(n)})}),this.indexedNetworkPoints=new gf(this.points.length),this.points.forEach(t=>{this.indexedNetworkPoints.add(t[0],t[1])}),this.indexedNetworkPoints.finish(),this.routeCache={}}getClosestNetworkCoordinate(t){const n=wf(this.indexedNetworkPoints,t[0],t[1],1),r=this.points[n[0]];return r||null}setRouteFinder(t){this.routeFinder=t}setNetwork(t){this.network=t,this.routeFinder.setNetwork(t),this.initialise()}getRoute(t,n){if(this.useCache){const l=`${t}-${n}`;if(this.routeCache[l])return this.routeCache[l]}const r={type:"Feature",geometry:{type:"Point",coordinates:t},properties:{}},s={type:"Feature",geometry:{type:"Point",coordinates:n},properties:{}},a=this.routeFinder.getRoute(r,s);if(this.useCache){const l=`${t}-${n}`;return this.routeCache[l]=a,a}return a}}const Pf={cancel:"Escape",finish:"Enter"},Lf={draw:"crosshair",close:"pointer"},{TerraDrawBaseDrawMode:Ef}=Ph;class Sf extends Ef{constructor(t){super(t,!0),this.mode="routesnap",this.currentCoordinate=0,this.keyEvents=Pf,this.cursors=Lf,this.maxPoints=1,this.currentPointIds=[],this.routeId=0,this.pixelDistance=(n,r)=>{const{x:s,y:a}=n,{x:l,y:u}=r,c=l-s,d=u-a;return Math.sqrt(d*d+c*c)},this.updateOptions(t)}updateOptions(t){super.updateOptions(t),t!=null&&t.routing&&t.routing!==this.routing&&(this.cleanUp(),this.routing=t.routing),(t==null?void 0:t.maxPoints)!==void 0&&t.maxPoints!==this.maxPoints&&t.maxPoints>0&&(this.maxPoints=t.maxPoints),t!=null&&t.cursors&&(this.cursors={...this.cursors,...t.cursors}),(t==null?void 0:t.keyEvents)===null?this.keyEvents={cancel:null,finish:null}:t!=null&&t.keyEvents&&(this.keyEvents={...this.keyEvents,...t.keyEvents})}measure(t,n){const{x:r,y:s}=this.project(n[0],n[1]);return this.pixelDistance({x:r,y:s},{x:t.containerX,y:t.containerY})}close(){this.currentId&&(this.currentCoordinate=0,this.currentId=void 0,this.currentPointIds=[],this.state==="drawing"&&this.setStarted())}registerBehaviors(t){}start(){this.setStarted(),this.setCursor(this.cursors.draw)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(t){if(this.setCursor(this.cursors.draw),this.moveLineId&&!this.store.has(this.moveLineId)&&(this.moveLineId=void 0),!this.currentId||this.currentCoordinate===0)return;if(this.currentId){const u=this.store.getGeometryCopy(this.currentId);if(this.measure(t,u.coordinates[u.coordinates.length-1])<this.pointerDistance){this.setCursor(this.cursors.close),this.moveLineId&&(this.store.delete([this.moveLineId]),this.moveLineId=void 0);return}}const n=this.store.getGeometryCopy(this.currentId),r=[t.lng,t.lat];let s=this.routing.getClosestNetworkCoordinate(r);if(!s)return;const a=n.coordinates.length-1,l=this.routing.getRoute(n.coordinates[a],s);if(l)if(this.moveLineId)this.store.updateGeometry([{id:this.moveLineId,geometry:l.geometry}]);else{const[u]=this.store.create([{geometry:l.geometry,properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.moveLineId=u}}onClick(t){if(t.button==="right")return;const n=[t.lng,t.lat];if(this.currentId&&!this.store.has(this.currentId)&&(this.currentId=void 0,this.currentCoordinate=0,this.currentPointIds=[]),this.currentId){const s=this.store.getGeometryCopy(this.currentId);if(this.measure(t,s.coordinates[s.coordinates.length-1])<this.pointerDistance){this.currentCoordinate===1&&this.store.delete(this.currentPointIds),this.close();return}}else this.routeId++;let r=this.routing.getClosestNetworkCoordinate(n);if(this.currentCoordinate===0){if(r){const[s,a]=this.store.create([{geometry:{type:"LineString",coordinates:[r]},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}},{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentId=s,this.currentPointIds.push(a),this.currentCoordinate++,this.state==="started"&&this.setDrawing()}}else if(this.currentCoordinate===1&&this.currentId&&r){const s=this.store.getGeometryCopy(this.currentId),a=this.routing.getRoute(s.coordinates[0],r);if(a){this.store.updateGeometry([{id:this.currentId,geometry:a==null?void 0:a.geometry}]);const[l]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentCoordinate=2,this.currentPointIds.push(l)}if(this.maxPoints===1){this.close();return}}else if(this.currentCoordinate>1&&this.currentId&&r&&this.currentCoordinate<=this.maxPoints){const s=this.store.getGeometryCopy(this.currentId),a=s.coordinates.length-1,l=this.routing.getRoute(s.coordinates[a],r);if(l){const u={...s,coordinates:[...s.coordinates,...l.geometry.coordinates]};this.store.updateGeometry([{id:this.currentId,geometry:u}]);const[c]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.maxPoints===this.currentCoordinate?this.close():(this.currentCoordinate++,this.currentPointIds.push(c))}}}onKeyDown(){}onKeyUp(t){t.key===this.keyEvents.cancel&&this.cleanUp(),t.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){try{this.currentId&&this.store.delete([this.currentId,...this.currentPointIds])}catch{}this.currentId=void 0,this.moveLineId=void 0,this.currentCoordinate=0,this.state==="drawing"&&this.setStarted()}styleFeature(t){const n=Ph.getDefaultStyling();return t.type==="Feature"&&t.geometry.type==="LineString"&&t.properties.mode===this.mode?(n.lineStringColor=this.getHexColorStylingValue(this.styles.lineStringColor,"#B90E0A",t),n.lineStringWidth=this.getNumericStylingValue(this.styles.lineStringWidth,4,t),n.zIndex=10,n):(t.type==="Feature"&&t.geometry.type==="Point"&&t.properties.mode===this.mode&&(n.pointColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",t),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",t),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.routePointOutlineWidth,1,t)),n)}validateFeature(t){return super.validateFeature(t)}afterFeatureAdded(t){}}function ia(){const i=[[30,60],[190,250],[260,290]],[t,n]=i[Math.floor(Math.random()*i.length)],r=Math.floor(Math.random()*(n-t+1))+t,s=60+Math.random()*20,a=50+Math.random()*10;return kf(r,s,a)}function kf(i,t,n){t/=100,n/=100;const r=l=>(l+i/30)%12,s=t*Math.min(n,1-n),a=l=>Math.round(255*(n-s*Math.max(-1,Math.min(r(l)-3,Math.min(9-r(l),1)))));return`#${[a(0),a(8),a(4)].map(l=>l.toString(16).padStart(2,"0")).join("")}`}function Cf(i,t,n){const r={};return new ef({adapter:new nf({lib:t,map:i,coordinatePrecision:9}),modes:[new $c({modeName:"networkOutline",styles:{polygonOutlineColor:"#d1cfcf",polygonFillColor:"#eeeeee",polygonFillOpacity:.19,polygonOutlineWidth:2}}),new Sf({routing:n,maxPoints:5,styles:{lineStringColor:a=>{const l=a.properties.routeId;return l||(r[l]=ia()),r[l]},routePointColor:a=>{const l=a.properties.routeId;return r[l]||(r[l]=ia()),r[l]}}})]})}var Tf=Object.create,Kn=Object.defineProperty,Af=Object.getOwnPropertyDescriptor,Df=Object.getOwnPropertyNames,na=Object.getOwnPropertySymbols,Bf=Object.getPrototypeOf,Eh=Object.prototype.hasOwnProperty,zf=Object.prototype.propertyIsEnumerable,ra=(i,t,n)=>t in i?Kn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,Of=(i,t)=>{for(var n in t||(t={}))Eh.call(t,n)&&ra(i,n,t[n]);if(na)for(var n of na(t))zf.call(t,n)&&ra(i,n,t[n]);return i},If=i=>Kn(i,"__esModule",{value:!0}),Qt=(i,t)=>function(){return t||(0,i[Object.keys(i)[0]])((t={exports:{}}).exports,t),t.exports},Ff=(i,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Df(t))!Eh.call(i,r)&&r!=="default"&&Kn(i,r,{get:()=>t[r],enumerable:!(n=Af(t,r))||n.enumerable});return i},Xt=i=>Ff(If(Kn(i!=null?Tf(Bf(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),ri=(i,t,n)=>new Promise((r,s)=>{var a=c=>{try{u(n.next(c))}catch(d){s(d)}},l=c=>{try{u(n.throw(c))}catch(d){s(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((n=n.apply(i,t)).next())}),pe=Qt({"node_modules/@mapbox/point-geometry/index.js"(i,t){t.exports=n;function n(r,s){this.x=r,this.y=s}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,a=r.y-this.y;return s*s+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=s,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),a=Math.sin(r),l=s*this.x-a*this.y,u=a*this.x+s*this.y;return this.x=l,this.y=u,this},_rotateAround:function(r,s){var a=Math.cos(r),l=Math.sin(r),u=s.x+a*(this.x-s.x)-l*(this.y-s.y),c=s.y+l*(this.x-s.x)+a*(this.y-s.y);return this.x=u,this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(r){return r instanceof n?r:Array.isArray(r)?new n(r[0],r[1]):r}}}),Sh=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(i,t){var n=pe();t.exports=r;function r(c,d,p,_,v){this.properties={},this.extent=p,this.type=0,this._pbf=c,this._geometry=-1,this._keys=_,this._values=v,c.readFields(s,this,d)}function s(c,d,p){c==1?d.id=p.readVarint():c==2?a(p,d):c==3?d.type=p.readVarint():c==4&&(d._geometry=p.pos)}function a(c,d){for(var p=c.readVarint()+c.pos;c.pos<p;){var _=d._keys[c.readVarint()],v=d._values[c.readVarint()];d.properties[_]=v}}r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,_=0,v=0,x=0,P=[],S;c.pos<d;){if(_<=0){var D=c.readVarint();p=D&7,_=D>>3}if(_--,p===1||p===2)v+=c.readSVarint(),x+=c.readSVarint(),p===1&&(S&&P.push(S),S=[]),S.push(new n(v,x));else if(p===7)S&&S.push(S[0].clone());else throw new Error("unknown command "+p)}return S&&P.push(S),P},r.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,_=0,v=0,x=0,P=1/0,S=-1/0,D=1/0,k=-1/0;c.pos<d;){if(_<=0){var g=c.readVarint();p=g&7,_=g>>3}if(_--,p===1||p===2)v+=c.readSVarint(),x+=c.readSVarint(),v<P&&(P=v),v>S&&(S=v),x<D&&(D=x),x>k&&(k=x);else if(p!==7)throw new Error("unknown command "+p)}return[P,D,S,k]},r.prototype.toGeoJSON=function(c,d,p){var _=this.extent*Math.pow(2,p),v=this.extent*c,x=this.extent*d,P=this.loadGeometry(),S=r.types[this.type],D,k;function g(E){for(var B=0;B<E.length;B++){var C=E[B],A=180-(C.y+x)*360/_;E[B]=[(C.x+v)*360/_-180,360/Math.PI*Math.atan(Math.exp(A*Math.PI/180))-90]}}switch(this.type){case 1:var y=[];for(D=0;D<P.length;D++)y[D]=P[D][0];P=y,g(P);break;case 2:for(D=0;D<P.length;D++)g(P[D]);break;case 3:for(P=l(P),D=0;D<P.length;D++)for(k=0;k<P[D].length;k++)g(P[D][k]);break}P.length===1?P=P[0]:S="Multi"+S;var M={type:"Feature",geometry:{type:S,coordinates:P},properties:this.properties};return"id"in this&&(M.id=this.id),M};function l(c){var d=c.length;if(d<=1)return[c];for(var p=[],_,v,x=0;x<d;x++){var P=u(c[x]);P!==0&&(v===void 0&&(v=P<0),v===P<0?(_&&p.push(_),_=[c[x]]):_.push(c[x]))}return _&&p.push(_),p}function u(c){for(var d=0,p=0,_=c.length,v=_-1,x,P;p<_;v=p++)x=c[p],P=c[v],d+=(P.x-x.x)*(x.y+P.y);return d}}}),kh=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(i,t){var n=Sh();t.exports=r;function r(l,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,u),this.length=this._features.length}function s(l,u,c){l===15?u.version=c.readVarint():l===1?u.name=c.readString():l===5?u.extent=c.readVarint():l===2?u._features.push(c.pos):l===3?u._keys.push(c.readString()):l===4&&u._values.push(a(c))}function a(l){for(var u=null,c=l.readVarint()+l.pos;l.pos<c;){var d=l.readVarint()>>3;u=d===1?l.readString():d===2?l.readFloat():d===3?l.readDouble():d===4?l.readVarint64():d===5?l.readVarint():d===6?l.readSVarint():d===7?l.readBoolean():null}return u}r.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var u=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,u,this.extent,this._keys,this._values)}}}),Nf=Qt({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(i,t){var n=kh();t.exports=r;function r(a,l){this.layers=a.readFields(s,{},l)}function s(a,l,u){if(a===3){var c=new n(u,u.readVarint()+u.pos);c.length&&(l[c.name]=c)}}}}),Rf=Qt({"node_modules/@mapbox/vector-tile/index.js"(i,t){t.exports.VectorTile=Nf(),t.exports.VectorTileFeature=Sh(),t.exports.VectorTileLayer=kh()}}),Zf=Qt({"node_modules/ieee754/index.js"(i){i.read=function(t,n,r,s,a){var l,u,c=a*8-s-1,d=(1<<c)-1,p=d>>1,_=-7,v=r?a-1:0,x=r?-1:1,P=t[n+v];for(v+=x,l=P&(1<<-_)-1,P>>=-_,_+=c;_>0;l=l*256+t[n+v],v+=x,_-=8);for(u=l&(1<<-_)-1,l>>=-_,_+=s;_>0;u=u*256+t[n+v],v+=x,_-=8);if(l===0)l=1-p;else{if(l===d)return u?NaN:(P?-1:1)*(1/0);u=u+Math.pow(2,s),l=l-p}return(P?-1:1)*u*Math.pow(2,l-s)},i.write=function(t,n,r,s,a,l){var u,c,d,p=l*8-a-1,_=(1<<p)-1,v=_>>1,x=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=s?0:l-1,S=s?1:-1,D=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(c=isNaN(n)?1:0,u=_):(u=Math.floor(Math.log(n)/Math.LN2),n*(d=Math.pow(2,-u))<1&&(u--,d*=2),u+v>=1?n+=x/d:n+=x*Math.pow(2,1-v),n*d>=2&&(u++,d/=2),u+v>=_?(c=0,u=_):u+v>=1?(c=(n*d-1)*Math.pow(2,a),u=u+v):(c=n*Math.pow(2,v-1)*Math.pow(2,a),u=0));a>=8;t[r+P]=c&255,P+=S,c/=256,a-=8);for(u=u<<a|c,p+=a;p>0;t[r+P]=u&255,P+=S,u/=256,p-=8);t[r+P-S]|=D*128}}}),Yf=Qt({"node_modules/pbf/index.js"(i,t){t.exports=r;var n=Zf();function r(w){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(w)?w:new Uint8Array(w||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=65536*65536,a=1/s,l=12,u=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(w,z,O){for(O=O||this.length;this.pos<O;){var W=this.readVarint(),Z=W>>3,J=this.pos;this.type=W&7,w(Z,z,this),this.pos===J&&this.skip(W)}return z},readMessage:function(w,z){return this.readFields(w,z,this.readVarint()+this.pos)},readFixed32:function(){var w=A(this.buf,this.pos);return this.pos+=4,w},readSFixed32:function(){var w=Y(this.buf,this.pos);return this.pos+=4,w},readFixed64:function(){var w=A(this.buf,this.pos)+A(this.buf,this.pos+4)*s;return this.pos+=8,w},readSFixed64:function(){var w=A(this.buf,this.pos)+Y(this.buf,this.pos+4)*s;return this.pos+=8,w},readFloat:function(){var w=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,w},readDouble:function(){var w=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,w},readVarint:function(w){var z=this.buf,O,W;return W=z[this.pos++],O=W&127,W<128||(W=z[this.pos++],O|=(W&127)<<7,W<128)||(W=z[this.pos++],O|=(W&127)<<14,W<128)||(W=z[this.pos++],O|=(W&127)<<21,W<128)?O:(W=z[this.pos],O|=(W&15)<<28,c(O,w,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var w=this.readVarint();return w%2===1?(w+1)/-2:w/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var w=this.readVarint()+this.pos,z=this.pos;return this.pos=w,w-z>=l&&u?j(this.buf,z,w):$(this.buf,z,w)},readBytes:function(){var w=this.readVarint()+this.pos,z=this.buf.subarray(this.pos,w);return this.pos=w,z},readPackedVarint:function(w,z){if(this.type!==r.Bytes)return w.push(this.readVarint(z));var O=d(this);for(w=w||[];this.pos<O;)w.push(this.readVarint(z));return w},readPackedSVarint:function(w){if(this.type!==r.Bytes)return w.push(this.readSVarint());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readSVarint());return w},readPackedBoolean:function(w){if(this.type!==r.Bytes)return w.push(this.readBoolean());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readBoolean());return w},readPackedFloat:function(w){if(this.type!==r.Bytes)return w.push(this.readFloat());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readFloat());return w},readPackedDouble:function(w){if(this.type!==r.Bytes)return w.push(this.readDouble());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readDouble());return w},readPackedFixed32:function(w){if(this.type!==r.Bytes)return w.push(this.readFixed32());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readFixed32());return w},readPackedSFixed32:function(w){if(this.type!==r.Bytes)return w.push(this.readSFixed32());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readSFixed32());return w},readPackedFixed64:function(w){if(this.type!==r.Bytes)return w.push(this.readFixed64());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readFixed64());return w},readPackedSFixed64:function(w){if(this.type!==r.Bytes)return w.push(this.readSFixed64());var z=d(this);for(w=w||[];this.pos<z;)w.push(this.readSFixed64());return w},skip:function(w){var z=w&7;if(z===r.Varint)for(;this.buf[this.pos++]>127;);else if(z===r.Bytes)this.pos=this.readVarint()+this.pos;else if(z===r.Fixed32)this.pos+=4;else if(z===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+z)},writeTag:function(w,z){this.writeVarint(w<<3|z)},realloc:function(w){for(var z=this.length||16;z<this.pos+w;)z*=2;if(z!==this.length){var O=new Uint8Array(z);O.set(this.buf),this.buf=O,this.length=z}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(w){this.realloc(4),I(this.buf,w,this.pos),this.pos+=4},writeSFixed32:function(w){this.realloc(4),I(this.buf,w,this.pos),this.pos+=4},writeFixed64:function(w){this.realloc(8),I(this.buf,w&-1,this.pos),I(this.buf,Math.floor(w*a),this.pos+4),this.pos+=8},writeSFixed64:function(w){this.realloc(8),I(this.buf,w&-1,this.pos),I(this.buf,Math.floor(w*a),this.pos+4),this.pos+=8},writeVarint:function(w){if(w=+w||0,w>268435455||w<0){_(w,this);return}this.realloc(4),this.buf[this.pos++]=w&127|(w>127?128:0),!(w<=127)&&(this.buf[this.pos++]=(w>>>=7)&127|(w>127?128:0),!(w<=127)&&(this.buf[this.pos++]=(w>>>=7)&127|(w>127?128:0),!(w<=127)&&(this.buf[this.pos++]=w>>>7&127)))},writeSVarint:function(w){this.writeVarint(w<0?-w*2-1:w*2)},writeBoolean:function(w){this.writeVarint(!!w)},writeString:function(w){w=String(w),this.realloc(w.length*4),this.pos++;var z=this.pos;this.pos=X(this.buf,w,this.pos);var O=this.pos-z;O>=128&&P(z,O,this),this.pos=z-1,this.writeVarint(O),this.pos+=O},writeFloat:function(w){this.realloc(4),n.write(this.buf,w,this.pos,!0,23,4),this.pos+=4},writeDouble:function(w){this.realloc(8),n.write(this.buf,w,this.pos,!0,52,8),this.pos+=8},writeBytes:function(w){var z=w.length;this.writeVarint(z),this.realloc(z);for(var O=0;O<z;O++)this.buf[this.pos++]=w[O]},writeRawMessage:function(w,z){this.pos++;var O=this.pos;w(z,this);var W=this.pos-O;W>=128&&P(O,W,this),this.pos=O-1,this.writeVarint(W),this.pos+=W},writeMessage:function(w,z,O){this.writeTag(w,r.Bytes),this.writeRawMessage(z,O)},writePackedVarint:function(w,z){z.length&&this.writeMessage(w,S,z)},writePackedSVarint:function(w,z){z.length&&this.writeMessage(w,D,z)},writePackedBoolean:function(w,z){z.length&&this.writeMessage(w,y,z)},writePackedFloat:function(w,z){z.length&&this.writeMessage(w,k,z)},writePackedDouble:function(w,z){z.length&&this.writeMessage(w,g,z)},writePackedFixed32:function(w,z){z.length&&this.writeMessage(w,M,z)},writePackedSFixed32:function(w,z){z.length&&this.writeMessage(w,E,z)},writePackedFixed64:function(w,z){z.length&&this.writeMessage(w,B,z)},writePackedSFixed64:function(w,z){z.length&&this.writeMessage(w,C,z)},writeBytesField:function(w,z){this.writeTag(w,r.Bytes),this.writeBytes(z)},writeFixed32Field:function(w,z){this.writeTag(w,r.Fixed32),this.writeFixed32(z)},writeSFixed32Field:function(w,z){this.writeTag(w,r.Fixed32),this.writeSFixed32(z)},writeFixed64Field:function(w,z){this.writeTag(w,r.Fixed64),this.writeFixed64(z)},writeSFixed64Field:function(w,z){this.writeTag(w,r.Fixed64),this.writeSFixed64(z)},writeVarintField:function(w,z){this.writeTag(w,r.Varint),this.writeVarint(z)},writeSVarintField:function(w,z){this.writeTag(w,r.Varint),this.writeSVarint(z)},writeStringField:function(w,z){this.writeTag(w,r.Bytes),this.writeString(z)},writeFloatField:function(w,z){this.writeTag(w,r.Fixed32),this.writeFloat(z)},writeDoubleField:function(w,z){this.writeTag(w,r.Fixed64),this.writeDouble(z)},writeBooleanField:function(w,z){this.writeVarintField(w,!!z)}};function c(w,z,O){var W=O.buf,Z,J;if(J=W[O.pos++],Z=(J&112)>>4,J<128||(J=W[O.pos++],Z|=(J&127)<<3,J<128)||(J=W[O.pos++],Z|=(J&127)<<10,J<128)||(J=W[O.pos++],Z|=(J&127)<<17,J<128)||(J=W[O.pos++],Z|=(J&127)<<24,J<128)||(J=W[O.pos++],Z|=(J&1)<<31,J<128))return p(w,Z,z);throw new Error("Expected varint not more than 10 bytes")}function d(w){return w.type===r.Bytes?w.readVarint()+w.pos:w.pos+1}function p(w,z,O){return O?z*4294967296+(w>>>0):(z>>>0)*4294967296+(w>>>0)}function _(w,z){var O,W;if(w>=0?(O=w%4294967296|0,W=w/4294967296|0):(O=~(-w%4294967296),W=~(-w/4294967296),O^4294967295?O=O+1|0:(O=0,W=W+1|0)),w>=18446744073709552e3||w<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");z.realloc(10),v(O,W,z),x(W,z)}function v(w,z,O){O.buf[O.pos++]=w&127|128,w>>>=7,O.buf[O.pos++]=w&127|128,w>>>=7,O.buf[O.pos++]=w&127|128,w>>>=7,O.buf[O.pos++]=w&127|128,w>>>=7,O.buf[O.pos]=w&127}function x(w,z){var O=(w&7)<<4;z.buf[z.pos++]|=O|((w>>>=3)?128:0),w&&(z.buf[z.pos++]=w&127|((w>>>=7)?128:0),w&&(z.buf[z.pos++]=w&127|((w>>>=7)?128:0),w&&(z.buf[z.pos++]=w&127|((w>>>=7)?128:0),w&&(z.buf[z.pos++]=w&127|((w>>>=7)?128:0),w&&(z.buf[z.pos++]=w&127)))))}function P(w,z,O){var W=z<=16383?1:z<=2097151?2:z<=268435455?3:Math.floor(Math.log(z)/(Math.LN2*7));O.realloc(W);for(var Z=O.pos-1;Z>=w;Z--)O.buf[Z+W]=O.buf[Z]}function S(w,z){for(var O=0;O<w.length;O++)z.writeVarint(w[O])}function D(w,z){for(var O=0;O<w.length;O++)z.writeSVarint(w[O])}function k(w,z){for(var O=0;O<w.length;O++)z.writeFloat(w[O])}function g(w,z){for(var O=0;O<w.length;O++)z.writeDouble(w[O])}function y(w,z){for(var O=0;O<w.length;O++)z.writeBoolean(w[O])}function M(w,z){for(var O=0;O<w.length;O++)z.writeFixed32(w[O])}function E(w,z){for(var O=0;O<w.length;O++)z.writeSFixed32(w[O])}function B(w,z){for(var O=0;O<w.length;O++)z.writeFixed64(w[O])}function C(w,z){for(var O=0;O<w.length;O++)z.writeSFixed64(w[O])}function A(w,z){return(w[z]|w[z+1]<<8|w[z+2]<<16)+w[z+3]*16777216}function I(w,z,O){w[O]=z,w[O+1]=z>>>8,w[O+2]=z>>>16,w[O+3]=z>>>24}function Y(w,z){return(w[z]|w[z+1]<<8|w[z+2]<<16)+(w[z+3]<<24)}function $(w,z,O){for(var W="",Z=z;Z<O;){var J=w[Z],R=null,V=J>239?4:J>223?3:J>191?2:1;if(Z+V>O)break;var H,nt,Q;V===1?J<128&&(R=J):V===2?(H=w[Z+1],(H&192)===128&&(R=(J&31)<<6|H&63,R<=127&&(R=null))):V===3?(H=w[Z+1],nt=w[Z+2],(H&192)===128&&(nt&192)===128&&(R=(J&15)<<12|(H&63)<<6|nt&63,(R<=2047||R>=55296&&R<=57343)&&(R=null))):V===4&&(H=w[Z+1],nt=w[Z+2],Q=w[Z+3],(H&192)===128&&(nt&192)===128&&(Q&192)===128&&(R=(J&15)<<18|(H&63)<<12|(nt&63)<<6|Q&63,(R<=65535||R>=1114112)&&(R=null))),R===null?(R=65533,V=1):R>65535&&(R-=65536,W+=String.fromCharCode(R>>>10&1023|55296),R=56320|R&1023),W+=String.fromCharCode(R),Z+=V}return W}function j(w,z,O){return u.decode(w.subarray(z,O))}function X(w,z,O){for(var W=0,Z,J;W<z.length;W++){if(Z=z.charCodeAt(W),Z>55295&&Z<57344)if(J)if(Z<56320){w[O++]=239,w[O++]=191,w[O++]=189,J=Z;continue}else Z=J-55296<<10|Z-56320|65536,J=null;else{Z>56319||W+1===z.length?(w[O++]=239,w[O++]=191,w[O++]=189):J=Z;continue}else J&&(w[O++]=239,w[O++]=191,w[O++]=189,J=null);Z<128?w[O++]=Z:(Z<2048?w[O++]=Z>>6|192:(Z<65536?w[O++]=Z>>12|224:(w[O++]=Z>>18|240,w[O++]=Z>>12&63|128),w[O++]=Z>>6&63|128),w[O++]=Z&63|128)}return O}}}),Xf=Qt({"node_modules/rbush/rbush.min.js"(i,t){(function(n,r){typeof i=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self).RBush=r()})(i,function(){function n(g,y,M,E,B){(function C(A,I,Y,$,j){for(;$>Y;){if($-Y>600){var X=$-Y+1,w=I-Y+1,z=Math.log(X),O=.5*Math.exp(2*z/3),W=.5*Math.sqrt(z*O*(X-O)/X)*(w-X/2<0?-1:1),Z=Math.max(Y,Math.floor(I-w*O/X+W)),J=Math.min($,Math.floor(I+(X-w)*O/X+W));C(A,I,Z,J,j)}var R=A[I],V=Y,H=$;for(r(A,Y,I),j(A[$],R)>0&&r(A,Y,$);V<H;){for(r(A,V,H),V++,H--;j(A[V],R)<0;)V++;for(;j(A[H],R)>0;)H--}j(A[Y],R)===0?r(A,Y,H):r(A,++H,$),H<=I&&(Y=H+1),I<=H&&($=H-1)}})(g,y,M||0,E||g.length-1,B||s)}function r(g,y,M){var E=g[y];g[y]=g[M],g[M]=E}function s(g,y){return g<y?-1:g>y?1:0}var a=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(g,y,M){if(!M)return y.indexOf(g);for(var E=0;E<y.length;E++)if(M(g,y[E]))return E;return-1}function u(g,y){c(g,0,g.children.length,y,g)}function c(g,y,M,E,B){B||(B=D(null)),B.minX=1/0,B.minY=1/0,B.maxX=-1/0,B.maxY=-1/0;for(var C=y;C<M;C++){var A=g.children[C];d(B,g.leaf?E(A):A)}return B}function d(g,y){return g.minX=Math.min(g.minX,y.minX),g.minY=Math.min(g.minY,y.minY),g.maxX=Math.max(g.maxX,y.maxX),g.maxY=Math.max(g.maxY,y.maxY),g}function p(g,y){return g.minX-y.minX}function _(g,y){return g.minY-y.minY}function v(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function x(g){return g.maxX-g.minX+(g.maxY-g.minY)}function P(g,y){return g.minX<=y.minX&&g.minY<=y.minY&&y.maxX<=g.maxX&&y.maxY<=g.maxY}function S(g,y){return y.minX<=g.maxX&&y.minY<=g.maxY&&y.maxX>=g.minX&&y.maxY>=g.minY}function D(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(g,y,M,E,B){for(var C=[y,M];C.length;)if(!((M=C.pop())-(y=C.pop())<=E)){var A=y+Math.ceil((M-y)/E/2)*E;n(g,A,y,M,B),C.push(y,A,A,M)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(g){var y=this.data,M=[];if(!S(g,y))return M;for(var E=this.toBBox,B=[];y;){for(var C=0;C<y.children.length;C++){var A=y.children[C],I=y.leaf?E(A):A;S(g,I)&&(y.leaf?M.push(A):P(g,I)?this._all(A,M):B.push(A))}y=B.pop()}return M},a.prototype.collides=function(g){var y=this.data;if(!S(g,y))return!1;for(var M=[];y;){for(var E=0;E<y.children.length;E++){var B=y.children[E],C=y.leaf?this.toBBox(B):B;if(S(g,C)){if(y.leaf||P(g,C))return!0;M.push(B)}}y=M.pop()}return!1},a.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var y=0;y<g.length;y++)this.insert(g[y]);return this}var M=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===M.height)this._splitRoot(this.data,M);else{if(this.data.height<M.height){var E=this.data;this.data=M,M=E}this._insert(M,this.data.height-M.height-1,!0)}else this.data=M;return this},a.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},a.prototype.clear=function(){return this.data=D([]),this},a.prototype.remove=function(g,y){if(!g)return this;for(var M,E,B,C=this.data,A=this.toBBox(g),I=[],Y=[];C||I.length;){if(C||(C=I.pop(),E=I[I.length-1],M=Y.pop(),B=!0),C.leaf){var $=l(g,C.children,y);if($!==-1)return C.children.splice($,1),I.push(C),this._condense(I),this}B||C.leaf||!P(C,A)?E?(M++,C=E.children[M],B=!1):C=null:(I.push(C),Y.push(M),M=0,E=C,C=C.children[0])}return this},a.prototype.toBBox=function(g){return g},a.prototype.compareMinX=function(g,y){return g.minX-y.minX},a.prototype.compareMinY=function(g,y){return g.minY-y.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(g){return this.data=g,this},a.prototype._all=function(g,y){for(var M=[];g;)g.leaf?y.push.apply(y,g.children):M.push.apply(M,g.children),g=M.pop();return y},a.prototype._build=function(g,y,M,E){var B,C=M-y+1,A=this._maxEntries;if(C<=A)return u(B=D(g.slice(y,M+1)),this.toBBox),B;E||(E=Math.ceil(Math.log(C)/Math.log(A)),A=Math.ceil(C/Math.pow(A,E-1))),(B=D([])).leaf=!1,B.height=E;var I=Math.ceil(C/A),Y=I*Math.ceil(Math.sqrt(A));k(g,y,M,Y,this.compareMinX);for(var $=y;$<=M;$+=Y){var j=Math.min($+Y-1,M);k(g,$,j,I,this.compareMinY);for(var X=$;X<=j;X+=I){var w=Math.min(X+I-1,j);B.children.push(this._build(g,X,w,E-1))}}return u(B,this.toBBox),B},a.prototype._chooseSubtree=function(g,y,M,E){for(;E.push(y),!y.leaf&&E.length-1!==M;){for(var B=1/0,C=1/0,A=void 0,I=0;I<y.children.length;I++){var Y=y.children[I],$=v(Y),j=(X=g,w=Y,(Math.max(w.maxX,X.maxX)-Math.min(w.minX,X.minX))*(Math.max(w.maxY,X.maxY)-Math.min(w.minY,X.minY))-$);j<C?(C=j,B=$<B?$:B,A=Y):j===C&&$<B&&(B=$,A=Y)}y=A||y.children[0]}var X,w;return y},a.prototype._insert=function(g,y,M){var E=M?g:this.toBBox(g),B=[],C=this._chooseSubtree(E,this.data,y,B);for(C.children.push(g),d(C,E);y>=0&&B[y].children.length>this._maxEntries;)this._split(B,y),y--;this._adjustParentBBoxes(E,B,y)},a.prototype._split=function(g,y){var M=g[y],E=M.children.length,B=this._minEntries;this._chooseSplitAxis(M,B,E);var C=this._chooseSplitIndex(M,B,E),A=D(M.children.splice(C,M.children.length-C));A.height=M.height,A.leaf=M.leaf,u(M,this.toBBox),u(A,this.toBBox),y?g[y-1].children.push(A):this._splitRoot(M,A)},a.prototype._splitRoot=function(g,y){this.data=D([g,y]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(g,y,M){for(var E,B,C,A,I,Y,$,j=1/0,X=1/0,w=y;w<=M-y;w++){var z=c(g,0,w,this.toBBox),O=c(g,w,M,this.toBBox),W=(B=z,C=O,A=void 0,I=void 0,Y=void 0,$=void 0,A=Math.max(B.minX,C.minX),I=Math.max(B.minY,C.minY),Y=Math.min(B.maxX,C.maxX),$=Math.min(B.maxY,C.maxY),Math.max(0,Y-A)*Math.max(0,$-I)),Z=v(z)+v(O);W<j?(j=W,E=w,X=Z<X?Z:X):W===j&&Z<X&&(X=Z,E=w)}return E||M-y},a.prototype._chooseSplitAxis=function(g,y,M){var E=g.leaf?this.compareMinX:p,B=g.leaf?this.compareMinY:_;this._allDistMargin(g,y,M,E)<this._allDistMargin(g,y,M,B)&&g.children.sort(E)},a.prototype._allDistMargin=function(g,y,M,E){g.children.sort(E);for(var B=this.toBBox,C=c(g,0,y,B),A=c(g,M-y,M,B),I=x(C)+x(A),Y=y;Y<M-y;Y++){var $=g.children[Y];d(C,g.leaf?B($):$),I+=x(C)}for(var j=M-y-1;j>=y;j--){var X=g.children[j];d(A,g.leaf?B(X):X),I+=x(A)}return I},a.prototype._adjustParentBBoxes=function(g,y,M){for(var E=M;E>=0;E--)d(y[E],g)},a.prototype._condense=function(g){for(var y=g.length-1,M=void 0;y>=0;y--)g[y].children.length===0?y>0?(M=g[y-1].children).splice(M.indexOf(g[y]),1):this.clear():u(g[y],this.toBBox)},a})}}),$f=Qt({"src/types/unitbezier.d.ts"(){}}),Uf=Qt({"node_modules/tinyqueue/tinyqueue.js"(i,t){(function(n,r){typeof i=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self,n.TinyQueue=r())})(i,function(){var n=function(a,l){if(a===void 0&&(a=[]),l===void 0&&(l=r),this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};n.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var a=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),a}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(a){for(var l=this,u=l.data,c=l.compare,d=u[a];a>0;){var p=a-1>>1,_=u[p];if(c(d,_)>=0)break;u[a]=_,a=p}u[a]=d},n.prototype._down=function(a){for(var l=this,u=l.data,c=l.compare,d=this.length>>1,p=u[a];a<d;){var _=(a<<1)+1,v=u[_],x=_+1;if(x<this.length&&c(u[x],v)<0&&(_=x,v=u[x]),c(v,p)>=0)break;u[a]=v,a=_}u[a]=p};function r(s,a){return s<a?-1:s>a?1:0}return n})}}),jf=Qt({"node_modules/polylabel/polylabel.js"(i,t){var n=Uf();n.default&&(n=n.default),t.exports=r,t.exports.default=r;function r(d,p,_){p=p||1;for(var v,x,P,S,D=0;D<d[0].length;D++){var k=d[0][D];(!D||k[0]<v)&&(v=k[0]),(!D||k[1]<x)&&(x=k[1]),(!D||k[0]>P)&&(P=k[0]),(!D||k[1]>S)&&(S=k[1])}var g=P-v,y=S-x,M=Math.min(g,y),E=M/2;if(M===0){var B=[v,x];return B.distance=0,B}for(var C=new n(void 0,s),A=v;A<P;A+=M)for(var I=x;I<S;I+=M)C.push(new a(A+E,I+E,E,d));var Y=u(d),$=new a(v+g/2,x+y/2,0,d);$.d>Y.d&&(Y=$);for(var j=C.length;C.length;){var X=C.pop();X.d>Y.d&&(Y=X,_&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,j)),!(X.max-Y.d<=p)&&(E=X.h/2,C.push(new a(X.x-E,X.y-E,E,d)),C.push(new a(X.x+E,X.y-E,E,d)),C.push(new a(X.x-E,X.y+E,E,d)),C.push(new a(X.x+E,X.y+E,E,d)),j+=4)}_&&(console.log("num probes: "+j),console.log("best distance: "+Y.d));var w=[Y.x,Y.y];return w.distance=Y.d,w}function s(d,p){return p.max-d.max}function a(d,p,_,v){this.x=d,this.y=p,this.h=_,this.d=l(d,p,v),this.max=this.d+this.h*Math.SQRT2}function l(d,p,_){for(var v=!1,x=1/0,P=0;P<_.length;P++)for(var S=_[P],D=0,k=S.length,g=k-1;D<k;g=D++){var y=S[D],M=S[g];y[1]>p!=M[1]>p&&d<(M[0]-y[0])*(p-y[1])/(M[1]-y[1])+y[0]&&(v=!v),x=Math.min(x,c(d,p,y,M))}return x===0?0:(v?1:-1)*Math.sqrt(x)}function u(d){for(var p=0,_=0,v=0,x=d[0],P=0,S=x.length,D=S-1;P<S;D=P++){var k=x[P],g=x[D],y=k[0]*g[1]-g[0]*k[1];_+=(k[0]+g[0])*y,v+=(k[1]+g[1])*y,p+=y*3}return p===0?new a(x[0][0],x[0][1],0,d):new a(_/p,v/p,0,d)}function c(d,p,_,v){var x=_[0],P=_[1],S=v[0]-x,D=v[1]-P;if(S!==0||D!==0){var k=((d-x)*S+(p-P)*D)/(S*S+D*D);k>1?(x=v[0],P=v[1]):k>0&&(x+=S*k,P+=D*k)}return S=d-x,D=p-P,S*S+D*D}}});Xt(pe());var Ue=Xt(pe()),ji=Xt(pe()),Wf=Xt(Rf()),Vf=Xt(Yf()),Ct=(i,t,n)=>new Promise((r,s)=>{var a=c=>{try{u(n.next(c))}catch(d){s(d)}},l=c=>{try{u(n.throw(c))}catch(d){s(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((n=n.apply(i,t)).next())}),Yt=Uint8Array,Ke=Uint16Array,Ch=Uint32Array,Th=new Yt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ah=new Yt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Hf=new Yt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Dh=function(i,t){for(var n=new Ke(31),r=0;r<31;++r)n[r]=t+=1<<i[r-1];for(var s=new Ch(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)s[a]=a-n[r]<<5|r;return[n,s]},Bh=Dh(Th,2),zh=Bh[0],Gf=Bh[1];zh[28]=258,Gf[258]=28;var qf=Dh(Ah,0),Jf=qf[0],Oh=new Ke(32768);for(ut=0;ut<32768;++ut)fe=(ut&43690)>>>1|(ut&21845)<<1,fe=(fe&52428)>>>2|(fe&13107)<<2,fe=(fe&61680)>>>4|(fe&3855)<<4,Oh[ut]=((fe&65280)>>>8|(fe&255)<<8)>>>1;var fe,ut,Ni=function(i,t,n){for(var r=i.length,s=0,a=new Ke(t);s<r;++s)i[s]&&++a[i[s]-1];var l=new Ke(t);for(s=0;s<t;++s)l[s]=l[s-1]+a[s-1]<<1;var u;{u=new Ke(1<<t);var c=15-t;for(s=0;s<r;++s)if(i[s])for(var d=s<<4|i[s],p=t-i[s],_=l[i[s]-1]++<<p,v=_|(1<<p)-1;_<=v;++_)u[Oh[_]>>>c]=d}return u},qi=new Yt(288);for(ut=0;ut<144;++ut)qi[ut]=8;var ut;for(ut=144;ut<256;++ut)qi[ut]=9;var ut;for(ut=256;ut<280;++ut)qi[ut]=7;var ut;for(ut=280;ut<288;++ut)qi[ut]=8;var ut,Ih=new Yt(32);for(ut=0;ut<32;++ut)Ih[ut]=5;var ut,Kf=Ni(qi,9),Qf=Ni(Ih,5),Ir=function(i){for(var t=i[0],n=1;n<i.length;++n)i[n]>t&&(t=i[n]);return t},Ht=function(i,t,n){var r=t/8|0;return(i[r]|i[r+1]<<8)>>(t&7)&n},Fr=function(i,t){var n=t/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(t&7)},td=function(i){return(i+7)/8|0},ed=function(i,t,n){(n==null||n>i.length)&&(n=i.length);var r=new(i.BYTES_PER_ELEMENT==2?Ke:i.BYTES_PER_ELEMENT==4?Ch:Yt)(n-t);return r.set(i.subarray(t,n)),r},id=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Jt=function(i,t,n){var r=new Error(t||id[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,Jt),!n)throw r;return r},wo=function(i,t,n){var r=i.length;if(!r||n&&n.f&&!n.l)return t||new Yt(0);var s=!t||n,a=!n||n.i;n||(n={}),t||(t=new Yt(r*3));var l=function(G){var ht=t.length;if(G>ht){var dt=new Yt(Math.max(ht*2,G));dt.set(t),t=dt}},u=n.f||0,c=n.p||0,d=n.b||0,p=n.l,_=n.d,v=n.m,x=n.n,P=r*8;do{if(!p){u=Ht(i,c,1);var S=Ht(i,c+1,3);if(c+=3,S)if(S==1)p=Kf,_=Qf,v=9,x=5;else if(S==2){var y=Ht(i,c,31)+257,M=Ht(i,c+10,15)+4,E=y+Ht(i,c+5,31)+1;c+=14;for(var B=new Yt(E),C=new Yt(19),A=0;A<M;++A)C[Hf[A]]=Ht(i,c+A*3,7);c+=M*3;for(var I=Ir(C),Y=(1<<I)-1,$=Ni(C,I),A=0;A<E;){var j=$[Ht(i,c,Y)];c+=j&15;var D=j>>>4;if(D<16)B[A++]=D;else{var X=0,w=0;for(D==16?(w=3+Ht(i,c,3),c+=2,X=B[A-1]):D==17?(w=3+Ht(i,c,7),c+=3):D==18&&(w=11+Ht(i,c,127),c+=7);w--;)B[A++]=X}}var z=B.subarray(0,y),O=B.subarray(y);v=Ir(z),x=Ir(O),p=Ni(z,v),_=Ni(O,x)}else Jt(1);else{var D=td(c)+4,k=i[D-4]|i[D-3]<<8,g=D+k;if(g>r){a&&Jt(0);break}s&&l(d+k),t.set(i.subarray(D,g),d),n.b=d+=k,n.p=c=g*8,n.f=u;continue}if(c>P){a&&Jt(0);break}}s&&l(d+131072);for(var W=(1<<v)-1,Z=(1<<x)-1,J=c;;J=c){var X=p[Fr(i,c)&W],R=X>>>4;if(c+=X&15,c>P){a&&Jt(0);break}if(X||Jt(2),R<256)t[d++]=R;else if(R==256){J=c,p=null;break}else{var V=R-254;if(R>264){var A=R-257,H=Th[A];V=Ht(i,c,(1<<H)-1)+zh[A],c+=H}var nt=_[Fr(i,c)&Z],Q=nt>>>4;nt||Jt(3),c+=nt&15;var O=Jf[Q];if(Q>3){var H=Ah[Q];O+=Fr(i,c)&(1<<H)-1,c+=H}if(c>P){a&&Jt(0);break}s&&l(d+131072);for(var et=d+V;d<et;d+=4)t[d]=t[d-O],t[d+1]=t[d+1-O],t[d+2]=t[d+2-O],t[d+3]=t[d+3-O];d=et}}n.l=p,n.p=J,n.b=d,n.f=u,p&&(u=1,n.m=v,n.d=_,n.n=x)}while(!u);return d==t.length?t:ed(t,0,d)},nd=new Yt(0),rd=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&Jt(6,"invalid gzip data");var t=i[3],n=10;t&4&&(n+=i[10]|(i[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!i[n++]);return n+(t&2)},od=function(i){var t=i.length;return(i[t-4]|i[t-3]<<8|i[t-2]<<16|i[t-1]<<24)>>>0},sd=function(i){((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)&&Jt(6,"invalid zlib data"),i[1]&32&&Jt(6,"invalid zlib data: preset dictionaries not supported")};function ad(i,t){return wo(i,t)}function hd(i,t){return wo(i.subarray(rd(i),-8),new Yt(od(i)))}function ld(i,t){return wo((sd(i),i.subarray(2,-4)),t)}function to(i,t){return i[0]==31&&i[1]==139&&i[2]==8?hd(i):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?ad(i,t):ld(i,t)}var ud=typeof TextDecoder<"u"&&new TextDecoder,cd=0;try{ud.decode(nd,{stream:!0}),cd=1}catch{}var Fh=(i,t)=>i*Math.pow(2,t),Ei=(i,t)=>Math.floor(i/Math.pow(2,t)),Vn=(i,t)=>Fh(i.getUint16(t+1,!0),8)+i.getUint8(t),Nh=(i,t)=>Fh(i.getUint32(t+2,!0),16)+i.getUint16(t,!0),fd=(i,t,n,r,s)=>{if(i!=r.getUint8(s))return i-r.getUint8(s);const a=Vn(r,s+1);if(t!=a)return t-a;const l=Vn(r,s+4);return n!=l?n-l:0},dd=(i,t,n,r)=>{const s=Rh(i,t|128,n,r);return s?{z:t,x:n,y:r,offset:s[0],length:s[1],is_dir:!0}:null},oa=(i,t,n,r)=>{const s=Rh(i,t,n,r);return s?{z:t,x:n,y:r,offset:s[0],length:s[1],is_dir:!1}:null},Rh=(i,t,n,r)=>{let s=0,a=i.byteLength/17-1;for(;s<=a;){const l=a+s>>1,u=fd(t,n,r,i,l*17);if(u>0)s=l+1;else if(u<0)a=l-1;else return[Nh(i,l*17+7),i.getUint32(l*17+13,!0)]}return null},pd=(i,t)=>i.is_dir&&!t.is_dir?1:!i.is_dir&&t.is_dir?-1:i.z!==t.z?i.z-t.z:i.x!==t.x?i.x-t.x:i.y-t.y,Zh=(i,t)=>{const n=i.getUint8(t*17);return{z:n&127,x:Vn(i,t*17+1),y:Vn(i,t*17+4),offset:Nh(i,t*17+7),length:i.getUint32(t*17+13,!0),is_dir:n>>7===1}},sa=i=>{const t=[],n=new DataView(i);for(let r=0;r<n.byteLength/17;r++)t.push(Zh(n,r));return md(t)},md=i=>{i.sort(pd);const t=new ArrayBuffer(17*i.length),n=new Uint8Array(t);for(let r=0;r<i.length;r++){const s=i[r];let a=s.z;s.is_dir&&(a=a|128),n[r*17]=a,n[r*17+1]=s.x&255,n[r*17+2]=s.x>>8&255,n[r*17+3]=s.x>>16&255,n[r*17+4]=s.y&255,n[r*17+5]=s.y>>8&255,n[r*17+6]=s.y>>16&255,n[r*17+7]=s.offset&255,n[r*17+8]=Ei(s.offset,8)&255,n[r*17+9]=Ei(s.offset,16)&255,n[r*17+10]=Ei(s.offset,24)&255,n[r*17+11]=Ei(s.offset,32)&255,n[r*17+12]=Ei(s.offset,48)&255,n[r*17+13]=s.length&255,n[r*17+14]=s.length>>8&255,n[r*17+15]=s.length>>16&255,n[r*17+16]=s.length>>24&255}return t},_d=(i,t)=>{if(i.byteLength<17)return null;const n=i.byteLength/17,r=Zh(i,n-1);if(r.is_dir){const s=r.z,a=t.z-s,l=Math.trunc(t.x/(1<<a)),u=Math.trunc(t.y/(1<<a));return{z:s,x:l,y:u}}return null};function gd(i){return Ct(this,null,function*(){const t=yield i.getBytes(0,512e3),n=new DataView(t.data),r=n.getUint32(4,!0),s=n.getUint16(8,!0),a=new TextDecoder("utf-8"),l=JSON.parse(a.decode(new DataView(t.data,10,r)));let u=0;l.compression==="gzip"&&(u=2);let c=0;"minzoom"in l&&(c=+l.minzoom);let d=0;"maxzoom"in l&&(d=+l.maxzoom);let p=0,_=0,v=0,x=-180,P=-85,S=180,D=85;if(l.bounds){const g=l.bounds.split(",");x=+g[0],P=+g[1],S=+g[2],D=+g[3]}if(l.center){const g=l.center.split(",");p=+g[0],_=+g[1],v=+g[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:c,maxZoom:d,minLon:x,minLat:P,maxLon:S,maxLat:D,centerZoom:v,centerLon:p,centerLat:_,etag:t.etag}})}function vd(i,t,n,r,s,a,l){return Ct(this,null,function*(){let u=yield n.getArrayBuffer(t,i.rootDirectoryOffset,i.rootDirectoryLength,i);i.specVersion===1&&(u=sa(u));const c=oa(new DataView(u),r,s,a);if(c){let _=(yield t.getBytes(c.offset,c.length,l)).data;const v=new DataView(_);return v.getUint8(0)==31&&v.getUint8(1)==139&&(_=to(new Uint8Array(_))),{data:_}}const d=_d(new DataView(u),{z:r,x:s,y:a});if(d){const p=dd(new DataView(u),d.z,d.x,d.y);if(p){let _=yield n.getArrayBuffer(t,p.offset,p.length,i);i.specVersion===1&&(_=sa(_));const v=oa(new DataView(_),r,s,a);if(v){let P=(yield t.getBytes(v.offset,v.length,l)).data;const S=new DataView(P);return S.getUint8(0)==31&&S.getUint8(1)==139&&(P=to(new Uint8Array(P))),{data:P}}}}})}var Yh={getHeader:gd,getZxy:vd};function je(i,t){return(t>>>0)*4294967296+(i>>>0)}function yd(i,t){const n=t.buf;let r,s;if(s=n[t.pos++],r=(s&112)>>4,s<128||(s=n[t.pos++],r|=(s&127)<<3,s<128)||(s=n[t.pos++],r|=(s&127)<<10,s<128)||(s=n[t.pos++],r|=(s&127)<<17,s<128)||(s=n[t.pos++],r|=(s&127)<<24,s<128)||(s=n[t.pos++],r|=(s&1)<<31,s<128))return je(i,r);throw new Error("Expected varint not more than 10 bytes")}function Si(i){const t=i.buf;let n,r;return r=t[i.pos++],n=r&127,r<128||(r=t[i.pos++],n|=(r&127)<<7,r<128)||(r=t[i.pos++],n|=(r&127)<<14,r<128)||(r=t[i.pos++],n|=(r&127)<<21,r<128)?n:(r=t[i.pos],n|=(r&15)<<28,yd(n,i))}function wd(i,t,n,r){if(r==0){n==1&&(t[0]=i-1-t[0],t[1]=i-1-t[1]);const s=t[0];t[0]=t[1],t[1]=s}}function xd(i,t,n){if(i>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Math.pow(2,i)-1||n>Math.pow(2,i)-1)throw Error("tile x/y outside zoom level bounds");let r=0,s=0;for(;s<i;)r+=Math.pow(2,s)*Math.pow(2,s),s++;const a=Math.pow(2,i);let l=0,u=0,c=0;const d=[t,n];let p=a/2;for(;p>0;)l=(d[0]&p)>0?1:0,u=(d[1]&p)>0?1:0,c+=p*p*(3*l^u),wd(p,d,l,u),p=p/2;return r+c}function Xh(i,t){return Ct(this,null,function*(){if(t===1||t===0)return i;if(t===2)return to(new Uint8Array(i));throw Error("Compression method not supported")})}var bd=127;function Md(i,t){let n=0,r=i.length-1;for(;n<=r;){const s=r+n>>1,a=t-i[s].tileId;if(a>0)n=s+1;else if(a<0)r=s-1;else return i[s]}return r>=0&&(i[r].runLength===0||t-i[r].tileId<i[r].runLength)?i[r]:null}var Pd=class{constructor(i){this.url=i}getKey(){return this.url}getBytes(i,t,n){return Ct(this,null,function*(){let r;n||(r=new AbortController,n=r.signal);let s=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+i+"-"+(i+t-1)}});if(s.status===416&&i===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const c=+u.substr(8);s=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(c-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const a=s.headers.get("Content-Length");if(s.status===200&&(!a||+a>t))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function Gt(i,t){const n=i.getUint32(t+4,!0),r=i.getUint32(t+0,!0);return n*Math.pow(2,32)+r}function Ld(i,t){const n=new DataView(i),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:Gt(n,8),rootDirectoryLength:Gt(n,16),jsonMetadataOffset:Gt(n,24),jsonMetadataLength:Gt(n,32),leafDirectoryOffset:Gt(n,40),leafDirectoryLength:Gt(n,48),tileDataOffset:Gt(n,56),tileDataLength:Gt(n,64),numAddressedTiles:Gt(n,72),numTileEntries:Gt(n,80),numTileContents:Gt(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:t}}function $h(i){const t={buf:new Uint8Array(i),pos:0},n=Si(t),r=[];let s=0;for(let a=0;a<n;a++){const l=Si(t);r.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let a=0;a<n;a++)r[a].runLength=Si(t);for(let a=0;a<n;a++)r[a].length=Si(t);for(let a=0;a<n;a++){const l=Si(t);l===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=l-1}return r}function Ed(i){const t=new DataView(i);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Ge=class extends Error{};function Sd(i,t,n,r){return Ct(this,null,function*(){const s=yield i.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ed(s.data)<3)return[yield Yh.getHeader(i)];const l=s.data.slice(0,bd);let u=s.etag;r&&s.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+i.getKey()),u=void 0);const c=Ld(l,u);if(n){const d=s.data.slice(c.rootDirectoryOffset,c.rootDirectoryOffset+c.rootDirectoryLength),p=i.getKey()+"|"+(c.etag||"")+"|"+c.rootDirectoryOffset+"|"+c.rootDirectoryLength,_=$h(yield t(d,c.internalCompression));return[c,[p,_.length,_]]}return[c,void 0]})}function kd(i,t,n,r,s){return Ct(this,null,function*(){const a=yield i.getBytes(n,r);if(s.etag&&s.etag!==a.etag)throw new Ge(a.etag);const l=yield t(a.data,s.internalCompression),u=$h(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Cd=class{constructor(i=100,t=!0,n=Xh){this.cache=new Map,this.maxCacheEntries=i,this.counter=1,this.prefetch=t,this.decompress=n}getHeader(i,t){return Ct(this,null,function*(){const n=i.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const r=new Promise((s,a)=>{Sd(i,this.decompress,this.prefetch,t).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{a(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:r}),r})}getDirectory(i,t,n,r){return Ct(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{kd(i,this.decompress,t,n,r).then(c=>{l(c),this.prune()}).catch(c=>{u(c)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}getArrayBuffer(i,t,n,r){return Ct(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{i.getBytes(t,n).then(c=>{if(r.etag&&r.etag!==c.etag)throw new Ge(c.etag);l(c.data),this.cache.has(s),this.prune()}).catch(c=>{u(c)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let i=1/0,t;this.cache.forEach((n,r)=>{n.lastUsed<i&&(i=n.lastUsed,t=r)}),t&&this.cache.delete(t)}}invalidate(i,t){return Ct(this,null,function*(){this.cache.delete(i.getKey()),yield this.getHeader(i,t)})}},Td=class{constructor(i,t,n){typeof i=="string"?this.source=new Pd(i):this.source=i,n?this.decompress=n:this.decompress=Xh,t?this.cache=t:this.cache=new Cd}getHeader(){return Ct(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(i,t,n,r){return Ct(this,null,function*(){const s=xd(i,t,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return Yh.getZxy(a,this.source,this.cache,i,t,n,r);if(i<a.minZoom||i>a.maxZoom)return;let l=a.rootDirectoryOffset,u=a.rootDirectoryLength;for(let c=0;c<=3;c++){const d=yield this.cache.getDirectory(this.source,l,u,a),p=Md(d,s);if(p)if(p.runLength>0){const _=yield this.source.getBytes(a.tileDataOffset+p.offset,p.length,r);if(a.etag&&a.etag!==_.etag)throw new Ge(_.etag);return{data:yield this.decompress(_.data,a.tileCompression),cacheControl:_.cacheControl,expires:_.expires}}else l=a.leafDirectoryOffset+p.offset,u=p.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(i,t,n,r){return Ct(this,null,function*(){try{return yield this.getZxyAttempt(i,t,n,r)}catch(s){if(s instanceof Ge)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(i,t,n,r);throw s}})}getMetadataAttempt(){return Ct(this,null,function*(){const i=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(i.jsonMetadataOffset,i.jsonMetadataLength);if(i.etag&&i.etag!==t.etag)throw new Ge(t.etag);const n=yield this.decompress(t.data,i.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return Ct(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(i){if(i instanceof Ge)return this.cache.invalidate(this.source,i.message),yield this.getMetadataAttempt();throw i}})}},Qe;(function(i){i[i.Point=1]="Point",i[i.Line=2]="Line",i[i.Polygon=3]="Polygon"})(Qe||(Qe={}));function Te(i){return i.x+":"+i.y+":"+i.z}var Ad=(i,t,n)=>{i.pos=t;for(var r=i.readVarint()+i.pos,s=1,a=0,l=0,u=0,c=1/0,d=-1/0,p=1/0,_=-1/0,v=[],x=[];i.pos<r;){if(a<=0){var P=i.readVarint();s=P&7,a=P>>3}if(a--,s===1||s===2)l+=i.readSVarint()*n,u+=i.readSVarint()*n,l<c&&(c=l),l>d&&(d=l),u<p&&(p=u),u>_&&(_=u),s===1&&(x.length>0&&v.push(x),x=[]),x.push(new ji.default(l,u));else if(s===7)x&&x.push(x[0].clone());else throw new Error("unknown command "+s)}return x&&v.push(x),{geom:v,bbox:{minX:c,minY:p,maxX:d,maxY:_}}};function Uh(i,t){let n=new Wf.VectorTile(new Vf.default(i)),r=new Map;for(let[s,a]of Object.entries(n.layers)){let l=[],u=a;for(let c=0;c<u.length;c++){let d=Ad(u.feature(c)._pbf,u.feature(c)._geometry,t/u.extent),p=0;for(let _ of d.geom)p+=_.length;l.push({id:u.feature(c).id,geomType:u.feature(c).type,geom:d.geom,numVertices:p,bbox:d.bbox,props:u.feature(c).properties})}r.set(s,l)}return r}var aa=class{constructor(i,t){typeof i=="string"?this.p=new Td(i):this.p=i,this.controllers=[],this.shouldCancelZooms=t}get(i,t){return ri(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));const n=new AbortController;this.controllers.push([i.z,n]);const r=n.signal;let s=yield this.p.getZxy(i.z,i.x,i.y,r);return s?Uh(s.data,t):new Map})}},Dd=class{constructor(i,t){this.url=i,this.controllers=[],this.shouldCancelZooms=t}get(i,t){return ri(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));let n=this.url.replace("{z}",i.z.toString()).replace("{x}",i.x.toString()).replace("{y}",i.y.toString());const r=new AbortController;this.controllers.push([i.z,r]);const s=r.signal;return new Promise((a,l)=>{fetch(n,{signal:s}).then(u=>u.arrayBuffer()).then(u=>{let c=Uh(u,t);a(c)}).catch(u=>{l(u)})})})}},eo=6378137,Bd=85.0511287798,En=eo*Math.PI,zd=i=>{let t=Math.PI/180,n=Math.max(Math.min(Bd,i[0]),-85.0511287798),r=Math.sin(n*t);return new ji.default(eo*i[1]*t,eo*Math.log((1+r)/(1-r))/2)};function ha(i){return i*i}function In(i,t){return ha(i.x-t.x)+ha(i.y-t.y)}function Od(i,t,n){var r=In(t,n);if(r===0)return In(i,t);var s=((i.x-t.x)*(n.x-t.x)+(i.y-t.y)*(n.y-t.y))/r;return s=Math.max(0,Math.min(1,s)),In(i,new ji.default(t.x+s*(n.x-t.x),t.y+s*(n.y-t.y)))}function la(i,t){for(var n=!1,r=0,s=t.length-1;r<t.length;s=r++){var a=t[r].x,l=t[r].y,u=t[s].x,c=t[s].y,d=l>i.y!=c>i.y&&i.x<(u-a)*(i.y-l)/(c-l)+a;d&&(n=!n)}return n}function Id(i){for(var t=0,n=0;n<i.length;n++){let r=(n+1)%i.length;t+=i[n].x*i[r].y,t-=i[r].x*i[n].y}return t<0}function Fd(i,t){var n=!1;for(let r of t)if(Id(r))la(i,r)&&(n=!1);else{if(n)return!0;la(i,r)&&(n=!0)}return n}function Nd(i,t){let n=1/0;for(let r of t){let s=Math.sqrt(In(i,r[0]));s<n&&(n=s)}return n}function Rd(i,t){let n=1/0;for(let s of t)for(var r=0;r<s.length-1;r++){let a=Math.sqrt(Od(i,s[r],s[r+1]));a<n&&(n=a)}return n}var Zd=class{constructor(i,t){this.source=i,this.cache=new Map,this.inflight=new Map,this.tileSize=t}queryFeatures(i,t,n,r){let s=zd([t,i]);var a=new ji.default((s.x+En)/(En*2),1-(s.y+En)/(En*2));a.x>1&&(a.x=a.x-Math.floor(a.x));let l=a.mult(1<<n),u=Math.floor(l.x),c=Math.floor(l.y);const d=Te({z:n,x:u,y:c});let p=[],_=this.cache.get(d);if(_){const v=new ji.default((l.x-u)*this.tileSize,(l.y-c)*this.tileSize);for(let[x,P]of _.data.entries())for(let S of P)S.geomType==1?Nd(v,S.geom)<r&&p.push({feature:S,layerName:x}):S.geomType==2?Rd(v,S.geom)<r&&p.push({feature:S,layerName:x}):Fd(v,S.geom)&&p.push({feature:S,layerName:x})}return p}get(i){return ri(this,null,function*(){const t=Te(i);return new Promise((n,r)=>{let s=this.cache.get(t);if(s)s.used=performance.now(),n(s.data);else{let a=this.inflight.get(t);a?a.push([n,r]):(this.inflight.set(t,[]),this.source.get(i,this.tileSize).then(l=>{this.cache.set(t,{used:performance.now(),data:l});let u=this.inflight.get(t);if(u&&u.forEach(c=>c[0](l)),this.inflight.delete(t),n(l),this.cache.size>=64){let c=1/0,d;this.cache.forEach((p,_)=>{p.used<c&&(c=p.used,d=_)}),d&&this.cache.delete(d)}}).catch(l=>{let u=this.inflight.get(t);u&&u.forEach(c=>c[1](l)),this.inflight.delete(t),r(l)}))}})})}},jh=(i,t,n)=>{let r=[];for(let s of i){let a=[];for(let l of s)a.push(l.clone().mult(t).add(n));r.push(a)}return r},Sn=(i,t)=>{let n=1<<t;return i<0&&(i=n+i),i>=n&&(i=i%n),i},Yd=class{constructor(i,t,n){this.tileCache=i,this.maxDataLevel=t,this.levelDiff=n}dataTilesForBounds(i,t){let n=Math.pow(2,i)/Math.pow(2,Math.ceil(i)),r=[];var s=1,a=this.tileCache.tileSize;if(i<this.levelDiff)s=1/(1<<this.levelDiff-i)*n,r.push({data_tile:{z:0,x:0,y:0},origin:new Ue.default(0,0),scale:s,dim:a*s});else if(i<=this.levelDiff+this.maxDataLevel){let c=1<<this.levelDiff,d=256*n,p=Math.ceil(i)-this.levelDiff,_=Math.floor(t.minX/c/d),v=Math.floor(t.minY/c/d),x=Math.floor(t.maxX/c/d),P=Math.floor(t.maxY/c/d);for(var l=_;l<=x;l++)for(var u=v;u<=P;u++){let S=new Ue.default(l*c*d,u*c*d);r.push({data_tile:{z:p,x:Sn(l,p),y:Sn(u,p)},origin:S,scale:n,dim:a*n})}}else{let c=1<<this.levelDiff;s=(1<<Math.ceil(i)-this.maxDataLevel-this.levelDiff)*n;let d=Math.floor(t.minX/c/256/s),p=Math.floor(t.minY/c/256/s),_=Math.floor(t.maxX/c/256/s),v=Math.floor(t.maxY/c/256/s);for(var l=d;l<=_;l++)for(var u=p;u<=v;u++){let S=new Ue.default(l*c*256*s,u*c*256*s);r.push({data_tile:{z:this.maxDataLevel,x:Sn(l,this.maxDataLevel),y:Sn(u,this.maxDataLevel)},origin:S,scale:s,dim:a*s})}}return r}dataTileForDisplayTile(i){var t,n=1,r=this.tileCache.tileSize,s;if(i.z<this.levelDiff)t={z:0,x:0,y:0},n=1/(1<<this.levelDiff-i.z),s=new Ue.default(0,0),r=r*n;else if(i.z<=this.levelDiff+this.maxDataLevel){let a=1<<this.levelDiff;t={z:i.z-this.levelDiff,x:Math.floor(i.x/a),y:Math.floor(i.y/a)},s=new Ue.default(t.x*a*256,t.y*a*256)}else{n=1<<i.z-this.maxDataLevel-this.levelDiff;let a=1<<this.levelDiff;t={z:this.maxDataLevel,x:Math.floor(i.x/a/n),y:Math.floor(i.y/a/n)},s=new Ue.default(t.x*a*n*256,t.y*a*n*256),r=r*n}return{data_tile:t,scale:n,origin:s,dim:r}}getBbox(i,t){return ri(this,null,function*(){let n=this.dataTilesForBounds(i,t);return(yield Promise.all(n.map(s=>this.tileCache.get(s.data_tile)))).map((s,a)=>{let l=n[a];return{data:s,z:i,data_tile:l.data_tile,scale:l.scale,dim:l.dim,origin:l.origin}})})}getDisplayTile(i){return ri(this,null,function*(){let t=this.dataTileForDisplayTile(i);return{data:yield this.tileCache.get(t.data_tile),z:i.z,data_tile:t.data_tile,scale:t.scale,origin:t.origin,dim:t.dim}})}queryFeatures(i,t,n){let r=Math.round(n),s=Math.min(r-this.levelDiff,this.maxDataLevel),a=16/(1<<r-s);return this.tileCache.queryFeatures(i,t,s,a)}},Xd=i=>{let t=r=>{let s=r.levelDiff===void 0?2:r.levelDiff,a=r.maxDataZoom||14,l;typeof r.url=="string"?r.url.endsWith(".pmtiles")?l=new aa(r.url,!0):l=new Dd(r.url,!0):l=new aa(r.url,!0);let u=new Zd(l,256*1<<s);return new Yd(u,a,s)},n=new Map;if(i.sources)for(const r in i.sources)n.set(r,t(i.sources[r]));else n.set("",t(i));return n},$d=Xt(pe());function Ud(i,t,n,r,s,a,l,u,c){let d=performance.now();i.save(),i.miterLimit=2;for(var p of s){if(p.minzoom&&t<p.minzoom||p.maxzoom&&t>p.maxzoom)continue;let P=n.get(p.dataSource||"");if(P)for(let S of P){var _=S.data.get(p.dataLayer);if(_===void 0)continue;p.symbolizer.before&&p.symbolizer.before(i,S.z);let D=S.origin;S.dim;let k=S.scale;i.save(),i.translate(D.x-l.x,D.y-l.y);for(var v of _){let g=v.geom,y=v.bbox;y.maxX*k+D.x<a.minX||y.minX*k+D.x>a.maxX||y.minY*k+D.y>a.maxY||y.maxY*k+D.y<a.minY||p.filter&&!p.filter(S.z,v)||(k!=1&&(g=jh(g,k,new $d.default(0,0))),p.symbolizer.draw(i,g,S.z,v))}i.restore()}}if(r){let P=r.searchBbox(a,1/0);for(var x of P)if(i.save(),i.translate(x.anchor.x-l.x,x.anchor.y-l.y),x.draw(i),i.restore(),c){i.lineWidth=.5,i.strokeStyle=c,i.fillStyle=c,i.globalAlpha=1,i.fillRect(x.anchor.x-l.x-2,x.anchor.y-l.y-2,4,4);for(let S of x.bboxes)i.strokeRect(S.minX-l.x,S.minY-l.y,S.maxX-S.minX,S.maxY-S.minY)}}return i.restore(),performance.now()-d}var jd=Xt(pe()),Wd=Xt(Xf()),Vd=(i,t,n)=>{let r=256,s=t/r,a=Math.floor(n.minX/r),l=Math.floor(n.minY/r),u=Math.floor(n.maxX/r),c=Math.floor(n.maxY/r),d=Math.log2(s),p=[];for(let _=a;_<=u;_++){let v=_%(1<<i);for(let x=l;x<=c;x++)p.push({display:Te({z:i,x:v,y:x}),key:Te({z:i-d,x:Math.floor(v/s),y:Math.floor(x/s)})})}return p},Hd=class{constructor(i,t){this.tree=new Wd.default,this.current=new Map,this.dim=i,this.maxLabeledTiles=t}hasPrefix(i){for(let t of this.current.keys())if(t.startsWith(i))return!0;return!1}has(i){return this.current.has(i)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(i,t){let n=new Set;for(let r of this.tree.search(i))r.indexed_label.order<=t&&n.add(r.indexed_label);return n}searchLabel(i,t){let n=new Set;for(let r of i.bboxes)for(let s of this.tree.search(r))s.indexed_label.order<=t&&n.add(s.indexed_label);return n}bboxCollides(i,t){for(let n of this.tree.search(i))if(n.indexed_label.order<=t)return!0;return!1}labelCollides(i,t){for(let n of i.bboxes)for(let r of this.tree.search(n))if(r.indexed_label.order<=t)return!0;return!1}deduplicationCollides(i){if(!i.deduplicationKey||!i.deduplicationDistance)return!1;let t=i.deduplicationDistance,n={minX:i.anchor.x-t,minY:i.anchor.y-t,maxX:i.anchor.x+t,maxY:i.anchor.y+t};for(let r of this.tree.search(n))if(r.indexed_label.deduplicationKey===i.deduplicationKey&&r.indexed_label.anchor.dist(i.anchor)<t)return!0;return!1}makeEntry(i){this.current.get(i)&&console.log("consistency error 1");let t=new Set;this.current.set(i,t)}insert(i,t,n){let r={anchor:i.anchor,bboxes:i.bboxes,draw:i.draw,order:t,tileKey:n,deduplicationKey:i.deduplicationKey,deduplicationDistance:i.deduplicationDistance},s=this.current.get(n);if(!s){let p=new Set;this.current.set(n,p),s=p}s.add(r);var a=!1,l=!1;for(let p of i.bboxes){var u=p;u.indexed_label=r,this.tree.insert(u),p.minX<0&&(a=!0),p.maxX>this.dim&&(l=!0)}if(a||l){var c=a?this.dim:-this.dim,d=[];for(let v of i.bboxes)d.push({minX:v.minX+c,minY:v.minY,maxX:v.maxX+c,maxY:v.maxY});let p={anchor:new jd.default(i.anchor.x+c,i.anchor.y),bboxes:d,draw:i.draw,order:t,tileKey:n},_=this.current.get(n);_&&_.add(p);for(let v of d){var u=v;u.indexed_label=p,this.tree.insert(u)}}}pruneOrNoop(i){let t=i.split(":"),n,r=0,s=0;for(var a of this.current.keys()){let l=a.split(":");if(l[3]===t[3]){s++;let u=Math.sqrt(Math.pow(+l[0]-+t[0],2)+Math.pow(+l[1]-+t[1],2));u>r&&(r=u,n=a)}n&&s>this.maxLabeledTiles&&this.pruneKey(n)}}pruneKey(i){let t=this.current.get(i);if(!t)return;let n=[];for(let r of this.tree.all())t.has(r.indexed_label)&&n.push(r);n.forEach(r=>{this.tree.remove(r)}),this.current.delete(i)}removeLabel(i){let t=[];for(let r of this.tree.all())i==r.indexed_label&&t.push(r);t.forEach(r=>{this.tree.remove(r)});let n=this.current.get(i.tileKey);n&&n.delete(i)}},Gd=class{constructor(i,t,n,r,s){this.index=new Hd(256*1<<i,r),this.z=i,this.scratch=t,this.labelRules=n,this.callback=s}layout(i){let t=performance.now(),n=new Set;for(let[l,u]of i)for(let c of u){let d=Te(c.data_tile)+":"+l;this.index.has(d)||(this.index.makeEntry(d),n.add(d))}let r=new Set;for(let[l,u]of this.labelRules.entries()){if(u.visible==!1||u.minzoom&&this.z<u.minzoom||u.maxzoom&&this.z>u.maxzoom)continue;let c=u.dataSource||"",d=i.get(c);if(d)for(let p of d){let _=Te(p.data_tile)+":"+c;if(!n.has(_))continue;let v=p.data.get(u.dataLayer);if(v===void 0)continue;let x=v;u.sort&&x.sort((S,D)=>u.sort?u.sort(S.props,D.props):0);let P={index:this.index,zoom:this.z,scratch:this.scratch,order:l,overzoom:this.z-p.data_tile.z};for(let S of x){if(u.filter&&!u.filter(this.z,S))continue;let D=jh(S.geom,p.scale,p.origin),k=u.symbolizer.place(P,D,S);if(k)for(let g of k){var s=!1;if(!(g.deduplicationKey&&this.index.deduplicationCollides(g))){if(this.index.labelCollides(g,1/0)){if(!this.index.labelCollides(g,l)){let y=this.index.searchLabel(g,1/0);for(let M of y){this.index.removeLabel(M);for(let E of M.bboxes)this.findInvalidatedTiles(r,p.dim,E,_)}this.index.insert(g,l,_),s=!0}}else this.index.insert(g,l,_),s=!0;if(s)for(let y of g.bboxes)(y.maxX>p.origin.x+p.dim||y.minX<p.origin.x||y.minY<p.origin.y||y.maxY>p.origin.y+p.dim)&&this.findInvalidatedTiles(r,p.dim,y,_)}}}}}for(var a of n)this.index.pruneOrNoop(a);return r.size>0&&this.callback&&this.callback(r),performance.now()-t}findInvalidatedTiles(i,t,n,r){let s=Vd(this.z,t,n);for(let a of s)a.key!=r&&this.index.hasPrefix(a.key)&&i.add(a.display)}add(i){var t=!0;for(let[n,r]of i)for(let s of r)this.index.has(Te(s.data_tile)+":"+n)||(t=!1);return t?0:this.layout(i)}},ua=class{constructor(i,t,n,r){this.labelers=new Map,this.scratch=i,this.labelRules=t,this.maxLabeledTiles=n,this.callback=r}add(i,t){var n=this.labelers.get(i);return n||(n=new Gd(i,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(i,n)),n.add(t)}getIndex(i){let t=this.labelers.get(i);if(t)return t.index}},ca={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"},fa={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function Ri(i,t,n){return Math.min(Math.max(i,n),t)}var ki=class extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}};function qd(i){if(typeof i!="string")throw new ki(i);if(i.trim().toLowerCase()==="transparent")return[0,0,0,0];let t=i.trim();t=ip.test(i)?function(l){const u=l.toLowerCase().trim(),c=Jd[function(d){let p=5381,_=d.length;for(;_;)p=33*p^d.charCodeAt(--_);return(p>>>0)%2341}(u)];if(!c)throw new ki(l);return`#${c}`}(i):i;const n=Kd.exec(t);if(n){const l=Array.from(n).slice(1);return[...l.slice(0,3).map(u=>parseInt(Wi(u,2),16)),parseInt(Wi(l[3]||"f",2),16)/255]}const r=Qd.exec(t);if(r){const l=Array.from(r).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,16)),parseInt(l[3]||"ff",16)/255]}const s=tp.exec(t);if(s){const l=Array.from(s).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,10)),parseFloat(l[3]||"1")]}const a=ep.exec(t);if(a){const[l,u,c,d]=Array.from(a).slice(1).map(parseFloat);if(Ri(0,100,u)!==u)throw new ki(i);if(Ri(0,100,c)!==c)throw new ki(i);return[...np(l,u,c),d||1]}throw new ki(i)}var da=i=>parseInt(i.replace(/_/g,""),36),Jd="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((i,t)=>{const n=da(t.substring(0,3)),r=da(t.substring(3)).toString(16);let s="";for(let a=0;a<6-r.length;a++)s+="0";return i[n]=`${s}${r}`,i},{}),Wi=(i,t)=>Array.from(Array(t)).map(()=>i).join(""),Kd=new RegExp(`^#${Wi("([a-f0-9])",3)}([a-f0-9])?$`,"i"),Qd=new RegExp(`^#${Wi("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),tp=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${Wi(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),ep=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ip=/^[a-z]+$/i,pa=i=>Math.round(255*i),np=(i,t,n)=>{let r=n/100;if(t===0)return[r,r,r].map(pa);const s=(i%360+360)%360/60,a=(1-Math.abs(2*r-1))*(t/100),l=a*(1-Math.abs(s%2-1));let u=0,c=0,d=0;s>=0&&s<1?(u=a,c=l):s>=1&&s<2?(u=l,c=a):s>=2&&s<3?(c=a,d=l):s>=3&&s<4?(c=l,d=a):s>=4&&s<5?(u=l,d=a):s>=5&&s<6&&(u=a,d=l);const p=r-a/2;return[u+p,c+p,d+p].map(pa)};function ma(i){const[t,n,r,s]=qd(i).map((d,p)=>p===3?d:d/255),a=Math.max(t,n,r),l=Math.min(t,n,r),u=(a+l)/2;if(a===l)return[0,0,u,s];const c=a-l;return[60*(t===a?(n-r)/c+(n<r?6:0):n===a?(r-t)/c+2:(t-n)/c+4),u>.5?c/(2-a-l):c/(a+l),u,s]}function rp(i,t,n,r){return`hsla(${(i%360).toFixed()}, ${Ri(0,100,100*t).toFixed()}%, ${Ri(0,100,100*n).toFixed()}%, ${parseFloat(Ri(0,1,r).toFixed(3))})`}var Kt=Xt(pe());Xt($f());var op=Xt(jf()),Ft=class{constructor(i,t){this.str=i??t,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(i,t){return typeof this.str=="function"?this.str(i,t):this.str}},_t=class{constructor(i,t=1){this.value=i??t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,t){return typeof this.value=="function"?this.value(i,t):this.value}},xo=class{constructor(i){var t;this.label_props=(t=i==null?void 0:i.label_props)!=null?t:["name"],this.textTransform=i==null?void 0:i.textTransform}get(i,t){let n,r;typeof this.label_props=="function"?r=this.label_props(i,t):r=this.label_props;for(let a of r)if(t.props.hasOwnProperty(a)&&typeof t.props[a]=="string"){n=t.props[a];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(i,t):s=this.textTransform,n&&s==="uppercase"?n=n.toUpperCase():n&&s==="lowercase"?n=n.toLowerCase():n&&s==="capitalize"&&(n=n.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),n}},bo=class{constructor(i){var t,n;i!=null&&i.font?this.font=i.font:(this.family=(t=i==null?void 0:i.fontFamily)!=null?t:"sans-serif",this.size=(n=i==null?void 0:i.fontSize)!=null?n:12,this.weight=i==null?void 0:i.fontWeight,this.style=i==null?void 0:i.fontStyle)}get(i,t){if(this.font)return typeof this.font=="function"?this.font(i,t):this.font;var n="";this.style&&(typeof this.style=="function"?n=this.style(i,t)+" ":n=this.style+" ");var r="";this.weight&&(typeof this.weight=="function"?r=this.weight(i,t)+" ":r=this.weight+" ");var s;typeof this.size=="function"?s=this.size(i,t):s=this.size;var a;return typeof this.family=="function"?a=this.family(i,t):a=this.family,`${n}${r}${s}px ${a}`}},sp=class{constructor(i,t=[]){this.value=i??t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,t){return typeof this.value=="function"?this.value(i,t):this.value}},_a=Xt(pe()),ap=(i,t,n)=>{var r=[],s,a,l,u=0,c=0,d=0,p=0,_=0,v=0,x=0,P=0,S=0,D=0,k=0,g=0;if(i.length<2)return[];if(i.length===2)return d=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),[{length:d,beginIndex:0,beginDistance:0,endIndex:2,endDistance:d}];for(p=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),u=1,c=i.length-1;u<c;u++)s=i[u-1],a=i[u],l=i[u+1],v=a.x-s.x,x=a.y-s.y,P=l.x-a.x,S=l.y-a.y,_=Math.sqrt(P*P+S*S),d+=p,D=Math.acos((v*P+x*S)/(p*_)),(D>t||d-g>n)&&(r.push({length:d-g,beginDistance:g,beginIndex:k,endIndex:u+1,endDistance:d}),k=u,g=d),p=_;return u-k>0&&r.push({length:d-g+_,beginIndex:k,beginDistance:g,endIndex:u+1,endDistance:d+_}),r};function hp(i,t,n,r){let s=[];for(let l of i){let u=ap(l,Math.PI/45,t);for(let c of u)if(c.length>=t+r){let d=new _a.default(l[c.beginIndex].x,l[c.beginIndex].y),p=l[c.endIndex-1],_=new _a.default((p.x-d.x)/c.length,(p.y-d.y)/c.length);for(var a=r;a<c.length-t;a+=n)s.push({start:d.add(_.mult(a)),end:d.add(_.mult(a+t))})}}return s}function lp(i,t,n,r){let s=t.x-i.x,a=t.y-i.y,l=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),u=[];for(var c=0;c<n+r;c+=2*r){let d=c*1/l;u.push({x:i.x+d*s,y:i.y+d*a})}return u}function Wh(i,t){if(i.length<=t)return[i];let n=t-1,r=i.lastIndexOf(" ",n),s=i.indexOf(" ",n);if(r==-1&&s==-1)return[i];let a,l;return s==-1||r>=0&&n-r<s-n?(a=i.substring(0,r),l=i.substring(r+1,i.length)):(a=i.substring(0,s),l=i.substring(s+1,i.length)),[a,...Wh(l,t)]}var Vh=5400,ga;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(ga||(ga={}));var va;(function(i){i[i.N=1]="N",i[i.NE=2]="NE",i[i.E=3]="E",i[i.SE=4]="SE",i[i.S=5]="S",i[i.SW=6]="SW",i[i.W=7]="W",i[i.NW=8]="NW"})(va||(va={}));var kt=class{constructor(i){var t;this.pattern=i.pattern,this.fill=new Ft(i.fill,"black"),this.opacity=new _t(i.opacity,1),this.stroke=new Ft(i.stroke,"black"),this.width=new _t(i.width,0),this.per_feature=(t=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||i.per_feature)!=null?t:!1,this.do_stroke=!1}before(i,t){if(!this.per_feature){i.globalAlpha=this.opacity.get(t),i.fillStyle=this.fill.get(t),i.strokeStyle=this.stroke.get(t);let n=this.width.get(t);n>0&&(this.do_stroke=!0),i.lineWidth=n}if(this.pattern){const n=i.createPattern(this.pattern,"repeat");n&&(i.fillStyle=n)}}draw(i,t,n,r){var s=!1;if(this.per_feature){i.globalAlpha=this.opacity.get(n,r),i.fillStyle=this.fill.get(n,r);var a=this.width.get(n,r);a&&(s=!0,i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a)}let l=()=>{i.fill(),(s||this.do_stroke)&&i.stroke()};var u=0;i.beginPath();for(var c of t){u+c.length>Vh&&(l(),u=0,i.beginPath());for(var d=0;d<c.length;d++){let p=c[d];d==0?i.moveTo(p.x,p.y):i.lineTo(p.x,p.y)}u+=c.length}u>0&&l()}};function up(i,t){let n=0;for(;t[n+1][0]<i;)n++;return n}function cp(i,t,n){return i*(n-t)+t}function fp(i,t,n,r){const s=r[t+1][0]-r[t][0],a=i-r[t][0];return s===0?0:(Math.pow(n,a)-1)/(Math.pow(n,s)-1)}function ge(i,t){return n=>{if(t.length<1)return 0;if(n<=t[0][0])return t[0][1];if(n>=t[t.length-1][0])return t[t.length-1][1];const r=up(n,t),s=fp(n,r,i,t);return cp(s,t[r][1],t[r+1][1])}}var re=class{constructor(i){var t;this.color=new Ft(i.color,"black"),this.width=new _t(i.width),this.opacity=new _t(i.opacity),this.dash=i.dash?new sp(i.dash):null,this.dashColor=new Ft(i.dashColor,"black"),this.dashWidth=new _t(i.dashWidth,1),this.lineCap=new Ft(i.lineCap,"butt"),this.lineJoin=new Ft(i.lineJoin,"miter"),this.skip=!1,this.per_feature=!!((t=this.dash)!=null&&t.per_feature||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||i.per_feature)}before(i,t){this.per_feature||(i.strokeStyle=this.color.get(t),i.lineWidth=this.width.get(t),i.globalAlpha=this.opacity.get(t),i.lineCap=this.lineCap.get(t),i.lineJoin=this.lineJoin.get(t))}draw(i,t,n,r){if(this.skip)return;let s=()=>{this.per_feature&&(i.globalAlpha=this.opacity.get(n,r),i.lineCap=this.lineCap.get(n,r),i.lineJoin=this.lineJoin.get(n,r)),this.dash?(i.save(),this.per_feature?(i.lineWidth=this.dashWidth.get(n,r),i.strokeStyle=this.dashColor.get(n,r),i.setLineDash(this.dash.get(n,r))):i.setLineDash(this.dash.get(n)),i.stroke(),i.restore()):(i.save(),this.per_feature&&(i.lineWidth=this.width.get(n,r),i.strokeStyle=this.color.get(n,r)),i.stroke(),i.restore())};var a=0;i.beginPath();for(var l of t){a+l.length>Vh&&(s(),a=0,i.beginPath());for(var u=0;u<l.length;u++){let c=l[u];u==0?i.moveTo(c.x,c.y):i.lineTo(c.x,c.y)}a+=l.length}a>0&&s()}},io=class{constructor(i){this.radius=new _t(i.radius,3),this.fill=new Ft(i.fill,"black"),this.stroke=new Ft(i.stroke,"white"),this.width=new _t(i.width,0),this.opacity=new _t(i.opacity)}draw(i,t,n,r){i.globalAlpha=this.opacity.get(n,r);let s=this.radius.get(n,r),a=this.width.get(n,r);a>0&&(i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a,i.beginPath(),i.arc(t[0][0].x,t[0][0].y,s+a/2,0,2*Math.PI),i.stroke()),i.fillStyle=this.fill.get(n,r),i.beginPath(),i.arc(t[0][0].x,t[0][0].y,s,0,2*Math.PI),i.fill()}place(i,t,n){t[0];let r=new Kt.default(t[0][0].x,t[0][0].y),s=this.radius.get(i.zoom,n),a={minX:r.x-s,minY:r.y-s,maxX:r.x+s,maxY:r.y+s};return[{anchor:r,bboxes:[a],draw:u=>{this.draw(u,[[new Kt.default(0,0)]],i.zoom,n)}}]}},dp=class{constructor(i){this.font=new bo(i),this.text=new xo(i),this.fill=new Ft(i.fill,"black"),this.background=new Ft(i.background,"white"),this.padding=new _t(i.padding,0)}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=i.scratch.measureText(r),l=a.width,u=a.actualBoundingBoxAscent,c=a.actualBoundingBoxDescent;t[0];let d=new Kt.default(t[0][0].x,t[0][0].y),p=this.padding.get(i.zoom,n),_={minX:d.x-l/2-p,minY:d.y-u-p,maxX:d.x+l/2+p,maxY:d.y+c+p};return[{anchor:d,bboxes:[_],draw:x=>{x.globalAlpha=1,x.fillStyle=this.background.get(i.zoom,n),x.fillRect(-l/2-p,-u-p,l+2*p,u+c+2*p),x.fillStyle=this.fill.get(i.zoom,n),x.font=s,x.fillText(r,-l/2,0)}}]}},ya=class{constructor(i){this.list=i}place(i,t,n){var r=this.list[0].place(i,t,n);if(!r)return;var s=r[0];let a=s.anchor,l=s.bboxes[0],u=l.maxY-l.minY,c=[{draw:s.draw,translate:{x:0,y:0}}],d=[[new Kt.default(t[0][0].x,t[0][0].y+u)]];for(let _=1;_<this.list.length;_++)r=this.list[_].place(i,d,n),r&&(s=r[0],l=Hh(l,s.bboxes[0]),c.push({draw:s.draw,translate:{x:0,y:u}}));return[{anchor:a,bboxes:[l],draw:_=>{for(let v of c)_.save(),_.translate(v.translate.x,v.translate.y),v.draw(_),_.restore()}}]}},Hh=(i,t)=>({minX:Math.min(i.minX,t.minX),minY:Math.min(i.minY,t.minY),maxX:Math.max(i.maxX,t.maxX),maxY:Math.max(i.maxY,t.maxY)}),wa=class{constructor(i){this.list=i}place(i,t,n){let r=this.list[0];if(!r)return;var s=r.place(i,t,n);if(!s)return;var a=s[0];let l=a.anchor,u=a.bboxes[0],c=[a.draw];for(let p=1;p<this.list.length;p++){if(s=this.list[p].place(i,t,n),!s)return;a=s[0],u=Hh(u,a.bboxes[0]),c.push(a.draw)}return[{anchor:l,bboxes:[u],draw:p=>{c.forEach(_=>_(p))}}]}},pp=class{constructor(i){this.symbolizer=i}place(i,t,n){let r=t[0][0],s=this.symbolizer.place(i,[[new Kt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=l.maxX-l.minX,c=l.maxY-l.minY,d={minX:r.x-u/2,maxX:r.x+u/2,minY:r.y-c/2,maxY:r.y+c/2};return[{anchor:r,bboxes:[d],draw:_=>{_.translate(-u/2,c/2-l.maxY),a.draw(_,{justify:2})}}]}},Mo=class{constructor(i){this.font=new bo(i),this.text=new xo(i),this.fill=new Ft(i.fill,"black"),this.stroke=new Ft(i.stroke,"black"),this.width=new _t(i.width,0),this.lineHeight=new _t(i.lineHeight,1),this.letterSpacing=new _t(i.letterSpacing,0),this.maxLineCodeUnits=new _t(i.maxLineChars,15),this.justify=i.justify}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=this.letterSpacing.get(i.zoom,n),l=Wh(r,this.maxLineCodeUnits.get(i.zoom,n));var u="",c=0;for(let k of l)k.length>c&&(c=k.length,u=k);let d=i.scratch.measureText(u),p=d.width+a*(c-1),_=d.actualBoundingBoxAscent,v=d.actualBoundingBoxDescent,x=(_+v)*this.lineHeight.get(i.zoom,n),P=new Kt.default(t[0][0].x,t[0][0].y),S={minX:P.x,minY:P.y-_,maxX:P.x+p,maxY:P.y+v+(l.length-1)*x};return[{anchor:P,bboxes:[S],draw:(k,g)=>{k.globalAlpha=1,k.font=s,k.fillStyle=this.fill.get(i.zoom,n);let y=this.width.get(i.zoom,n);var M=0;for(let A of l){var E=0;if(this.justify==2||g&&g.justify==2?E=(p-k.measureText(A).width)/2:(this.justify==3||g&&g.justify==3)&&(E=p-k.measureText(A).width),y)if(k.lineWidth=y*2,k.strokeStyle=this.stroke.get(i.zoom,n),a>0){var B=E;for(var C of A)k.strokeText(C,B,M),B+=k.measureText(C).width+a}else k.strokeText(A,E,M);if(a>0){var B=E;for(var C of A)k.fillText(C,B,M),B+=k.measureText(C).width+a}else k.fillText(A,E,M);M+=x}}}]}},Ci=class{constructor(i){this.centered=new pp(new Mo(i))}place(i,t,n){return this.centered.place(i,t,n)}},mp=class{constructor(i,t){var n,r,s;this.symbolizer=i,this.offsetX=new _t(t.offsetX,0),this.offsetY=new _t(t.offsetY,0),this.justify=(n=t.justify)!=null?n:void 0,this.placements=(r=t.placements)!=null?r:[2,6,8,4,1,3,5,7],this.ddValues=(s=t.ddValues)!=null?s:()=>({})}place(i,t,n){if(n.geomType!==Qe.Point)return;let r=t[0][0],s=this.symbolizer.place(i,[[new Kt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=this.offsetX,c=this.offsetY,d=this.justify,p=this.placements;const{offsetX:_,offsetY:v,justify:x,placements:P}=this.ddValues(i.zoom,n)||{};_&&(u=new _t(_,0)),v&&(c=new _t(v,0)),x&&(d=x),P&&(p=P);const S=u.get(i.zoom,n),D=c.get(i.zoom,n);let k=(B,C)=>({minX:B.x+C.x+l.minX,minY:B.y+C.y+l.minY,maxX:B.x+C.x+l.maxX,maxY:B.y+C.y+l.maxY});var g=new Kt.default(S,D),y;let M=B=>{B.translate(g.x,g.y),a.draw(B,{justify:y})};const E=(B,C)=>{const A=k(B,C);if(!i.index.bboxCollides(A,i.order))return[{anchor:r,bboxes:[A],draw:M}]};for(let B of p){const C=this.computeXAxisOffset(S,l,B),A=this.computeYAxisOffset(D,l,B);return y=this.computeJustify(d,B),g=new Kt.default(C,A),E(r,g)}}computeXAxisOffset(i,t,n){const r=t.maxX,s=r/2;return[1,5].includes(n)?i-s:[8,7,6].includes(n)?i-r:i}computeYAxisOffset(i,t,n){const r=Math.abs(t.minY),s=t.maxY,a=(t.minY+t.maxY)/2;return[3,7].includes(n)?i-a:[8,2,1].includes(n)?i-s:[6,4,5].includes(n)?i+r:i}computeJustify(i,t){return i||([1,5].includes(t)?2:[2,3,4].includes(t)?1:3)}},kn=class{constructor(i){this.symbolizer=new mp(new Mo(i),i)}place(i,t,n){return this.symbolizer.place(i,t,n)}},xa;(function(i){i[i.Above=1]="Above",i[i.Center=2]="Center",i[i.Below=3]="Below"})(xa||(xa={}));var _p=class{constructor(i){var t;this.font=new bo(i),this.text=new xo(i),this.fill=new Ft(i.fill,"black"),this.stroke=new Ft(i.stroke,"black"),this.width=new _t(i.width,0),this.offset=new _t(i.offset,0),this.position=(t=i.position)!=null?t:1,this.maxLabelCodeUnits=new _t(i.maxLabelChars,40),this.repeatDistance=new _t(i.repeatDistance,250)}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r||r.length>this.maxLabelCodeUnits.get(i.zoom,n))return;let s=20,a=n.bbox;if(a.maxY-a.minY<s&&a.maxX-a.minX<s)return;let l=this.font.get(i.zoom,n);i.scratch.font=l;let u=i.scratch.measureText(r),c=u.width,d=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent;var p=this.repeatDistance.get(i.zoom,n);i.overzoom>4&&(p*=1<<i.overzoom-4);let _=d*2,v=hp(t,c,p,_);if(v.length==0)return;let x=[];for(let P of v){let S=P.end.x-P.start.x,D=P.end.y-P.start.y,g=lp(P.start,P.end,c,_/2).map(M=>({minX:M.x-_/2,minY:M.y-_/2,maxX:M.x+_/2,maxY:M.y+_/2})),y=M=>{M.globalAlpha=1,M.rotate(Math.atan2(D,S)),S<0&&(M.scale(-1,-1),M.translate(-c,0));let E=0;this.position===3?E+=d:this.position===2&&(E+=d/2),M.translate(0,E-this.offset.get(i.zoom,n)),M.font=l;let B=this.width.get(i.zoom,n);B&&(M.lineWidth=B,M.strokeStyle=this.stroke.get(i.zoom,n),M.strokeText(r,0,0)),M.fillStyle=this.fill.get(i.zoom,n),M.fillText(r,0,0)};x.push({anchor:P.start,bboxes:g,draw:y,deduplicationKey:r,deduplicationDistance:p})}return x}},Nr=class{constructor(i){this.symbolizer=new Mo(i)}place(i,t,n){let r=n.bbox;if((r.maxY-r.minY)*(r.maxX-r.minX)<2e4)return;let a=this.symbolizer.place(i,[[new Kt.default(0,0)]],n);if(!a||a.length==0)return;let l=a[0],u=l.bboxes[0],c=t[0],d=(0,op.default)([c.map(x=>[x.x,x.y])]),p=new Kt.default(d[0],d[1]),_={minX:p.x-(u.maxX-u.minX)/2,minY:p.y-(u.maxY-u.minY)/2,maxX:p.x+(u.maxX-u.minX)/2,maxY:p.y+(u.maxY-u.minY)/2};return[{anchor:p,bboxes:[_],draw:x=>{x.translate(l.anchor.x-(u.maxX-u.minX)/2,l.anchor.y),l.draw(x)}}]}},Gh=(i,t)=>{let n=ma(t),r=Of({},i);for(const[s,a]of Object.entries(i)){let l=ma(a);r[s]=rp(n[0],n[1],l[2],l[3])}return r},ba=(i,t)=>(t&&(i=Gh(i,t)),[{dataLayer:"earth",symbolizer:new kt({fill:i.earth})},{dataLayer:"natural",symbolizer:new kt({fill:i.glacier}),filter:(n,r)=>r.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new kt({fill:i.residential}),filter:(n,r)=>r.props.landuse=="residential"||r.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new kt({fill:i.hospital}),filter:(n,r)=>r.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new kt({fill:i.cemetery}),filter:(n,r)=>r.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new kt({fill:i.school}),filter:(n,r)=>r.props.amenity=="school"||r.props.amenity=="kindergarten"||r.props.amenity=="university"||r.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new kt({fill:i.industrial}),filter:(n,r)=>r.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new kt({fill:i.wood}),filter:(n,r)=>r.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new kt({fill:i.grass}),filter:(n,r)=>r.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new kt({fill:i.park}),filter:(n,r)=>r.props.leisure=="park"},{dataLayer:"water",symbolizer:new kt({fill:i.water})},{dataLayer:"natural",symbolizer:new kt({fill:i.sand}),filter:(n,r)=>r.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new kt({fill:i.buildings})},{dataLayer:"roads",symbolizer:new re({color:i.highwayCasing,width:ge(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new re({color:i.majorRoadCasing,width:ge(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:i.mediumRoadCasing,width:ge(1.4,[[13,3],[17,6],[20,18]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:i.minorRoadCasing,width:ge(1.4,[[14,2],[17,5],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:i.minorRoad,width:ge(1.4,[[14,1],[17,3],[20,13]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:i.mediumRoad,width:ge(1.4,[[13,2],[17,4],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:i.majorRoad,width:ge(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:i.highway,width:ge(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new re({color:i.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new kt({fill:i.mask})}]),Ma=(i,t,n,r)=>{t&&(i=Gh(i,t));var s=["name"];n&&(s=n);let a=(l,u)=>r?l instanceof kn?new ya([l,new kn({fill:u,label_props:r})]):new ya([l,new Ci({fill:u,label_props:r})]):l;return[{dataLayer:"places",symbolizer:a(new Ci({label_props:s,fill:i.countryLabel,lineHeight:1.5,font:(l,u)=>l<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),i.countryLabel),filter:(l,u)=>u.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:a(new Ci({label_props:s,fill:i.stateLabel,font:"300 16px sans-serif"}),i.stateLabel),filter:(l,u)=>u.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",minzoom:7,symbolizer:a(new Ci({label_props:s,fill:i.cityLabel,font:(l,u)=>(u==null?void 0:u.props["pmap:rank"])===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new wa([new io({radius:2,fill:i.cityLabel}),a(new kn({label_props:s,fill:i.cityLabel,offsetX:2,offsetY:2,font:(l,u)=>(u==null?void 0:u.props["pmap:rank"])===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel)]),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new Ci({label_props:s,fill:i.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),i.neighbourhoodLabel),filter:(l,u)=>u.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new Nr({label_props:s,fill:i.landuseLabel,font:"300 12px sans-serif"}),i.landuseLabel)},{dataLayer:"water",symbolizer:a(new Nr({label_props:s,fill:i.waterLabel,font:"italic 600 12px sans-serif"}),i.waterLabel)},{dataLayer:"natural",symbolizer:a(new Nr({label_props:s,fill:i.naturalLabel,font:"italic 300 12px sans-serif"}),i.naturalLabel)},{dataLayer:"roads",symbolizer:a(new _p({label_props:s,fill:i.roadsLabel,font:"500 12px sans-serif"}),i.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new dp({label_props:["ref"],font:"600 9px sans-serif",background:i.highway,padding:2,fill:i.neighbourhoodLabel}),filter:(l,u)=>u.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new wa([new io({radius:2,fill:i.poisLabel}),a(new kn({label_props:s,fill:i.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),i.poisLabel)])}]},Pa=(i,t,n)=>[{dataSource:i,dataLayer:t,symbolizer:new io({opacity:.2,fill:n,radius:4}),filter:(r,s)=>s.geomType==Qe.Point},{dataSource:i,dataLayer:t,symbolizer:new re({opacity:.2,color:n,width:2}),filter:(r,s)=>s.geomType==Qe.Line},{dataSource:i,dataLayer:t,symbolizer:new kt({opacity:.2,fill:n,stroke:n,width:1}),filter:(r,s)=>s.geomType==Qe.Polygon}],gp=(i,t)=>{var n=[];for(var[r,s]of i)for(var a of s)for(var l of a.data.keys())r===t.dataSource&&l===t.dataLayer||(n=n.concat(Pa(r,l,"steelblue")));return n=n.concat(Pa(t.dataSource||"",t.dataLayer,"red")),n},vp=Xt(pe()),yp=i=>new Promise((t,n)=>{setTimeout(()=>{t()},i)}),wp=i=>i.then(t=>({status:"fulfilled",value:t}),t=>({status:"rejected",reason:t})),xp=(i={})=>{class t extends L.GridLayer{constructor(r={}){r.noWrap&&!r.bounds&&(r.bounds=[[-90,-180],[90,180]]),r.attribution==null&&(r.attribution='<a href="https://protomaps.com">Protomaps</a>  <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(r);let s=r.dark?fa:ca;this.paint_rules=r.paint_rules||ba(s,r.shade),this.label_rules=r.label_rules||Ma(s,r.shade,r.language1,r.language2),this.backgroundColor=r.backgroundColor,this.lastRequestedZ=void 0,this.xray=r.xray,this.tasks=r.tasks||[],this.views=Xd(r),this.debug=r.debug;let a=document.createElement("canvas").getContext("2d");this.scratch=a,this.onTilesInvalidated=l=>{l.forEach(u=>{this.rerenderTile(u)})},this.labelers=new ua(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=r.tileDelay||3,this.lang=r.lang,this.inspector=this.inspect(this)}setDefaultStyle(r,s,a,l){let u=r?fa:ca;this.paint_rules=ba(u,s),this.label_rules=Ma(u,s,a,l)}renderTile(r,s,a,l=()=>{}){return ri(this,null,function*(){this.lastRequestedZ=r.z;let u=[];for(const[C,A]of this.views){let I=A.getDisplayTile(r);u.push({key:C,promise:I})}let c=yield Promise.all(u.map(C=>C.promise.then(A=>({status:"fulfilled",value:A,key:C.key}),A=>({status:"rejected",reason:A,key:C.key})))),d=new Map;for(const C of c)C.status==="fulfilled"?d.set(C.key,[C.value]):C.reason.name==="AbortError"||console.error(C.reason);if(s.key!=a||this.lastRequestedZ!==r.z||(yield Promise.all(this.tasks.map(wp)),s.key!=a)||this.lastRequestedZ!==r.z)return;let p=this.labelers.add(r.z,d);if(s.key!=a||this.lastRequestedZ!==r.z)return;let _=this.labelers.getIndex(r.z);if(!this._map)return;let v=this._map.getCenter().wrap(),x=this._getTiledPixelBounds(v),P=this._pxBoundsToTileRange(x),S=P.getCenter(),D=r.distanceTo(S)*this.tileDelay;if(yield yp(D),s.key!=a||this.lastRequestedZ!==r.z)return;let k=16,g={minX:256*r.x-k,minY:256*r.y-k,maxX:256*(r.x+1)+k,maxY:256*(r.y+1)+k},y=new vp.default(256*r.x,256*r.y);s.width=this.tile_size,s.height=this.tile_size;let M=s.getContext("2d");M.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),M.clearRect(0,0,256,256),this.backgroundColor&&(M.save(),M.fillStyle=this.backgroundColor,M.fillRect(0,0,256,256),M.restore());var E=0;let B=this.paint_rules;if(this.xray&&(B=gp(d,this.xray)),E=Ud(M,r.z,d,this.xray?null:_,B,g,y,!1,this.debug),this.debug){M.save(),M.fillStyle=this.debug,M.font="600 12px sans-serif",M.fillText(r.z+" "+r.x+" "+r.y,4,14),M.font="12px sans-serif";let C=28;for(let[A,I]of d){let Y=I[0].data_tile;M.fillText(A+(A?" ":"")+Y.z+" "+Y.x+" "+Y.y,4,C),C+=14}M.font="600 10px sans-serif",E>8&&(M.fillText(E.toFixed()+" ms paint",4,C),C+=14),p>8&&M.fillText(p.toFixed()+" ms layout",4,C),M.strokeStyle=this.debug,M.lineWidth=.5,M.beginPath(),M.moveTo(0,0),M.lineTo(0,256),M.stroke(),M.lineWidth=.5,M.beginPath(),M.moveTo(0,0),M.lineTo(256,0),M.stroke(),M.restore()}l()})}rerenderTile(r){for(let s in this._tiles){let a=this._wrapCoords(this._keyToTileCoords(s));r===this._tileCoordsToKey(a)&&this.renderTile(a,this._tiles[s].el,r)}}clearLayout(){this.labelers=new ua(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let r in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(r)),a=this._tileCoordsToKey(s);this.renderTile(s,this._tiles[r].el,a)}}createTile(r,s){let a=L.DomUtil.create("canvas","leaflet-tile");a.lang=this.lang;let l=this._tileCoordsToKey(r);return a.key=l,this.renderTile(r,a,l,()=>{s(null,a)}),a}_removeTile(r){let s=this._tiles[r];s&&(s.el.removed=!0,s.el.key=void 0,L.DomUtil.removeClass(s.el,"leaflet-tile-loaded"),s.el.width=s.el.height=0,L.DomUtil.remove(s.el),delete this._tiles[r],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(r)}))}queryFeatures(r,s){let a=new Map;for(var[l,u]of this.views)a.set(l,u.queryFeatures(r,s,this._map.getZoom()));return a}inspect(r){return s=>{let a=["","",""],l=r._map.wrapLatLng(s.latlng),u=r.queryFeatures(l.lng,l.lat);var c="";let d=!0;for(var[p,_]of u)for(var v of _)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===p&&this.xray.dataLayer===v.layerName))){c=c+`<div style="margin-top:${d?0:.5}em">${a[v.feature.geomType-1]} <b>${p} ${p?"/":""} ${v.layerName}</b> ${v.feature.id||""}</div>`;for(const x in v.feature.props)c=c+`<div style="font-size:0.9em">${x} = ${v.feature.props[x]}</div>`;d=!1}d&&(c="No features."),L.popup().setLatLng(s.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+c+"</div>").openOn(r._map)}}addInspector(r){return r.on("click",this.inspector)}removeInspector(r){return r.off("click",this.inspector)}}return new t(i)};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function bp({L:i,id:t,lat:n,lng:r,zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:c}){const d=i.map(t,{center:[n,r],zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:c});return xp({url:"https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf?key=d23c43b7c56e123d"}).addTo(d),d}var no={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(i,t){(function(n,r){r(t)})(co,function(n){var r="1.9.4";function s(e){var o,h,f,m;for(h=1,f=arguments.length;h<f;h++){m=arguments[h];for(o in m)e[o]=m[o]}return e}var a=Object.create||function(){function e(){}return function(o){return e.prototype=o,new e}}();function l(e,o){var h=Array.prototype.slice;if(e.bind)return e.bind.apply(e,h.call(arguments,1));var f=h.call(arguments,2);return function(){return e.apply(o,f.length?f.concat(h.call(arguments)):arguments)}}var u=0;function c(e){return"_leaflet_id"in e||(e._leaflet_id=++u),e._leaflet_id}function d(e,o,h){var f,m,b,T;return T=function(){f=!1,m&&(b.apply(h,m),m=!1)},b=function(){f?m=arguments:(e.apply(h,arguments),setTimeout(T,o),f=!0)},b}function p(e,o,h){var f=o[1],m=o[0],b=f-m;return e===f&&h?e:((e-m)%b+b)%b+m}function _(){return!1}function v(e,o){if(o===!1)return e;var h=Math.pow(10,o===void 0?6:o);return Math.round(e*h)/h}function x(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function P(e){return x(e).split(/\s+/)}function S(e,o){Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?a(e.options):{});for(var h in o)e.options[h]=o[h];return e.options}function D(e,o,h){var f=[];for(var m in e)f.push(encodeURIComponent(h?m.toUpperCase():m)+"="+encodeURIComponent(e[m]));return(!o||o.indexOf("?")===-1?"?":"&")+f.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function g(e,o){return e.replace(k,function(h,f){var m=o[f];if(m===void 0)throw new Error("No value provided for variable "+h);return typeof m=="function"&&(m=m(o)),m})}var y=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function M(e,o){for(var h=0;h<e.length;h++)if(e[h]===o)return h;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function B(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var C=0;function A(e){var o=+new Date,h=Math.max(0,16-(o-C));return C=o+h,window.setTimeout(e,h)}var I=window.requestAnimationFrame||B("RequestAnimationFrame")||A,Y=window.cancelAnimationFrame||B("CancelAnimationFrame")||B("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function $(e,o,h){if(h&&I===A)e.call(o);else return I.call(window,l(e,o))}function j(e){e&&Y.call(window,e)}var X={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:c,throttle:d,wrapNum:p,falseFn:_,formatNum:v,trim:x,splitWords:P,setOptions:S,getParamString:D,template:g,isArray:y,indexOf:M,emptyImageUrl:E,requestFn:I,cancelFn:Y,requestAnimFrame:$,cancelAnimFrame:j};function w(){}w.extend=function(e){var o=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=o.__super__=this.prototype,f=a(h);f.constructor=o,o.prototype=f;for(var m in this)Object.prototype.hasOwnProperty.call(this,m)&&m!=="prototype"&&m!=="__super__"&&(o[m]=this[m]);return e.statics&&s(o,e.statics),e.includes&&(z(e.includes),s.apply(null,[f].concat(e.includes))),s(f,e),delete f.statics,delete f.includes,f.options&&(f.options=h.options?a(h.options):{},s(f.options,e.options)),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var b=0,T=f._initHooks.length;b<T;b++)f._initHooks[b].call(this)}},o},w.include=function(e){var o=this.prototype.options;return s(this.prototype,e),e.options&&(this.prototype.options=o,this.mergeOptions(e.options)),this},w.mergeOptions=function(e){return s(this.prototype.options,e),this},w.addInitHook=function(e){var o=Array.prototype.slice.call(arguments,1),h=typeof e=="function"?e:function(){this[e].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function z(e){if(!(typeof L>"u"||!L||!L.Mixin)){e=y(e)?e:[e];for(var o=0;o<e.length;o++)e[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var O={on:function(e,o,h){if(typeof e=="object")for(var f in e)this._on(f,e[f],o);else{e=P(e);for(var m=0,b=e.length;m<b;m++)this._on(e[m],o,h)}return this},off:function(e,o,h){if(!arguments.length)delete this._events;else if(typeof e=="object")for(var f in e)this._off(f,e[f],o);else{e=P(e);for(var m=arguments.length===1,b=0,T=e.length;b<T;b++)m?this._off(e[b]):this._off(e[b],o,h)}return this},_on:function(e,o,h,f){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(e,o,h)===!1){h===this&&(h=void 0);var m={fn:o,ctx:h};f&&(m.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(m)}},_off:function(e,o,h){var f,m,b;if(this._events&&(f=this._events[e],!!f)){if(arguments.length===1){if(this._firingCount)for(m=0,b=f.length;m<b;m++)f[m].fn=_;delete this._events[e];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var T=this._listens(e,o,h);if(T!==!1){var F=f[T];this._firingCount&&(F.fn=_,this._events[e]=f=f.slice()),f.splice(T,1)}}},fire:function(e,o,h){if(!this.listens(e,h))return this;var f=s({},o,{type:e,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var m=this._events[e];if(m){this._firingCount=this._firingCount+1||1;for(var b=0,T=m.length;b<T;b++){var F=m[b],N=F.fn;F.once&&this.off(e,N,F.ctx),N.call(F.ctx||this,f)}this._firingCount--}}return h&&this._propagateEvent(f),this},listens:function(e,o,h,f){typeof e!="string"&&console.warn('"string" type argument expected');var m=o;typeof o!="function"&&(f=!!o,m=void 0,h=void 0);var b=this._events&&this._events[e];if(b&&b.length&&this._listens(e,m,h)!==!1)return!0;if(f){for(var T in this._eventParents)if(this._eventParents[T].listens(e,o,h,f))return!0}return!1},_listens:function(e,o,h){if(!this._events)return!1;var f=this._events[e]||[];if(!o)return!!f.length;h===this&&(h=void 0);for(var m=0,b=f.length;m<b;m++)if(f[m].fn===o&&f[m].ctx===h)return m;return!1},once:function(e,o,h){if(typeof e=="object")for(var f in e)this._on(f,e[f],o,!0);else{e=P(e);for(var m=0,b=e.length;m<b;m++)this._on(e[m],o,h,!0)}return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[c(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[c(e)],this},_propagateEvent:function(e){for(var o in this._eventParents)this._eventParents[o].fire(e.type,s({layer:e.target,propagatedFrom:e.target},e),!0)}};O.addEventListener=O.on,O.removeEventListener=O.clearAllEventListeners=O.off,O.addOneTimeEventListener=O.once,O.fireEvent=O.fire,O.hasEventListeners=O.listens;var W=w.extend(O);function Z(e,o,h){this.x=h?Math.round(e):e,this.y=h?Math.round(o):o}var J=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(e){return this.clone()._add(R(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(R(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new Z(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new Z(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=J(this.x),this.y=J(this.y),this},distanceTo:function(e){e=R(e);var o=e.x-this.x,h=e.y-this.y;return Math.sqrt(o*o+h*h)},equals:function(e){return e=R(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=R(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function R(e,o,h){return e instanceof Z?e:y(e)?new Z(e[0],e[1]):e==null?e:typeof e=="object"&&"x"in e&&"y"in e?new Z(e.x,e.y):new Z(e,o,h)}function V(e,o){if(e)for(var h=o?[e,o]:e,f=0,m=h.length;f<m;f++)this.extend(h[f])}V.prototype={extend:function(e){var o,h;if(!e)return this;if(e instanceof Z||typeof e[0]=="number"||"x"in e)o=h=R(e);else if(e=H(e),o=e.min,h=e.max,!o||!h)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=h.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(e){return R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return R(this.min.x,this.max.y)},getTopRight:function(){return R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var o,h;return typeof e[0]=="number"||e instanceof Z?e=R(e):e=H(e),e instanceof V?(o=e.min,h=e.max):o=h=e,o.x>=this.min.x&&h.x<=this.max.x&&o.y>=this.min.y&&h.y<=this.max.y},intersects:function(e){e=H(e);var o=this.min,h=this.max,f=e.min,m=e.max,b=m.x>=o.x&&f.x<=h.x,T=m.y>=o.y&&f.y<=h.y;return b&&T},overlaps:function(e){e=H(e);var o=this.min,h=this.max,f=e.min,m=e.max,b=m.x>o.x&&f.x<h.x,T=m.y>o.y&&f.y<h.y;return b&&T},isValid:function(){return!!(this.min&&this.max)},pad:function(e){var o=this.min,h=this.max,f=Math.abs(o.x-h.x)*e,m=Math.abs(o.y-h.y)*e;return H(R(o.x-f,o.y-m),R(h.x+f,h.y+m))},equals:function(e){return e?(e=H(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight())):!1}};function H(e,o){return!e||e instanceof V?e:new V(e,o)}function nt(e,o){if(e)for(var h=o?[e,o]:e,f=0,m=h.length;f<m;f++)this.extend(h[f])}nt.prototype={extend:function(e){var o=this._southWest,h=this._northEast,f,m;if(e instanceof et)f=e,m=e;else if(e instanceof nt){if(f=e._southWest,m=e._northEast,!f||!m)return this}else return e?this.extend(G(e)||Q(e)):this;return!o&&!h?(this._southWest=new et(f.lat,f.lng),this._northEast=new et(m.lat,m.lng)):(o.lat=Math.min(f.lat,o.lat),o.lng=Math.min(f.lng,o.lng),h.lat=Math.max(m.lat,h.lat),h.lng=Math.max(m.lng,h.lng)),this},pad:function(e){var o=this._southWest,h=this._northEast,f=Math.abs(o.lat-h.lat)*e,m=Math.abs(o.lng-h.lng)*e;return new nt(new et(o.lat-f,o.lng-m),new et(h.lat+f,h.lng+m))},getCenter:function(){return new et((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new et(this.getNorth(),this.getWest())},getSouthEast:function(){return new et(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof et||"lat"in e?e=G(e):e=Q(e);var o=this._southWest,h=this._northEast,f,m;return e instanceof nt?(f=e.getSouthWest(),m=e.getNorthEast()):f=m=e,f.lat>=o.lat&&m.lat<=h.lat&&f.lng>=o.lng&&m.lng<=h.lng},intersects:function(e){e=Q(e);var o=this._southWest,h=this._northEast,f=e.getSouthWest(),m=e.getNorthEast(),b=m.lat>=o.lat&&f.lat<=h.lat,T=m.lng>=o.lng&&f.lng<=h.lng;return b&&T},overlaps:function(e){e=Q(e);var o=this._southWest,h=this._northEast,f=e.getSouthWest(),m=e.getNorthEast(),b=m.lat>o.lat&&f.lat<h.lat,T=m.lng>o.lng&&f.lng<h.lng;return b&&T},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,o){return e?(e=Q(e),this._southWest.equals(e.getSouthWest(),o)&&this._northEast.equals(e.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(e,o){return e instanceof nt?e:new nt(e,o)}function et(e,o,h){if(isNaN(e)||isNaN(o))throw new Error("Invalid LatLng object: ("+e+", "+o+")");this.lat=+e,this.lng=+o,h!==void 0&&(this.alt=+h)}et.prototype={equals:function(e,o){if(!e)return!1;e=G(e);var h=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return h<=(o===void 0?1e-9:o)},toString:function(e){return"LatLng("+v(this.lat,e)+", "+v(this.lng,e)+")"},distanceTo:function(e){return dt.distance(this,G(e))},wrap:function(){return dt.wrapLatLng(this)},toBounds:function(e){var o=180*e/40075017,h=o/Math.cos(Math.PI/180*this.lat);return Q([this.lat-o,this.lng-h],[this.lat+o,this.lng+h])},clone:function(){return new et(this.lat,this.lng,this.alt)}};function G(e,o,h){return e instanceof et?e:y(e)&&typeof e[0]!="object"?e.length===3?new et(e[0],e[1],e[2]):e.length===2?new et(e[0],e[1]):null:e==null?e:typeof e=="object"&&"lat"in e?new et(e.lat,"lng"in e?e.lng:e.lon,e.alt):o===void 0?null:new et(e,o,h)}var ht={latLngToPoint:function(e,o){var h=this.projection.project(e),f=this.scale(o);return this.transformation._transform(h,f)},pointToLatLng:function(e,o){var h=this.scale(o),f=this.transformation.untransform(e,h);return this.projection.unproject(f)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var o=this.projection.bounds,h=this.scale(e),f=this.transformation.transform(o.min,h),m=this.transformation.transform(o.max,h);return new V(f,m)},infinite:!1,wrapLatLng:function(e){var o=this.wrapLng?p(e.lng,this.wrapLng,!0):e.lng,h=this.wrapLat?p(e.lat,this.wrapLat,!0):e.lat,f=e.alt;return new et(h,o,f)},wrapLatLngBounds:function(e){var o=e.getCenter(),h=this.wrapLatLng(o),f=o.lat-h.lat,m=o.lng-h.lng;if(f===0&&m===0)return e;var b=e.getSouthWest(),T=e.getNorthEast(),F=new et(b.lat-f,b.lng-m),N=new et(T.lat-f,T.lng-m);return new nt(F,N)}},dt=s({},ht,{wrapLng:[-180,180],R:6371e3,distance:function(e,o){var h=Math.PI/180,f=e.lat*h,m=o.lat*h,b=Math.sin((o.lat-e.lat)*h/2),T=Math.sin((o.lng-e.lng)*h/2),F=b*b+Math.cos(f)*Math.cos(m)*T*T,N=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return this.R*N}}),wt=6378137,Mt={R:wt,MAX_LATITUDE:85.0511287798,project:function(e){var o=Math.PI/180,h=this.MAX_LATITUDE,f=Math.max(Math.min(h,e.lat),-h),m=Math.sin(f*o);return new Z(this.R*e.lng*o,this.R*Math.log((1+m)/(1-m))/2)},unproject:function(e){var o=180/Math.PI;return new et((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*o,e.x*o/this.R)},bounds:function(){var e=wt*Math.PI;return new V([-e,-e],[e,e])}()};function Pt(e,o,h,f){if(y(e)){this._a=e[0],this._b=e[1],this._c=e[2],this._d=e[3];return}this._a=e,this._b=o,this._c=h,this._d=f}Pt.prototype={transform:function(e,o){return this._transform(e.clone(),o)},_transform:function(e,o){return o=o||1,e.x=o*(this._a*e.x+this._b),e.y=o*(this._c*e.y+this._d),e},untransform:function(e,o){return o=o||1,new Z((e.x/o-this._b)/this._a,(e.y/o-this._d)/this._c)}};function Tt(e,o,h,f){return new Pt(e,o,h,f)}var Lt=s({},dt,{code:"EPSG:3857",projection:Mt,transformation:function(){var e=.5/(Math.PI*Mt.R);return Tt(e,.5,-e,.5)}()}),Nt=s({},Lt,{code:"EPSG:900913"});function At(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Dt(e,o){var h="",f,m,b,T,F,N;for(f=0,b=e.length;f<b;f++){for(F=e[f],m=0,T=F.length;m<T;m++)N=F[m],h+=(m?"L":"M")+N.x+" "+N.y;h+=o?K.svg?"z":"x":""}return h||"M0 0"}var Et=document.documentElement.style,Rt="ActiveXObject"in window,ye=Rt&&!document.addEventListener,Ji="msLaunchUri"in navigator&&!("documentMode"in document),oi=te("webkit"),Ki=te("android"),Qi=te("android 2")||te("android 3"),tn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),en=Ki&&te("Google")&&tn<537&&!("AudioNode"in window),we=!!window.opera,Eo=!Ji&&te("chrome"),So=te("gecko")&&!oi&&!we&&!Rt,xl=!Eo&&te("safari"),ko=te("phantom"),Co="OTransition"in Et,bl=navigator.platform.indexOf("Win")===0,To=Rt&&"transition"in Et,tr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Qi,Ao="MozPerspective"in Et,Ml=!window.L_DISABLE_3D&&(To||tr||Ao)&&!Co&&!ko,si=typeof orientation<"u"||te("mobile"),Pl=si&&oi,Ll=si&&tr,Do=!window.PointerEvent&&window.MSPointerEvent,Bo=!!(window.PointerEvent||Do),zo="ontouchstart"in window||!!window.TouchEvent,El=!window.L_NO_TOUCH&&(zo||Bo),Sl=si&&we,kl=si&&So,Cl=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Tl=function(){var e=!1;try{var o=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",_,o),window.removeEventListener("testPassiveEventSupport",_,o)}catch{}return e}(),Al=function(){return!!document.createElement("canvas").getContext}(),er=!!(document.createElementNS&&At("svg").createSVGRect),Dl=!!er&&function(){var e=document.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Bl=!er&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var o=e.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),zl=navigator.platform.indexOf("Mac")===0,Ol=navigator.platform.indexOf("Linux")===0;function te(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var K={ie:Rt,ielt9:ye,edge:Ji,webkit:oi,android:Ki,android23:Qi,androidStock:en,opera:we,chrome:Eo,gecko:So,safari:xl,phantom:ko,opera12:Co,win:bl,ie3d:To,webkit3d:tr,gecko3d:Ao,any3d:Ml,mobile:si,mobileWebkit:Pl,mobileWebkit3d:Ll,msPointer:Do,pointer:Bo,touch:El,touchNative:zo,mobileOpera:Sl,mobileGecko:kl,retina:Cl,passiveEvents:Tl,canvas:Al,svg:er,vml:Bl,inlineSvg:Dl,mac:zl,linux:Ol},Oo=K.msPointer?"MSPointerDown":"pointerdown",Io=K.msPointer?"MSPointerMove":"pointermove",Fo=K.msPointer?"MSPointerUp":"pointerup",No=K.msPointer?"MSPointerCancel":"pointercancel",ir={touchstart:Oo,touchmove:Io,touchend:Fo,touchcancel:No},Ro={touchstart:Yl,touchmove:nn,touchend:nn,touchcancel:nn},Ae={},Zo=!1;function Il(e,o,h){return o==="touchstart"&&Zl(),Ro[o]?(h=Ro[o].bind(this,h),e.addEventListener(ir[o],h,!1),h):(console.warn("wrong event specified:",o),_)}function Fl(e,o,h){if(!ir[o]){console.warn("wrong event specified:",o);return}e.removeEventListener(ir[o],h,!1)}function Nl(e){Ae[e.pointerId]=e}function Rl(e){Ae[e.pointerId]&&(Ae[e.pointerId]=e)}function Yo(e){delete Ae[e.pointerId]}function Zl(){Zo||(document.addEventListener(Oo,Nl,!0),document.addEventListener(Io,Rl,!0),document.addEventListener(Fo,Yo,!0),document.addEventListener(No,Yo,!0),Zo=!0)}function nn(e,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var h in Ae)o.touches.push(Ae[h]);o.changedTouches=[o],e(o)}}function Yl(e,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&bt(o),nn(e,o)}function Xl(e){var o={},h,f;for(f in e)h=e[f],o[f]=h&&h.bind?h.bind(e):h;return e=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var $l=200;function Ul(e,o){e.addEventListener("dblclick",o);var h=0,f;function m(b){if(b.detail!==1){f=b.detail;return}if(!(b.pointerType==="mouse"||b.sourceCapabilities&&!b.sourceCapabilities.firesTouchEvents)){var T=Wo(b);if(!(T.some(function(N){return N instanceof HTMLLabelElement&&N.attributes.for})&&!T.some(function(N){return N instanceof HTMLInputElement||N instanceof HTMLSelectElement}))){var F=Date.now();F-h<=$l?(f++,f===2&&o(Xl(b))):f=1,h=F}}}return e.addEventListener("click",m),{dblclick:o,simDblclick:m}}function jl(e,o){e.removeEventListener("dblclick",o.dblclick),e.removeEventListener("click",o.simDblclick)}var nr=sn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ai=sn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Xo=ai==="webkitTransition"||ai==="OTransition"?ai+"End":"transitionend";function $o(e){return typeof e=="string"?document.getElementById(e):e}function hi(e,o){var h=e.style[o]||e.currentStyle&&e.currentStyle[o];if((!h||h==="auto")&&document.defaultView){var f=document.defaultView.getComputedStyle(e,null);h=f?f[o]:null}return h==="auto"?null:h}function lt(e,o,h){var f=document.createElement(e);return f.className=o||"",h&&h.appendChild(f),f}function pt(e){var o=e.parentNode;o&&o.removeChild(e)}function rn(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function De(e){var o=e.parentNode;o&&o.lastChild!==e&&o.appendChild(e)}function Be(e){var o=e.parentNode;o&&o.firstChild!==e&&o.insertBefore(e,o.firstChild)}function rr(e,o){if(e.classList!==void 0)return e.classList.contains(o);var h=on(e);return h.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(h)}function ot(e,o){if(e.classList!==void 0)for(var h=P(o),f=0,m=h.length;f<m;f++)e.classList.add(h[f]);else if(!rr(e,o)){var b=on(e);or(e,(b?b+" ":"")+o)}}function mt(e,o){e.classList!==void 0?e.classList.remove(o):or(e,x((" "+on(e)+" ").replace(" "+o+" "," ")))}function or(e,o){e.className.baseVal===void 0?e.className=o:e.className.baseVal=o}function on(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function $t(e,o){"opacity"in e.style?e.style.opacity=o:"filter"in e.style&&Wl(e,o)}function Wl(e,o){var h=!1,f="DXImageTransform.Microsoft.Alpha";try{h=e.filters.item(f)}catch{if(o===1)return}o=Math.round(o*100),h?(h.Enabled=o!==100,h.Opacity=o):e.style.filter+=" progid:"+f+"(opacity="+o+")"}function sn(e){for(var o=document.documentElement.style,h=0;h<e.length;h++)if(e[h]in o)return e[h];return!1}function xe(e,o,h){var f=o||new Z(0,0);e.style[nr]=(K.ie3d?"translate("+f.x+"px,"+f.y+"px)":"translate3d("+f.x+"px,"+f.y+"px,0)")+(h?" scale("+h+")":"")}function gt(e,o){e._leaflet_pos=o,K.any3d?xe(e,o):(e.style.left=o.x+"px",e.style.top=o.y+"px")}function be(e){return e._leaflet_pos||new Z(0,0)}var li,ui,sr;if("onselectstart"in document)li=function(){rt(window,"selectstart",bt)},ui=function(){ct(window,"selectstart",bt)};else{var ci=sn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);li=function(){if(ci){var e=document.documentElement.style;sr=e[ci],e[ci]="none"}},ui=function(){ci&&(document.documentElement.style[ci]=sr,sr=void 0)}}function ar(){rt(window,"dragstart",bt)}function hr(){ct(window,"dragstart",bt)}var an,lr;function ur(e){for(;e.tabIndex===-1;)e=e.parentNode;e.style&&(hn(),an=e,lr=e.style.outlineStyle,e.style.outlineStyle="none",rt(window,"keydown",hn))}function hn(){an&&(an.style.outlineStyle=lr,an=void 0,lr=void 0,ct(window,"keydown",hn))}function Uo(e){do e=e.parentNode;while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function cr(e){var o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}var Vl={__proto__:null,TRANSFORM:nr,TRANSITION:ai,TRANSITION_END:Xo,get:$o,getStyle:hi,create:lt,remove:pt,empty:rn,toFront:De,toBack:Be,hasClass:rr,addClass:ot,removeClass:mt,setClass:or,getClass:on,setOpacity:$t,testProp:sn,setTransform:xe,setPosition:gt,getPosition:be,get disableTextSelection(){return li},get enableTextSelection(){return ui},disableImageDrag:ar,enableImageDrag:hr,preventOutline:ur,restoreOutline:hn,getSizedParentNode:Uo,getScale:cr};function rt(e,o,h,f){if(o&&typeof o=="object")for(var m in o)dr(e,m,o[m],h);else{o=P(o);for(var b=0,T=o.length;b<T;b++)dr(e,o[b],h,f)}return this}var ee="_leaflet_events";function ct(e,o,h,f){if(arguments.length===1)jo(e),delete e[ee];else if(o&&typeof o=="object")for(var m in o)pr(e,m,o[m],h);else if(o=P(o),arguments.length===2)jo(e,function(F){return M(o,F)!==-1});else for(var b=0,T=o.length;b<T;b++)pr(e,o[b],h,f);return this}function jo(e,o){for(var h in e[ee]){var f=h.split(/\d/)[0];(!o||o(f))&&pr(e,f,null,null,h)}}var fr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function dr(e,o,h,f){var m=o+c(h)+(f?"_"+c(f):"");if(e[ee]&&e[ee][m])return this;var b=function(F){return h.call(f||e,F||window.event)},T=b;!K.touchNative&&K.pointer&&o.indexOf("touch")===0?b=Il(e,o,b):K.touch&&o==="dblclick"?b=Ul(e,b):"addEventListener"in e?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?e.addEventListener(fr[o]||o,b,K.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(b=function(F){F=F||window.event,_r(e,F)&&T(F)},e.addEventListener(fr[o],b,!1)):e.addEventListener(o,T,!1):e.attachEvent("on"+o,b),e[ee]=e[ee]||{},e[ee][m]=b}function pr(e,o,h,f,m){m=m||o+c(h)+(f?"_"+c(f):"");var b=e[ee]&&e[ee][m];if(!b)return this;!K.touchNative&&K.pointer&&o.indexOf("touch")===0?Fl(e,o,b):K.touch&&o==="dblclick"?jl(e,b):"removeEventListener"in e?e.removeEventListener(fr[o]||o,b,!1):e.detachEvent("on"+o,b),e[ee][m]=null}function Me(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function mr(e){return dr(e,"wheel",Me),this}function fi(e){return rt(e,"mousedown touchstart dblclick contextmenu",Me),e._leaflet_disable_click=!0,this}function bt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Pe(e){return bt(e),Me(e),this}function Wo(e){if(e.composedPath)return e.composedPath();for(var o=[],h=e.target;h;)o.push(h),h=h.parentNode;return o}function Vo(e,o){if(!o)return new Z(e.clientX,e.clientY);var h=cr(o),f=h.boundingClientRect;return new Z((e.clientX-f.left)/h.x-o.clientLeft,(e.clientY-f.top)/h.y-o.clientTop)}var Hl=K.linux&&K.chrome?window.devicePixelRatio:K.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ho(e){return K.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/Hl:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}function _r(e,o){var h=o.relatedTarget;if(!h)return!0;try{for(;h&&h!==e;)h=h.parentNode}catch{return!1}return h!==e}var Gl={__proto__:null,on:rt,off:ct,stopPropagation:Me,disableScrollPropagation:mr,disableClickPropagation:fi,preventDefault:bt,stop:Pe,getPropagationPath:Wo,getMousePosition:Vo,getWheelDelta:Ho,isExternalTarget:_r,addListener:rt,removeListener:ct},Go=W.extend({run:function(e,o,h,f){this.stop(),this._el=e,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(f||.5,.2),this._startPos=be(e),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=$(this._animate,this),this._step()},_step:function(e){var o=+new Date-this._startTime,h=this._duration*1e3;o<h?this._runFrame(this._easeOut(o/h),e):(this._runFrame(1),this._complete())},_runFrame:function(e,o){var h=this._startPos.add(this._offset.multiplyBy(e));o&&h._round(),gt(this._el,h),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),at=W.extend({options:{crs:Lt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,o){o=S(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(G(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ai&&K.any3d&&!K.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,Xo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,o,h){if(o=o===void 0?this._zoom:this._limitZoom(o),e=this._limitCenter(G(e),o,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var f=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,o,h.zoom):this._tryAnimatedPan(e,h.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(e,o,h.pan&&h.pan.noMoveStart),this},setZoom:function(e,o){return this._loaded?this.setView(this.getCenter(),e,{zoom:o}):(this._zoom=e,this)},zoomIn:function(e,o){return e=e||(K.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,o)},zoomOut:function(e,o){return e=e||(K.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,o)},setZoomAround:function(e,o,h){var f=this.getZoomScale(o),m=this.getSize().divideBy(2),b=e instanceof Z?e:this.latLngToContainerPoint(e),T=b.subtract(m).multiplyBy(1-1/f),F=this.containerPointToLatLng(m.add(T));return this.setView(F,o,{zoom:h})},_getBoundsCenterZoom:function(e,o){o=o||{},e=e.getBounds?e.getBounds():Q(e);var h=R(o.paddingTopLeft||o.padding||[0,0]),f=R(o.paddingBottomRight||o.padding||[0,0]),m=this.getBoundsZoom(e,!1,h.add(f));if(m=typeof o.maxZoom=="number"?Math.min(o.maxZoom,m):m,m===1/0)return{center:e.getCenter(),zoom:m};var b=f.subtract(h).divideBy(2),T=this.project(e.getSouthWest(),m),F=this.project(e.getNorthEast(),m),N=this.unproject(T.add(F).divideBy(2).add(b),m);return{center:N,zoom:m}},fitBounds:function(e,o){if(e=Q(e),!e.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(e,o);return this.setView(h.center,h.zoom,o)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,o){return this.setView(e,this._zoom,{pan:o})},panBy:function(e,o){if(e=R(e).round(),o=o||{},!e.x&&!e.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Go,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){ot(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,h,o.duration||.25,o.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,o,h){if(h=h||{},h.animate===!1||!K.any3d)return this.setView(e,o,h);this._stop();var f=this.project(this.getCenter()),m=this.project(e),b=this.getSize(),T=this._zoom;e=G(e),o=o===void 0?T:o;var F=Math.max(b.x,b.y),N=F*this.getZoomScale(T,o),U=m.distanceTo(f)||1,q=1.42,tt=q*q;function st(vt){var wn=vt?-1:1,Fu=vt?N:F,Nu=N*N-F*F+wn*tt*tt*U*U,Ru=2*Fu*tt*U,Sr=Nu/Ru,Cs=Math.sqrt(Sr*Sr+1)-Sr,Zu=Cs<1e-9?-18:Math.log(Cs);return Zu}function St(vt){return(Math.exp(vt)-Math.exp(-vt))/2}function xt(vt){return(Math.exp(vt)+Math.exp(-vt))/2}function jt(vt){return St(vt)/xt(vt)}var Bt=st(0);function Re(vt){return F*(xt(Bt)/xt(Bt+q*vt))}function Bu(vt){return F*(xt(Bt)*jt(Bt+q*vt)-St(Bt))/tt}function zu(vt){return 1-Math.pow(1-vt,1.5)}var Ou=Date.now(),Ss=(st(1)-Bt)/q,Iu=h.duration?1e3*h.duration:1e3*Ss*.8;function ks(){var vt=(Date.now()-Ou)/Iu,wn=zu(vt)*Ss;vt<=1?(this._flyToFrame=$(ks,this),this._move(this.unproject(f.add(m.subtract(f).multiplyBy(Bu(wn)/U)),T),this.getScaleZoom(F/Re(wn),T),{flyTo:!0})):this._move(e,o)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),ks.call(this),this},flyToBounds:function(e,o){var h=this._getBoundsCenterZoom(e,o);return this.flyTo(h.center,h.zoom,o)},setMaxBounds:function(e){return e=Q(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var o=this.options.minZoom;return this.options.minZoom=e,this._loaded&&o!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var o=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&o!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,o){this._enforcingBounds=!0;var h=this.getCenter(),f=this._limitCenter(h,this._zoom,Q(e));return h.equals(f)||this.panTo(f,o),this._enforcingBounds=!1,this},panInside:function(e,o){o=o||{};var h=R(o.paddingTopLeft||o.padding||[0,0]),f=R(o.paddingBottomRight||o.padding||[0,0]),m=this.project(this.getCenter()),b=this.project(e),T=this.getPixelBounds(),F=H([T.min.add(h),T.max.subtract(f)]),N=F.getSize();if(!F.contains(b)){this._enforcingBounds=!0;var U=b.subtract(F.getCenter()),q=F.extend(b).getSize().subtract(N);m.x+=U.x<0?-q.x:q.x,m.y+=U.y<0?-q.y:q.y,this.panTo(this.unproject(m),o),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=s({animate:!1,pan:!0},e===!0?{animate:!0}:e);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),f=o.divideBy(2).round(),m=h.divideBy(2).round(),b=f.subtract(m);return!b.x&&!b.y?this:(e.animate&&e.pan?this.panBy(b):(e.pan&&this._rawPanBy(b),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=s({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,h,e):navigator.geolocation.getCurrentPosition(o,h,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var o=e.code,h=e.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var o=e.coords.latitude,h=e.coords.longitude,f=new et(o,h),m=f.toBounds(e.coords.accuracy*2),b=this._locateOptions;if(b.setView){var T=this.getBoundsZoom(m);this.setView(f,b.maxZoom?Math.min(T,b.maxZoom):T)}var F={latlng:f,bounds:m,timestamp:e.timestamp};for(var N in e.coords)typeof e.coords[N]=="number"&&(F[N]=e.coords[N]);this.fire("locationfound",F)}},addHandler:function(e,o){if(!o)return this;var h=this[e]=new o(this);return this._handlers.push(h),this.options[e]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),pt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var e;for(e in this._layers)this._layers[e].remove();for(e in this._panes)pt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,o){var h="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),f=lt("div",h,o||this._mapPane);return e&&(this._panes[e]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),o=this.unproject(e.getBottomLeft()),h=this.unproject(e.getTopRight());return new nt(o,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,o,h){e=Q(e),h=R(h||[0,0]);var f=this.getZoom()||0,m=this.getMinZoom(),b=this.getMaxZoom(),T=e.getNorthWest(),F=e.getSouthEast(),N=this.getSize().subtract(h),U=H(this.project(F,f),this.project(T,f)).getSize(),q=K.any3d?this.options.zoomSnap:1,tt=N.x/U.x,st=N.y/U.y,St=o?Math.max(tt,st):Math.min(tt,st);return f=this.getScaleZoom(St,f),q&&(f=Math.round(f/(q/100))*(q/100),f=o?Math.ceil(f/q)*q:Math.floor(f/q)*q),Math.max(m,Math.min(b,f))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,o){var h=this._getTopLeftPoint(e,o);return new V(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===void 0?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,o){var h=this.options.crs;return o=o===void 0?this._zoom:o,h.scale(e)/h.scale(o)},getScaleZoom:function(e,o){var h=this.options.crs;o=o===void 0?this._zoom:o;var f=h.zoom(e*h.scale(o));return isNaN(f)?1/0:f},project:function(e,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(G(e),o)},unproject:function(e,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(R(e),o)},layerPointToLatLng:function(e){var o=R(e).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(e){var o=this.project(G(e))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(G(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(Q(e))},distance:function(e,o){return this.options.crs.distance(G(e),G(o))},containerPointToLayerPoint:function(e){return R(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return R(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var o=this.containerPointToLayerPoint(R(e));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(e)))},mouseEventToContainerPoint:function(e){return Vo(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var o=this._container=$o(e);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(o,"scroll",this._onScroll,this),this._containerId=c(o)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&K.any3d,ot(e,"leaflet-container"+(K.touch?" leaflet-touch":"")+(K.retina?" leaflet-retina":"")+(K.ielt9?" leaflet-oldie":"")+(K.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=hi(e,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),gt(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ot(e.markerPane,"leaflet-zoom-hide"),ot(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,o,h){gt(this._mapPane,new Z(0,0));var f=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var m=this._zoom!==o;this._moveStart(m,h)._move(e,o)._moveEnd(m),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(e,o){return e&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(e,o,h,f){o===void 0&&(o=this._zoom);var m=this._zoom!==o;return this._zoom=o,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),f?h&&h.pinch&&this.fire("zoom",h):((m||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){gt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[c(this._container)]=this;var o=e?ct:rt;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),K.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=$(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,o){for(var h=[],f,m=o==="mouseout"||o==="mouseover",b=e.target||e.srcElement,T=!1;b;){if(f=this._targets[c(b)],f&&(o==="click"||o==="preclick")&&this._draggableMoved(f)){T=!0;break}if(f&&f.listens(o,!0)&&(m&&!_r(b,e)||(h.push(f),m))||b===this._container)break;b=b.parentNode}return!h.length&&!T&&!m&&this.listens(o,!0)&&(h=[this]),h},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var o=e.target||e.srcElement;if(!(!this._loaded||o._leaflet_disable_events||e.type==="click"&&this._isClickDisabled(o))){var h=e.type;h==="mousedown"&&ur(o),this._fireDOMEvent(e,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,o,h){if(e.type==="click"){var f=s({},e);f.type="preclick",this._fireDOMEvent(f,f.type,h)}var m=this._findEventTargets(e,o);if(h){for(var b=[],T=0;T<h.length;T++)h[T].listens(o,!0)&&b.push(h[T]);m=b.concat(m)}if(m.length){o==="contextmenu"&&bt(e);var F=m[0],N={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var U=F.getLatLng&&(!F._radius||F._radius<=10);N.containerPoint=U?this.latLngToContainerPoint(F.getLatLng()):this.mouseEventToContainerPoint(e),N.layerPoint=this.containerPointToLayerPoint(N.containerPoint),N.latlng=U?F.getLatLng():this.layerPointToLatLng(N.layerPoint)}for(T=0;T<m.length;T++)if(m[T].fire(o,N,!0),N.originalEvent._stopped||m[T].options.bubblingMouseEvents===!1&&M(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,o=this._handlers.length;e<o;e++)this._handlers[e].disable()},whenReady:function(e,o){return this._loaded?e.call(o||this,{target:this}):this.on("load",e,o),this},_getMapPanePos:function(){return be(this._mapPane)||new Z(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,o){var h=e&&o!==void 0?this._getNewPixelOrigin(e,o):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,o){var h=this.getSize()._divideBy(2);return this.project(e,o)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,o,h){var f=this._getNewPixelOrigin(h,o);return this.project(e,o)._subtract(f)},_latLngBoundsToNewLayerBounds:function(e,o,h){var f=this._getNewPixelOrigin(h,o);return H([this.project(e.getSouthWest(),o)._subtract(f),this.project(e.getNorthWest(),o)._subtract(f),this.project(e.getSouthEast(),o)._subtract(f),this.project(e.getNorthEast(),o)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,o,h){if(!h)return e;var f=this.project(e,o),m=this.getSize().divideBy(2),b=new V(f.subtract(m),f.add(m)),T=this._getBoundsOffset(b,h,o);return Math.abs(T.x)<=1&&Math.abs(T.y)<=1?e:this.unproject(f.add(T),o)},_limitOffset:function(e,o){if(!o)return e;var h=this.getPixelBounds(),f=new V(h.min.add(e),h.max.add(e));return e.add(this._getBoundsOffset(f,o))},_getBoundsOffset:function(e,o,h){var f=H(this.project(o.getNorthEast(),h),this.project(o.getSouthWest(),h)),m=f.min.subtract(e.min),b=f.max.subtract(e.max),T=this._rebound(m.x,-b.x),F=this._rebound(m.y,-b.y);return new Z(T,F)},_rebound:function(e,o){return e+o>0?Math.round(e-o)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(o))},_limitZoom:function(e){var o=this.getMinZoom(),h=this.getMaxZoom(),f=K.any3d?this.options.zoomSnap:1;return f&&(e=Math.round(e/f)*f),Math.max(o,Math.min(h,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){mt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,o){var h=this._getCenterOffset(e)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,o),!0)},_createAnimProxy:function(){var e=this._proxy=lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(o){var h=nr,f=this._proxy.style[h];xe(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),f===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),o=this.getZoom();xe(this._proxy,this.project(e,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,o,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(o),m=this._getCenterOffset(e)._divideBy(1-1/f);return h.animate!==!0&&!this.getSize().contains(m)?!1:($(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(e,o,!0)},this),!0)},_animateZoom:function(e,o,h,f){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=o,ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:o,noUpdate:f}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&mt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ql(e,o){return new at(e,o)}var Wt=w.extend({options:{position:"topright"},initialize:function(e){S(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var o=this._map;return o&&o.removeControl(this),this.options.position=e,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var o=this._container=this.onAdd(e),h=this.getPosition(),f=e._controlCorners[h];return ot(o,"leaflet-control"),h.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),di=function(e){return new Wt(e)};at.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},o="leaflet-",h=this._controlContainer=lt("div",o+"control-container",this._container);function f(m,b){var T=o+m+" "+o+b;e[m+b]=lt("div",T,h)}f("top","left"),f("top","right"),f("bottom","left"),f("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)pt(this._controlCorners[e]);pt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qo=Wt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,o,h,f){return h<f?-1:f<h?1:0}},initialize:function(e,o,h){S(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var f in e)this._addLayer(e[f],f);for(f in o)this._addLayer(o[f],f,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return Wt.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,o){return this._addLayer(e,o),this._map?this._update():this},addOverlay:function(e,o){return this._addLayer(e,o,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var o=this._getLayer(c(e));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):mt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return mt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",o=this._container=lt("div",e),h=this.options.collapsed;o.setAttribute("aria-haspopup",!0),fi(o),mr(o);var f=this._section=lt("section",e+"-list");h&&(this._map.on("click",this.collapse,this),rt(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var m=this._layersLink=lt("a",e+"-toggle",o);m.href="#",m.title="Layers",m.setAttribute("role","button"),rt(m,{keydown:function(b){b.keyCode===13&&this._expandSafely()},click:function(b){bt(b),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=lt("div",e+"-base",f),this._separator=lt("div",e+"-separator",f),this._overlaysList=lt("div",e+"-overlays",f),o.appendChild(f)},_getLayer:function(e){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&c(this._layers[o].layer)===e)return this._layers[o]},_addLayer:function(e,o,h){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:o,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(f,m){return this.options.sortFunction(f.layer,m.layer,f.name,m.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;rn(this._baseLayersList),rn(this._overlaysList),this._layerControlInputs=[];var e,o,h,f,m=0;for(h=0;h<this._layers.length;h++)f=this._layers[h],this._addItem(f),o=o||f.overlay,e=e||!f.overlay,m+=f.overlay?0:1;return this.options.hideSingleBase&&(e=e&&m>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=o&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var o=this._getLayer(c(e.target)),h=o.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;h&&this._map.fire(h,o)},_createRadioElement:function(e,o){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(o?' checked="checked"':"")+"/>",f=document.createElement("div");return f.innerHTML=h,f.firstChild},_addItem:function(e){var o=document.createElement("label"),h=this._map.hasLayer(e.layer),f;e.overlay?(f=document.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=h):f=this._createRadioElement("leaflet-base-layers_"+c(this),h),this._layerControlInputs.push(f),f.layerId=c(e.layer),rt(f,"click",this._onInputClick,this);var m=document.createElement("span");m.innerHTML=" "+e.name;var b=document.createElement("span");o.appendChild(b),b.appendChild(f),b.appendChild(m);var T=e.overlay?this._overlaysList:this._baseLayersList;return T.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var e=this._layerControlInputs,o,h,f=[],m=[];this._handlingClick=!0;for(var b=e.length-1;b>=0;b--)o=e[b],h=this._getLayer(o.layerId).layer,o.checked?f.push(h):o.checked||m.push(h);for(b=0;b<m.length;b++)this._map.hasLayer(m[b])&&this._map.removeLayer(m[b]);for(b=0;b<f.length;b++)this._map.hasLayer(f[b])||this._map.addLayer(f[b]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e=this._layerControlInputs,o,h,f=this._map.getZoom(),m=e.length-1;m>=0;m--)o=e[m],h=this._getLayer(o.layerId).layer,o.disabled=h.options.minZoom!==void 0&&f<h.options.minZoom||h.options.maxZoom!==void 0&&f>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,rt(e,"click",bt),this.expand();var o=this;setTimeout(function(){ct(e,"click",bt),o._preventClick=!1})}}),Jl=function(e,o,h){return new qo(e,o,h)},gr=Wt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var o="leaflet-control-zoom",h=lt("div",o+" leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,o+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,o+"-out",h,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,o,h,f,m){var b=lt("a",h,f);return b.innerHTML=e,b.href="#",b.title=o,b.setAttribute("role","button"),b.setAttribute("aria-label",o),fi(b),rt(b,"click",Pe),rt(b,"click",m,this),rt(b,"click",this._refocusOnMap,this),b},_updateDisabled:function(){var e=this._map,o="leaflet-disabled";mt(this._zoomInButton,o),mt(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(ot(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(ot(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});at.mergeOptions({zoomControl:!0}),at.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new gr,this.addControl(this.zoomControl))});var Kl=function(e){return new gr(e)},Jo=Wt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var o="leaflet-control-scale",h=lt("div",o),f=this.options;return this._addScales(f,o+"-line",h),e.on(f.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),h},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,o,h){e.metric&&(this._mScale=lt("div",o,h)),e.imperial&&(this._iScale=lt("div",o,h))},_update:function(){var e=this._map,o=e.getSize().y/2,h=e.distance(e.containerPointToLatLng([0,o]),e.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(h)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var o=this._getRoundNum(e),h=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,h,o/e)},_updateImperial:function(e){var o=e*3.2808399,h,f,m;o>5280?(h=o/5280,f=this._getRoundNum(h),this._updateScale(this._iScale,f+" mi",f/h)):(m=this._getRoundNum(o),this._updateScale(this._iScale,m+" ft",m/o))},_updateScale:function(e,o,h){e.style.width=Math.round(this.options.maxWidth*h)+"px",e.innerHTML=o},_getRoundNum:function(e){var o=Math.pow(10,(Math.floor(e)+"").length-1),h=e/o;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,o*h}}),Ql=function(e){return new Jo(e)},tu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',vr=Wt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(K.inlineSvg?tu+" ":"")+"Leaflet</a>"},initialize:function(e){S(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=lt("div","leaflet-control-attribution"),fi(this._container);for(var o in e._layers)e._layers[o].getAttribution&&this.addAttribution(e._layers[o].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var o in this._attributions)this._attributions[o]&&e.push(o);var h=[];this.options.prefix&&h.push(this.options.prefix),e.length&&h.push(e.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});at.mergeOptions({attributionControl:!0}),at.addInitHook(function(){this.options.attributionControl&&new vr().addTo(this)});var eu=function(e){return new vr(e)};Wt.Layers=qo,Wt.Zoom=gr,Wt.Scale=Jo,Wt.Attribution=vr,di.layers=Jl,di.zoom=Kl,di.scale=Ql,di.attribution=eu;var ie=w.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ie.addTo=function(e,o){return e.addHandler(o,this),this};var iu={Events:O},Ko=K.touch?"touchstart mousedown":"mousedown",me=W.extend({options:{clickTolerance:3},initialize:function(e,o,h,f){S(this,f),this._element=e,this._dragStartTarget=o||e,this._preventOutline=h},enable:function(){this._enabled||(rt(this._dragStartTarget,Ko,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(me._dragging===this&&this.finishDrag(!0),ct(this._dragStartTarget,Ko,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!rr(this._element,"leaflet-zoom-anim"))){if(e.touches&&e.touches.length!==1){me._dragging===this&&this.finishDrag();return}if(!(me._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(me._dragging=this,this._preventOutline&&ur(this._element),ar(),li(),!this._moving)){this.fire("down");var o=e.touches?e.touches[0]:e,h=Uo(this._element);this._startPoint=new Z(o.clientX,o.clientY),this._startPos=be(this._element),this._parentScale=cr(h);var f=e.type==="mousedown";rt(document,f?"mousemove":"touchmove",this._onMove,this),rt(document,f?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(e){if(this._enabled){if(e.touches&&e.touches.length>1){this._moved=!0;return}var o=e.touches&&e.touches.length===1?e.touches[0]:e,h=new Z(o.clientX,o.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,bt(e),this._moved||(this.fire("dragstart"),this._moved=!0,ot(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=e,this._updatePosition())}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),gt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){mt(document.body,"leaflet-dragging"),this._lastTarget&&(mt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ct(document,"mousemove touchmove",this._onMove,this),ct(document,"mouseup touchend touchcancel",this._onUp,this),hr(),ui();var o=this._moved&&this._moving;this._moving=!1,me._dragging=!1,o&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function Qo(e,o,h){var f,m=[1,4,2,8],b,T,F,N,U,q,tt,st;for(b=0,q=e.length;b<q;b++)e[b]._code=Le(e[b],o);for(F=0;F<4;F++){for(tt=m[F],f=[],b=0,q=e.length,T=q-1;b<q;T=b++)N=e[b],U=e[T],N._code&tt?U._code&tt||(st=ln(U,N,tt,o,h),st._code=Le(st,o),f.push(st)):(U._code&tt&&(st=ln(U,N,tt,o,h),st._code=Le(st,o),f.push(st)),f.push(N));e=f}return e}function ts(e,o){var h,f,m,b,T,F,N,U,q;if(!e||e.length===0)throw new Error("latlngs not passed");Ut(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var tt=G([0,0]),st=Q(e),St=st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest());St<1700&&(tt=yr(e));var xt=e.length,jt=[];for(h=0;h<xt;h++){var Bt=G(e[h]);jt.push(o.project(G([Bt.lat-tt.lat,Bt.lng-tt.lng])))}for(F=N=U=0,h=0,f=xt-1;h<xt;f=h++)m=jt[h],b=jt[f],T=m.y*b.x-b.y*m.x,N+=(m.x+b.x)*T,U+=(m.y+b.y)*T,F+=T*3;F===0?q=jt[0]:q=[N/F,U/F];var Re=o.unproject(R(q));return G([Re.lat+tt.lat,Re.lng+tt.lng])}function yr(e){for(var o=0,h=0,f=0,m=0;m<e.length;m++){var b=G(e[m]);o+=b.lat,h+=b.lng,f++}return G([o/f,h/f])}var nu={__proto__:null,clipPolygon:Qo,polygonCenter:ts,centroid:yr};function es(e,o){if(!o||!e.length)return e.slice();var h=o*o;return e=su(e,h),e=ou(e,h),e}function is(e,o,h){return Math.sqrt(pi(e,o,h,!0))}function ru(e,o,h){return pi(e,o,h)}function ou(e,o){var h=e.length,f=typeof Uint8Array<"u"?Uint8Array:Array,m=new f(h);m[0]=m[h-1]=1,wr(e,m,o,0,h-1);var b,T=[];for(b=0;b<h;b++)m[b]&&T.push(e[b]);return T}function wr(e,o,h,f,m){var b=0,T,F,N;for(F=f+1;F<=m-1;F++)N=pi(e[F],e[f],e[m],!0),N>b&&(T=F,b=N);b>h&&(o[T]=1,wr(e,o,h,f,T),wr(e,o,h,T,m))}function su(e,o){for(var h=[e[0]],f=1,m=0,b=e.length;f<b;f++)au(e[f],e[m])>o&&(h.push(e[f]),m=f);return m<b-1&&h.push(e[b-1]),h}var ns;function rs(e,o,h,f,m){var b=f?ns:Le(e,h),T=Le(o,h),F,N,U;for(ns=T;;){if(!(b|T))return[e,o];if(b&T)return!1;F=b||T,N=ln(e,o,F,h,m),U=Le(N,h),F===b?(e=N,b=U):(o=N,T=U)}}function ln(e,o,h,f,m){var b=o.x-e.x,T=o.y-e.y,F=f.min,N=f.max,U,q;return h&8?(U=e.x+b*(N.y-e.y)/T,q=N.y):h&4?(U=e.x+b*(F.y-e.y)/T,q=F.y):h&2?(U=N.x,q=e.y+T*(N.x-e.x)/b):h&1&&(U=F.x,q=e.y+T*(F.x-e.x)/b),new Z(U,q,m)}function Le(e,o){var h=0;return e.x<o.min.x?h|=1:e.x>o.max.x&&(h|=2),e.y<o.min.y?h|=4:e.y>o.max.y&&(h|=8),h}function au(e,o){var h=o.x-e.x,f=o.y-e.y;return h*h+f*f}function pi(e,o,h,f){var m=o.x,b=o.y,T=h.x-m,F=h.y-b,N=T*T+F*F,U;return N>0&&(U=((e.x-m)*T+(e.y-b)*F)/N,U>1?(m=h.x,b=h.y):U>0&&(m+=T*U,b+=F*U)),T=e.x-m,F=e.y-b,f?T*T+F*F:new Z(m,b)}function Ut(e){return!y(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]<"u"}function os(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ut(e)}function ss(e,o){var h,f,m,b,T,F,N,U;if(!e||e.length===0)throw new Error("latlngs not passed");Ut(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var q=G([0,0]),tt=Q(e),st=tt.getNorthWest().distanceTo(tt.getSouthWest())*tt.getNorthEast().distanceTo(tt.getNorthWest());st<1700&&(q=yr(e));var St=e.length,xt=[];for(h=0;h<St;h++){var jt=G(e[h]);xt.push(o.project(G([jt.lat-q.lat,jt.lng-q.lng])))}for(h=0,f=0;h<St-1;h++)f+=xt[h].distanceTo(xt[h+1])/2;if(f===0)U=xt[0];else for(h=0,b=0;h<St-1;h++)if(T=xt[h],F=xt[h+1],m=T.distanceTo(F),b+=m,b>f){N=(b-f)/m,U=[F.x-N*(F.x-T.x),F.y-N*(F.y-T.y)];break}var Bt=o.unproject(R(U));return G([Bt.lat+q.lat,Bt.lng+q.lng])}var hu={__proto__:null,simplify:es,pointToSegmentDistance:is,closestPointOnSegment:ru,clipSegment:rs,_getEdgeIntersection:ln,_getBitCode:Le,_sqClosestPointOnSegment:pi,isFlat:Ut,_flat:os,polylineCenter:ss},xr={project:function(e){return new Z(e.lng,e.lat)},unproject:function(e){return new et(e.y,e.x)},bounds:new V([-180,-90],[180,90])},br={R:6378137,R_MINOR:6356752314245179e-9,bounds:new V([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(e){var o=Math.PI/180,h=this.R,f=e.lat*o,m=this.R_MINOR/h,b=Math.sqrt(1-m*m),T=b*Math.sin(f),F=Math.tan(Math.PI/4-f/2)/Math.pow((1-T)/(1+T),b/2);return f=-h*Math.log(Math.max(F,1e-10)),new Z(e.lng*o*h,f)},unproject:function(e){for(var o=180/Math.PI,h=this.R,f=this.R_MINOR/h,m=Math.sqrt(1-f*f),b=Math.exp(-e.y/h),T=Math.PI/2-2*Math.atan(b),F=0,N=.1,U;F<15&&Math.abs(N)>1e-7;F++)U=m*Math.sin(T),U=Math.pow((1-U)/(1+U),m/2),N=Math.PI/2-2*Math.atan(b*U)-T,T+=N;return new et(T*o,e.x*o/h)}},lu={__proto__:null,LonLat:xr,Mercator:br,SphericalMercator:Mt},uu=s({},dt,{code:"EPSG:3395",projection:br,transformation:function(){var e=.5/(Math.PI*br.R);return Tt(e,.5,-e,.5)}()}),as=s({},dt,{code:"EPSG:4326",projection:xr,transformation:Tt(1/180,1,-1/180,.5)}),cu=s({},ht,{projection:xr,transformation:Tt(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,o){var h=o.lng-e.lng,f=o.lat-e.lat;return Math.sqrt(h*h+f*f)},infinite:!0});ht.Earth=dt,ht.EPSG3395=uu,ht.EPSG3857=Lt,ht.EPSG900913=Nt,ht.EPSG4326=as,ht.Simple=cu;var Vt=W.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[c(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[c(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var o=e.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var h=this.getEvents();o.on(h,this),this.once("remove",function(){o.off(h,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});at.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var o=c(e);return this._layers[o]?this:(this._layers[o]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var o=c(e);return this._layers[o]?(this._loaded&&e.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return c(e)in this._layers},eachLayer:function(e,o){for(var h in this._layers)e.call(o,this._layers[h]);return this},_addLayers:function(e){e=e?y(e)?e:[e]:[];for(var o=0,h=e.length;o<h;o++)this.addLayer(e[o])},_addZoomLimit:function(e){(!isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[c(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var o=c(e);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,o=-1/0,h=this._getZoomSpan();for(var f in this._zoomBoundLayers){var m=this._zoomBoundLayers[f].options;e=m.minZoom===void 0?e:Math.min(e,m.minZoom),o=m.maxZoom===void 0?o:Math.max(o,m.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=e===1/0?void 0:e,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ze=Vt.extend({initialize:function(e,o){S(this,o),this._layers={};var h,f;if(e)for(h=0,f=e.length;h<f;h++)this.addLayer(e[h])},addLayer:function(e){var o=this.getLayerId(e);return this._layers[o]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var o=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(e){var o=typeof e=="number"?e:this.getLayerId(e);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var o=Array.prototype.slice.call(arguments,1),h,f;for(h in this._layers)f=this._layers[h],f[e]&&f[e].apply(f,o);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,o){for(var h in this._layers)e.call(o,this._layers[h]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return c(e)}}),fu=function(e,o){return new ze(e,o)},he=ze.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),ze.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),ze.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new nt;for(var o in this._layers){var h=this._layers[o];e.extend(h.getBounds?h.getBounds():h.getLatLng())}return e}}),du=function(e,o){return new he(e,o)},Oe=w.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){S(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,o){var h=this._getIconUrl(e);if(!h){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var f=this._createImg(h,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(f,e),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f},_setIconStyles:function(e,o){var h=this.options,f=h[o+"Size"];typeof f=="number"&&(f=[f,f]);var m=R(f),b=R(o==="shadow"&&h.shadowAnchor||h.iconAnchor||m&&m.divideBy(2,!0));e.className="leaflet-marker-"+o+" "+(h.className||""),b&&(e.style.marginLeft=-b.x+"px",e.style.marginTop=-b.y+"px"),m&&(e.style.width=m.x+"px",e.style.height=m.y+"px")},_createImg:function(e,o){return o=o||document.createElement("img"),o.src=e,o},_getIconUrl:function(e){return K.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function pu(e){return new Oe(e)}var mi=Oe.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return typeof mi.imagePath!="string"&&(mi.imagePath=this._detectIconPath()),(this.options.imagePath||mi.imagePath)+Oe.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var o=function(h,f,m){var b=f.exec(h);return b&&b[m]};return e=o(e,/^url\((['"])?(.+)\1\)$/,2),e&&o(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=lt("div","leaflet-default-icon-path",document.body),o=hi(e,"background-image")||hi(e,"backgroundImage");if(document.body.removeChild(e),o=this._stripUrl(o),o)return o;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),hs=ie.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new me(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ot(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&mt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var o=this._marker,h=o._map,f=this._marker.options.autoPanSpeed,m=this._marker.options.autoPanPadding,b=be(o._icon),T=h.getPixelBounds(),F=h.getPixelOrigin(),N=H(T.min._subtract(F).add(m),T.max._subtract(F).subtract(m));if(!N.contains(b)){var U=R((Math.max(N.max.x,b.x)-N.max.x)/(T.max.x-N.max.x)-(Math.min(N.min.x,b.x)-N.min.x)/(T.min.x-N.min.x),(Math.max(N.max.y,b.y)-N.max.y)/(T.max.y-N.max.y)-(Math.min(N.min.y,b.y)-N.min.y)/(T.min.y-N.min.y)).multiplyBy(f);h.panBy(U,{animate:!1}),this._draggable._newPos._add(U),this._draggable._startPos._add(U),gt(o._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=$(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=$(this._adjustPan.bind(this,e)))},_onDrag:function(e){var o=this._marker,h=o._shadow,f=be(o._icon),m=o._map.layerPointToLatLng(f);h&&gt(h,f),o._latlng=m,e.latlng=m,e.oldLatLng=this._oldLatLng,o.fire("move",e).fire("drag",e)},_onDragEnd:function(e){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),un=Vt.extend({options:{icon:new mi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,o){S(this,o),this._latlng=G(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var o=this._latlng;return this._latlng=G(e),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=e.icon.createIcon(this._icon),f=!1;h!==this._icon&&(this._icon&&this._removeIcon(),f=!0,e.title&&(h.title=e.title),h.tagName==="IMG"&&(h.alt=e.alt||"")),ot(h,o),e.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(h,"focus",this._panOnFocus,this);var m=e.icon.createShadow(this._shadow),b=!1;m!==this._shadow&&(this._removeShadow(),b=!0),m&&(ot(m,o),m.alt=""),this._shadow=m,e.opacity<1&&this._updateOpacity(),f&&this.getPane().appendChild(this._icon),this._initInteraction(),m&&b&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ct(this._icon,"focus",this._panOnFocus,this),pt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&gt(this._icon,e),this._shadow&&gt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),hs)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new hs(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&$t(this._icon,e),this._shadow&&$t(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var o=this.options.icon.options,h=o.iconSize?R(o.iconSize):R(0,0),f=o.iconAnchor?R(o.iconAnchor):R(0,0);e.panInside(this._latlng,{paddingTopLeft:f,paddingBottomRight:h.subtract(f)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function mu(e,o){return new un(e,o)}var _e=Vt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return S(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),cn=_e.extend({options:{fill:!0,radius:10},initialize:function(e,o){S(this,o),this._latlng=G(e),this._radius=this.options.radius},setLatLng:function(e){var o=this._latlng;return this._latlng=G(e),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var o=e&&e.radius||this._radius;return _e.prototype.setStyle.call(this,e),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,o=this._radiusY||e,h=this._clickTolerance(),f=[e+h,o+h];this._pxBounds=new V(this._point.subtract(f),this._point.add(f))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function _u(e,o){return new cn(e,o)}var Mr=cn.extend({initialize:function(e,o,h){if(typeof o=="number"&&(o=s({},h,{radius:o})),S(this,o),this._latlng=G(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new nt(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:_e.prototype.setStyle,_project:function(){var e=this._latlng.lng,o=this._latlng.lat,h=this._map,f=h.options.crs;if(f.distance===dt.distance){var m=Math.PI/180,b=this._mRadius/dt.R/m,T=h.project([o+b,e]),F=h.project([o-b,e]),N=T.add(F).divideBy(2),U=h.unproject(N).lat,q=Math.acos((Math.cos(b*m)-Math.sin(o*m)*Math.sin(U*m))/(Math.cos(o*m)*Math.cos(U*m)))/m;(isNaN(q)||q===0)&&(q=b/Math.cos(Math.PI/180*o)),this._point=N.subtract(h.getPixelOrigin()),this._radius=isNaN(q)?0:N.x-h.project([U,e-q]).x,this._radiusY=N.y-T.y}else{var tt=f.unproject(f.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(tt).x}this._updateBounds()}});function gu(e,o,h){return new Mr(e,o,h)}var le=_e.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,o){S(this,o),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var o=1/0,h=null,f=pi,m,b,T=0,F=this._parts.length;T<F;T++)for(var N=this._parts[T],U=1,q=N.length;U<q;U++){m=N[U-1],b=N[U];var tt=f(e,m,b,!0);tt<o&&(o=tt,h=f(e,m,b))}return h&&(h.distance=Math.sqrt(o)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ss(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,o){return o=o||this._defaultShape(),e=G(e),o.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new nt,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return Ut(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var o=[],h=Ut(e),f=0,m=e.length;f<m;f++)h?(o[f]=G(e[f]),this._bounds.extend(o[f])):o[f]=this._convertLatLngs(e[f]);return o},_project:function(){var e=new V;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),o=new Z(e,e);this._rawPxBounds&&(this._pxBounds=new V([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(e,o,h){var f=e[0]instanceof et,m=e.length,b,T;if(f){for(T=[],b=0;b<m;b++)T[b]=this._map.latLngToLayerPoint(e[b]),h.extend(T[b]);o.push(T)}else for(b=0;b<m;b++)this._projectLatlngs(e[b],o,h)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,h,f,m,b,T,F,N;for(h=0,m=0,b=this._rings.length;h<b;h++)for(N=this._rings[h],f=0,T=N.length;f<T-1;f++)F=rs(N[f],N[f+1],e,f,!0),F&&(o[m]=o[m]||[],o[m].push(F[0]),(F[1]!==N[f+1]||f===T-2)&&(o[m].push(F[1]),m++))}},_simplifyPoints:function(){for(var e=this._parts,o=this.options.smoothFactor,h=0,f=e.length;h<f;h++)e[h]=es(e[h],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,o){var h,f,m,b,T,F,N=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(h=0,b=this._parts.length;h<b;h++)for(F=this._parts[h],f=0,T=F.length,m=T-1;f<T;m=f++)if(!(!o&&f===0)&&is(e,F[m],F[f])<=N)return!0;return!1}});function vu(e,o){return new le(e,o)}le._flat=os;var Ie=le.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ts(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var o=le.prototype._convertLatLngs.call(this,e),h=o.length;return h>=2&&o[0]instanceof et&&o[0].equals(o[h-1])&&o.pop(),o},_setLatLngs:function(e){le.prototype._setLatLngs.call(this,e),Ut(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ut(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,o=this.options.weight,h=new Z(o,o);if(e=new V(e.min.subtract(h),e.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}for(var f=0,m=this._rings.length,b;f<m;f++)b=Qo(this._rings[f],e,!0),b.length&&this._parts.push(b)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var o=!1,h,f,m,b,T,F,N,U;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(b=0,N=this._parts.length;b<N;b++)for(h=this._parts[b],T=0,U=h.length,F=U-1;T<U;F=T++)f=h[T],m=h[F],f.y>e.y!=m.y>e.y&&e.x<(m.x-f.x)*(e.y-f.y)/(m.y-f.y)+f.x&&(o=!o);return o||le.prototype._containsPoint.call(this,e,!0)}});function yu(e,o){return new Ie(e,o)}var ue=he.extend({initialize:function(e,o){S(this,o),this._layers={},e&&this.addData(e)},addData:function(e){var o=y(e)?e:e.features,h,f,m;if(o){for(h=0,f=o.length;h<f;h++)m=o[h],(m.geometries||m.geometry||m.features||m.coordinates)&&this.addData(m);return this}var b=this.options;if(b.filter&&!b.filter(e))return this;var T=fn(e,b);return T?(T.feature=mn(e),T.defaultOptions=T.options,this.resetStyle(T),b.onEachFeature&&b.onEachFeature(e,T),this.addLayer(T)):this},resetStyle:function(e){return e===void 0?this.eachLayer(this.resetStyle,this):(e.options=s({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(o){this._setLayerStyle(o,e)},this)},_setLayerStyle:function(e,o){e.setStyle&&(typeof o=="function"&&(o=o(e.feature)),e.setStyle(o))}});function fn(e,o){var h=e.type==="Feature"?e.geometry:e,f=h?h.coordinates:null,m=[],b=o&&o.pointToLayer,T=o&&o.coordsToLatLng||Pr,F,N,U,q;if(!f&&!h)return null;switch(h.type){case"Point":return F=T(f),ls(b,e,F,o);case"MultiPoint":for(U=0,q=f.length;U<q;U++)F=T(f[U]),m.push(ls(b,e,F,o));return new he(m);case"LineString":case"MultiLineString":return N=dn(f,h.type==="LineString"?0:1,T),new le(N,o);case"Polygon":case"MultiPolygon":return N=dn(f,h.type==="Polygon"?1:2,T),new Ie(N,o);case"GeometryCollection":for(U=0,q=h.geometries.length;U<q;U++){var tt=fn({geometry:h.geometries[U],type:"Feature",properties:e.properties},o);tt&&m.push(tt)}return new he(m);case"FeatureCollection":for(U=0,q=h.features.length;U<q;U++){var st=fn(h.features[U],o);st&&m.push(st)}return new he(m);default:throw new Error("Invalid GeoJSON object.")}}function ls(e,o,h,f){return e?e(o,h):new un(h,f&&f.markersInheritOptions&&f)}function Pr(e){return new et(e[1],e[0],e[2])}function dn(e,o,h){for(var f=[],m=0,b=e.length,T;m<b;m++)T=o?dn(e[m],o-1,h):(h||Pr)(e[m]),f.push(T);return f}function Lr(e,o){return e=G(e),e.alt!==void 0?[v(e.lng,o),v(e.lat,o),v(e.alt,o)]:[v(e.lng,o),v(e.lat,o)]}function pn(e,o,h,f){for(var m=[],b=0,T=e.length;b<T;b++)m.push(o?pn(e[b],Ut(e[b])?0:o-1,h,f):Lr(e[b],f));return!o&&h&&m.length>0&&m.push(m[0].slice()),m}function Fe(e,o){return e.feature?s({},e.feature,{geometry:o}):mn(o)}function mn(e){return e.type==="Feature"||e.type==="FeatureCollection"?e:{type:"Feature",properties:{},geometry:e}}var Er={toGeoJSON:function(e){return Fe(this,{type:"Point",coordinates:Lr(this.getLatLng(),e)})}};un.include(Er),Mr.include(Er),cn.include(Er),le.include({toGeoJSON:function(e){var o=!Ut(this._latlngs),h=pn(this._latlngs,o?1:0,!1,e);return Fe(this,{type:(o?"Multi":"")+"LineString",coordinates:h})}}),Ie.include({toGeoJSON:function(e){var o=!Ut(this._latlngs),h=o&&!Ut(this._latlngs[0]),f=pn(this._latlngs,h?2:o?1:0,!0,e);return o||(f=[f]),Fe(this,{type:(h?"Multi":"")+"Polygon",coordinates:f})}}),ze.include({toMultiPoint:function(e){var o=[];return this.eachLayer(function(h){o.push(h.toGeoJSON(e).geometry.coordinates)}),Fe(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(e){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(e);var h=o==="GeometryCollection",f=[];return this.eachLayer(function(m){if(m.toGeoJSON){var b=m.toGeoJSON(e);if(h)f.push(b.geometry);else{var T=mn(b);T.type==="FeatureCollection"?f.push.apply(f,T.features):f.push(T)}}}),h?Fe(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});function us(e,o){return new ue(e,o)}var wu=us,_n=Vt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,o,h){this._url=e,this._bounds=Q(o),S(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&De(this._image),this},bringToBack:function(){return this._map&&Be(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=Q(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._url.tagName==="IMG",o=this._image=e?this._url:lt("img");if(ot(o,"leaflet-image-layer"),this._zoomAnimated&&ot(o,"leaflet-zoom-animated"),this.options.className&&ot(o,this.options.className),o.onselectstart=_,o.onmousemove=_,o.onload=l(this.fire,this,"load"),o.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(e){var o=this._map.getZoomScale(e.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;xe(this._image,h,o)},_reset:function(){var e=this._image,o=new V(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=o.getSize();gt(e,o.min),e.style.width=h.x+"px",e.style.height=h.y+"px"},_updateOpacity:function(){$t(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),xu=function(e,o,h){return new _n(e,o,h)},cs=_n.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e=this._url.tagName==="VIDEO",o=this._image=e?this._url:lt("video");if(ot(o,"leaflet-image-layer"),this._zoomAnimated&&ot(o,"leaflet-zoom-animated"),this.options.className&&ot(o,this.options.className),o.onselectstart=_,o.onmousemove=_,o.onloadeddata=l(this.fire,this,"load"),e){for(var h=o.getElementsByTagName("source"),f=[],m=0;m<h.length;m++)f.push(h[m].src);this._url=h.length>0?f:[o.src];return}y(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var b=0;b<this._url.length;b++){var T=lt("source");T.src=this._url[b],o.appendChild(T)}}});function bu(e,o,h){return new cs(e,o,h)}var fs=_n.extend({_initImage:function(){var e=this._image=this._url;ot(e,"leaflet-image-layer"),this._zoomAnimated&&ot(e,"leaflet-zoom-animated"),this.options.className&&ot(e,this.options.className),e.onselectstart=_,e.onmousemove=_}});function Mu(e,o,h){return new fs(e,o,h)}var ne=Vt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,o){e&&(e instanceof et||y(e))?(this._latlng=G(e),S(this,o)):(S(this,e),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(e){return e=arguments.length?e:this._source._map,e.hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&$t(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&$t(this._container,1),this.bringToFront(),this.options.interactive&&(ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?($t(this._container,0),this._removeTimeout=setTimeout(l(pt,void 0,this._container),200)):pt(this._container),this.options.interactive&&(mt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=G(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&De(this._container),this},bringToBack:function(){return this._map&&Be(this._container),this},_prepareOpen:function(e){var o=this._source;if(!o._map)return!1;if(o instanceof he){o=null;var h=this._source._layers;for(var f in h)if(h[f]._map){o=h[f];break}if(!o)return!1;this._source=o}if(!e)if(o.getCenter)e=o.getCenter();else if(o.getLatLng)e=o.getLatLng();else if(o.getBounds)e=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")e.innerHTML=o;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),o=R(this.options.offset),h=this._getAnchor();this._zoomAnimated?gt(this._container,e.add(h)):o=o.add(e).add(h);var f=this._containerBottom=-o.y,m=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=f+"px",this._container.style.left=m+"px"}},_getAnchor:function(){return[0,0]}});at.include({_initOverlay:function(e,o,h,f){var m=o;return m instanceof e||(m=new e(f).setContent(o)),h&&m.setLatLng(h),m}}),Vt.include({_initOverlay:function(e,o,h,f){var m=h;return m instanceof e?(S(m,f),m._source=this):(m=o&&!f?o:new e(f,this),m.setContent(h)),m}});var gn=ne.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return e=arguments.length?e:this._source._map,!e.hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,ne.prototype.openOn.call(this,e)},onAdd:function(e){ne.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _e||this._source.on("preclick",Me))},onRemove:function(e){ne.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _e||this._source.off("preclick",Me))},getEvents:function(){var e=ne.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",o=this._container=lt("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=lt("div",e+"-content-wrapper",o);if(this._contentNode=lt("div",e+"-content",h),fi(o),mr(this._contentNode),rt(o,"contextmenu",Me),this._tipContainer=lt("div",e+"-tip-container",o),this._tip=lt("div",e+"-tip",this._tipContainer),this.options.closeButton){var f=this._closeButton=lt("a",e+"-close-button",o);f.setAttribute("role","button"),f.setAttribute("aria-label","Close popup"),f.href="#close",f.innerHTML='<span aria-hidden="true">&#215;</span>',rt(f,"click",function(m){bt(m),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,o=e.style;o.width="",o.whiteSpace="nowrap";var h=e.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),o.width=h+1+"px",o.whiteSpace="",o.height="";var f=e.offsetHeight,m=this.options.maxHeight,b="leaflet-popup-scrolled";m&&f>m?(o.height=m+"px",ot(e,b)):mt(e,b),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),h=this._getAnchor();gt(this._container,o.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var e=this._map,o=parseInt(hi(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+o,f=this._containerWidth,m=new Z(this._containerLeft,-h-this._containerBottom);m._add(be(this._container));var b=e.layerPointToContainerPoint(m),T=R(this.options.autoPanPadding),F=R(this.options.autoPanPaddingTopLeft||T),N=R(this.options.autoPanPaddingBottomRight||T),U=e.getSize(),q=0,tt=0;b.x+f+N.x>U.x&&(q=b.x+f-U.x+N.x),b.x-q-F.x<0&&(q=b.x-F.x),b.y+h+N.y>U.y&&(tt=b.y+h-U.y+N.y),b.y-tt-F.y<0&&(tt=b.y-F.y),(q||tt)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([q,tt]))}},_getAnchor:function(){return R(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Pu=function(e,o){return new gn(e,o)};at.mergeOptions({closePopupOnClick:!0}),at.include({openPopup:function(e,o,h){return this._initOverlay(gn,e,o,h).openOn(this),this},closePopup:function(e){return e=arguments.length?e:this._popup,e&&e.close(),this}}),Vt.include({bindPopup:function(e,o){return this._popup=this._initOverlay(gn,this._popup,e,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof he||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(!(!this._popup||!this._map)){Pe(e);var o=e.layer||e.target;if(this._popup._source===o&&!(o instanceof _e)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng);return}this._popup._source=o,this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){e.originalEvent.keyCode===13&&this._openPopup(e)}});var vn=ne.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){ne.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){ne.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=ne.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip",o=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=lt("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var o,h,f=this._map,m=this._container,b=f.latLngToContainerPoint(f.getCenter()),T=f.layerPointToContainerPoint(e),F=this.options.direction,N=m.offsetWidth,U=m.offsetHeight,q=R(this.options.offset),tt=this._getAnchor();F==="top"?(o=N/2,h=U):F==="bottom"?(o=N/2,h=0):F==="center"?(o=N/2,h=U/2):F==="right"?(o=0,h=U/2):F==="left"?(o=N,h=U/2):T.x<b.x?(F="right",o=0,h=U/2):(F="left",o=N+(q.x+tt.x)*2,h=U/2),e=e.subtract(R(o,h,!0)).add(q).add(tt),mt(m,"leaflet-tooltip-right"),mt(m,"leaflet-tooltip-left"),mt(m,"leaflet-tooltip-top"),mt(m,"leaflet-tooltip-bottom"),ot(m,"leaflet-tooltip-"+F),gt(m,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&$t(this._container,e)},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(o)},_getAnchor:function(){return R(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Lu=function(e,o){return new vn(e,o)};at.include({openTooltip:function(e,o,h){return this._initOverlay(vn,e,o,h).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Vt.include({bindTooltip:function(e,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(vn,this._tooltip,e,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!(!e&&this._tooltipHandlersAdded)){var o=e?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[o](h),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof he||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var o=typeof e.getElement=="function"&&e.getElement();o&&(rt(o,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),rt(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var o=typeof e.getElement=="function"&&e.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(e)});return}this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)}},_moveTooltip:function(e){var o=e.latlng,h,f;this._tooltip.options.sticky&&e.originalEvent&&(h=this._map.mouseEventToContainerPoint(e.originalEvent),f=this._map.containerPointToLayerPoint(h),o=this._map.layerPointToLatLng(f)),this._tooltip.setLatLng(o)}});var ds=Oe.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var o=e&&e.tagName==="DIV"?e:document.createElement("div"),h=this.options;if(h.html instanceof Element?(rn(o),o.appendChild(h.html)):o.innerHTML=h.html!==!1?h.html:"",h.bgPos){var f=R(h.bgPos);o.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Eu(e){return new ds(e)}Oe.Default=mi;var _i=Vt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:K.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){S(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),pt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(De(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Be(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof Z?e:new Z(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var o=this.getPane().children,h=-e(-1/0,1/0),f=0,m=o.length,b;f<m;f++)b=o[f].style.zIndex,o[f]!==this._container&&b&&(h=e(h,+b));isFinite(h)&&(this.options.zIndex=h+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!K.ielt9){$t(this._container,this.options.opacity);var e=+new Date,o=!1,h=!1;for(var f in this._tiles){var m=this._tiles[f];if(!(!m.current||!m.loaded)){var b=Math.min(1,(e-m.loaded)/200);$t(m.el,b),b<1?o=!0:(m.active?h=!0:this._onOpaqueTile(m),m.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),o&&(j(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this))}},_onOpaqueTile:_,_initContainer:function(){this._container||(this._container=lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,o=this.options.maxZoom;if(e!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===e?(this._levels[h].el.style.zIndex=o-Math.abs(e-h),this._onUpdateLevel(h)):(pt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var f=this._levels[e],m=this._map;return f||(f=this._levels[e]={},f.el=lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=o,f.origin=m.project(m.unproject(m.getPixelOrigin()),e).round(),f.zoom=e,this._setZoomTransform(f,m.getCenter(),m.getZoom()),_(f.el.offsetWidth),this._onCreateLevel(f)),this._level=f,f}},_onUpdateLevel:_,_onRemoveLevel:_,_onCreateLevel:_,_pruneTiles:function(){if(this._map){var e,o,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)o=this._tiles[e],o.retain=o.current;for(e in this._tiles)if(o=this._tiles[e],o.current&&!o.active){var f=o.coords;this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(e){for(var o in this._tiles)this._tiles[o].coords.z===e&&this._removeTile(o)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)pt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,o,h,f){var m=Math.floor(e/2),b=Math.floor(o/2),T=h-1,F=new Z(+m,+b);F.z=+T;var N=this._tileCoordsToKey(F),U=this._tiles[N];return U&&U.active?(U.retain=!0,!0):(U&&U.loaded&&(U.retain=!0),T>f?this._retainParent(m,b,T,f):!1)},_retainChildren:function(e,o,h,f){for(var m=2*e;m<2*e+2;m++)for(var b=2*o;b<2*o+2;b++){var T=new Z(m,b);T.z=h+1;var F=this._tileCoordsToKey(T),N=this._tiles[F];if(N&&N.active){N.retain=!0;continue}else N&&N.loaded&&(N.retain=!0);h+1<f&&this._retainChildren(m,b,h+1,f)}},_resetView:function(e){var o=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var o=this.options;return o.minNativeZoom!==void 0&&e<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<e?o.maxNativeZoom:e},_setView:function(e,o,h,f){var m=Math.round(o);this.options.maxZoom!==void 0&&m>this.options.maxZoom||this.options.minZoom!==void 0&&m<this.options.minZoom?m=void 0:m=this._clampZoom(m);var b=this.options.updateWhenZooming&&m!==this._tileZoom;(!f||b)&&(this._tileZoom=m,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),m!==void 0&&this._update(e),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(e,o)},_setZoomTransforms:function(e,o){for(var h in this._levels)this._setZoomTransform(this._levels[h],e,o)},_setZoomTransform:function(e,o,h){var f=this._map.getZoomScale(h,e.zoom),m=e.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(o,h)).round();K.any3d?xe(e.el,m,f):gt(e.el,m)},_resetGrid:function(){var e=this._map,o=e.options.crs,h=this._tileSize=this.getTileSize(),f=this._tileZoom,m=this._map.getPixelWorldBounds(this._tileZoom);m&&(this._globalTileRange=this._pxBoundsToTileRange(m)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,o.wrapLng[0]],f).x/h.x),Math.ceil(e.project([0,o.wrapLng[1]],f).x/h.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([o.wrapLat[0],0],f).y/h.x),Math.ceil(e.project([o.wrapLat[1],0],f).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(e){var o=this._map,h=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),f=o.getZoomScale(h,this._tileZoom),m=o.project(e,this._tileZoom).floor(),b=o.getSize().divideBy(f*2);return new V(m.subtract(b),m.add(b))},_update:function(e){var o=this._map;if(o){var h=this._clampZoom(o.getZoom());if(e===void 0&&(e=o.getCenter()),this._tileZoom!==void 0){var f=this._getTiledPixelBounds(e),m=this._pxBoundsToTileRange(f),b=m.getCenter(),T=[],F=this.options.keepBuffer,N=new V(m.getBottomLeft().subtract([F,-F]),m.getTopRight().add([F,-F]));if(!(isFinite(m.min.x)&&isFinite(m.min.y)&&isFinite(m.max.x)&&isFinite(m.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var U in this._tiles){var q=this._tiles[U].coords;(q.z!==this._tileZoom||!N.contains(new Z(q.x,q.y)))&&(this._tiles[U].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(e,h);return}for(var tt=m.min.y;tt<=m.max.y;tt++)for(var st=m.min.x;st<=m.max.x;st++){var St=new Z(st,tt);if(St.z=this._tileZoom,!!this._isValidTile(St)){var xt=this._tiles[this._tileCoordsToKey(St)];xt?xt.current=!0:T.push(St)}}if(T.sort(function(Bt,Re){return Bt.distanceTo(b)-Re.distanceTo(b)}),T.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var jt=document.createDocumentFragment();for(st=0;st<T.length;st++)this._addTile(T[st],jt);this._level.el.appendChild(jt)}}}},_isValidTile:function(e){var o=this._map.options.crs;if(!o.infinite){var h=this._globalTileRange;if(!o.wrapLng&&(e.x<h.min.x||e.x>h.max.x)||!o.wrapLat&&(e.y<h.min.y||e.y>h.max.y))return!1}if(!this.options.bounds)return!0;var f=this._tileCoordsToBounds(e);return Q(this.options.bounds).overlaps(f)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var o=this._map,h=this.getTileSize(),f=e.scaleBy(h),m=f.add(h),b=o.unproject(f,e.z),T=o.unproject(m,e.z);return[b,T]},_tileCoordsToBounds:function(e){var o=this._tileCoordsToNwSe(e),h=new nt(o[0],o[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var o=e.split(":"),h=new Z(+o[0],+o[1]);return h.z=+o[2],h},_removeTile:function(e){var o=this._tiles[e];o&&(pt(o.el),delete this._tiles[e],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){ot(e,"leaflet-tile");var o=this.getTileSize();e.style.width=o.x+"px",e.style.height=o.y+"px",e.onselectstart=_,e.onmousemove=_,K.ielt9&&this.options.opacity<1&&$t(e,this.options.opacity)},_addTile:function(e,o){var h=this._getTilePos(e),f=this._tileCoordsToKey(e),m=this.createTile(this._wrapCoords(e),l(this._tileReady,this,e));this._initTile(m),this.createTile.length<2&&$(l(this._tileReady,this,e,null,m)),gt(m,h),this._tiles[f]={el:m,coords:e,current:!0},o.appendChild(m),this.fire("tileloadstart",{tile:m,coords:e})},_tileReady:function(e,o,h){o&&this.fire("tileerror",{error:o,tile:h,coords:e});var f=this._tileCoordsToKey(e);h=this._tiles[f],h&&(h.loaded=+new Date,this._map._fadeAnimated?($t(h.el,0),j(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),o||(ot(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),K.ielt9||!this._map._fadeAnimated?$(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var o=new Z(this._wrapX?p(e.x,this._wrapX):e.x,this._wrapY?p(e.y,this._wrapY):e.y);return o.z=e.z,o},_pxBoundsToTileRange:function(e){var o=this.getTileSize();return new V(e.min.unscaleBy(o).floor(),e.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Su(e){return new _i(e)}var Ne=_i.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,o){this._url=e,o=S(this,o),o.detectRetina&&K.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,o){return this._url===e&&o===void 0&&(o=!0),this._url=e,o||this.redraw(),this},createTile:function(e,o){var h=document.createElement("img");return rt(h,"load",l(this._tileOnLoad,this,o,h)),rt(h,"error",l(this._tileOnError,this,o,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(e),h},getTileUrl:function(e){var o={r:K.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-e.y;this.options.tms&&(o.y=h),o["-y"]=h}return g(this._url,s(o,this.options))},_tileOnLoad:function(e,o){K.ielt9?setTimeout(l(e,this,null,o),0):e(null,o)},_tileOnError:function(e,o,h){var f=this.options.errorTileUrl;f&&o.getAttribute("src")!==f&&(o.src=f),e(h,o)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,o=this.options.maxZoom,h=this.options.zoomReverse,f=this.options.zoomOffset;return h&&(e=o-e),e+f},_getSubdomain:function(e){var o=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var e,o;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&(o=this._tiles[e].el,o.onload=_,o.onerror=_,!o.complete)){o.src=E;var h=this._tiles[e].coords;pt(o),delete this._tiles[e],this.fire("tileabort",{tile:o,coords:h})}},_removeTile:function(e){var o=this._tiles[e];if(o)return o.el.setAttribute("src",E),_i.prototype._removeTile.call(this,e)},_tileReady:function(e,o,h){if(!(!this._map||h&&h.getAttribute("src")===E))return _i.prototype._tileReady.call(this,e,o,h)}});function ps(e,o){return new Ne(e,o)}var ms=Ne.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,o){this._url=e;var h=s({},this.defaultWmsParams);for(var f in o)f in this.options||(h[f]=o[f]);o=S(this,o);var m=o.detectRetina&&K.retina?2:1,b=this.getTileSize();h.width=b.x*m,h.height=b.y*m,this.wmsParams=h},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Ne.prototype.onAdd.call(this,e)},getTileUrl:function(e){var o=this._tileCoordsToNwSe(e),h=this._crs,f=H(h.project(o[0]),h.project(o[1])),m=f.min,b=f.max,T=(this._wmsVersion>=1.3&&this._crs===as?[m.y,m.x,b.y,b.x]:[m.x,m.y,b.x,b.y]).join(","),F=Ne.prototype.getTileUrl.call(this,e);return F+D(this.wmsParams,F,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+T},setParams:function(e,o){return s(this.wmsParams,e),o||this.redraw(),this}});function ku(e,o){return new ms(e,o)}Ne.WMS=ms,ps.wms=ku;var ce=Vt.extend({options:{padding:.1},initialize:function(e){S(this,e),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,o){var h=this._map.getZoomScale(o,this._zoom),f=this._map.getSize().multiplyBy(.5+this.options.padding),m=this._map.project(this._center,o),b=f.multiplyBy(-h).add(m).subtract(this._map._getNewPixelOrigin(e,o));K.any3d?xe(this._container,b,h):gt(this._container,b)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var e in this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,o=this._map.getSize(),h=this._map.containerPointToLayerPoint(o.multiplyBy(-e)).round();this._bounds=new V(h,h.add(o.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),_s=ce.extend({options:{tolerance:0},getEvents:function(){var e=ce.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ce.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");rt(e,"mousemove",this._onMouseMove,this),rt(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,pt(this._container),ct(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var e;this._redrawBounds=null;for(var o in this._layers)e=this._layers[o],e._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ce.prototype._update.call(this);var e=this._bounds,o=this._container,h=e.getSize(),f=K.retina?2:1;gt(o,e.min),o.width=f*h.x,o.height=f*h.y,o.style.width=h.x+"px",o.style.height=h.y+"px",K.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){ce.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[c(e)]=e;var o=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var o=e._order,h=o.next,f=o.prev;h?h.prev=f:this._drawLast=f,f?f.next=h:this._drawFirst=h,delete e._order,delete this._layers[c(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(typeof e.options.dashArray=="string"){var o=e.options.dashArray.split(/[, ]+/),h=[],f,m;for(m=0;m<o.length;m++){if(f=Number(o[m]),isNaN(f))return;h.push(f)}e.options._dashArray=h}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||$(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var o=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new V,this._redrawBounds.extend(e._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(e._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var o=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,o=this._redrawBounds;if(this._ctx.save(),o){var h=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)e=f.layer,(!o||e._pxBounds&&e._pxBounds.intersects(o))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,o){if(this._drawing){var h,f,m,b,T=e._parts,F=T.length,N=this._ctx;if(F){for(N.beginPath(),h=0;h<F;h++){for(f=0,m=T[h].length;f<m;f++)b=T[h][f],N[f?"lineTo":"moveTo"](b.x,b.y);o&&N.closePath()}this._fillStroke(N,e)}}},_updateCircle:function(e){if(!(!this._drawing||e._empty())){var o=e._point,h=this._ctx,f=Math.max(Math.round(e._radius),1),m=(Math.max(Math.round(e._radiusY),1)||f)/f;m!==1&&(h.save(),h.scale(1,m)),h.beginPath(),h.arc(o.x,o.y/m,f,0,Math.PI*2,!1),m!==1&&h.restore(),this._fillStroke(h,e)}},_fillStroke:function(e,o){var h=o.options;h.fill&&(e.globalAlpha=h.fillOpacity,e.fillStyle=h.fillColor||h.color,e.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(e.setLineDash&&e.setLineDash(o.options&&o.options._dashArray||[]),e.globalAlpha=h.opacity,e.lineWidth=h.weight,e.strokeStyle=h.color,e.lineCap=h.lineCap,e.lineJoin=h.lineJoin,e.stroke())},_onClick:function(e){for(var o=this._map.mouseEventToLayerPoint(e),h,f,m=this._drawFirst;m;m=m.next)h=m.layer,h.options.interactive&&h._containsPoint(o)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(h))&&(f=h);this._fireEvent(f?[f]:!1,e)},_onMouseMove:function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,o)}},_handleMouseOut:function(e){var o=this._hoveredLayer;o&&(mt(this._container,"leaflet-interactive"),this._fireEvent([o],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,o){if(!this._mouseHoverThrottled){for(var h,f,m=this._drawFirst;m;m=m.next)h=m.layer,h.options.interactive&&h._containsPoint(o)&&(f=h);f!==this._hoveredLayer&&(this._handleMouseOut(e),f&&(ot(this._container,"leaflet-interactive"),this._fireEvent([f],e,"mouseover"),this._hoveredLayer=f)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,e),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,o,h){this._map._fireDOMEvent(o,h||o.type,e)},_bringToFront:function(e){var o=e._order;if(o){var h=o.next,f=o.prev;if(h)h.prev=f;else return;f?f.next=h:h&&(this._drawFirst=h),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(e)}},_bringToBack:function(e){var o=e._order;if(o){var h=o.next,f=o.prev;if(f)f.next=h;else return;h?h.prev=f:f&&(this._drawLast=f),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(e)}}});function gs(e){return K.canvas?new _s(e):null}var gi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch{}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Cu={_initContainer:function(){this._container=lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ce.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var o=e._container=gi("shape");ot(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",e._path=gi("path"),o.appendChild(e._path),this._updateStyle(e),this._layers[c(e)]=e},_addPath:function(e){var o=e._container;this._container.appendChild(o),e.options.interactive&&e.addInteractiveTarget(o)},_removePath:function(e){var o=e._container;pt(o),e.removeInteractiveTarget(o),delete this._layers[c(e)]},_updateStyle:function(e){var o=e._stroke,h=e._fill,f=e.options,m=e._container;m.stroked=!!f.stroke,m.filled=!!f.fill,f.stroke?(o||(o=e._stroke=gi("stroke")),m.appendChild(o),o.weight=f.weight+"px",o.color=f.color,o.opacity=f.opacity,f.dashArray?o.dashStyle=y(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=f.lineCap.replace("butt","flat"),o.joinstyle=f.lineJoin):o&&(m.removeChild(o),e._stroke=null),f.fill?(h||(h=e._fill=gi("fill")),m.appendChild(h),h.color=f.fillColor||f.color,h.opacity=f.fillOpacity):h&&(m.removeChild(h),e._fill=null)},_updateCircle:function(e){var o=e._point.round(),h=Math.round(e._radius),f=Math.round(e._radiusY||h);this._setPath(e,e._empty()?"M0 0":"AL "+o.x+","+o.y+" "+h+","+f+" 0,"+65535*360)},_setPath:function(e,o){e._path.v=o},_bringToFront:function(e){De(e._container)},_bringToBack:function(e){Be(e._container)}},yn=K.vml?gi:At,vi=ce.extend({_initContainer:function(){this._container=yn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pt(this._container),ct(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ce.prototype._update.call(this);var e=this._bounds,o=e.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,h.setAttribute("width",o.x),h.setAttribute("height",o.y)),gt(h,e.min),h.setAttribute("viewBox",[e.min.x,e.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(e){var o=e._path=yn("path");e.options.className&&ot(o,e.options.className),e.options.interactive&&ot(o,"leaflet-interactive"),this._updateStyle(e),this._layers[c(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){pt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[c(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var o=e._path,h=e.options;o&&(h.stroke?(o.setAttribute("stroke",h.color),o.setAttribute("stroke-opacity",h.opacity),o.setAttribute("stroke-width",h.weight),o.setAttribute("stroke-linecap",h.lineCap),o.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?o.setAttribute("stroke-dasharray",h.dashArray):o.removeAttribute("stroke-dasharray"),h.dashOffset?o.setAttribute("stroke-dashoffset",h.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),h.fill?(o.setAttribute("fill",h.fillColor||h.color),o.setAttribute("fill-opacity",h.fillOpacity),o.setAttribute("fill-rule",h.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(e,o){this._setPath(e,Dt(e._parts,o))},_updateCircle:function(e){var o=e._point,h=Math.max(Math.round(e._radius),1),f=Math.max(Math.round(e._radiusY),1)||h,m="a"+h+","+f+" 0 1,0 ",b=e._empty()?"M0 0":"M"+(o.x-h)+","+o.y+m+h*2+",0 "+m+-h*2+",0 ";this._setPath(e,b)},_setPath:function(e,o){e._path.setAttribute("d",o)},_bringToFront:function(e){De(e._path)},_bringToBack:function(e){Be(e._path)}});K.vml&&vi.include(Cu);function vs(e){return K.svg||K.vml?new vi(e):null}at.include({getRenderer:function(e){var o=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(e){if(e==="overlayPane"||e===void 0)return!1;var o=this._paneRenderers[e];return o===void 0&&(o=this._createRenderer({pane:e}),this._paneRenderers[e]=o),o},_createRenderer:function(e){return this.options.preferCanvas&&gs(e)||vs(e)}});var ys=Ie.extend({initialize:function(e,o){Ie.prototype.initialize.call(this,this._boundsToLatLngs(e),o)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=Q(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Tu(e,o){return new ys(e,o)}vi.create=yn,vi.pointsToPath=Dt,ue.geometryToLayer=fn,ue.coordsToLatLng=Pr,ue.coordsToLatLngs=dn,ue.latLngToCoords=Lr,ue.latLngsToCoords=pn,ue.getFeature=Fe,ue.asFeature=mn,at.mergeOptions({boxZoom:!0});var ws=ie.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ct(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),li(),ar(),this._startPoint=this._map.mouseEventToContainerPoint(e),rt(document,{contextmenu:Pe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=lt("div","leaflet-zoom-box",this._container),ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var o=new V(this._point,this._startPoint),h=o.getSize();gt(this._box,o.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(pt(this._box),mt(this._container,"leaflet-crosshair")),ui(),hr(),ct(document,{contextmenu:Pe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var o=new nt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(e){e.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});at.addInitHook("addHandler","boxZoom",ws),at.mergeOptions({doubleClickZoom:!0});var xs=ie.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var o=this._map,h=o.getZoom(),f=o.options.zoomDelta,m=e.originalEvent.shiftKey?h-f:h+f;o.options.doubleClickZoom==="center"?o.setZoom(m):o.setZoomAround(e.containerPoint,m)}});at.addInitHook("addHandler","doubleClickZoom",xs),at.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var bs=ie.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new me(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){mt(this._map._container,"leaflet-grab"),mt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=Q(this._map.options.maxBounds);this._offsetLimit=H(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var o=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(o),this._prunePositions(o)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,o){return e-(e-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var e=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;e.x<o.min.x&&(e.x=this._viscousLimit(e.x,o.min.x)),e.y<o.min.y&&(e.y=this._viscousLimit(e.y,o.min.y)),e.x>o.max.x&&(e.x=this._viscousLimit(e.x,o.max.x)),e.y>o.max.y&&(e.y=this._viscousLimit(e.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,o=Math.round(e/2),h=this._initialWorldOffset,f=this._draggable._newPos.x,m=(f-o+h)%e+o-h,b=(f+o+h)%e-o-h,T=Math.abs(m+h)<Math.abs(b+h)?m:b;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=T},_onDragEnd:function(e){var o=this._map,h=o.options,f=!h.inertia||e.noInertia||this._times.length<2;if(o.fire("dragend",e),f)o.fire("moveend");else{this._prunePositions(+new Date);var m=this._lastPos.subtract(this._positions[0]),b=(this._lastTime-this._times[0])/1e3,T=h.easeLinearity,F=m.multiplyBy(T/b),N=F.distanceTo([0,0]),U=Math.min(h.inertiaMaxSpeed,N),q=F.multiplyBy(U/N),tt=U/(h.inertiaDeceleration*T),st=q.multiplyBy(-tt/2).round();!st.x&&!st.y?o.fire("moveend"):(st=o._limitOffset(st,o.options.maxBounds),$(function(){o.panBy(st,{duration:tt,easeLinearity:T,noMoveStart:!0,animate:!0})}))}}});at.addInitHook("addHandler","dragging",bs),at.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ms=ie.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),rt(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ct(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,o=document.documentElement,h=e.scrollTop||o.scrollTop,f=e.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(f,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var o=this._panKeys={},h=this.keyCodes,f,m;for(f=0,m=h.left.length;f<m;f++)o[h.left[f]]=[-1*e,0];for(f=0,m=h.right.length;f<m;f++)o[h.right[f]]=[e,0];for(f=0,m=h.down.length;f<m;f++)o[h.down[f]]=[0,e];for(f=0,m=h.up.length;f<m;f++)o[h.up[f]]=[0,-1*e]},_setZoomDelta:function(e){var o=this._zoomKeys={},h=this.keyCodes,f,m;for(f=0,m=h.zoomIn.length;f<m;f++)o[h.zoomIn[f]]=e;for(f=0,m=h.zoomOut.length;f<m;f++)o[h.zoomOut[f]]=-e},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ct(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var o=e.keyCode,h=this._map,f;if(o in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(f=this._panKeys[o],e.shiftKey&&(f=R(f).multiplyBy(3)),h.options.maxBounds&&(f=h._limitOffset(R(f),h.options.maxBounds)),h.options.worldCopyJump){var m=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(f)));h.panTo(m)}else h.panBy(f)}else if(o in this._zoomKeys)h.setZoom(h.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Pe(e)}}});at.addInitHook("addHandler","keyboard",Ms),at.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ps=ie.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ct(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var o=Ho(e),h=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var f=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),f),Pe(e)},_performZoom:function(){var e=this._map,o=e.getZoom(),h=this._map.options.zoomSnap||0;e._stop();var f=this._delta/(this._map.options.wheelPxPerZoomLevel*4),m=4*Math.log(2/(1+Math.exp(-Math.abs(f))))/Math.LN2,b=h?Math.ceil(m/h)*h:m,T=e._limitZoom(o+(this._delta>0?b:-b))-o;this._delta=0,this._startTime=null,T&&(e.options.scrollWheelZoom==="center"?e.setZoom(o+T):e.setZoomAround(this._lastMousePos,o+T))}});at.addInitHook("addHandler","scrollWheelZoom",Ps);var Au=600;at.mergeOptions({tapHold:K.touchNative&&K.safari&&K.mobile,tapTolerance:15});var Ls=ie.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ct(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),e.touches.length===1){var o=e.touches[0];this._startPos=this._newPos=new Z(o.clientX,o.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",bt),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Au),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){ct(document,"touchend",bt),ct(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),ct(document,"touchend touchcancel contextmenu",this._cancel,this),ct(document,"touchmove",this._onMove,this)},_onMove:function(e){var o=e.touches[0];this._newPos=new Z(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,o){var h=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});h._simulated=!0,o.target.dispatchEvent(h)}});at.addInitHook("addHandler","tapHold",Ls),at.mergeOptions({touchZoom:K.touch,bounceAtZoomLimits:!0});var Es=ie.extend({addHooks:function(){ot(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){mt(this._map._container,"leaflet-touch-zoom"),ct(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var o=this._map;if(!(!e.touches||e.touches.length!==2||o._animatingZoom||this._zooming)){var h=o.mouseEventToContainerPoint(e.touches[0]),f=o.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(h.add(f)._divideBy(2))),this._startDist=h.distanceTo(f),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),bt(e)}},_onTouchMove:function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var o=this._map,h=o.mouseEventToContainerPoint(e.touches[0]),f=o.mouseEventToContainerPoint(e.touches[1]),m=h.distanceTo(f)/this._startDist;if(this._zoom=o.getScaleZoom(m,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&m<1||this._zoom>o.getMaxZoom()&&m>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,m===1)return}else{var b=h._add(f)._divideBy(2)._subtract(this._centerPoint);if(m===1&&b.x===0&&b.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(b),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var T=l(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=$(T,this,!0),bt(e)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),ct(document,"touchmove",this._onTouchMove,this),ct(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});at.addInitHook("addHandler","touchZoom",Es),at.BoxZoom=ws,at.DoubleClickZoom=xs,at.Drag=bs,at.Keyboard=Ms,at.ScrollWheelZoom=Ps,at.TapHold=Ls,at.TouchZoom=Es,n.Bounds=V,n.Browser=K,n.CRS=ht,n.Canvas=_s,n.Circle=Mr,n.CircleMarker=cn,n.Class=w,n.Control=Wt,n.DivIcon=ds,n.DivOverlay=ne,n.DomEvent=Gl,n.DomUtil=Vl,n.Draggable=me,n.Evented=W,n.FeatureGroup=he,n.GeoJSON=ue,n.GridLayer=_i,n.Handler=ie,n.Icon=Oe,n.ImageOverlay=_n,n.LatLng=et,n.LatLngBounds=nt,n.Layer=Vt,n.LayerGroup=ze,n.LineUtil=hu,n.Map=at,n.Marker=un,n.Mixin=iu,n.Path=_e,n.Point=Z,n.PolyUtil=nu,n.Polygon=Ie,n.Polyline=le,n.Popup=gn,n.PosAnimation=Go,n.Projection=lu,n.Rectangle=ys,n.Renderer=ce,n.SVG=vi,n.SVGOverlay=fs,n.TileLayer=Ne,n.Tooltip=vn,n.Transformation=Pt,n.Util=X,n.VideoOverlay=cs,n.bind=l,n.bounds=H,n.canvas=gs,n.circle=gu,n.circleMarker=_u,n.control=di,n.divIcon=Eu,n.extend=s,n.featureGroup=du,n.geoJSON=us,n.geoJson=wu,n.gridLayer=Su,n.icon=pu,n.imageOverlay=xu,n.latLng=G,n.latLngBounds=Q,n.layerGroup=fu,n.map=ql,n.marker=mu,n.point=R,n.polygon=yu,n.polyline=vu,n.popup=Pu,n.rectangle=Tu,n.setOptions=S,n.stamp=c,n.svg=vs,n.svgOverlay=Mu,n.tileLayer=ps,n.tooltip=Lu,n.transformation=Tt,n.version=r,n.videoOverlay=bu;var Du=window.L;n.noConflict=function(){return window.L=Du,this},window.L=n})})(no,no.exports);var qh=no.exports;const Mp=ah(qh),Jh=Yu({__proto__:null,default:Mp},[qh]),Pp="_button_6v7zm_1",Lp="_active_6v7zm_21",Ep="_hiddenOnMobile_6v7zm_26",Fn={button:Pp,active:Lp,hiddenOnMobile:Ep};function Sp(i){return i.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}const kp=({mode:i,currentMode:t,changeMode:n,label:r,hiddenOnTouch:s})=>{let a=Fn.button;return s&&(a=`${Fn.hiddenOnMobile} ${a}`),t===i&&(a=`${Fn.active} ${a}`),ft("button",{id:i,class:a,onClick:()=>{n(i)},children:r||Sp(i)})},Cp=({label:i,onClick:t})=>ft("button",{id:"clear",class:Fn.button,onClick:()=>{t()},children:i}),Tp="_buttons_123u9_1",Ap={buttons:Tp},Dp=({mode:i,onClear:t,changeMode:n})=>ft("div",{class:Ap.buttons,children:[ft(kp,{label:"Route Snap",mode:"routesnap",currentMode:i,changeMode:n}),ft(Cp,{onClick:t,label:"Clear"})]});function Bp(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function zp(i,t,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return Bp({type:"Polygon",coordinates:i},t,n)}function Kh(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,v,x=i.type,P=x==="FeatureCollection",S=x==="Feature",D=P?i.features.length:1,k=0;k<D;k++){d=P?i.features[k].geometry:S?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var y=0,M=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,k,y,M)===!1)return!1;_++,y++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,k,y,M)===!1)return!1;_++,E==="MultiPoint"&&y++}E==="LineString"&&y++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,k,y,M)===!1)return!1;_++}E==="MultiLineString"&&y++,E==="Polygon"&&M++}E==="Polygon"&&y++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(M=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,k,y,M)===!1)return!1;_++}M++}y++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(Kh(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var Po={exports:{}},Qh={exports:{}};(function(i,t){(function(n,r){i.exports=r()})(co,function(){function n(g,y,M,E,B){(function C(A,I,Y,$,j){for(;$>Y;){if($-Y>600){var X=$-Y+1,w=I-Y+1,z=Math.log(X),O=.5*Math.exp(2*z/3),W=.5*Math.sqrt(z*O*(X-O)/X)*(w-X/2<0?-1:1),Z=Math.max(Y,Math.floor(I-w*O/X+W)),J=Math.min($,Math.floor(I+(X-w)*O/X+W));C(A,I,Z,J,j)}var R=A[I],V=Y,H=$;for(r(A,Y,I),j(A[$],R)>0&&r(A,Y,$);V<H;){for(r(A,V,H),V++,H--;j(A[V],R)<0;)V++;for(;j(A[H],R)>0;)H--}j(A[Y],R)===0?r(A,Y,H):r(A,++H,$),H<=I&&(Y=H+1),I<=H&&($=H-1)}})(g,y,M||0,E||g.length-1,B||s)}function r(g,y,M){var E=g[y];g[y]=g[M],g[M]=E}function s(g,y){return g<y?-1:g>y?1:0}var a=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(g,y,M){if(!M)return y.indexOf(g);for(var E=0;E<y.length;E++)if(M(g,y[E]))return E;return-1}function u(g,y){c(g,0,g.children.length,y,g)}function c(g,y,M,E,B){B||(B=D(null)),B.minX=1/0,B.minY=1/0,B.maxX=-1/0,B.maxY=-1/0;for(var C=y;C<M;C++){var A=g.children[C];d(B,g.leaf?E(A):A)}return B}function d(g,y){return g.minX=Math.min(g.minX,y.minX),g.minY=Math.min(g.minY,y.minY),g.maxX=Math.max(g.maxX,y.maxX),g.maxY=Math.max(g.maxY,y.maxY),g}function p(g,y){return g.minX-y.minX}function _(g,y){return g.minY-y.minY}function v(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function x(g){return g.maxX-g.minX+(g.maxY-g.minY)}function P(g,y){return g.minX<=y.minX&&g.minY<=y.minY&&y.maxX<=g.maxX&&y.maxY<=g.maxY}function S(g,y){return y.minX<=g.maxX&&y.minY<=g.maxY&&y.maxX>=g.minX&&y.maxY>=g.minY}function D(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(g,y,M,E,B){for(var C=[y,M];C.length;)if(!((M=C.pop())-(y=C.pop())<=E)){var A=y+Math.ceil((M-y)/E/2)*E;n(g,A,y,M,B),C.push(y,A,A,M)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(g){var y=this.data,M=[];if(!S(g,y))return M;for(var E=this.toBBox,B=[];y;){for(var C=0;C<y.children.length;C++){var A=y.children[C],I=y.leaf?E(A):A;S(g,I)&&(y.leaf?M.push(A):P(g,I)?this._all(A,M):B.push(A))}y=B.pop()}return M},a.prototype.collides=function(g){var y=this.data;if(!S(g,y))return!1;for(var M=[];y;){for(var E=0;E<y.children.length;E++){var B=y.children[E],C=y.leaf?this.toBBox(B):B;if(S(g,C)){if(y.leaf||P(g,C))return!0;M.push(B)}}y=M.pop()}return!1},a.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var y=0;y<g.length;y++)this.insert(g[y]);return this}var M=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===M.height)this._splitRoot(this.data,M);else{if(this.data.height<M.height){var E=this.data;this.data=M,M=E}this._insert(M,this.data.height-M.height-1,!0)}else this.data=M;return this},a.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},a.prototype.clear=function(){return this.data=D([]),this},a.prototype.remove=function(g,y){if(!g)return this;for(var M,E,B,C=this.data,A=this.toBBox(g),I=[],Y=[];C||I.length;){if(C||(C=I.pop(),E=I[I.length-1],M=Y.pop(),B=!0),C.leaf){var $=l(g,C.children,y);if($!==-1)return C.children.splice($,1),I.push(C),this._condense(I),this}B||C.leaf||!P(C,A)?E?(M++,C=E.children[M],B=!1):C=null:(I.push(C),Y.push(M),M=0,E=C,C=C.children[0])}return this},a.prototype.toBBox=function(g){return g},a.prototype.compareMinX=function(g,y){return g.minX-y.minX},a.prototype.compareMinY=function(g,y){return g.minY-y.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(g){return this.data=g,this},a.prototype._all=function(g,y){for(var M=[];g;)g.leaf?y.push.apply(y,g.children):M.push.apply(M,g.children),g=M.pop();return y},a.prototype._build=function(g,y,M,E){var B,C=M-y+1,A=this._maxEntries;if(C<=A)return u(B=D(g.slice(y,M+1)),this.toBBox),B;E||(E=Math.ceil(Math.log(C)/Math.log(A)),A=Math.ceil(C/Math.pow(A,E-1))),(B=D([])).leaf=!1,B.height=E;var I=Math.ceil(C/A),Y=I*Math.ceil(Math.sqrt(A));k(g,y,M,Y,this.compareMinX);for(var $=y;$<=M;$+=Y){var j=Math.min($+Y-1,M);k(g,$,j,I,this.compareMinY);for(var X=$;X<=j;X+=I){var w=Math.min(X+I-1,j);B.children.push(this._build(g,X,w,E-1))}}return u(B,this.toBBox),B},a.prototype._chooseSubtree=function(g,y,M,E){for(;E.push(y),!y.leaf&&E.length-1!==M;){for(var B=1/0,C=1/0,A=void 0,I=0;I<y.children.length;I++){var Y=y.children[I],$=v(Y),j=(X=g,w=Y,(Math.max(w.maxX,X.maxX)-Math.min(w.minX,X.minX))*(Math.max(w.maxY,X.maxY)-Math.min(w.minY,X.minY))-$);j<C?(C=j,B=$<B?$:B,A=Y):j===C&&$<B&&(B=$,A=Y)}y=A||y.children[0]}var X,w;return y},a.prototype._insert=function(g,y,M){var E=M?g:this.toBBox(g),B=[],C=this._chooseSubtree(E,this.data,y,B);for(C.children.push(g),d(C,E);y>=0&&B[y].children.length>this._maxEntries;)this._split(B,y),y--;this._adjustParentBBoxes(E,B,y)},a.prototype._split=function(g,y){var M=g[y],E=M.children.length,B=this._minEntries;this._chooseSplitAxis(M,B,E);var C=this._chooseSplitIndex(M,B,E),A=D(M.children.splice(C,M.children.length-C));A.height=M.height,A.leaf=M.leaf,u(M,this.toBBox),u(A,this.toBBox),y?g[y-1].children.push(A):this._splitRoot(M,A)},a.prototype._splitRoot=function(g,y){this.data=D([g,y]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(g,y,M){for(var E,B,C,A,I,Y,$,j=1/0,X=1/0,w=y;w<=M-y;w++){var z=c(g,0,w,this.toBBox),O=c(g,w,M,this.toBBox),W=(B=z,C=O,A=void 0,I=void 0,Y=void 0,$=void 0,A=Math.max(B.minX,C.minX),I=Math.max(B.minY,C.minY),Y=Math.min(B.maxX,C.maxX),$=Math.min(B.maxY,C.maxY),Math.max(0,Y-A)*Math.max(0,$-I)),Z=v(z)+v(O);W<j?(j=W,E=w,X=Z<X?Z:X):W===j&&Z<X&&(X=Z,E=w)}return E||M-y},a.prototype._chooseSplitAxis=function(g,y,M){var E=g.leaf?this.compareMinX:p,B=g.leaf?this.compareMinY:_;this._allDistMargin(g,y,M,E)<this._allDistMargin(g,y,M,B)&&g.children.sort(E)},a.prototype._allDistMargin=function(g,y,M,E){g.children.sort(E);for(var B=this.toBBox,C=c(g,0,y,B),A=c(g,M-y,M,B),I=x(C)+x(A),Y=y;Y<M-y;Y++){var $=g.children[Y];d(C,g.leaf?B($):$),I+=x(C)}for(var j=M-y-1;j>=y;j--){var X=g.children[j];d(A,g.leaf?B(X):X),I+=x(A)}return I},a.prototype._adjustParentBBoxes=function(g,y,M){for(var E=M;E>=0;E--)d(y[E],g)},a.prototype._condense=function(g){for(var y=g.length-1,M=void 0;y>=0;y--)g[y].children.length===0?y>0?(M=g[y-1].children).splice(M.indexOf(g[y]),1):this.clear():u(g[y],this.toBBox)},a})})(Qh);var Op=Qh.exports;class tl{constructor(t=[],n=Ip){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=(t<<1)+1,u=n[l];const c=l+1;if(c<this.length&&r(n[c],u)<0&&(l=c,u=n[c]),r(u,a)>=0)break;n[t]=u,t=l}n[t]=a}}function Ip(i,t){return i<t?-1:i>t?1:0}const Fp=Object.freeze(Object.defineProperty({__proto__:null,default:tl},Symbol.toStringTag,{value:"Module"})),Np=fo(Fp);var Qn={exports:{}},Rp=function(t,n,r,s){var a=t[0],l=t[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var c=(s-r)/2,d=0,p=c-1;d<c;p=d++){var _=n[r+d*2+0],v=n[r+d*2+1],x=n[r+p*2+0],P=n[r+p*2+1],S=v>l!=P>l&&a<(x-_)*(l-v)/(P-v)+_;S&&(u=!u)}return u},Zp=function(t,n,r,s){var a=t[0],l=t[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var c=s-r,d=0,p=c-1;d<c;p=d++){var _=n[d+r][0],v=n[d+r][1],x=n[p+r][0],P=n[p+r][1],S=v>l!=P>l&&a<(x-_)*(l-v)/(P-v)+_;S&&(u=!u)}return u},el=Rp,il=Zp;Qn.exports=function(t,n,r,s){return n.length>0&&Array.isArray(n[0])?il(t,n,r,s):el(t,n,r,s)};Qn.exports.nested=il;Qn.exports.flat=el;var Yp=Qn.exports,ro={exports:{}};(function(i,t){(function(n,r){r(t)})(co,function(n){const s=33306690738754706e-32;function a(S,D,k,g,y){let M,E,B,C,A=D[0],I=g[0],Y=0,$=0;I>A==I>-A?(M=A,A=D[++Y]):(M=I,I=g[++$]);let j=0;if(Y<S&&$<k)for(I>A==I>-A?(B=M-((E=A+M)-A),A=D[++Y]):(B=M-((E=I+M)-I),I=g[++$]),M=E,B!==0&&(y[j++]=B);Y<S&&$<k;)I>A==I>-A?(B=M-((E=M+A)-(C=E-M))+(A-C),A=D[++Y]):(B=M-((E=M+I)-(C=E-M))+(I-C),I=g[++$]),M=E,B!==0&&(y[j++]=B);for(;Y<S;)B=M-((E=M+A)-(C=E-M))+(A-C),A=D[++Y],M=E,B!==0&&(y[j++]=B);for(;$<k;)B=M-((E=M+I)-(C=E-M))+(I-C),I=g[++$],M=E,B!==0&&(y[j++]=B);return M===0&&j!==0||(y[j++]=M),j}function l(S){return new Float64Array(S)}const u=33306690738754716e-32,c=22204460492503146e-32,d=11093356479670487e-47,p=l(4),_=l(8),v=l(12),x=l(16),P=l(4);n.orient2d=function(S,D,k,g,y,M){const E=(D-M)*(k-y),B=(S-y)*(g-M),C=E-B;if(E===0||B===0||E>0!=B>0)return C;const A=Math.abs(E+B);return Math.abs(C)>=u*A?C:-function(I,Y,$,j,X,w,z){let O,W,Z,J,R,V,H,nt,Q,et,G,ht,dt,wt,Mt,Pt,Tt,Lt;const Nt=I-X,At=$-X,Dt=Y-w,Et=j-w;R=(Mt=(nt=Nt-(H=(V=134217729*Nt)-(V-Nt)))*(et=Et-(Q=(V=134217729*Et)-(V-Et)))-((wt=Nt*Et)-H*Q-nt*Q-H*et))-(G=Mt-(Tt=(nt=Dt-(H=(V=134217729*Dt)-(V-Dt)))*(et=At-(Q=(V=134217729*At)-(V-At)))-((Pt=Dt*At)-H*Q-nt*Q-H*et))),p[0]=Mt-(G+R)+(R-Tt),R=(dt=wt-((ht=wt+G)-(R=ht-wt))+(G-R))-(G=dt-Pt),p[1]=dt-(G+R)+(R-Pt),R=(Lt=ht+G)-ht,p[2]=ht-(Lt-R)+(G-R),p[3]=Lt;let Rt=function(Qi,tn){let en=tn[0];for(let we=1;we<Qi;we++)en+=tn[we];return en}(4,p),ye=c*z;if(Rt>=ye||-Rt>=ye||(O=I-(Nt+(R=I-Nt))+(R-X),Z=$-(At+(R=$-At))+(R-X),W=Y-(Dt+(R=Y-Dt))+(R-w),J=j-(Et+(R=j-Et))+(R-w),O===0&&W===0&&Z===0&&J===0)||(ye=d*z+s*Math.abs(Rt),(Rt+=Nt*J+Et*O-(Dt*Z+At*W))>=ye||-Rt>=ye))return Rt;R=(Mt=(nt=O-(H=(V=134217729*O)-(V-O)))*(et=Et-(Q=(V=134217729*Et)-(V-Et)))-((wt=O*Et)-H*Q-nt*Q-H*et))-(G=Mt-(Tt=(nt=W-(H=(V=134217729*W)-(V-W)))*(et=At-(Q=(V=134217729*At)-(V-At)))-((Pt=W*At)-H*Q-nt*Q-H*et))),P[0]=Mt-(G+R)+(R-Tt),R=(dt=wt-((ht=wt+G)-(R=ht-wt))+(G-R))-(G=dt-Pt),P[1]=dt-(G+R)+(R-Pt),R=(Lt=ht+G)-ht,P[2]=ht-(Lt-R)+(G-R),P[3]=Lt;const Ji=a(4,p,4,P,_);R=(Mt=(nt=Nt-(H=(V=134217729*Nt)-(V-Nt)))*(et=J-(Q=(V=134217729*J)-(V-J)))-((wt=Nt*J)-H*Q-nt*Q-H*et))-(G=Mt-(Tt=(nt=Dt-(H=(V=134217729*Dt)-(V-Dt)))*(et=Z-(Q=(V=134217729*Z)-(V-Z)))-((Pt=Dt*Z)-H*Q-nt*Q-H*et))),P[0]=Mt-(G+R)+(R-Tt),R=(dt=wt-((ht=wt+G)-(R=ht-wt))+(G-R))-(G=dt-Pt),P[1]=dt-(G+R)+(R-Pt),R=(Lt=ht+G)-ht,P[2]=ht-(Lt-R)+(G-R),P[3]=Lt;const oi=a(Ji,_,4,P,v);R=(Mt=(nt=O-(H=(V=134217729*O)-(V-O)))*(et=J-(Q=(V=134217729*J)-(V-J)))-((wt=O*J)-H*Q-nt*Q-H*et))-(G=Mt-(Tt=(nt=W-(H=(V=134217729*W)-(V-W)))*(et=Z-(Q=(V=134217729*Z)-(V-Z)))-((Pt=W*Z)-H*Q-nt*Q-H*et))),P[0]=Mt-(G+R)+(R-Tt),R=(dt=wt-((ht=wt+G)-(R=ht-wt))+(G-R))-(G=dt-Pt),P[1]=dt-(G+R)+(R-Pt),R=(Lt=ht+G)-ht,P[2]=ht-(Lt-R)+(G-R),P[3]=Lt;const Ki=a(oi,v,4,P,x);return x[Ki-1]}(S,D,k,g,y,M,A)},n.orient2dfast=function(S,D,k,g,y,M){return(D-M)*(k-y)-(S-y)*(g-M)},Object.defineProperty(n,"__esModule",{value:!0})})})(ro,ro.exports);var Xp=ro.exports,La=Op,Nn=Np,$p=Yp,Up=Xp.orient2d;Nn.default&&(Nn=Nn.default);Po.exports=nl;Po.exports.default=nl;function nl(i,t,n){t=Math.max(0,t===void 0?2:t),n=n||0;var r=Gp(i),s=new La(16);s.toBBox=function(g){return{minX:g[0],minY:g[1],maxX:g[0],maxY:g[1]}},s.compareMinX=function(g,y){return g[0]-y[0]},s.compareMinY=function(g,y){return g[1]-y[1]},s.load(i);for(var a=[],l=0,u;l<r.length;l++){var c=r[l];s.remove(c),u=ka(c,u),a.push(u)}var d=new La(16);for(l=0;l<a.length;l++)d.insert(Rr(a[l]));for(var p=t*t,_=n*n;a.length;){var v=a.shift(),x=v.p,P=v.next.p,S=Zr(x,P);if(!(S<_)){var D=S/p;c=jp(s,v.prev.p,x,P,v.next.next.p,D,d),c&&Math.min(Zr(c,x),Zr(c,P))<=D&&(a.push(v),a.push(ka(c,v)),s.remove(c),d.remove(v),d.insert(Rr(v)),d.insert(Rr(v.next)))}}v=u;var k=[];do k.push(v.p),v=v.next;while(v!==u);return k.push(v.p),k}function jp(i,t,n,r,s,a,l){for(var u=new Nn([],Wp),c=i.data;c;){for(var d=0;d<c.children.length;d++){var p=c.children[d],_=c.leaf?Yr(p,n,r):Vp(n,r,p);_>a||u.push({node:p,dist:_})}for(;u.length&&!u.peek().node.children;){var v=u.pop(),x=v.node,P=Yr(x,t,n),S=Yr(x,r,s);if(v.dist<P&&v.dist<S&&Sa(n,x,l)&&Sa(r,x,l))return x}c=u.pop(),c&&(c=c.node)}return null}function Wp(i,t){return i.dist-t.dist}function Vp(i,t,n){if(Ea(i,n)||Ea(t,n))return 0;var r=Cn(i[0],i[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var s=Cn(i[0],i[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(s===0)return 0;var a=Cn(i[0],i[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var l=Cn(i[0],i[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return l===0?0:Math.min(r,s,a,l)}function Ea(i,t){return i[0]>=t.minX&&i[0]<=t.maxX&&i[1]>=t.minY&&i[1]<=t.maxY}function Sa(i,t,n){for(var r=Math.min(i[0],t[0]),s=Math.min(i[1],t[1]),a=Math.max(i[0],t[0]),l=Math.max(i[1],t[1]),u=n.search({minX:r,minY:s,maxX:a,maxY:l}),c=0;c<u.length;c++)if(Hp(u[c].p,u[c].next.p,i,t))return!1;return!0}function qe(i,t,n){return Up(i[0],i[1],t[0],t[1],n[0],n[1])}function Hp(i,t,n,r){return i!==r&&t!==n&&qe(i,t,n)>0!=qe(i,t,r)>0&&qe(n,r,i)>0!=qe(n,r,t)>0}function Rr(i){var t=i.p,n=i.next.p;return i.minX=Math.min(t[0],n[0]),i.minY=Math.min(t[1],n[1]),i.maxX=Math.max(t[0],n[0]),i.maxY=Math.max(t[1],n[1]),i}function Gp(i){for(var t=i[0],n=i[0],r=i[0],s=i[0],a=0;a<i.length;a++){var l=i[a];l[0]<t[0]&&(t=l),l[0]>r[0]&&(r=l),l[1]<n[1]&&(n=l),l[1]>s[1]&&(s=l)}var u=[t,n,r,s],c=u.slice();for(a=0;a<i.length;a++)$p(i[a],u)||c.push(i[a]);return Jp(c)}function ka(i,t){var n={p:i,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function Zr(i,t){var n=i[0]-t[0],r=i[1]-t[1];return n*n+r*r}function Yr(i,t,n){var r=t[0],s=t[1],a=n[0]-r,l=n[1]-s;if(a!==0||l!==0){var u=((i[0]-r)*a+(i[1]-s)*l)/(a*a+l*l);u>1?(r=n[0],s=n[1]):u>0&&(r+=a*u,s+=l*u)}return a=i[0]-r,l=i[1]-s,a*a+l*l}function Cn(i,t,n,r,s,a,l,u){var c=n-i,d=r-t,p=l-s,_=u-a,v=i-s,x=t-a,P=c*c+d*d,S=c*p+d*_,D=p*p+_*_,k=c*v+d*x,g=p*v+_*x,y=P*D-S*S,M,E,B,C,A=y,I=y;y===0?(E=0,A=1,C=g,I=D):(E=S*g-D*k,C=P*g-S*k,E<0?(E=0,C=g,I=D):E>A&&(E=A,C=g+S,I=D)),C<0?(C=0,-k<0?E=0:-k>P?E=A:(E=-k,A=P)):C>I&&(C=I,-k+S<0?E=0:-k+S>P?E=A:(E=-k+S,A=P)),M=E===0?0:E/A,B=C===0?0:C/I;var Y=(1-M)*i+M*n,$=(1-M)*t+M*r,j=(1-B)*s+B*l,X=(1-B)*a+B*u,w=j-Y,z=X-$;return w*w+z*z}function qp(i,t){return i[0]===t[0]?i[1]-t[1]:i[0]-t[0]}function Jp(i){i.sort(qp);for(var t=[],n=0;n<i.length;n++){for(;t.length>=2&&qe(t[t.length-2],t[t.length-1],i[n])<=0;)t.pop();t.push(i[n])}for(var r=[],s=i.length-1;s>=0;s--){for(;r.length>=2&&qe(r[r.length-2],r[r.length-1],i[s])<=0;)r.pop();r.push(i[s])}return r.pop(),t.pop(),t.concat(r)}var Kp=Po.exports;const Qp=ah(Kp);function tm(i,t={}){t.concavity=t.concavity||1/0;const n=[];if(Kh(i,s=>{n.push([s[0],s[1]])}),!n.length)return null;const r=Qp(n,t.concavity);return r.length>3?zp([r]):null}var Ca=tm;function em(i){if(!i)throw new Error("geojson is required");switch(i.type){case"Feature":return rl(i);case"FeatureCollection":return im(i);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Lo(i);default:throw new Error("unknown GeoJSON type")}}function rl(i){const t={type:"Feature"};return Object.keys(i).forEach(n=>{switch(n){case"type":case"properties":case"geometry":return;default:t[n]=i[n]}}),t.properties=ol(i.properties),i.geometry==null?t.geometry=null:t.geometry=Lo(i.geometry),t}function ol(i){const t={};return i&&Object.keys(i).forEach(n=>{const r=i[n];typeof r=="object"?r===null?t[n]=null:Array.isArray(r)?t[n]=r.map(s=>s):t[n]=ol(r):t[n]=r}),t}function im(i){const t={type:"FeatureCollection"};return Object.keys(i).forEach(n=>{switch(n){case"type":case"features":return;default:t[n]=i[n]}}),t.features=i.features.map(n=>rl(n)),t}function Lo(i){const t={type:i.type};return i.bbox&&(t.bbox=i.bbox),i.type==="GeometryCollection"?(t.geometries=i.geometries.map(n=>Lo(n)),t):(t.coordinates=sl(i.coordinates),t)}function sl(i){const t=i;return typeof t[0]!="object"?t.slice():t.map(n=>sl(n))}function al(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,v,x=i.type,P=x==="FeatureCollection",S=x==="Feature",D=P?i.features.length:1,k=0;k<D;k++){d=P?i.features[k].geometry:S?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var y=0,M=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,k,y,M)===!1)return!1;_++,y++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,k,y,M)===!1)return!1;_++,E==="MultiPoint"&&y++}E==="LineString"&&y++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,k,y,M)===!1)return!1;_++}E==="MultiLineString"&&y++,E==="Polygon"&&M++}E==="Polygon"&&y++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(M=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,k,y,M)===!1)return!1;_++}M++}y++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(al(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Hn(i,t={}){if(i.bbox!=null&&t.recompute!==!0)return i.bbox;const n=[1/0,1/0,-1/0,-1/0];return al(i,r=>{n[0]>r[0]&&(n[0]=r[0]),n[1]>r[1]&&(n[1]=r[1]),n[2]<r[0]&&(n[2]=r[0]),n[3]<r[1]&&(n[3]=r[1])}),n}function nm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function rm(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ta(i[0])||!Ta(i[1]))throw new Error("coordinates must contain numbers");return nm({type:"Point",coordinates:i},t,n)}function Ta(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function om(i,t={}){const n=Hn(i),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return rm([r,s],t.properties,t)}function sm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function am(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Aa(i[0])||!Aa(i[1]))throw new Error("coordinates must contain numbers");return sm({type:"Point",coordinates:i},t,n)}function Aa(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function hl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,v,x=i.type,P=x==="FeatureCollection",S=x==="Feature",D=P?i.features.length:1,k=0;k<D;k++){d=P?i.features[k].geometry:S?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var y=0,M=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=E==="Polygon"||E==="MultiPolygon"?1:0,E){case null:break;case"Point":if(t(c,_,k,y,M)===!1)return!1;_++,y++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,k,y,M)===!1)return!1;_++,E==="MultiPoint"&&y++}E==="LineString"&&y++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,k,y,M)===!1)return!1;_++}E==="MultiLineString"&&y++,E==="Polygon"&&M++}E==="Polygon"&&y++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(M=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,k,y,M)===!1)return!1;_++}M++}y++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(hl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function hm(i,t={}){let n=0,r=0,s=0;return hl(i,function(a){n+=a[0],r+=a[1],s++}),am([n/s,r/s],t.properties)}function lm(i){return i%(2*Math.PI)*180/Math.PI}function Xr(i){return i%360*Math.PI/180}function Tn(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function um(i,t,n={}){let r;return n.final?r=Da(Tn(t),Tn(i)):r=Da(Tn(i),Tn(t)),r>180?-(360-r):r}function Da(i,t){const n=Xr(i[1]),r=Xr(t[1]);let s=Xr(t[0]-i[0]);s>Math.PI&&(s-=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI);const a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),l=Math.atan2(s,a);return(lm(l)+360)%360}var Ot=63710088e-1,ll={centimeters:Ot*100,centimetres:Ot*100,degrees:360/(2*Math.PI),feet:Ot*3.28084,inches:Ot*39.37,kilometers:Ot/1e3,kilometres:Ot/1e3,meters:Ot,metres:Ot,miles:Ot/1609.344,millimeters:Ot*1e3,millimetres:Ot*1e3,nauticalmiles:Ot/1852,radians:1,yards:Ot*1.0936};function cm(i,t="kilometers"){const n=ll[t];if(!n)throw new Error(t+" units is invalid");return i*n}function fm(i,t="kilometers"){const n=ll[t];if(!n)throw new Error(t+" units is invalid");return i/n}function dm(i,t="kilometers",n="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return cm(fm(i,t),n)}function Ba(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function pm(i,t,n={}){const r=Ba(i),s=Ba(t);s[0]+=s[0]-r[0]>180?-360:r[0]-s[0]>180?360:0;const a=mm(r,s);return dm(a,"meters",n.units)}function mm(i,t,n){n=n===void 0?Ot:Number(n);const r=n,s=i[1]*Math.PI/180,a=t[1]*Math.PI/180,l=a-s;let u=Math.abs(t[0]-i[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);const c=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=Math.abs(c)>1e-11?l/c:Math.cos(s);return Math.sqrt(l*l+d*d*u*u)*r}var It=63710088e-1,ul={centimeters:It*100,centimetres:It*100,degrees:360/(2*Math.PI),feet:It*3.28084,inches:It*39.37,kilometers:It/1e3,kilometres:It/1e3,meters:It,metres:It,miles:It/1609.344,millimeters:It*1e3,millimetres:It*1e3,nauticalmiles:It/1852,radians:1,yards:It*1.0936};function _m(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function gm(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Oa(i[0])||!Oa(i[1]))throw new Error("coordinates must contain numbers");return _m({type:"Point",coordinates:i},t,n)}function vm(i,t="kilometers"){const n=ul[t];if(!n)throw new Error(t+" units is invalid");return i*n}function ym(i,t="kilometers"){const n=ul[t];if(!n)throw new Error(t+" units is invalid");return i/n}function za(i){return i%360*Math.PI/180}function wm(i,t="kilometers",n="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return vm(ym(i,t),n)}function Oa(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function xm(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function bm(i,t,n,r={}){const s=t<0;let a=wm(Math.abs(t),r.units,"meters");s&&(a=-Math.abs(a));const l=xm(i),u=Mm(l,a,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,gm(u,r.properties)}function Mm(i,t,n,r){r=r===void 0?It:Number(r);const s=t/r,a=i[0]*Math.PI/180,l=za(i[1]),u=za(n),c=s*Math.cos(u);let d=l+c;Math.abs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d);const p=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),_=Math.abs(p)>1e-11?c/p:Math.cos(l),v=s*Math.sin(u)/_;return[((a+v)*180/Math.PI+540)%360-180,d*180/Math.PI]}function Pm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function An(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ia(i[0])||!Ia(i[1]))throw new Error("coordinates must contain numbers");return Pm({type:"Point",coordinates:i},t,n)}function Ia(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Lm(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)}function cl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,v,x=i.type,P=x==="FeatureCollection",S=x==="Feature",D=P?i.features.length:1,k=0;k<D;k++){d=P?i.features[k].geometry:S?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var y=0,M=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,k,y,M)===!1)return!1;_++,y++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,k,y,M)===!1)return!1;_++,E==="MultiPoint"&&y++}E==="LineString"&&y++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,k,y,M)===!1)return!1;_++}E==="MultiLineString"&&y++,E==="Polygon"&&M++}E==="Polygon"&&y++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(M=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,k,y,M)===!1)return!1;_++}M++}y++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(cl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Em(i,t){if(i.type==="Feature")t(i,0);else if(i.type==="FeatureCollection")for(var n=0;n<i.features.length&&t(i.features[n],n)!==!1;n++);}function Sm(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function km(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Cm(i,t){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}function Tm(i,t,n){if(n=n||{},!Lm(n))throw new Error("options is invalid");const r=n.origin||"centroid",s=n.mutate||!1;if(!i)throw new Error("geojson required");if(typeof t!="number"||t<=0)throw new Error("invalid factor");const a=Array.isArray(r)||typeof r=="object";return s!==!0&&(i=em(i)),i.type==="FeatureCollection"&&!a?(Em(i,function(l,u){i.features[u]=Fa(l,t,r)}),i):Fa(i,t,r)}function Fa(i,t,n){const r=Cm(i)==="Point",s=Am(i,n);return t===1||r||(cl(i,function(a){const l=pm(s,a),u=um(s,a),c=l*t,d=km(bm(s,c,u));a[0]=d[0],a[1]=d[1],a.length===3&&(a[2]*=t)}),delete i.bbox),i}function Am(i,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return Sm(t);const n=i.bbox?i.bbox:Hn(i,{recompute:!0}),r=n[0],s=n[1],a=n[2],l=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return An([r,s]);case"se":case"southeast":case"eastsouth":case"bottomright":return An([a,s]);case"nw":case"northwest":case"westnorth":case"topleft":return An([r,l]);case"ne":case"northeast":case"eastnorth":case"topright":return An([a,l]);case"center":return om(i);case void 0:case null:case"centroid":return hm(i);default:throw new Error("invalid origin")}}function Dm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Bm(i,t,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return Dm({type:"Polygon",coordinates:i},t,n)}function zm(i,t={}){const n=Number(i[0]),r=Number(i[1]),s=Number(i[2]),a=Number(i[3]);if(i.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const l=[n,r];return Bm([[l,[s,r],[s,a],[n,a],l]],t.properties,{bbox:i,id:t.id})}const Om=(i,t)=>{const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3};function Im(i){const t=.0033528106647474805,n=t*(2-t),r=Math.PI/180,s=Math.cos(i*r),a=1/(1-n*(1-s*s)),l=Math.sqrt(a),u=6378.137*r,c=u*l*s,d=u*l*a*(1-n);return function(p,_){let v=p[0]-_[0];for(;v<-180;)v+=360;for(;v>180;)v-=360;const x=v*c,P=(p[1]-_[1])*d;return Math.sqrt(x*x+P*P)}}let Fm=class{constructor(){this.keys=[],this.values=[],this.idxs=[],this.length=0,this.insertCounter=0}insert(t,n){let r=this.length;this.length=r+1;let s=t,a=n,l=this.insertCounter++;for(;r>0;){const u=r-1>>>2,c=this.keys[u],d=this.idxs[u];if(s>c||s===c&&l>d)break;this.keys[r]=c,this.values[r]=this.values[u],this.idxs[r]=d,r=u}this.keys[r]=s,this.values[r]=a,this.idxs[r]=l}extractMin(){const t=this.length;if(t===0)return null;const n=this.values[0],r=t-1;return this.length=r,r>0&&(this.keys[0]=this.keys[r],this.values[0]=this.values[r],this.idxs[0]=this.idxs[r],this.bubbleDown(0)),n}size(){return this.length}bubbleDown(t){const n=this.length,r=this.keys,s=this.values,a=this.idxs,l=r[t],u=s[t],c=a[t];for(;;){const d=1+(t<<2);if(d>=n)break;let p=d,_=r[d],v=a[d],x=s[d];const P=d+1;if(P<n){const k=r[P],g=a[P];(k<_||k===_&&g<v)&&(p=P,_=k,v=g,x=s[P])}const S=d+2;if(S<n){const k=r[S],g=a[S];(k<_||k===_&&g<v)&&(p=S,_=k,v=g,x=s[S])}const D=d+3;if(D<n){const k=r[D],g=a[D];(k<_||k===_&&g<v)&&(p=D,_=k,v=g,x=s[D])}if(!(_<l||_===l&&v<c))break;r[t]=_,s[t]=x,a[t]=v,t=p}r[t]=l,s[t]=u,a[t]=c}};class Nm{constructor(t){var n,r;this.network=null,this.distanceMeasurement=void 0,this.heapConstructor=void 0,this.coordinateIndexMap=new Map,this.coordinates=[],this.adjacencyList=[],this.csrOffsets=null,this.csrIndices=null,this.csrDistances=null,this.csrNodeCount=0,this.gScoreScratch=null,this.cameFromScratch=null,this.visitedScratch=null,this.hScratch=null,this.scratchCapacity=0,this.distanceMeasurement=(n=t==null?void 0:t.distanceMeasurement)!=null?n:Om,this.heapConstructor=(r=t==null?void 0:t.heap)!=null?r:Fm}buildRouteGraph(t){this.network=t,this.coordinateIndexMap=new Map,this.coordinates=[],this.adjacencyList=[],this.csrOffsets=null,this.csrIndices=null,this.csrDistances=null,this.csrNodeCount=0;const n=this.coordinateIndexMap,r=this.coordinates,s=this.distanceMeasurement,a=t.features,l=[];for(let D=0,k=a.length;D<k;D++){const g=a[D].geometry.coordinates;for(let y=0,M=g.length-1;y<M;y++){var u,c;const E=g[y],B=g[y+1],C=E[0],A=E[1],I=B[0],Y=B[1];let $=n.get(C);$===void 0&&($=new Map,n.set(C,$));let j=$.get(A);j===void 0&&(j=r.length,r.push(E),$.set(A,j));let X=n.get(I);X===void 0&&(X=new Map,n.set(I,X));let w=X.get(Y);w===void 0&&(w=r.length,r.push(B),X.set(Y,w)),l[j]=((u=l[j])!=null?u:0)+1,l[w]=((c=l[w])!=null?c:0)+1}}const d=this.coordinates.length;this.csrNodeCount=d;const p=new Int32Array(d+1);for(let D=0;D<d;D++){var _;const k=(_=l[D])!=null?_:0;p[D+1]=p[D]+k}const v=p[d],x=new Int32Array(v),P=new Float64Array(v),S=p.slice();for(let D=0,k=a.length;D<k;D++){const g=a[D].geometry.coordinates;for(let y=0,M=g.length-1;y<M;y++){const E=g[y],B=g[y+1],C=E[1],A=B[0],I=B[1],Y=this.coordinateIndexMap.get(E[0]).get(C),$=this.coordinateIndexMap.get(A).get(I),j=s(E,B);let X=S[Y]++;x[X]=$,P[X]=j,X=S[$]++,x[X]=Y,P[X]=j}}this.csrOffsets=p,this.csrIndices=x,this.csrDistances=P,this.adjacencyList=new Array(d)}getRoute(t,n){if(this.network===null)throw new Error("Network not built. Please call buildRouteGraph(network) first.");const r=this.getOrCreateIndex(t.geometry.coordinates),s=this.getOrCreateIndex(n.geometry.coordinates);if(r===s)return null;const a=this.coordinates,l=this.adjacencyList,u=this.distanceMeasurement,c=a.length;this.ensureScratch(c);const d=this.gScoreScratch,p=this.cameFromScratch,_=this.visitedScratch,v=this.hScratch;d.fill(Number.POSITIVE_INFINITY,0,c),p.fill(-1,0,c),_.fill(0,0,c),v.fill(-1,0,c);const x=new this.heapConstructor,P=a[s];let S=v[r];for(S<0&&(S=u(a[r],P),v[r]=S),x.insert(S,r),d[r]=0;x.size()>0;){const g=x.extractMin();if(_[g]===0){if(g===s)break;if(_[g]=1,this.csrOffsets&&g<this.csrNodeCount){const y=this.csrOffsets,M=this.csrIndices,E=this.csrDistances,B=y[g+1];for(let C=y[g];C<B;C++){const A=M[C],I=d[g]+E[C];if(I<d[A]){d[A]=I,p[A]=g;let Y=v[A];Y<0&&(Y=u(a[A],P),v[A]=Y),x.insert(I+Y,A)}}}else{const y=l[g];if(!y||y.length===0)continue;for(let M=0,E=y.length;M<E;M++){const B=y[M],C=B.node,A=d[g]+B.distance;if(A<d[C]){d[C]=A,p[C]=g;let I=v[C];I<0&&(I=u(a[C],P),v[C]=I),x.insert(A+I,C)}}}}}if(p[s]<0)return null;const D=[];let k=s;for(;k!==r;)D.push(a[k]),k=p[k];return D.push(a[r]),D.reverse(),{type:"Feature",geometry:{type:"LineString",coordinates:D},properties:{}}}getOrCreateIndex(t){const n=t[0],r=t[1];let s=this.coordinateIndexMap.get(n);s===void 0&&(s=new Map,this.coordinateIndexMap.set(n,s));let a=s.get(r);if(a===void 0&&(a=this.coordinates.length,this.coordinates.push(t),s.set(r,a),this.adjacencyList[a]=[],this.csrOffsets)){const l=this.csrNodeCount;if(a===l){const u=new Int32Array(l+2);u.set(this.csrOffsets,0),u[l+1]=u[l],this.csrOffsets=u,this.csrNodeCount=l+1}}return a}ensureScratch(t){if(this.scratchCapacity>=t&&this.gScoreScratch&&this.cameFromScratch&&this.visitedScratch&&this.hScratch)return;const n=0|t;this.gScoreScratch=new Float64Array(n),this.cameFromScratch=new Int32Array(n),this.visitedScratch=new Uint8Array(n),this.hScratch=new Float64Array(n),this.scratchCapacity=n}}var zt=63710088e-1,Rm={centimeters:zt*100,centimetres:zt*100,degrees:zt/111325,feet:zt*3.28084,inches:zt*39.37,kilometers:zt/1e3,kilometres:zt/1e3,meters:zt,metres:zt,miles:zt/1609.344,millimeters:zt*1e3,millimetres:zt*1e3,nauticalmiles:zt/1852,radians:1,yards:zt*1.0936};function fl(i,t,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Gn(i,t,n){if(n===void 0&&(n={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Na(i[0])||!Na(i[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:i};return fl(r,t,n)}function Zm(i,t,n){if(n===void 0&&(n={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:i};return fl(r,t,n)}function dl(i,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=i,n}function Ym(i,t){t===void 0&&(t="kilometers");var n=Rm[t];if(!n)throw new Error(t+" units is invalid");return i*n}function Dn(i){var t=i%360;return t*Math.PI/180}function Na(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Xm(i,t,n,r={}){const s={vertices:Object.keys(i).reduce((_,v)=>(_[v]={...i[v]},_),{}),coordinates:Object.keys(i).reduce((_,v)=>{_[v]={};for(const x of Object.keys(i[v]))_[v][x]=[t[v]];return _},{}),edgeData:"edgeDataReducer"in r?Object.keys(i).reduce((_,v)=>(_[v]=Object.keys(i[v]).reduce((x,P)=>(x[P]=n[v][P],x),{}),_),{}):{}},{vertices:a,coordinates:l,edgeData:u}=s,c="edgeDataReducer"in r&&u,d=Object.keys(i).filter(_=>jm(i,_));for(const _ of d){const v=a[_],x=Object.keys(v);if(x.length!==0){for(const P of x)for(const S of x)P!==S&&(p(_,P,S),p(_,S,P));for(const P of x){if(!a[P])throw new Error(`Missing neighbor vertex for ${P}`);delete a[P][_],delete l[P][_]}delete a[_],delete l[_]}}return s;function p(_,v,x){const P=a[_],S=a[v],D=S[_];if(!S[x]&&D){S[x]=D+P[x],l[v][x]=[...l[v][_],...l[_][x]];let k=c?u[v][_]:void 0;const g=c?u[_][x]:void 0;c&&k&&g&&(u[v][x]=r.edgeDataReducer(k,g))}}}function $m(i,t,n,r,s,a,l={}){const u=t[i];return Object.keys(u).reduce(c,{edges:{},incomingEdges:{},coordinates:{},incomingCoordinates:{},reducedEdges:{}});function c(d,p){const _=Um(i,p,t,n,r,s,a,l),v=_.weight,x=_.reverseWeight;if(_.vertexKey!==i&&((!d.edges[_.vertexKey]||d.edges[_.vertexKey]>v)&&(d.edges[_.vertexKey]=v,d.coordinates[_.vertexKey]=[r[i]].concat(_.coordinates),d.reducedEdges[_.vertexKey]=_.reducedEdge),!isNaN(x)&&(!d.incomingEdges[_.vertexKey]||d.incomingEdges[_.vertexKey]>x))){d.incomingEdges[_.vertexKey]=x;var P=[r[i]].concat(_.coordinates);P.reverse(),d.incomingCoordinates[_.vertexKey]=P}return d}}function Um(i,t,n,r,s,a,l,u={}){var S;let c=n[i][t],d=n[t][i];const p=[],_=[];let v="edgeDataReducer"in u?a[t][i]:void 0;for(;!r[t];){var x=n[t];if(!x)break;var P=Object.keys(x).filter(function(g){return g!==i})[0];c+=x[P];{if(d+=((S=n[P])==null?void 0:S[t])||1/0,_.indexOf(t)>=0){r[t]=n[t];break}_.push(t)}const D=a[t]&&a[t][P];"edgeDataReducer"in u&&v&&D&&(v=u.edgeDataReducer(v,D)),p.push(s[t]),i=t,t=P}return{vertexKey:t,weight:c,reverseWeight:d,coordinates:p,reducedEdge:v}}function jm(i,t){const n=i[t],r=Object.keys(n);switch(r.length){case 1:return!i[r[0]][t];case 2:return r.every(a=>i[a][t]);default:return!1}}function Wm(i,t,n){const r={[t]:0},s=[0,[t],t],a=new tl([s],(l,u)=>l[0]-u[0]);for(;;){const l=a.pop();if(!l)return;const u=l[0],c=l[2];if(c===n)return[l[0],l[1]];const d=i[c];Object.keys(d).forEach(function(p){var _=u+d[p];if(_<1/0&&(!(p in r)||_<r[p])){r[p]=_;const v=[_,l[1].concat([p]),p];a.push(v)}})}}function Ra(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Vm(i,t,n){n===void 0&&(n={});var r=Ra(i),s=Ra(t),a=Dn(s[1]-r[1]),l=Dn(s[0]-r[0]),u=Dn(r[1]),c=Dn(s[1]),d=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(c);return Ym(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),n.units)}function oo(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,v,x=i.type,P=x==="FeatureCollection",S=x==="Feature",D=P?i.features.length:1,k=0;k<D;k++){d=P?i.features[k].geometry:S?i.geometry:i,v=d?d.type==="GeometryCollection":!1,u=v?d.geometries.length:1;for(var g=0;g<u;g++){var y=0,M=0;if(l=v?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,k,y,M)===!1)return!1;_++,y++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,k,y,M)===!1)return!1;_++,E==="MultiPoint"&&y++}E==="LineString"&&y++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,k,y,M)===!1)return!1;_++}E==="MultiLineString"&&y++,E==="Polygon"&&M++}E==="Polygon"&&y++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(M=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,k,y,M)===!1)return!1;_++}M++}y++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(oo(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Hm(i,t){if(i.type==="Feature")t(i,0);else if(i.type==="FeatureCollection")for(var n=0;n<i.features.length&&t(i.features[n],n)!==!1;n++);}function Gm(i){var t=[];return i.type==="FeatureCollection"?Hm(i,function(n){oo(n,function(r){t.push(Gn(r,n.properties))})}):oo(i,function(n){t.push(Gn(n,i.properties))}),dl(t)}function Zi(i,t){return[Math.round(i[0]/t)*t,Math.round(i[1]/t)*t]}function qm(i,t={}){const{key:n=ml}=t,{tolerance:r=1e-5}=t,s=dl(i.features.filter(d=>d.geometry.type==="LineString")),l=Gm(s).features.reduce(function(p,_,v,x){var P=Zi(_.geometry.coordinates,r);return p[n(P)]=_.geometry.coordinates,v%1e3===0&&t.progress&&t.progress("topo:vertices",v,x.length),p},{}),u=pl(s,c,[]);return{vertices:l,edges:u};function c(d,p){return p.geometry.coordinates.forEach(function(v,x,P){if(x>0){var S=n(Zi(P[x-1],r)),D=n(Zi(v,r));d.push([S,D,p.properties])}}),d}}function pl(i,t,n){return i.type==="FeatureCollection"?i.features.reduce(function(s,a){return pl(a,t,s)},n):t(n,i)}function ml(i){return i.join(",")}function Jm(i,t={}){const n=qm(i,t),{weight:r=Km}=t,s=n.edges.reduce(c,{edgeData:{},vertices:{}}),{vertices:a,coordinates:l,edgeData:u}=Xm(s.vertices,n.vertices,s.edgeData,t);return{vertices:s.vertices,edgeData:s.edgeData,sourceCoordinates:n.vertices,compactedVertices:a,compactedCoordinates:l,compactedEdges:u};function c(d,p,_,v){const[x,P,S]=p,D=r(n.vertices[x],n.vertices[P],S);return D&&(k(x),k(P),D instanceof Object?(g(x,P,D.forward||1/0),g(P,x,D.backward||1/0)):(g(x,P,D||1/0),g(P,x,D||1/0))),_%1e3===0&&t.progress&&t.progress("edgeweights",_,v.length),d;function k(y){d.vertices[y]||(d.vertices[y]={},d.edgeData[y]={})}function g(y,M,E){var B=d.vertices[y];B[M]=E,d.edgeData[y][M]="edgeDataReducer"in t?t.edgeDataSeed(S):void 0}}}function Km(i,t){return Vm(Gn(i),Gn(t))}class Za{constructor(t,n={}){this.graph=Jm(t,n),this.options=n}findPath(t,n){const{key:r=ml,tolerance:s=1e-5}=this.options,a=r(Zi(t.geometry.coordinates,s)),l=r(Zi(n.geometry.coordinates,s));if(!this.graph.vertices[a]||!this.graph.vertices[l])return;const u=this._createPhantom(a),c=this._createPhantom(l);try{const d=Wm(this.graph.compactedVertices,a,l);if(d){const[p,_]=d;return{path:_.reduce((v,x,P,S)=>(P>0&&(v=v.concat(this.graph.compactedCoordinates[S[P-1]][x])),v),[]).concat([this.graph.sourceCoordinates[l]]),weight:p,edgeDatas:"edgeDataReducer"in this.options?_.reduce((v,x,P,S)=>(P>0&&v.push(this.graph.compactedEdges[S[P-1]][x]),v),[]):void 0}}else return}finally{this._removePhantom(u),this._removePhantom(c)}}_createPhantom(t){if(this.graph.compactedVertices[t])return;const n=$m(t,this.graph.vertices,this.graph.compactedVertices,this.graph.sourceCoordinates,this.graph.edgeData,!0,this.options);return this.graph.compactedVertices[t]=n.edges,this.graph.compactedCoordinates[t]=n.coordinates,"edgeDataReducer"in this.options&&(this.graph.compactedEdges[t]=n.reducedEdges),Object.keys(n.incomingEdges).forEach(r=>{this.graph.compactedVertices[r][t]=n.incomingEdges[r],this.graph.compactedCoordinates[r]||(this.graph.compactedCoordinates[r]={}),this.graph.compactedCoordinates[r][t]=[this.graph.sourceCoordinates[r],...n.incomingCoordinates[r].slice(0,-1)],this.graph.compactedEdges&&(this.graph.compactedEdges[r]||(this.graph.compactedEdges[r]={}),this.graph.compactedEdges[r][t]=n.reducedEdges[r])}),t}_removePhantom(t){t&&(Object.keys(this.graph.compactedVertices[t]).forEach(n=>{delete this.graph.compactedVertices[n][t]}),Object.keys(this.graph.compactedCoordinates[t]).forEach(n=>{delete this.graph.compactedCoordinates[n][t]}),"edgeDataReducer"in this.options&&Object.keys(this.graph.compactedEdges[t]).forEach(n=>{delete this.graph.compactedEdges[n][t]}),delete this.graph.compactedVertices[t],delete this.graph.compactedCoordinates[t],this.graph.compactedEdges&&delete this.graph.compactedEdges[t])}}function Qm(i){if(i){const{weight:t,edgeDatas:n}=i;return Zm(i.path,{weight:t,edgeDatas:n})}}function t_(i){let t=new Za(i);return{getRoute:(r,s)=>{const a=t.findPath(r,s);return a&&a.path.length>1?Qm(a):null},setNetwork:r=>{t=new Za(r)}}}function e_(i){const t=Im(i.features[0].geometry.coordinates[0][1]),n=new Nm({distanceMeasurement:t});return n.buildRouteGraph(i),{getRoute:n.getRoute.bind(n),setNetwork:r=>{n.buildRouteGraph(r)}}}const qt={TerraRoute:"terra-route",GeoJSONPathFinder:"geojson-path-finder"};function Ya(i,t=qt.TerraRoute){let n;if(t===qt.GeoJSONPathFinder)n=t_(i);else if(t===qt.TerraRoute)n=e_(i);else throw new Error(`Unknown routing option: ${t}`);return n}function _l(i,t,n){n[i]=!0;for(const r of t[i])n[r]||_l(r,t,n)}function i_(i,t){const n=JSON.stringify(i),r=JSON.stringify(t);return n<r?`${n}|${r}`:`${r}|${n}`}function n_(i,t){const[n,r]=function(s,a){const[l,u]=s,[c,d]=a;return l<c||l===c&&u<=d?[s,a]:[a,s]}(i,t);return JSON.stringify([n,r])}function gl(i){const t=new Map;for(const n of i.features){const r=n.geometry.coordinates;for(let s=0;s<r.length-1;s++){const a=r[s],l=r[s+1],u=n_(a,l);t.has(u)||t.set(u,{type:"Feature",geometry:{type:"LineString",coordinates:[a,l]},properties:{}})}}return{type:"FeatureCollection",features:Array.from(t.values())}}function r_(i,t){const n=i.length,r=t.length;if(n>r)return!1;for(let a=0;a<=r-n;a++){let l=!0;for(let u=0;u<n;u++)if(t[a+u][0]!==i[u][0]||t[a+u][1]!==i[u][1]){l=!1;break}if(l)return!0}const s=[...i].reverse();for(let a=0;a<=r-n;a++){let l=!0;for(let u=0;u<n;u++)if(t[a+u][0]!==s[u][0]||t[a+u][1]!==s[u][1]){l=!1;break}if(l)return!0}return!1}function $r(i){const t=gl(i),n=new Map;function r(l){return l.join(",")}for(let l=0;l<t.features.length;l++){const u=t.features[l].geometry.coordinates;if(u.length<2)continue;const c=r(u[0]),d=r(u[u.length-1]);n.set(c,(n.get(c)||0)+1),n.set(d,(n.get(d)||0)+1)}const s=new Map,a=new Map;for(let l=0;l<t.features.length;l++){const u=t.features[l],c=u.geometry.coordinates;if(c.length<2)continue;const d=r(c[0]),p=r(c[c.length-1]),_=n.get(d)||0,v=n.get(p)||0,x=c.map(r).join(";");_===1||v===1?s.has(x)||s.set(x,u):a.has(x)||a.set(x,u)}return{leafEdges:{type:"FeatureCollection",features:Array.from(s.values())},nonLeafEdges:{type:"FeatureCollection",features:Array.from(a.values())}}}function o_(i,t,n,r,s){const a=i.geometry.coordinates;for(const l of a)if(!s_(l,t,n,r,s))return!1;return!0}function s_(i,t,n,r,s){const[a,l]=i;return a>=t&&a<=r&&l>=n&&l<=s}function Yi(){return Yi=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Yi.apply(null,arguments)}const vl=(i,t)=>{const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3},a_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class h_{constructor(t,n=64,r=Float64Array,s){if(this.data=void 0,this.ids=void 0,this.coords=void 0,this._pos=void 0,this._finished=void 0,this.numItems=void 0,this.nodeSize=void 0,this.ArrayType=void 0,this.IndexArrayType=void 0,isNaN(t)||t<0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=t,this.nodeSize=Math.min(Math.max(n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=a_.indexOf(this.ArrayType),l=2*t*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+c,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+l+u+c),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+c,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return so(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function so(i,t,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;yl(i,t,l,r,s,a),so(i,t,n,r,l-1,1-a),so(i,t,n,l+1,s,1-a)}function yl(i,t,n,r,s,a){for(;s>r;){if(s-r>600){const d=s-r+1,p=n-r+1,_=Math.log(d),v=.5*Math.exp(2*_/3),x=.5*Math.sqrt(_*v*(d-v)/d)*(p-d/2<0?-1:1);yl(i,t,n,Math.max(r,Math.floor(n-p*v/d+x)),Math.min(s,Math.floor(n+(d-p)*v/d+x)),a)}const l=t[2*n+a];let u=r,c=s;for(Ti(i,t,r,n),t[2*s+a]>l&&Ti(i,t,r,s);u<c;){for(Ti(i,t,u,c),u++,c--;t[2*u+a]<l;)u++;for(;t[2*c+a]>l;)c--}t[2*r+a]===l?Ti(i,t,r,c):(c++,Ti(i,t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function Ti(i,t,n,r){Ur(i,n,r),Ur(t,2*n,2*r),Ur(t,2*n+1,2*r+1)}function Ur(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}class l_{constructor(t=[],n=(r,s)=>r<s?-1:r>s?1:0){if(this.data=void 0,this.length=void 0,this.compare=void 0,this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=1+(t<<1);const u=l+1;if(u<this.length&&r(n[u],n[l])<0&&(l=u),r(n[l],a)>=0)break;n[t]=n[l],t=l}n[t]=a}}const oe=Math.PI/180;function Xa(i,t,n,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(i>=s&&i<=a)return t<l?ke((t-l)*oe):t>u?ke((t-u)*oe):0;const c=Math.min(ke((i-s)*oe),ke((i-a)*oe)),d=function(p,_){const v=1-2*_;return v<=0?p>0?90:-90:Math.atan(Math.tan(p*oe)/v)/oe}(t,c);return d>l&&d<u?Rn(c,n,t,d):Math.min(Rn(c,n,t,l),Rn(c,n,t,u))}function u_(i,t){return i.dist-t.dist}function ke(i){const t=Math.sin(i/2);return t*t}function Rn(i,t,n,r){return t*Math.cos(r*oe)*i+ke((n-r)*oe)}function $a(i,t,n,r,s){return Rn(ke((i-n)*oe),s,t,r)}function ve(i){const t=i.geometry.coordinates;let n=0;for(let r=0;r<t.length-1;r++)n+=vl(t[r],t[r+1]);return n}class c_{constructor(t){this.network=void 0,this.network=t}getRouteLength(t){return ve(t)}setNetwork(t){this.network=t}getNetwork(){return this.network}getNetworkInBoundingBox(t){return function(n,r){const[s,a,l,u]=r;if(s>=l||a>=u)throw new Error("Invalid bounding box: min values must be less than max values");const c=[];for(const d of n.features)o_(d,s,a,l,u)&&c.push(d);return{type:"FeatureCollection",features:c}}(this.network,t)}getNetworkWithoutDuplicatesOrSubsections(){return function(t){const n=t.features,r=new Set;for(let s=0;s<n.length;s++){const a=n[s].geometry.coordinates;for(let l=0;l<n.length;l++){if(s===l)continue;const u=n[l].geometry.coordinates;if(r_(a,u)&&(a.length<u.length||a.length===u.length&&s>l)){r.add(s);break}}}return{type:"FeatureCollection",features:n.filter((s,a)=>!r.has(a))}}(this.network)}getConnectedComponents(){return function(t){const n=t.features,r=new Map,s=new Map;function a(d){return`${d[0]},${d[1]}`}for(let d=0;d<n.length;d++){const p=n[d].geometry.coordinates;for(const _ of p){const v=a(_);s.has(v)||s.set(v,new Set),s.get(v).add(d)}}for(let d=0;d<n.length;d++){r.set(d,new Set);const p=n[d].geometry.coordinates;for(const _ of p){const v=a(_),x=s.get(v);if(x)for(const P of x)P!==d&&r.get(d).add(P)}}const l=new Set,u=[];function c(d,p){const _=[d];for(;_.length>0;){const v=_.pop();if(l.has(v))continue;l.add(v),p.push(n[v]);const x=r.get(v);if(x)for(const P of x)l.has(P)||_.push(P)}}for(let d=0;d<n.length;d++)if(!l.has(d)){const p=[];c(d,p),u.push({type:"FeatureCollection",features:p})}return u.sort((d,p)=>d.features.length-p.features.length),u}(this.network)}getConnectedComponentCount(){return function(t){const n=t.features,r=n.length,s=new Map;for(let d=0;d<r;d++){const p=n[d].geometry.coordinates;for(const _ of p){const v=`${(a=_)[0]},${a[1]}`;s.has(v)||s.set(v,[]),s.get(v).push(d)}}var a;const l=Array.from({length:r},()=>[]);for(const d of s.values())for(let p=0;p<d.length;p++)for(let _=p+1;_<d.length;_++){const v=d[p],x=d[_];l[v].push(x),l[x].push(v)}const u=new Array(r).fill(!1);let c=0;for(let d=0;d<r;d++)u[d]||(_l(d,l,u),c++);return c}(this.network)}getNodeAndEdgeCount(){return function(t){const n=new Set,r=new Set;for(const s of t.features){const a=s.geometry.coordinates;for(const l of a)n.add(JSON.stringify(l));for(let l=0;l<a.length-1;l++){const u=i_(a[l],a[l+1]);r.add(u)}}return{nodeCount:n.size,edgeCount:r.size}}(this.network)}getNodes(){return{type:"FeatureCollection",features:function(t){const n=new Set,r=[];for(const s of t.features)for(const a of s.geometry.coordinates){const l=a.join(",");n.has(l)||(n.add(l),r.push({type:"Feature",geometry:{type:"Point",coordinates:a},properties:{}}))}return r}(this.network)}}getNodeCount(){const{nodeCount:t}=this.getNodeAndEdgeCount();return t}getEdges(){return gl(this.network)}getLongestEdgeLength(){const t=this.getLongestEdge();return t?ve(t):-1}getAverageEdgeLength(){const t=this.getEdges().features;return t.length===0?-1:t.reduce((n,r)=>n+ve(r),0)/t.length}getNodeDegrees(){const t={},n=this.getEdges().features;for(const r of n){const[s,a]=r.geometry.coordinates,l=`${s[0]},${s[1]}`,u=`${a[0]},${a[1]}`;t[l]=(t[l]||0)+1,t[u]=(t[u]||0)+1}return t}getNodeDegreeStats(){const t=Object.values(this.getNodeDegrees());return t.length===0?{min:0,max:0,avg:0}:{min:Math.min(...t),max:Math.max(...t),avg:t.reduce((n,r)=>n+r,0)/t.length}}getShortestEdgeLength(){const t=this.getShortestEdge();return t?ve(t):-1}getLongestEdge(){const t=this.getEdges().features;if(t.length===0)return null;const n=t.sort((r,s)=>ve(r)-ve(s));return n[n.length-1]}getShortestEdge(){const t=this.getEdges().features;return t.length===0?null:t.sort((n,r)=>ve(n)-ve(r))[0]}getEdgeCount(){const{edgeCount:t}=this.getNodeAndEdgeCount();return t}getLeafEdges(){return $r(this.network).leafEdges}getPrunedEdges(t){if(t&&t>0){let n=this.network;for(let r=0;r<t;r++)n=$r(n).nonLeafEdges;return n}return $r(this.network).nonLeafEdges}getUnifiedNetwork(t){return function(n,r){if(n.features.length<2)return n;const s=new Set,a=new Map,l=[],u=new Map;for(const _ of n.features)for(const v of _.geometry.coordinates){const x=`${v[0]},${v[1]}`;u.has(x)||(u.set(x,l.length),l.push(v))}let c=new h_(l.length);for(const _ of l)c.add(_[0],_[1]);function d(_,v,x){let P=null,S=1/0;const D=function(k,g,y,M=1/0,E=1/0){let B=1;const C=[];M===void 0&&(M=1/0),E!==void 0&&(B=ke(E/6371));const A=new l_([],u_);let I={left:0,right:k.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const Y=Math.cos(y*oe);for(;I;){const $=I.right,j=I.left;if($-j<=k.nodeSize)for(let X=j;X<=$;X++){const w=k.ids[X],z=$a(g,y,k.coords[2*X],k.coords[2*X+1],Y);A.push({id:w,dist:z})}else{const X=j+$>>1,w=k.coords[2*X],z=k.coords[2*X+1],O=k.ids[X],W=$a(g,y,w,z,Y);A.push({id:O,dist:W});const Z=(I.axis+1)%2,J={left:j,right:X-1,axis:Z,minLng:I.minLng,minLat:I.minLat,maxLng:I.axis===0?w:I.maxLng,maxLat:I.axis===1?z:I.maxLat,dist:0},R={left:X+1,right:$,axis:Z,minLng:I.axis===0?w:I.minLng,minLat:I.axis===1?z:I.minLat,maxLng:I.maxLng,maxLat:I.maxLat,dist:0};J.dist=Xa(g,y,Y,J),R.dist=Xa(g,y,Y,R),A.push(J),A.push(R)}for(;A.length&&A.peek().id!=null;){const X=A.pop();if(X.dist>B||(C.push(X.id),C.length===M))return C}I=A.pop()}return C}(c,_[0],_[1],1/0,r/1e3);for(const k of D){const g=l[k],y=`${g[0]},${g[1]}`;if(!s.has(y)||v.includes(g)||x.has(y))continue;const M=1e3*vl(g,_);M<=r&&M<S&&(P=g,S=M)}return P!==null?P:(s.add(`${_[0]},${_[1]}`),_)}c.finish();const p=n.features.map(_=>{const v=[],x=[],P=new Set;for(const S of _.geometry.coordinates){const D=`${S[0]},${S[1]}`;if(!a.has(D)){const y=d(S,v,P);P.has(`${y[0]},${y[1]}`)?a.set(D,S):a.set(D,y)}const k=a.get(D),g=`${k[0]},${k[1]}`;P.has(g)||(x.push(k),P.add(g)),v.push(S)}return Yi({},_,{geometry:Yi({},_.geometry,{coordinates:x})})});return Yi({},n,{features:p})}(this.network,t)}}const jr=51.539931,Wr=-.078,Ua={L:Jh,id:"leaflet-map",lng:Wr,lat:jr,zoom:13,minZoom:10,maxZoom:20,tapTolerance:10,maxBounds:[[jr-.05,Wr-.05],[jr+.05,Wr+.05]]},f_=()=>{const i=kc(null),[t,n]=xi(),[r,s]=xi("static"),[a,l]=xi(),[u,c]=xi();Xs(()=>{const k=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/public/network.json":"./network.json";fetch(k).then(g=>{g.json().then(y=>{l(y)})})},[]),Xs(()=>{t||n(bp(Ua))},[t]);const[d,p]=xi(qt.TerraRoute),_=Ui(()=>{if(a)return{[qt.TerraRoute]:Ya(a,qt.TerraRoute),[qt.GeoJSONPathFinder]:Ya(a,qt.GeoJSONPathFinder)}},[a]),{draw:v,routing:x}=Ui(()=>{if(t&&a&&_){const D=new Mf({network:a,useCache:!0,routeFinder:_[qt.TerraRoute]}),k=Cf(t,Jh,D);k.start();const g=Ca(a);return g&&g.properties&&(g.properties.mode="networkOutline"),k.addFeatures([g]),{draw:k,routing:D}}return{draw:void 0,routing:void 0}},[t,a,_]),P=$s(D=>{v&&(s(D),v.setMode(D))},[v]),S=$s(()=>{if(!v)return;const D=v.getSnapshot().filter(({properties:k})=>k.mode!=="networkOutline").map(({id:k})=>k);v.removeFeatures(D)},[v]);return ft("div",{class:wi.home,children:ft("div",{ref:i,class:wi.map,id:Ua.id,children:[ft("button",{class:wi.split,onClick:D=>{D.preventDefault(),D.stopPropagation();let k;if(!u&&a)k=a;else if(u)k=u;else return;const g=Hn(k),y=zm(g),M=Tm(y,.9),E=new c_(k),B=Hn(M),C=E.getNetworkInBoundingBox(B);x==null||x.setNetwork(C),c(C);const A=v==null?void 0:v.getSnapshot().find(({properties:Y})=>Y.mode==="networkOutline");v==null||v.removeFeatures([A.id]);const I=Ca(C);I&&I.properties&&(I.properties.mode="networkOutline"),v==null||v.addFeatures([I])},children:"Prune"}),ft("select",{disabled:!x||!_,onChange:D=>{if(!x||!_)return;const k=D.target,g=k.options[k.selectedIndex].value;p(g),x.setRouteFinder(_[g])},class:wi.routingSelect,children:[ft("option",{value:qt.TerraRoute,children:"Terra Route"}),ft("option",{value:qt.GeoJSONPathFinder,children:"GeoJSON Path Finder"})]}),v?ft(Dp,{mode:r,changeMode:P,onClear:S}):null,v?null:ft("div",{class:wi.loading,children:"Loading..."})]})})};console.log("App.tsx");const d_=()=>ft("div",{id:"app",children:[ft(xc,{}),ft(f_,{})]});let Ee,Oi;const p_=(i,t)=>{if(Ee=void 0,t&&t.type==="click"){if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button!==0)return i;const n=t.target.closest("a[href]"),r=n&&n.getAttribute("href");if(!n||n.origin!=location.origin||/^#/.test(r)||!/^(_?self)?$/i.test(n.target)||Oi&&(typeof Oi=="string"?!r.startsWith(Oi):!Oi.test(r)))return i;Ee=!0,t.preventDefault(),t=n.href.replace(location.origin,"")}else typeof t=="string"?Ee=!0:t&&t.url?(Ee=!t.replace,t=t.url):t=location.pathname+location.search;return Ee===!0?history.pushState(null,"",t):Ee===!1&&history.replaceState(null,"",t),t};function wl(i){const[t,n]=gh(p_,i.url||location.pathname+location.search);i.scope&&(Oi=i.scope);const r=Ee===!0,s=Ui(()=>{const a=new URL(t,location.origin),l=a.pathname.replace(/\/+$/g,"")||"/";return{url:t,path:l,query:Object.fromEntries(a.searchParams),route:(u,c)=>n({url:u,replace:c}),wasPush:r}},[t]);return Sc(()=>(addEventListener("click",n),addEventListener("popstate",n),()=>{removeEventListener("click",n),removeEventListener("popstate",n)}),[]),ti(wl.ctx.Provider,{value:s},i.children)}Promise.resolve();wl.ctx=uo({});uo({});const ja=it.__b;it.__b=i=>{i.type&&i.type._forwarded&&i.ref&&(i.props.ref=i.ref,i.ref=null),ja&&ja(i)};const Wa=it.__e;it.__e=(i,t,n)=>{if(i&&i.then){let r=t;for(;r=r.__;)if(r.__c&&r.__c.__c)return t.__e==null&&(t.__c.__z=[n.__e],t.__e=n.__e,t.__k=n.__k),t.__k||(t.__k=[]),r.__c.__c(i,t)}Wa&&Wa(i,t,n)};let Va;function m_(i,t){if(typeof window>"u")return;let n=document.querySelector("script[type=isodata]");t=t||n&&n.parentNode||document.body,!Va&&n?lo(i,t):ho(i,t),Va=!0}typeof window<"u"&&m_(ft(d_,{}),document.getElementById("app"));
