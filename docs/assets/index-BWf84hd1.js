function Xu(i,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in i)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var Ji,nt,ih,nh,Zi,As,rh,Un={},oh=[],Uu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ge(i,t){for(var n in t)i[n]=t[n];return i}function sh(i){var t=i.parentNode;t&&t.removeChild(i)}function oi(i,t,n){var r,s,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?s=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?Ji.call(arguments,2):n),typeof i=="function"&&i.defaultProps!=null)for(a in i.defaultProps)l[a]===void 0&&(l[a]=i.defaultProps[a]);return Yi(i,l,r,s,null)}function Yi(i,t,n,r,s){var a={type:i,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++ih};return s==null&&nt.vnode!=null&&nt.vnode(a),a}function ju(){return{current:null}}function Ki(i){return i.children}function ii(i,t){this.props=i,this.context=t}function Vi(i,t){if(t==null)return i.__?Vi(i.__,i.__.__k.indexOf(i)+1):null;for(var n;t<i.__k.length;t++)if((n=i.__k[t])!=null&&n.__e!=null)return n.__e;return typeof i.type=="function"?Vi(i):null}function ah(i){var t,n;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,t=0;t<i.__k.length;t++)if((n=i.__k[t])!=null&&n.__e!=null){i.__e=i.__c.base=n.__e;break}return ah(i)}}function Jr(i){(!i.__d&&(i.__d=!0)&&Zi.push(i)&&!jn.__r++||As!==nt.debounceRendering)&&((As=nt.debounceRendering)||setTimeout)(jn)}function jn(){for(var i;jn.__r=Zi.length;)i=Zi.sort(function(t,n){return t.__v.__b-n.__v.__b}),Zi=[],i.some(function(t){var n,r,s,a,l,u;t.__d&&(l=(a=(n=t).__v).__e,(u=n.__P)&&(r=[],(s=ge({},a)).__v=a.__v+1,co(u,a,s,n.__n,u.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Vi(a),a.__h),ch(r,a),a.__e!=l&&ah(a)))})}function hh(i,t,n,r,s,a,l,u,c,d){var p,_,w,M,P,k,A,O=r&&r.__k||oh,g=O.length;for(n.__k=[],p=0;p<t.length;p++)if((M=n.__k[p]=(M=t[p])==null||typeof M=="boolean"?null:typeof M=="string"||typeof M=="number"||typeof M=="bigint"?Yi(null,M,null,null,M):Array.isArray(M)?Yi(Ki,{children:M},null,null,null):M.__b>0?Yi(M.type,M.props,M.key,M.ref?M.ref:null,M.__v):M)!=null){if(M.__=n,M.__b=n.__b+1,(w=O[p])===null||w&&M.key==w.key&&M.type===w.type)O[p]=void 0;else for(_=0;_<g;_++){if((w=O[_])&&M.key==w.key&&M.type===w.type){O[_]=void 0;break}w=null}co(i,M,w=w||Un,s,a,l,u,c,d),P=M.__e,(_=M.ref)&&w.ref!=_&&(A||(A=[]),w.ref&&A.push(w.ref,null,M),A.push(_,M.__c||P,M)),P!=null?(k==null&&(k=P),typeof M.type=="function"&&M.__k===w.__k?M.__d=c=lh(M,c,i):c=uh(i,M,w,O,P,c),typeof n.type=="function"&&(n.__d=c)):c&&w.__e==c&&c.parentNode!=i&&(c=Vi(w))}for(n.__e=k,p=g;p--;)O[p]!=null&&dh(O[p],O[p]);if(A)for(p=0;p<A.length;p++)fh(A[p],A[++p],A[++p])}function lh(i,t,n){for(var r,s=i.__k,a=0;s&&a<s.length;a++)(r=s[a])&&(r.__=i,t=typeof r.type=="function"?lh(r,t,n):uh(n,r,r,s,r.__e,t));return t}function Wn(i,t){return t=t||[],i==null||typeof i=="boolean"||(Array.isArray(i)?i.some(function(n){Wn(n,t)}):t.push(i)),t}function uh(i,t,n,r,s,a){var l,u,c;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(n==null||s!=a||s.parentNode==null)t:if(a==null||a.parentNode!==i)i.appendChild(s),l=null;else{for(u=a,c=0;(u=u.nextSibling)&&c<r.length;c+=1)if(u==s)break t;i.insertBefore(s,a),l=a}return l!==void 0?l:s.nextSibling}function Wu(i,t,n,r,s){var a;for(a in n)a==="children"||a==="key"||a in t||Vn(i,a,null,n[a],r);for(a in t)s&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||Vn(i,a,t[a],n[a],r)}function Os(i,t,n){t[0]==="-"?i.setProperty(t,n):i[t]=n==null?"":typeof n!="number"||Uu.test(t)?n:n+"px"}function Vn(i,t,n,r,s){var a;t:if(t==="style")if(typeof n=="string")i.style.cssText=n;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(t in r)n&&t in n||Os(i.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Os(i.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in i?t.toLowerCase().slice(2):t.slice(2),i.l||(i.l={}),i.l[t+a]=n,n?r||i.addEventListener(t,a?Bs:Is,a):i.removeEventListener(t,a?Bs:Is,a);else if(t!=="dangerouslySetInnerHTML"){if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in i)try{i[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t.indexOf("-")==-1?i.removeAttribute(t):i.setAttribute(t,n))}}function Is(i){this.l[i.type+!1](nt.event?nt.event(i):i)}function Bs(i){this.l[i.type+!0](nt.event?nt.event(i):i)}function co(i,t,n,r,s,a,l,u,c){var d,p,_,w,M,P,k,A,O,g,v,y,E,S,C,T=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,u=t.__e=n.__e,t.__h=null,a=[u]),(d=nt.__b)&&d(t);try{t:if(typeof T=="function"){if(A=t.props,O=(d=T.contextType)&&r[d.__c],g=d?O?O.props.value:d.__:r,n.__c?k=(p=t.__c=n.__c).__=p.__E:("prototype"in T&&T.prototype.render?t.__c=p=new T(A,g):(t.__c=p=new ii(A,g),p.constructor=T,p.render=Hu),O&&O.sub(p),p.props=A,p.state||(p.state={}),p.context=g,p.__n=r,_=p.__d=!0,p.__h=[],p._sb=[]),p.__s==null&&(p.__s=p.state),T.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=ge({},p.__s)),ge(p.__s,T.getDerivedStateFromProps(A,p.__s))),w=p.props,M=p.state,_)T.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(T.getDerivedStateFromProps==null&&A!==w&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(A,g),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(A,p.__s,g)===!1||t.__v===n.__v){for(p.props=A,p.state=p.__s,t.__v!==n.__v&&(p.__d=!1),p.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(z){z&&(z.__=t)}),v=0;v<p._sb.length;v++)p.__h.push(p._sb[v]);p._sb=[],p.__h.length&&l.push(p);break t}p.componentWillUpdate!=null&&p.componentWillUpdate(A,p.__s,g),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(w,M,P)})}if(p.context=g,p.props=A,p.__v=t,p.__P=i,y=nt.__r,E=0,"prototype"in T&&T.prototype.render){for(p.state=p.__s,p.__d=!1,y&&y(t),d=p.render(p.props,p.state,p.context),S=0;S<p._sb.length;S++)p.__h.push(p._sb[S]);p._sb=[]}else do p.__d=!1,y&&y(t),d=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++E<25);p.state=p.__s,p.getChildContext!=null&&(r=ge(ge({},r),p.getChildContext())),_||p.getSnapshotBeforeUpdate==null||(P=p.getSnapshotBeforeUpdate(w,M)),C=d!=null&&d.type===Ki&&d.key==null?d.props.children:d,hh(i,Array.isArray(C)?C:[C],t,n,r,s,a,l,u,c),p.base=t.__e,t.__h=null,p.__h.length&&l.push(p),k&&(p.__E=p.__=null),p.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Vu(n.__e,t,n,r,s,a,l,c);(d=nt.diffed)&&d(t)}catch(z){t.__v=null,(c||a!=null)&&(t.__e=u,t.__h=!!c,a[a.indexOf(u)]=null),nt.__e(z,t,n)}}function ch(i,t){nt.__c&&nt.__c(t,i),i.some(function(n){try{i=n.__h,n.__h=[],i.some(function(r){r.call(n)})}catch(r){nt.__e(r,n.__v)}})}function Vu(i,t,n,r,s,a,l,u){var c,d,p,_=n.props,w=t.props,M=t.type,P=0;if(M==="svg"&&(s=!0),a!=null){for(;P<a.length;P++)if((c=a[P])&&"setAttribute"in c==!!M&&(M?c.localName===M:c.nodeType===3)){i=c,a[P]=null;break}}if(i==null){if(M===null)return document.createTextNode(w);i=s?document.createElementNS("http://www.w3.org/2000/svg",M):document.createElement(M,w.is&&w),a=null,u=!1}if(M===null)_===w||u&&i.data===w||(i.data=w);else{if(a=a&&Ji.call(i.childNodes),d=(_=n.props||Un).dangerouslySetInnerHTML,p=w.dangerouslySetInnerHTML,!u){if(a!=null)for(_={},P=0;P<i.attributes.length;P++)_[i.attributes[P].name]=i.attributes[P].value;(p||d)&&(p&&(d&&p.__html==d.__html||p.__html===i.innerHTML)||(i.innerHTML=p&&p.__html||""))}if(Wu(i,w,_,s,u),p)t.__k=[];else if(P=t.props.children,hh(i,Array.isArray(P)?P:[P],t,n,r,s&&M!=="foreignObject",a,l,a?a[0]:n.__k&&Vi(n,0),u),a!=null)for(P=a.length;P--;)a[P]!=null&&sh(a[P]);u||("value"in w&&(P=w.value)!==void 0&&(P!==i.value||M==="progress"&&!P||M==="option"&&P!==_.value)&&Vn(i,"value",P,_.value,!1),"checked"in w&&(P=w.checked)!==void 0&&P!==i.checked&&Vn(i,"checked",P,_.checked,!1))}return i}function fh(i,t,n){try{typeof i=="function"?i(t):i.current=t}catch(r){nt.__e(r,n)}}function dh(i,t,n){var r,s;if(nt.unmount&&nt.unmount(i),(r=i.ref)&&(r.current&&r.current!==i.__e||fh(r,null,t)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){nt.__e(a,t)}r.base=r.__P=null,i.__c=void 0}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&dh(r[s],t,n||typeof i.type!="function");n||i.__e==null||sh(i.__e),i.__=i.__e=i.__d=void 0}function Hu(i,t,n){return this.constructor(i,n)}function fo(i,t,n){var r,s,a;nt.__&&nt.__(i,t),s=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],co(t,i=(!r&&n||t).__k=oi(Ki,null,[i]),s||Un,Un,t.ownerSVGElement!==void 0,!r&&n?[n]:s?null:t.firstChild?Ji.call(t.childNodes):null,a,!r&&n?n:s?s.__e:t.firstChild,r),ch(a,i)}function po(i,t){fo(i,t,po)}function ph(i,t,n){var r,s,a,l=ge({},i.props);for(a in t)a=="key"?r=t[a]:a=="ref"?s=t[a]:l[a]=t[a];return arguments.length>2&&(l.children=arguments.length>3?Ji.call(arguments,2):n),Yi(i.type,l,r||i.key,s||i.ref,null)}function mo(i,t){var n={__c:t="__cC"+rh++,__:i,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,a;return this.getChildContext||(s=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&s.some(Jr)},this.sub=function(l){s.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){s.splice(s.indexOf(l),1),u&&u.call(l)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Ji=oh.slice,nt={__e:function(i,t,n,r){for(var s,a,l;t=t.__;)if((s=t.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(i)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),l=s.__d),l)return s.__E=s}catch(u){i=u}throw i}},ih=0,nh=function(i){return i!=null&&i.constructor===void 0},ii.prototype.setState=function(i,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ge({},this.state),typeof i=="function"&&(i=i(ge({},n),this.props)),i&&ge(n,i),i!=null&&this.__v&&(t&&this._sb.push(t),Jr(this))},ii.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Jr(this))},ii.prototype.render=Ki,Zi=[],jn.__r=0,rh=0;const $u=Object.freeze(Object.defineProperty({__proto__:null,Component:ii,Fragment:Ki,cloneElement:ph,createContext:mo,createElement:oi,createRef:ju,h:oi,hydrate:po,get isValidElement(){return nh},get options(){return nt},render:fo,toChildArray:Wn},Symbol.toStringTag,{value:"Module"}));var Gu=0;function rt(i,t,n,r,s){var a,l,u={};for(l in t)l=="ref"?a=t[l]:u[l]=t[l];var c={type:i,props:u,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Gu,__source:s,__self:r};if(typeof i=="function"&&(a=i.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return nt.vnode&&nt.vnode(c),c}function mh(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function _o(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var t=i.default;if(typeof t=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),n}var xe={};const qu=_o($u);var Ju={};function _h(i,t){for(var n in t)i[n]=t[n];return i}function go(i,t,n){var r=/(?:\?([^#]*))?(#.*)?$/,s=i.match(r),a={},l;if(s&&s[1])for(var u=s[1].split("&"),c=0;c<u.length;c++){var d=u[c].split("=");a[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}i=Kr(i.replace(r,"")),t=Kr(t||"");for(var p=Math.max(i.length,t.length),_=0;_<p;_++)if(t[_]&&t[_].charAt(0)===":"){var w=t[_].replace(/(^:|[+*?]+$)/g,""),M=(t[_].match(/[+*?]+$/)||Ju)[0]||"",P=~M.indexOf("+"),k=~M.indexOf("*"),A=i[_]||"";if(!A&&!k&&(M.indexOf("?")<0||P)){l=!1;break}if(a[w]=decodeURIComponent(A),P||k){a[w]=i.slice(_).map(decodeURIComponent).join("/");break}}else if(t[_]!==i[_]){l=!1;break}return n.default!==!0&&l===!1?!1:a}function Ku(i,t){return i.rank<t.rank?1:i.rank>t.rank?-1:i.index-t.index}function Qu(i,t){return i.index=t,i.rank=ic(i),i.props}function Kr(i){return i.replace(/(^\/+|\/+$)/g,"").split("/")}function tc(i){return i.charAt(0)==":"?1+"*+?".indexOf(i.charAt(i.length-1))||4:5}function ec(i){return Kr(i).map(tc).join("")}function ic(i){return i.props.default?0:ec(i.props.path)}var Zt=null,Ie=[],Hn=[],nc={};function rc(i,t){t===void 0&&(t="push"),Zt&&Zt[t]?Zt[t](i):typeof history<"u"&&history[t+"State"]&&history[t+"State"](null,null,i)}function er(){var i;return Zt&&Zt.location?i=Zt.location:Zt&&Zt.getCurrentLocation?i=Zt.getCurrentLocation():i=typeof location<"u"?location:nc,""+(i.pathname||"")+(i.search||"")}function vo(i,t){return t===void 0&&(t=!1),typeof i!="string"&&i.url&&(t=i.replace,i=i.url),oc(i)&&rc(i,t?"replace":"push"),gh(i)}function oc(i){for(var t=Ie.length;t--;)if(Ie[t].canRoute(i))return!0;return!1}function gh(i){for(var t=!1,n=0;n<Ie.length;n++)Ie[n].routeTo(i)===!0&&(t=!0);for(var r=Hn.length;r--;)Hn[r](i);return t}function vh(i){if(!(!i||!i.getAttribute)){var t=i.getAttribute("href"),n=i.getAttribute("target");if(!(!t||!t.match(/^\//g)||n&&!n.match(/^_?self$/i)))return vo(t)}}function sc(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0))return vh(i.currentTarget||i.target||this),yh(i)}function yh(i){return i&&(i.stopImmediatePropagation&&i.stopImmediatePropagation(),i.stopPropagation&&i.stopPropagation(),i.preventDefault()),!1}function ac(i){if(!(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button!==0)){var t=i.target;do if(String(t.nodeName).toUpperCase()==="A"&&t.getAttribute("href")){if(t.hasAttribute("native"))return;if(vh(t))return yh(i)}while(t=t.parentNode)}}var zs=!1;function hc(){zs||(typeof addEventListener=="function"&&(Zt||addEventListener("popstate",function(){gh(er())}),addEventListener("click",ac)),zs=!0)}var he=(function(i){function t(n){i.call(this,n),n.history&&(Zt=n.history),this.state={url:n.url||er()},hc()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.shouldComponentUpdate=function(r){return r.static!==!0?!0:r.url!==this.props.url||r.onChange!==this.props.onChange},t.prototype.canRoute=function(r){var s=Wn(this.props.children);return this.getMatchingChildren(s,r,!1).length>0},t.prototype.routeTo=function(r){this.setState({url:r});var s=this.canRoute(r);return this.updating||this.forceUpdate(),s},t.prototype.componentWillMount=function(){Ie.push(this),this.updating=!0},t.prototype.componentDidMount=function(){var r=this;Zt&&(this.unlisten=Zt.listen(function(s){r.routeTo(""+(s.pathname||"")+(s.search||""))})),this.updating=!1},t.prototype.componentWillUnmount=function(){typeof this.unlisten=="function"&&this.unlisten(),Ie.splice(Ie.indexOf(this),1)},t.prototype.componentWillUpdate=function(){this.updating=!0},t.prototype.componentDidUpdate=function(){this.updating=!1},t.prototype.getMatchingChildren=function(r,s,a){return r.filter(Qu).sort(Ku).map(function(l){var u=go(s,l.props.path,l.props);if(u){if(a!==!1){var c={url:s,matches:u};return _h(c,u),delete c.ref,delete c.key,ph(l,c)}return l}}).filter(Boolean)},t.prototype.render=function(r,s){var a=r.children,l=r.onChange,u=s.url,c=this.getMatchingChildren(Wn(a),u,!0),d=c[0]||null,p=this.previousUrl;return u!==p&&(this.previousUrl=u,typeof l=="function"&&l({router:this,url:u,previous:p,active:c,current:d})),d},t})(ii),wh=function(i){return oi("a",_h({onClick:sc},i))},xh=function(i){return oi(i.component,i)};he.subscribers=Hn;he.getCurrentUrl=er;he.route=vo;he.Router=he;he.Route=xh;he.Link=wh;he.exec=go;const lc=Object.freeze(Object.defineProperty({__proto__:null,Link:wh,Route:xh,Router:he,default:he,exec:go,getCurrentUrl:er,route:vo,subscribers:Hn},Symbol.toStringTag,{value:"Module"})),uc=_o(lc);var Fs;function cc(){if(Fs)return xe;Fs=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.Link=xe.Match=void 0;var i=Object.assign||function(d){for(var p=1;p<arguments.length;p++){var _=arguments[p];for(var w in _)Object.prototype.hasOwnProperty.call(_,w)&&(d[w]=_[w])}return d},t=qu,n=uc;function r(d,p){var _={};for(var w in d)p.indexOf(w)>=0||Object.prototype.hasOwnProperty.call(d,w)&&(_[w]=d[w]);return _}function s(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function a(d,p){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:d}function l(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(d,p):d.__proto__=p)}var u=xe.Match=(function(d){l(p,d);function p(){var _,w,M;s(this,p);for(var P=arguments.length,k=Array(P),A=0;A<P;A++)k[A]=arguments[A];return M=(_=(w=a(this,d.call.apply(d,[this].concat(k))),w),w.update=function(O){w.nextUrl=O,w.setState({})},_),a(w,M)}return p.prototype.componentDidMount=function(){n.subscribers.push(this.update)},p.prototype.componentWillUnmount=function(){n.subscribers.splice(n.subscribers.indexOf(this.update)>>>0,1)},p.prototype.render=function(w){var M=this.nextUrl||(0,n.getCurrentUrl)(),P=M.replace(/\?.+$/,"");return this.nextUrl=null,w.children({url:M,path:P,matches:(0,n.exec)(P,w.path,{})!==!1})},p})(t.Component),c=function(p){var _=p.activeClassName,w=p.path,M=r(p,["activeClassName","path"]);return(0,t.h)(u,{path:w||M.href},function(P){var k=P.matches;return(0,t.h)(n.Link,i({},M,{class:[M.class||M.className,k&&_].filter(Boolean).join(" ")}))})};return xe.Link=c,xe.default=u,u.Link=c,xe}var fc=cc();const dc="_header_19max_1",pc="_nav_19max_14",mc="_github_19max_19",_c="_logo_19max_26",gc="_active_19max_66",bi={header:dc,nav:pc,github:mc,logo:_c,active:gc},vc=""+new URL("logo-DQvm3LRv.png",import.meta.url).href,yc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",wc=()=>rt("header",{class:bi.header,children:[rt("div",{class:bi.nav,children:[rt("img",{class:bi.logo,src:vc}),rt("nav",{children:rt(fc.Link,{activeClassName:bi.active,href:"/",children:"Home"})})]}),rt("div",{class:bi.github,children:rt("a",{href:"https://www.github.com/JamesLMilner/terra-draw",children:rt("img",{src:yc})})})]}),xc="_home_tzwl9_1",bc="_map_tzwl9_7",Mc="_helpOverlay_tzwl9_14",Pc="_helpHeader_tzwl9_27",Lc="_helpTitle_tzwl9_35",Ec="_helpClose_tzwl9_40",Sc="_helpBody_tzwl9_55",Cc="_helpHint_tzwl9_74",kc="_loading_tzwl9_131",de={home:xc,map:bc,helpOverlay:Mc,helpHeader:Pc,helpTitle:Lc,helpClose:Ec,helpBody:Sc,helpHint:Cc,loading:kc};var Qi,wt,Ar,Ns,Hi=0,bh=[],zn=[],Rs=nt.__b,Zs=nt.__r,Ys=nt.diffed,Xs=nt.__c,Us=nt.unmount;function ir(i,t){nt.__h&&nt.__h(wt,i,Hi||t),Hi=0;var n=wt.__H||(wt.__H={__:[],__h:[]});return i>=n.__.length&&n.__.push({__V:zn}),n.__[i]}function We(i){return Hi=1,Mh(Ph,i)}function Mh(i,t,n){var r=ir(Qi++,2);if(r.t=i,!r.__c&&(r.__=[Ph(void 0,t),function(a){var l=r.__N?r.__N[0]:r.__[0],u=r.t(l,a);l!==u&&(r.__N=[u,r.__[1]],r.__c.setState({}))}],r.__c=wt,!wt.u)){wt.u=!0;var s=wt.shouldComponentUpdate;wt.shouldComponentUpdate=function(a,l,u){if(!r.__c.__H)return!0;var c=r.__c.__H.__.filter(function(p){return p.__c});if(c.every(function(p){return!p.__N}))return!s||s.call(this,a,l,u);var d=!1;return c.forEach(function(p){if(p.__N){var _=p.__[0];p.__=p.__N,p.__N=void 0,_!==p.__[0]&&(d=!0)}}),!(!d&&r.__c.props===a)&&(!s||s.call(this,a,l,u))}}return r.__N||r.__}function js(i,t){var n=ir(Qi++,3);!nt.__s&&yo(n.__H,t)&&(n.__=i,n.i=t,wt.__H.__h.push(n))}function Tc(i,t){var n=ir(Qi++,4);!nt.__s&&yo(n.__H,t)&&(n.__=i,n.i=t,wt.__h.push(n))}function Dc(i){return Hi=5,$i(function(){return{current:i}},[])}function $i(i,t){var n=ir(Qi++,7);return yo(n.__H,t)?(n.__V=i(),n.i=t,n.__h=i,n.__V):n.__}function Or(i,t){return Hi=8,$i(function(){return i},t)}function Ac(){for(var i;i=bh.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(Fn),i.__H.__h.forEach(Qr),i.__H.__h=[]}catch(t){i.__H.__h=[],nt.__e(t,i.__v)}}nt.__b=function(i){wt=null,Rs&&Rs(i)},nt.__r=function(i){Zs&&Zs(i),Qi=0;var t=(wt=i.__c).__H;t&&(Ar===wt?(t.__h=[],wt.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=zn,n.__N=n.i=void 0})):(t.__h.forEach(Fn),t.__h.forEach(Qr),t.__h=[])),Ar=wt},nt.diffed=function(i){Ys&&Ys(i);var t=i.__c;t&&t.__H&&(t.__H.__h.length&&(bh.push(t)!==1&&Ns===nt.requestAnimationFrame||((Ns=nt.requestAnimationFrame)||Oc)(Ac)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==zn&&(n.__=n.__V),n.i=void 0,n.__V=zn})),Ar=wt=null},nt.__c=function(i,t){t.some(function(n){try{n.__h.forEach(Fn),n.__h=n.__h.filter(function(r){return!r.__||Qr(r)})}catch(r){t.some(function(s){s.__h&&(s.__h=[])}),t=[],nt.__e(r,n.__v)}}),Xs&&Xs(i,t)},nt.unmount=function(i){Us&&Us(i);var t,n=i.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Fn(r)}catch(s){t=s}}),n.__H=void 0,t&&nt.__e(t,n.__v))};var Ws=typeof requestAnimationFrame=="function";function Oc(i){var t,n=function(){clearTimeout(r),Ws&&cancelAnimationFrame(t),setTimeout(i)},r=setTimeout(n,100);Ws&&(t=requestAnimationFrame(n))}function Fn(i){var t=wt,n=i.__c;typeof n=="function"&&(i.__c=void 0,n()),wt=t}function Qr(i){var t=wt;i.__c=i.__(),wt=t}function yo(i,t){return!i||i.length!==t.length||t.some(function(n,r){return n!==i[r]})}function Ph(i,t){return typeof t=="function"?t(i):t}function ae(){return ae=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ae.apply(null,arguments)}var to;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(to||(to={}));const pe={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT_FEATURE_ID:"selectionPointFeatureId",SELECTION_POINT:"selectionPoint"},me={MODE:"mode",CURRENTLY_DRAWING:"currentlyDrawing",EDITED:"edited",CLOSING_POINT:"closingPoint",SNAPPING_POINT:"snappingPoint",COORDINATE_POINT:"coordinatePoint",COORDINATE_POINT_FEATURE_ID:"coordinatePointFeatureId",COORDINATE_POINT_IDS:"coordinatePointIds",PROVISIONAL_COORDINATE_COUNT:"provisionalCoordinateCount",COMMITTED_COORDINATE_COUNT:"committedCoordinateCount",MARKER:"marker"};function Ir(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function Vs(i){return!!(i&&typeof i=="object"&&"properties"in i&&typeof i.properties=="object"&&i.properties!==null&&"mode"in i.properties)}function Hs(i){return!!(function(t){return typeof t=="number"&&!isNaN(new Date(t).valueOf())})(i)}const Ic="Feature mode property does not match the mode being added to";var si;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(si||(si={}));const Bc={rightClick:!0,contextMenu:!1,leftClick:!0,onDragStart:!0,onDrag:!0,onDragEnd:!0};let Lh=class{get state(){return this._state}set state(t){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(t){if(typeof t!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=t}registerBehaviors(t){}constructor(t,n=!1){this._state="unregistered",this._styles={},this.pointerEvents=Bc,this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.isInitialUpdate=!1,this.type=si.Drawing,this.mode="base",n?this.isInitialUpdate=!0:this.updateOptions(ae({},t))}updateOptions(t){t!=null&&t.styles&&(this.styles=ae({},this._styles,t.styles)),t!=null&&t.pointerDistance&&(this.pointerDistance=t.pointerDistance),t!=null&&t.validation&&(this.validate=t&&t.validation),t!=null&&t.projection&&(this.projection=t.projection),t?.pointerEvents!==void 0&&(this.pointerEvents=t.pointerEvents),t!=null&&t.modeName&&this.isInitialUpdate===!0&&(this.mode=t.modeName),this.isInitialUpdate=!1}allowPointerEvent(t,n){return typeof t=="boolean"?t:typeof t!="function"||t(n)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(t){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=t.store,this.store.registerOnChange(t.onChange),this.setDoubleClickToZoom=t.setDoubleClickToZoom,this.project=t.project,this.unproject=t.unproject,this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.setCursor=t.setCursor,this.onStyleChange=t.onChange,this.onFinish=t.onFinish,this.coordinatePrecision=t.coordinatePrecision,this.registerBehaviors({mode:t.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:t.coordinatePrecision,projection:this.projection})}validateFeature(t){return this.performFeatureValidation(t)}afterFeatureAdded(t){}afterFeatureUpdated(t){}performFeatureValidation(t){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=(function(r,s){let a;if(Ir(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(Ir(r.geometry))if(Ir(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}})(t,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(t,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:to.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(t,n){const r=this.performFeatureValidation(t);return r.valid?t.properties.mode!==this.mode?{valid:!1,reason:Ic}:n(t):{valid:!1,reason:r.reason}}onFinish(t,n){}onDeselect(t){}onSelect(t){}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){}onClick(t){}onDragStart(t,n){}onDrag(t,n){}onDragEnd(t,n){}getHexColorStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getNumericStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getUrlStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getStylingValue(t,n,r){return t===void 0?n:typeof t=="function"?t(r):t}};function zc(i,t){const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3}function $n(i,t=9){const n=Math.pow(10,t);return Math.round(i*n)/n}const $s=57.29577951308232,Gs=.017453292519943295,Gn=6378137,wo=(i,t)=>({x:i===0?0:i*Gs*Gn,y:t===0?0:Math.log(Math.tan(Math.PI/4+t*Gs/2))*Gn}),eo=(i,t)=>({lng:i===0?0:$s*(i/Gn),lat:t===0?0:(2*Math.atan(Math.exp(t/Gn))-Math.PI/2)*$s});function xo(i,t){return qs(i[0])<=t&&qs(i[1])<=t}function bo(i){return i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"&&i[0]!==1/0&&i[1]!==1/0&&(n=i[0])>=-180&&n<=180&&(t=i[1])>=-90&&t<=90;var t,n}function qs(i){let t=1,n=0;for(;Math.round(i*t)/t!==i;)t*=10,n++;return n}const Fc="Feature has holes",Nc="Feature has less than 4 coordinates",Rc="Feature has invalid coordinates",Zc="Feature coordinates are not closed";function Yc(i,t){if(i.geometry.type!=="Polygon")return{valid:!1,reason:"Feature is not a Polygon"};if(i.geometry.coordinates.length!==1)return{valid:!1,reason:Fc};if(i.geometry.coordinates[0].length<4)return{valid:!1,reason:Nc};for(let s=0;s<i.geometry.coordinates[0].length;s++){if(!bo(i.geometry.coordinates[0][s]))return{valid:!1,reason:Rc};if(!xo(i.geometry.coordinates[0][s],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return(n=i.geometry.coordinates[0][0])[0]!==(r=i.geometry.coordinates[0][i.geometry.coordinates[0].length-1])[0]||n[1]!==r[1]?{valid:!1,reason:Zc}:{valid:!0};var n,r}const io=(i,t)=>{const{x:n,y:r}=i,{x:s,y:a}=t,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};function Xc({unproject:i,point:t,pointerDistance:n}){const r=n/2,{x:s,y:a}=t;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[i(s-r,a-r),i(s+r,a-r),i(s+r,a+r),i(s-r,a+r),i(s-r,a-r)].map(l=>[l.lng,l.lat])]}}}function Uc(i,t){if(i.geometry.type!=="LineString")return{valid:!1,reason:"Feature is not a LineString"};if(i.geometry.coordinates.length<2)return{valid:!1,reason:"Feature has less than 2 coordinates"};for(let n=0;n<i.geometry.coordinates.length;n++){if(!bo(i.geometry.coordinates[n]))return{valid:!1,reason:"Feature has invalid coordinates"};if(!xo(i.geometry.coordinates[n],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return{valid:!0}}const jc="Feature is not a Point",Wc="Feature has invalid coordinates",Vc="Feature has coordinates with excessive precision";function Hc(i,t){return i.geometry.type!=="Point"?{valid:!1,reason:jc}:bo(i.geometry.coordinates)?xo(i.geometry.coordinates,t)?{valid:!0}:{valid:!1,reason:Vc}:{valid:!1,reason:Wc}}class $c extends Lh{constructor(t){if(!t.modeName)throw new Error("Mode name is required for TerraDrawRenderMode");super(t,!0),this.type=si.Render,this.mode="render",this.updateOptions(t)}updateOptions(t){super.updateOptions(t)}registerBehaviors(t){this.mode=t.mode}start(){this.setStarted()}stop(){this.setStopped()}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(t){return{pointColor:this.getHexColorStylingValue(this.styles.pointColor,"#3f97e0",t),pointWidth:this.getNumericStylingValue(this.styles.pointWidth,6,t),pointOutlineColor:this.getHexColorStylingValue(this.styles.pointOutlineColor,"#ffffff",t),pointOutlineWidth:this.getNumericStylingValue(this.styles.pointOutlineWidth,0,t),polygonFillColor:this.getHexColorStylingValue(this.styles.polygonFillColor,"#3f97e0",t),polygonFillOpacity:this.getNumericStylingValue(this.styles.polygonFillOpacity,.3,t),polygonOutlineColor:this.getHexColorStylingValue(this.styles.polygonOutlineColor,"#3f97e0",t),polygonOutlineWidth:this.getNumericStylingValue(this.styles.polygonOutlineWidth,4,t),lineStringWidth:this.getNumericStylingValue(this.styles.lineStringWidth,4,t),lineStringColor:this.getHexColorStylingValue(this.styles.lineStringColor,"#3f97e0",t),zIndex:this.getNumericStylingValue(this.styles.zIndex,0,t)}}validateFeature(t){const n=super.validateFeature(t);if(n.valid){const r=t,s=Hc(r,this.coordinatePrecision).valid||Yc(r,this.coordinatePrecision).valid||Uc(r,this.coordinatePrecision).valid;return s?{valid:!0}:{valid:s,reason:"Feature is not a valid Point, Polygon or LineString feature"}}return n}}function Gc(i,t){let n=!1;for(let l=0,u=t.length;l<u;l++){const c=t[l];for(let d=0,p=c.length,_=p-1;d<p;_=d++)(s=c[d])[1]>(r=i)[1]!=(a=c[_])[1]>r[1]&&r[0]<(a[0]-s[0])*(r[1]-s[1])/(a[1]-s[1])+s[0]&&(n=!n)}var r,s,a;return n}const Js=(i,t,n)=>{const r=a=>a*a,s=(a,l)=>r(a.x-l.x)+r(a.y-l.y);return Math.sqrt(((a,l,u)=>{const c=s(l,u);if(c===0)return s(a,l);let d=((a.x-l.x)*(u.x-l.x)+(a.y-l.y)*(u.y-l.y))/c;return d=Math.max(0,Math.min(1,d)),s(a,{x:l.x+d*(u.x-l.x),y:l.y+d*(u.y-l.y)})})(i,t,n))},qc=(i,t)=>{if(t===0||t===360||t===-360)return i;const n=.017453292519943295*t,r=(i.geometry.type==="Polygon"?i.geometry.coordinates[0]:i.geometry.coordinates).map(([l,u])=>wo(l,u)),s=r.reduce((l,u)=>({x:l.x+u.x,y:l.y+u.y}),{x:0,y:0});s.x/=r.length,s.y/=r.length;const a=r.map(l=>({x:s.x+(l.x-s.x)*Math.cos(n)-(l.y-s.y)*Math.sin(n),y:s.y+(l.x-s.x)*Math.sin(n)+(l.y-s.y)*Math.cos(n)})).map(({x:l,y:u})=>[eo(l,u).lng,eo(l,u).lat]);return i.geometry.type==="Polygon"?i.geometry.coordinates[0]=a:i.geometry.coordinates=a,i};function Jc({coordinates:i,originX:t,originY:n,xScale:r,yScale:s}){r===1&&s===1||i.forEach(a=>{const{x:l,y:u}=wo(a[0],a[1]),c=t+(l-t)*r,d=n+(u-n)*s,{lng:p,lat:_}=eo(c,d);a[0]=p,a[1]=_})}let Kc=class extends Lh{constructor(...t){super(...t),this.type=si.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return ae({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0,markerUrl:void 0,markerHeight:void 0,markerWidth:void 0})}};function Eh(i,t,n,r,s){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,p=Math.log(c),_=.5*Math.exp(2*p/3),w=.5*Math.sqrt(p*_*(c-_)/c)*(d-c/2<0?-1:1);Eh(i,t,Math.max(n,Math.floor(t-d*_/c+w)),Math.min(r,Math.floor(t+(c-d)*_/c+w)),s)}const a=i[t];let l=n,u=r;for(Mi(i,n,t),s(i[r],a)>0&&Mi(i,n,r);l<u;){for(Mi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?Mi(i,n,u):(u++,Mi(i,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}function Mi(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}function Ve(i,t){Oi(i,0,i.children.length,t,i)}function Oi(i,t,n,r,s){s||(s=Qe([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<n;a++){const l=i.children[a];Ii(s,i.leaf?r(l):l)}return s}function Ii(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Qc(i,t){return i.minX-t.minX}function tf(i,t){return i.minY-t.minY}function Br(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Ln(i){return i.maxX-i.minX+(i.maxY-i.minY)}function ef(i,t){const n=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function zr(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function En(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function Qe(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ks(i,t,n,r,s){const a=[t,n];for(;a.length;){if((n=a.pop())-(t=a.pop())<=r)continue;const l=t+Math.ceil((n-t)/r/2)*r;Eh(i,l,t,n,s),a.push(t,l,l,n)}}class nf{constructor(t){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(t){let n=this.data;const r=[];if(!En(t,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],c=n.leaf?s(u):u;En(t,c)&&(n.leaf?r.push(u):zr(t,c)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(t){let n=this.data;if(En(t,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(En(t,l)){if(n.leaf||zr(t,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(t){if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(t){this._insert(t,this.data.height-1)}clear(){this.data=Qe([])}remove(t){let n=this.data;const r=this.toBBox(t),s=[],a=[];let l,u,c=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),c=!0),n.leaf){const d=n.children.indexOf(t);d!==-1&&(n.children.splice(d,1),s.push(n),this._condense(s))}c||n.leaf||!zr(n,r)?u?(l++,n=u.children[l],c=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=Qe(t.slice(n,r+1)),Ve(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=Qe([]),l.leaf=!1,l.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));Ks(t,n,r,d,this.compareMinX);for(let p=n;p<=r;p+=d){const _=Math.min(p+d-1,r);Ks(t,p,_,c,this.compareMinY);for(let w=p;w<=_;w+=c){const M=Math.min(w+c-1,_);l.children.push(this._build(t,w,M,s-1))}}return Ve(l,this.toBBox),l}_chooseSubtree(t,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,c=1/0,d=1/0;for(let p=0;p<n.children.length;p++){const _=n.children[p],w=Br(_),M=(a=t,l=_,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-w);M<d?(d=M,c=w<c?w:c,u=_):M===d&&w<c&&(c=w,u=_)}n=u||n.children[0]}var a,l;return n}_insert(t,n,r){const s=r?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(t),Ii(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(t,n){const r=t[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=Qe(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,Ve(r,this.toBBox),Ve(u,this.toBBox),n?t[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(t,n){this.data=Qe([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Ve(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const c=Oi(t,0,u,this.toBBox),d=Oi(t,u,r,this.toBBox),p=ef(c,d),_=Br(c)+Br(d);p<a?(a=p,s=u,l=_<l?_:l):p===a&&_<l&&(l=_,s=u)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:Qc,a=t.leaf?this.compareMinY:tf;this._allDistMargin(t,n,r,s)<this._allDistMargin(t,n,r,a)&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const a=this.toBBox,l=Oi(t,0,n,a),u=Oi(t,r-n,r,a);let c=Ln(l)+Ln(u);for(let d=n;d<r-n;d++){const p=t.children[d];Ii(l,t.leaf?a(p):p),c+=Ln(l)}for(let d=r-n-1;d>=n;d--){const p=t.children[d];Ii(u,t.leaf?a(p):p),c+=Ln(u)}return c}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Ii(n[s],t)}_condense(t){for(let n,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(n=t[r-1].children,n.splice(n.indexOf(t[r]),1)):this.clear():Ve(t[r],this.toBBox)}}class rf{constructor(t){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new nf(t&&t.maxEntries?t.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(t,n){this.idToNode.set(t.id,n),this.nodeToId.set(n,t.id)}toBBox(t){const n=[],r=[];let s;if(t.geometry.type==="Polygon")s=t.geometry.coordinates[0];else if(t.geometry.type==="LineString")s=t.geometry.coordinates;else{if(t.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[t.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(t){if(this.idToNode.get(String(t.id)))throw new Error("Feature already exists");const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}load(t){const n=[],r=new Set;t.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(t){this.remove(t.id);const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}remove(t){const n=this.idToNode.get(t);if(!n)throw new Error(`${t} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(t){return this.tree.search(this.toBBox(t)).map(n=>this.nodeToId.get(n))}collides(t){return this.tree.collides(this.toBBox(t))}}const of={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=16*Math.random()|0;return(i=="x"?t:3&t|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36},Qs={target:"geometry"},ta={target:"properties"};class sf{constructor(t){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new rf,this.tracked=!t||t.tracked!==!1,this.idStrategy=t&&t.idStrategy?t.idStrategy:of}clone(t){return JSON.parse(JSON.stringify(t))}getId(){return this.idStrategy.getId()}has(t){return!!this.store[t]}load(t,n,r,s){if(t.length===0)return[];let a=this.clone(t);const l=[],u=[];a=a.filter(d=>{d.id==null&&(d.id=this.idStrategy.getId());const p=d.id;if(n){const _=n(d);if(!_.valid)return l.push({id:p,valid:!1,reason:_.reason}),!1}if(this.tracked){if(d.properties.createdAt){if(!Hs(d.properties.createdAt))return l.push({id:d.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else d.properties.createdAt=+new Date;if(d.properties.updatedAt){if(!Hs(d.properties.updatedAt))return l.push({id:d.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else d.properties.updatedAt=+new Date}return this.has(p)?(l.push({id:p,valid:!1,reason:`Feature already exists with this id: ${p}`}),!1):(this.store[p]=d,u.push(d),l.push({id:p,valid:!0}),!0)}),this.spatialIndex.load(a);const c=u.map(({id:d})=>d);return c.length>0&&(this._onChange(c,"create",s),r&&u.forEach(d=>{r(d)})),l}search(t,n){const r=this.spatialIndex.search(t).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(t){this._onChange=(n,r,s)=>{t(n,r,s)}}getGeometryCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get properties copy`);return this.clone(n.properties)}updateProperty(t,n){const r=new Set;t.forEach(({id:s,property:a,value:l})=>{const u=this.store[s];if(!u)throw new Error(`No feature with this (${s}), can not update geometry`);u.properties[a]!==l&&(r.add(s),l===void 0?delete u.properties[a]:u.properties[a]=l,this.tracked&&(u.properties.updatedAt=+new Date))}),this._onChange&&r.size>0&&this._onChange([...r],"update",n?ae({},n,ta):ta)}updateGeometry(t,n){const r=new Set;t.forEach(({id:s,geometry:a})=>{r.add(s);const l=this.store[s];if(!l)throw new Error(`No feature with this (${s}), can not update geometry`);l.geometry=this.clone(a),this.spatialIndex.update(l),this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&r.size>0&&this._onChange([...r],"update",n?ae({},n,Qs):Qs)}create(t,n){const r=[];return t.forEach(({geometry:s,properties:a})=>{let l,u=ae({},a);this.tracked&&(l=+new Date,a?(u.createdAt=typeof a.createdAt=="number"?a.createdAt:l,u.updatedAt=typeof a.updatedAt=="number"?a.updatedAt:l):u={createdAt:l,updatedAt:l});const c=this.getId(),d={id:c,type:"Feature",geometry:s,properties:u};this.store[c]=d,this.spatialIndex.insert(d),r.push(c)}),this._onChange&&this._onChange([...r],"create",n),r}delete(t,n){t.forEach(r=>{if(!this.store[r])throw new Error(`No feature with id ${r}, can not delete`);delete this.store[r],this.spatialIndex.remove(r)}),this._onChange&&this._onChange([...t],"delete",n)}copy(t){return this.clone(this.store[t])}copyAll(){return this.clone(Object.keys(this.store).map(t=>this.store[t]))}copyAllWhere(t){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&t(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class He{constructor({name:t,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=t,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}}var af={__proto__:null,TerraDrawBaseAdapter:class{constructor(i){this._nextKeyUpIsContextMenu=!1,this._lastPointerDownEventTarget=void 0,this._ignoreMismatchedPointerEvents=!1,this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._ignoreMismatchedPointerEvents=typeof i.ignoreMismatchedPointerEvents=="boolean"&&i.ignoreMismatchedPointerEvents,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const t=this.getMapEventElement(i.type),{left:n,top:r}=t.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i,t=!1){const n=this.getLngLatFromEvent(i);if(!n)return null;const{lng:r,lat:s}=n,{containerX:a,containerY:l}=this.getMapElementXYPosition(i),u=this.getButton(i),c=Array.from(this._heldKeys);return{lng:$n(r,this._coordinatePrecision),lat:$n(s,this._coordinatePrecision),containerX:a,containerY:l,button:u,heldKeys:c,isContextMenu:t}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(t=>{t.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new He({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t,this._lastPointerDownEventTarget=i.target?i.target:void 0)},register:i=>{this.getMapEventElement("pointerdown").addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement("pointerdown").removeEventListener("pointerdown",i)}}),new He({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const t=this.getDrawEventFromEvent(i);if(t)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:t.containerX,y:t.containerY},s=this._currentModeCallbacks.getState(),a=io(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._nextKeyUpIsContextMenu=!1,this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(t,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement("pointermove").addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement("pointermove").removeEventListener("pointermove",i)}}),new He({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&(i.preventDefault(),this._nextKeyUpIsContextMenu=!0)},register:i=>{this.getMapEventElement("contextmenu").addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement("contextmenu").removeEventListener("contextmenu",i)}}),new He({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement("pointerup")||this._ignoreMismatchedPointerEvents&&this._lastPointerDownEventTarget!==i.target||(this._lastPointerDownEventTarget=void 0,!i.isPrimary))return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(t,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||(this._nextKeyUpIsContextMenu&&(t.isContextMenu=!0,this._nextKeyUpIsContextMenu=!1),this._currentModeCallbacks.onClick(t)),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement("pointerup").addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement("pointerup").removeEventListener("pointerup",i)}}),new He({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement("keyup").addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement("keyup").removeEventListener("keyup",i)}}),new He({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement("keydown").addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement("keydown").removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear(),this._currentModeCallbacks=void 0,this._lastDrawEvent=void 0,this._lastPointerDownEventTarget=void 0,this._nextKeyUpIsContextMenu=!1}}};function no(i){if(i===null||typeof i=="boolean"||typeof i=="string")return!0;if(i===void 0)return!1;if(typeof i=="number")return Number.isFinite(i);if(typeof i=="bigint"||typeof i=="symbol"||typeof i=="function"||i instanceof RegExp||i instanceof Map||i instanceof Set||i instanceof Date)return!1;if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const t=Object.getPrototypeOf(i);if(t!==Object.prototype&&t!==null)return!1}if(ArrayBuffer.isView(i)&&!(i instanceof DataView))return!1;if(Array.isArray(i)){for(const t of i)if(!no(t))return!1}return typeof i=="object"&&Object.keys(i).every(t=>typeof t=="string"&&no(i[t]))}class hf{constructor(t){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=t.adapter,this._mode=new Kc;const n=new Set,r=t.modes.reduce((p,_)=>{if(n.has(_.mode))throw new Error(`There is already a ${_.mode} mode provided`);return n.add(_.mode),p[_.mode]=_,p},{}),s=Object.keys(r);if(s.length===0)throw new Error("No modes provided");s.forEach(p=>{if(r[p].type===si.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=p}}),this._modes=ae({},r,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new sf({tracked:!!t.tracked,idStrategy:t.idStrategy?t.idStrategy:void 0});const a=p=>{const _=[],w=this._store.copyAll().filter(M=>!p.includes(M.id)||(_.push(M),!1));return{changed:_,unchanged:w}},l=(p,_)=>{this._enabled&&this._eventListeners.finish.forEach(w=>{w(p,_)})},u=(p,_,w)=>{if(!this._enabled)return;this._eventListeners.change.forEach(k=>{k(p,_,w)});const{changed:M,unchanged:P}=a(p);_==="create"?this._adapter.render({created:M,deletedIds:[],unchanged:P,updated:[]},this.getModeStyles()):_==="update"?this._adapter.render({created:[],deletedIds:[],unchanged:P,updated:M},this.getModeStyles()):_==="delete"?this._adapter.render({created:[],deletedIds:p,unchanged:P,updated:[]},this.getModeStyles()):_==="styling"&&this._adapter.render({created:[],deletedIds:[],unchanged:P,updated:[]},this.getModeStyles())},c=p=>{if(!this._enabled)return;this._eventListeners.select.forEach(M=>{M(p)});const{changed:_,unchanged:w}=a([p]);this._adapter.render({created:[],deletedIds:[],unchanged:w,updated:_},this.getModeStyles())},d=p=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(M=>{M()});const{changed:_,unchanged:w}=a([p]);_&&this._adapter.render({created:[],deletedIds:[],unchanged:w,updated:_},this.getModeStyles())};Object.keys(this._modes).forEach(p=>{this._modes[p].register({mode:p,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:u,onSelect:c,onDeselect:d,onFinish:l,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const t={};return Object.keys(this._modes).forEach(n=>{t[n]=r=>this._instanceSelectMode&&r.properties[pe.SELECTED]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(r):this._modes[n].styleFeature.bind(this._modes[n])(r)}),t}featuresAtLocation({lng:t,lat:n},r){const s=r&&r.pointerDistance!==void 0?r.pointerDistance:30,a=!r||r.ignoreSelectFeatures===void 0||r.ignoreSelectFeatures,l=!(!r||r.ignoreCoordinatePoints===void 0)&&r.ignoreCoordinatePoints,u=!(!r||r.ignoreCurrentlyDrawing===void 0)&&r.ignoreCurrentlyDrawing,c=!(!r||r.ignoreClosingPoints===void 0)&&r.ignoreClosingPoints,d=!(!r||r.ignoreSnappingPoints===void 0)&&r.ignoreSnappingPoints,p=this._adapter.unproject.bind(this._adapter),_=this._adapter.project.bind(this._adapter),w=_(t,n),M=Xc({unproject:p,point:w,pointerDistance:s});return this._store.search(M).filter(P=>{if(a&&(P.properties[pe.MID_POINT]||P.properties[pe.SELECTION_POINT])||l&&P.properties[me.COORDINATE_POINT]||c&&P.properties[me.CLOSING_POINT]||u&&P.properties[me.CURRENTLY_DRAWING]||d&&P.properties[me.SNAPPING_POINT])return!1;if(P.geometry.type==="Point"){const k=P.geometry.coordinates,A=_(k[0],k[1]);return io(w,A)<s}if(P.geometry.type==="LineString"){const k=P.geometry.coordinates;for(let A=0;A<k.length-1;A++){const O=k[A],g=k[A+1];if(Js(w,_(O[0],O[1]),_(g[0],g[1]))<s)return!0}return!1}if(Gc([t,n],P.geometry.coordinates))return!0;if(r!=null&&r.includePolygonsWithinPointerDistance){const k=P.geometry.coordinates;for(const A of k)for(let O=0;O<A.length-1;O++){const g=A[O],v=A[O+1],y=_(g[0],g[1]),E=_(v[0],v[1]);if(Js(w,y,E)<s)return!0}}return!1}).map(P=>{if(r==null||!r.addClosestCoordinateInfoToProperties)return P;let k;if(P.geometry.type==="Polygon")k=P.geometry.coordinates[0].slice(0,-1);else{if(P.geometry.type!=="LineString")return P;k=P.geometry.coordinates}let A,O=-1,g=1/0;for(let v=0;v<k.length;v++){const y=k[v],E=io(_(y[0],y[1]),w);E<g&&(O=v,g=E,A=y)}return P.properties.closestCoordinateIndexToEvent=O,P.properties.closestCoordinatePixelDistanceToEvent=g,P.properties.closestCoordinateDistanceKmToEvent=zc(A,[t,n]),P})}getSelectModeOrThrow(){const t=this.getSelectMode({switchToSelectMode:!0});if(!t)throw new Error("No select mode defined in instance");return t}getSelectMode({switchToSelectMode:t}){if(this.checkEnabled(),!this._instanceSelectMode)return null;const n=this.getMode();return t&&n!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}isGuidanceFeature(t){return!!(t.properties[pe.MID_POINT]||t.properties[pe.SELECTION_POINT]||t.properties[me.COORDINATE_POINT]||t.properties[me.SNAPPING_POINT])}setModeStyles(t,n){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._modes[t].styles=n}updateModeOptions(t,n){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._modes[t].updateOptions(n)}getSnapshot(){return this._store.copyAll()}getSnapshotFeature(t){if(this._store.has(t))return this._store.copy(t)}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(t){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}getModeState(){return this._mode.state}setMode(t){if(this.checkEnabled(),!this._modes[t])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[t],this._mode.start()}removeFeatures(t){this.checkEnabled();const n=[];t.forEach(r=>{if(!this._store.has(r))throw new Error(`No feature with id ${r}, can not delete`);const s=this._store.copy(r);s.properties[pe.SELECTED]&&this.deselectFeature(r),s.properties[me.COORDINATE_POINT_IDS]&&n.push(...s.properties[me.COORDINATE_POINT_IDS])}),this._store.delete([...t,...n],{origin:"api"})}selectFeature(t){this.getSelectModeOrThrow().selectFeature(t)}deselectFeature(t){this.getSelectModeOrThrow().deselectFeature(t)}getFeatureId(){return this._store.getId()}hasFeature(t){return this._store.has(t)}checkIsReservedProperty(t){return![...Object.values(pe),...Object.values(me)].includes(t)}updateFeatureProperties(t,n){if(!this._store.has(t))throw new Error(`No feature with id ${t} present in store`);const r=this._store.copy(t);if(this.isGuidanceFeature(r))throw new Error("Guidance features are not allowed to be updated directly.");const s=r.properties.mode;if(!this._modes[s])throw new Error(`No mode with name ${s} present in instance`);const a=Object.entries(n);a.forEach(([l,u])=>{if(!this.checkIsReservedProperty(l))throw new Error(`You are trying to update a reserved property name: ${l}. Please choose another name.`);if(u!==void 0&&!no(u))throw new Error(`Invalid JSON value provided for property ${l}`)}),this._store.updateProperty(a.map(([l,u])=>({id:r.id,property:l,value:u})),{origin:"api"})}updateFeatureGeometry(t,n){if(!this._store.has(t))throw new Error(`No feature with id ${t} present in store`);const r=this._store.copy(t);if(this.isGuidanceFeature(r))throw new Error("Guidance features are not allowed to be updated directly.");if(!(r&&n&&n.type&&n.coordinates))throw new Error("Invalid geometry provided");if(n.type!==r.geometry.type)throw new Error(`Geometry type mismatch: expected ${r.geometry.type}, got ${n.type}`);const s=r.properties.mode,a=this._modes[s];if(!a)throw new Error(`No mode with name ${s} present in instance`);const l=ae({},r,{geometry:n}),u=a.validateFeature(l);if(!u.valid)throw new Error(`Feature validation failed: ${u.reason||"Unknown reason"}`);if(this._store.updateGeometry([{id:r.id,geometry:n}],{origin:"api"}),a.afterFeatureUpdated){a.afterFeatureUpdated(l);const c=l.properties[pe.SELECTED],d=this.getSelectMode({switchToSelectMode:!1});d&&c&&d.afterFeatureUpdated(l)}}transformFeatureGeometry(t,n){if(!this._store.has(t))throw new Error(`No feature with id ${t} present in store`);let r=this._store.copy(t);if(this.isGuidanceFeature(r))throw new Error("Guidance features are not allowed to be updated directly.");const s=r.properties.mode,a=this._modes[s];if(!a)throw new Error(`No mode with name ${s} present in instance`);let l;if(r.geometry.type==="Polygon")l=r.geometry.coordinates[0];else{if(r.geometry.type!=="LineString")throw new Error(`Feature geometry type ${r.geometry.type} is not supported for transformation`);l=r.geometry.coordinates}if(n.projection!="web-mercator")throw new Error(`Projection ${n.projection} is not currently supported for transformation`);if(n.type==="scale"){const{x:u,y:c}=wo(n.origin[0],n.origin[1]);Jc({coordinates:l,originX:u,originY:c,xScale:n.options.xScale||1,yScale:n.options.yScale||1})}else n.type==="rotate"&&(r=qc(r,n.options.angle||0),l=r.geometry.type==="Polygon"?r.geometry.coordinates[0]:r.geometry.coordinates);if(l=l.map(u=>[$n(u[0],this._adapter.getCoordinatePrecision()),$n(u[1],this._adapter.getCoordinatePrecision())]),r.geometry.coordinates=r.geometry.type==="Polygon"?[l]:l,this._store.updateGeometry([{id:r.id,geometry:r.geometry}],{origin:"api"}),a.afterFeatureUpdated){a.afterFeatureUpdated(r);const u=r.properties[pe.SELECTED],c=this.getSelectMode({switchToSelectMode:!1});c&&u&&c.afterFeatureUpdated(r)}}addFeatures(t){return this.checkEnabled(),t.length===0?[]:this._store.load(t,n=>{if(Vs(n)){const r=n.properties.mode,s=this._modes[r];if(!s)return{id:n.id,valid:!1,reason:`${r} mode is not in the list of instantiated modes`};const a=s.validateFeature.bind(s)(n);return{id:n.id,valid:a.valid,reason:a.reason?a.reason:a.valid?void 0:"Feature is invalid"}}return{id:n.id,valid:!1,reason:"Mode property does not exist"}},n=>{if(Vs(n)){const r=this._modes[n.properties.mode];r&&r.afterFeatureAdded&&r.afterFeatureAdded(n)}},{origin:"api"})}start(){this._enabled||(this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(t=>{t()})},getState:()=>this._mode.state,onClick:t=>{this._mode.onClick(t)},onMouseMove:t=>{this._mode.onMouseMove(t)},onKeyDown:t=>{this._mode.onKeyDown(t)},onKeyUp:t=>{this._mode.onKeyUp(t)},onDragStart:(t,n)=>{this._mode.onDragStart(t,n)},onDrag:(t,n)=>{this._mode.onDrag(t,n)},onDragEnd:(t,n)=>{this._mode.onDragEnd(t,n)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}}))}getFeaturesAtLngLat(t,n){const{lng:r,lat:s}=t;return this.featuresAtLocation({lng:r,lat:s},n)}getFeaturesAtPointerEvent(t,n){const r=this._adapter.getLngLatFromEvent.bind(this._adapter)(t);return r===null?[]:this.featuresAtLocation(r,n)}stop(){this._enabled&&(this._enabled=!1,this._adapter.unregister())}on(t,n){const r=this._eventListeners[t];r.includes(n)||r.push(n)}off(t,n){const r=this._eventListeners[t];r.includes(n)&&r.splice(r.indexOf(n),1)}}let lf=class extends af.TerraDrawBaseAdapter{constructor(t){super(t),this._lib=void 0,this._map=void 0,this._panes={},this._container=void 0,this._layers={},this._lib=t.lib,this._map=t.map,this._container=this._map.getContainer()}createPaneStyleSheet(t,n){const r=document.createElement("style");return r.innerHTML=`.leaflet-${t}-pane {z-index: ${n+600}`,document.getElementsByTagName("head")[0].appendChild(r),this._map.createPane(t),r}clearPanes(){Object.values(this._panes).forEach(t=>{t&&t.remove()}),this._panes={}}clearLayers(){Object.values(this._layers).forEach(t=>{this._map.removeLayer(t)}),this._layers={}}styleGeoJSONLayer(t){return{pointToLayer:(n,r)=>{if(!n.properties)throw new Error("Feature has no properties");if(typeof n.properties.mode!="string")throw new Error("Feature mode is not a string");const s=(0,t[n.properties.mode])(n),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),this._lib.circleMarker(r,{radius:s.pointWidth,stroke:s.pointOutlineWidth||!1,color:s.pointOutlineColor,weight:s.pointOutlineWidth,fillOpacity:.8,fillColor:s.pointColor,pane:a,interactive:!1})},style:n=>{if(!n||!n.properties)return{};const r=n,s=(0,t[r.properties.mode])(r),a=String(s.zIndex);return this._panes[a]||(this._panes[a]=this.createPaneStyleSheet(a,s.zIndex)),r.geometry.type==="LineString"?{interactive:!1,color:s.lineStringColor,weight:s.lineStringWidth,pane:a}:r.geometry.type==="Polygon"?{interactive:!1,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,weight:s.polygonOutlineWidth,stroke:!0,color:s.polygonOutlineColor,pane:a}:{}}}}getLngLatFromEvent(t){const{containerX:n,containerY:r}=this.getMapElementXYPosition(t),s=this._map.containerPointToLatLng({x:n,y:r});return s.lng===null||isNaN(s.lng)||s.lat===null||isNaN(s.lat)?null:{lng:s.lng,lat:s.lat}}getMapEventElement(){return this._container}setDraggability(t){t?this._map.dragging.enable():this._map.dragging.disable()}project(t,n){const{x:r,y:s}=this._map.latLngToContainerPoint({lng:t,lat:n});return{x:r,y:s}}unproject(t,n){const{lng:r,lat:s}=this._map.containerPointToLatLng({x:t,y:n});return{lng:r,lat:s}}setCursor(t){t==="unset"?this.getMapEventElement().style.removeProperty("cursor"):this.getMapEventElement().style.cursor=t}setDoubleClickToZoom(t){t?this._map.doubleClickZoom.enable():this._map.doubleClickZoom.disable()}render(t,n){if(t.created.forEach(r=>{r.id&&(this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),t.deletedIds.forEach(r=>{this._layers[r]&&(this._map.removeLayer(this._layers[r]),delete this._layers[r])}),t.updated.forEach(r=>{r.id&&(this._layers[r.id]&&this._map.removeLayer(this._layers[r.id]),this._layers[r.id]=this._lib.geoJSON(r,this.styleGeoJSONLayer(n)),this._map.addLayer(this._layers[r.id]))}),t.created.length===0&&t.updated.length===0&&t.deletedIds.length===0){const r=[];Object.keys(this._layers).forEach(s=>{r.push(()=>{const a=this._layers[s],l=a.toGeoJSON();this._map.removeLayer(a);const u=this._lib.geoJSON(l,this.styleGeoJSONLayer(n));this._layers[s]=u,u.addTo(this._map),this._map.addLayer(this._layers[s])})}),setTimeout(()=>{r.forEach(s=>s())})}}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers(),this.clearPanes())}register(t){var n;super.register(t),(n=this._currentModeCallbacks)!=null&&n.onReady&&this._currentModeCallbacks.onReady()}getCoordinatePrecision(){return super.getCoordinatePrecision()}unregister(){return super.unregister()}};function qn(){return qn=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},qn.apply(null,arguments)}var ro;(function(i){i.Commit="commit",i.Provisional="provisional",i.Finish="finish"})(ro||(ro={}));const uf={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT:"selectionPoint"};function Fr(i){return!!(i&&typeof i=="object"&&i!==null&&!Array.isArray(i))}function ea(i){return!!(function(t){return typeof t=="number"&&!isNaN(new Date(t).valueOf())})(i)}const cf="Feature mode property does not match the mode being added to";var Jn;(function(i){i.Drawing="drawing",i.Select="select",i.Static="static",i.Render="render"})(Jn||(Jn={}));let Sh=class{get state(){return this._state}set state(t){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(t){if(typeof t!="object")throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=t}registerBehaviors(t){}constructor(t,n=!1){this._state="unregistered",this._styles={},this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.type=Jn.Drawing,this.mode="base",n||this.updateOptions(t)}updateOptions(t){t!=null&&t.styles&&(this.styles=qn({},this._styles,t.styles)),t!=null&&t.pointerDistance&&(this.pointerDistance=t.pointerDistance),t!=null&&t.validation&&(this.validate=t&&t.validation),t!=null&&t.projection&&(this.projection=t.projection)}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(t){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=t.store,this.store.registerOnChange(t.onChange),this.setDoubleClickToZoom=t.setDoubleClickToZoom,this.project=t.project,this.unproject=t.unproject,this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.setCursor=t.setCursor,this.onStyleChange=t.onChange,this.onFinish=t.onFinish,this.coordinatePrecision=t.coordinatePrecision,this.registerBehaviors({mode:t.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:t.coordinatePrecision,projection:this.projection})}validateFeature(t){return this.performFeatureValidation(t)}afterFeatureAdded(t){}performFeatureValidation(t){if(this._state==="unregistered")throw new Error("Mode must be registered");const n=(function(r,s){let a;if(Fr(r))if(r.id==null)a="Feature has no id";else if(typeof r.id!="string"&&typeof r.id!="number")a="Feature must be string or number as per GeoJSON spec";else if(s(r.id))if(Fr(r.geometry))if(Fr(r.properties))if(typeof r.geometry.type=="string"&&["Polygon","LineString","Point"].includes(r.geometry.type))if(Array.isArray(r.geometry.coordinates)){if(!r.properties.mode||typeof r.properties.mode!="string")return{valid:!1,reason:"Feature does not have a valid mode property"}}else a="Feature coordinates is not an array";else a="Feature is not Point, LineString or Polygon";else a="Feature has no properties";else a="Feature has no geometry";else a="Feature must match the id strategy (default is UUID4)";else a="Feature is not object";return a?{valid:!1,reason:a}:{valid:!0}})(t,this.store.idStrategy.isValidId);if(this.validate){const r=this.validate(t,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:ro.Provisional});return{valid:n.valid&&r.valid,reason:r.reason}}return{valid:n.valid,reason:n.reason}}validateModeFeature(t,n){const r=this.performFeatureValidation(t);return r.valid?t.properties.mode!==this.mode?{valid:!1,reason:cf}:n(t):{valid:!1,reason:r.reason}}onFinish(t,n){}onDeselect(t){}onSelect(t){}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){}onClick(t){}onDragStart(t,n){}onDrag(t,n){}onDragEnd(t,n){}getHexColorStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getNumericStylingValue(t,n,r){return this.getStylingValue(t,n,r)}getStylingValue(t,n,r){return t===void 0?n:typeof t=="function"?t(r):t}},ff=class extends Sh{constructor(...t){super(...t),this.type=Jn.Select}};function ia(i,t=9){const n=Math.pow(10,t);return Math.round(i*n)/n}const df=(i,t)=>{const{x:n,y:r}=i,{x:s,y:a}=t,l=s-n,u=a-r;return Math.sqrt(u*u+l*l)};function Ch(i,t,n,r,s){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,p=Math.log(c),_=.5*Math.exp(2*p/3),w=.5*Math.sqrt(p*_*(c-_)/c)*(d-c/2<0?-1:1);Ch(i,t,Math.max(n,Math.floor(t-d*_/c+w)),Math.min(r,Math.floor(t+(c-d)*_/c+w)),s)}const a=i[t];let l=n,u=r;for(Pi(i,n,t),s(i[r],a)>0&&Pi(i,n,r);l<u;){for(Pi(i,l,u),l++,u--;s(i[l],a)<0;)l++;for(;s(i[u],a)>0;)u--}s(i[n],a)===0?Pi(i,n,u):(u++,Pi(i,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}function Pi(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}function $e(i,t){Bi(i,0,i.children.length,t,i)}function Bi(i,t,n,r,s){s||(s=ti([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<n;a++){const l=i.children[a];zi(s,i.leaf?r(l):l)}return s}function zi(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function pf(i,t){return i.minX-t.minX}function mf(i,t){return i.minY-t.minY}function Nr(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Sn(i){return i.maxX-i.minX+(i.maxY-i.minY)}function _f(i,t){const n=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,a-r)}function Rr(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Cn(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function ti(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function na(i,t,n,r,s){const a=[t,n];for(;a.length;){if((n=a.pop())-(t=a.pop())<=r)continue;const l=t+Math.ceil((n-t)/r/2)*r;Ch(i,l,t,n,s),a.push(t,l,l,n)}}class gf{constructor(t){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(t){let n=this.data;const r=[];if(!Cn(t,n))return r;const s=this.toBBox,a=[];for(;n;){for(let l=0;l<n.children.length;l++){const u=n.children[l],c=n.leaf?s(u):u;Cn(t,c)&&(n.leaf?r.push(u):Rr(t,c)?this._all(u,r):a.push(u))}n=a.pop()}return r}collides(t){let n=this.data;if(Cn(t,n)){const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const a=n.children[s],l=n.leaf?this.toBBox(a):a;if(Cn(t,l)){if(n.leaf||Rr(t,l))return!0;r.push(a)}}n=r.pop()}}return!1}load(t){if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n}insert(t){this._insert(t,this.data.height-1)}clear(){this.data=ti([])}remove(t){let n=this.data;const r=this.toBBox(t),s=[],a=[];let l,u,c=!1;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],l=a.pop(),c=!0),n.leaf){const d=n.children.indexOf(t);d!==-1&&(n.children.splice(d,1),s.push(n),this._condense(s))}c||n.leaf||!Rr(n,r)?u?(l++,n=u.children[l],c=!1):n=null:(s.push(n),a.push(l),l=0,u=n,n=n.children[0])}}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const a=r-n+1;let l,u=this._maxEntries;if(a<=u)return l=ti(t.slice(n,r+1)),$e(l,this.toBBox),l;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),l=ti([]),l.leaf=!1,l.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));na(t,n,r,d,this.compareMinX);for(let p=n;p<=r;p+=d){const _=Math.min(p+d-1,r);na(t,p,_,c,this.compareMinY);for(let w=p;w<=_;w+=c){const M=Math.min(w+c-1,_);l.children.push(this._build(t,w,M,s-1))}}return $e(l,this.toBBox),l}_chooseSubtree(t,n,r,s){for(;s.push(n),!n.leaf&&s.length-1!==r;){let u,c=1/0,d=1/0;for(let p=0;p<n.children.length;p++){const _=n.children[p],w=Nr(_),M=(a=t,l=_,(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-w);M<d?(d=M,c=w<c?w:c,u=_):M===d&&w<c&&(c=w,u=_)}n=u||n.children[0]}var a,l;return n}_insert(t,n,r){const s=r?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,n,a);for(l.children.push(t),zi(l,s);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(s,a,n)}_split(t,n){const r=t[n],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const l=this._chooseSplitIndex(r,a,s),u=ti(r.children.splice(l,r.children.length-l));u.height=r.height,u.leaf=r.leaf,$e(r,this.toBBox),$e(u,this.toBBox),n?t[n-1].children.push(u):this._splitRoot(r,u)}_splitRoot(t,n){this.data=ti([t,n]),this.data.height=t.height+1,this.data.leaf=!1,$e(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,a=1/0,l=1/0;for(let u=n;u<=r-n;u++){const c=Bi(t,0,u,this.toBBox),d=Bi(t,u,r,this.toBBox),p=_f(c,d),_=Nr(c)+Nr(d);p<a?(a=p,s=u,l=_<l?_:l):p===a&&_<l&&(l=_,s=u)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:pf,a=t.leaf?this.compareMinY:mf;this._allDistMargin(t,n,r,s)<this._allDistMargin(t,n,r,a)&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const a=this.toBBox,l=Bi(t,0,n,a),u=Bi(t,r-n,r,a);let c=Sn(l)+Sn(u);for(let d=n;d<r-n;d++){const p=t.children[d];zi(l,t.leaf?a(p):p),c+=Sn(l)}for(let d=r-n-1;d>=n;d--){const p=t.children[d];zi(u,t.leaf?a(p):p),c+=Sn(u)}return c}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)zi(n[s],t)}_condense(t){for(let n,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(n=t[r-1].children,n.splice(n.indexOf(t[r]),1)):this.clear():$e(t[r],this.toBBox)}}class vf{constructor(t){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new gf(t&&t.maxEntries?t.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(t,n){this.idToNode.set(t.id,n),this.nodeToId.set(n,t.id)}toBBox(t){const n=[],r=[];let s;if(t.geometry.type==="Polygon")s=t.geometry.coordinates[0];else if(t.geometry.type==="LineString")s=t.geometry.coordinates;else{if(t.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[t.geometry.coordinates]}for(let u=0;u<s.length;u++)r.push(s[u][1]),n.push(s[u][0]);const a=Math.min(...r),l=Math.max(...r);return{minX:Math.min(...n),minY:a,maxX:Math.max(...n),maxY:l}}insert(t){if(this.idToNode.get(String(t.id)))throw new Error("Feature already exists");const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}load(t){const n=[],r=new Set;t.forEach(s=>{const a=this.toBBox(s);if(this.setMaps(s,a),r.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);r.add(String(s.id)),n.push(a)}),this.tree.load(n)}update(t){this.remove(t.id);const n=this.toBBox(t);this.setMaps(t,n),this.tree.insert(n)}remove(t){const n=this.idToNode.get(t);if(!n)throw new Error(`${t} not inserted into the spatial index`);this.tree.remove(n)}clear(){this.tree.clear()}search(t){return this.tree.search(this.toBBox(t)).map(n=>this.nodeToId.get(n))}collides(t){return this.tree.collides(this.toBBox(t))}}const yf={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=16*Math.random()|0;return(i=="x"?t:3&t|8).toString(16)}),isValidId:i=>typeof i=="string"&&i.length===36};class wf{constructor(t){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new vf,this.tracked=!t||t.tracked!==!1,this.idStrategy=t&&t.idStrategy?t.idStrategy:yf}clone(t){return JSON.parse(JSON.stringify(t))}getId(){return this.idStrategy.getId()}has(t){return!!this.store[t]}load(t,n,r){if(t.length===0)return[];let s=this.clone(t);const a=[],l=[];return s=s.filter(u=>{u.id==null&&(u.id=this.idStrategy.getId());const c=u.id;if(n){const d=n(u);if(!d.valid)return l.push({id:c,valid:!1,reason:d.reason}),!1}if(this.tracked){if(u.properties.createdAt){if(!ea(u.properties.createdAt))return l.push({id:u.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else u.properties.createdAt=+new Date;if(u.properties.updatedAt){if(!ea(u.properties.updatedAt))return l.push({id:u.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else u.properties.updatedAt=+new Date}return this.has(c)?(l.push({id:c,valid:!1,reason:`Feature already exists with this id: ${c}`}),!1):(this.store[c]=u,a.push(c),r&&r(u),l.push({id:c,valid:!0}),!0)}),this.spatialIndex.load(s),this._onChange(a,"create"),l}search(t,n){const r=this.spatialIndex.search(t).map(s=>this.store[s]);return this.clone(n?r.filter(n):r)}registerOnChange(t){this._onChange=(n,r)=>{t(n,r)}}getGeometryCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get geometry copy`);return this.clone(n.geometry)}getPropertiesCopy(t){const n=this.store[t];if(!n)throw new Error(`No feature with this id (${t}), can not get properties copy`);return this.clone(n.properties)}updateProperty(t){const n=[];t.forEach(({id:r,property:s,value:a})=>{const l=this.store[r];if(!l)throw new Error(`No feature with this (${r}), can not update geometry`);n.push(r),l.properties[s]=a,this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}updateGeometry(t){const n=[];t.forEach(({id:r,geometry:s})=>{n.push(r);const a=this.store[r];if(!a)throw new Error(`No feature with this (${r}), can not update geometry`);a.geometry=this.clone(s),this.spatialIndex.update(a),this.tracked&&(a.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update")}create(t){const n=[];return t.forEach(({geometry:r,properties:s})=>{let a,l=qn({},s);this.tracked&&(a=+new Date,s?(l.createdAt=typeof s.createdAt=="number"?s.createdAt:a,l.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:a):l={createdAt:a,updatedAt:a});const u=this.getId(),c={id:u,type:"Feature",geometry:r,properties:l};this.store[u]=c,this.spatialIndex.insert(c),n.push(u)}),this._onChange&&this._onChange([...n],"create"),n}delete(t){t.forEach(n=>{if(!this.store[n])throw new Error(`No feature with id ${n}, can not delete`);delete this.store[n],this.spatialIndex.remove(n)}),this._onChange&&this._onChange([...t],"delete")}copy(t){return this.clone(this.store[t])}copyAll(){return this.clone(Object.keys(this.store).map(t=>this.store[t]))}copyAllWhere(t){return this.clone(Object.keys(this.store).map(n=>this.store[n]).filter(n=>n.properties&&t(n.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class Ge{constructor({name:t,callback:n,unregister:r,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=t,this.register=()=>{this.registered||(this.registered=!0,s(n))},this.unregister=()=>{this.register&&(this.registered=!1,r(n))},this.callback=n}}var kh={__proto__:null,GeoJSONStore:wf,TerraDrawBaseDrawMode:Sh,TerraDrawBaseSelectMode:ff,TerraDrawBaseAdapter:class{constructor(i){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof i.minPixelDragDistance=="number"?i.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof i.minPixelDragDistanceSelecting=="number"?i.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof i.minPixelDragDistanceDrawing=="number"?i.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof i.coordinatePrecision=="number"?i.coordinatePrecision:9}getButton(i){return i.button===-1?"neither":i.button===0?"left":i.button===1?"middle":i.button===2?"right":"neither"}getMapElementXYPosition(i){const t=this.getMapEventElement(),{left:n,top:r}=t.getBoundingClientRect();return{containerX:i.clientX-n,containerY:i.clientY-r}}getDrawEventFromEvent(i){const t=this.getLngLatFromEvent(i);if(!t)return null;const{lng:n,lat:r}=t,{containerX:s,containerY:a}=this.getMapElementXYPosition(i),l=this.getButton(i),u=Array.from(this._heldKeys);return{lng:ia(n,this._coordinatePrecision),lat:ia(r,this._coordinatePrecision),containerX:s,containerY:a,button:l,heldKeys:u}}register(i){this._currentModeCallbacks=i,this._listeners=this.getAdapterListeners(),this._listeners.forEach(t=>{t.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new Ge({name:"pointerdown",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t)},register:i=>{this.getMapEventElement().addEventListener("pointerdown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerdown",i)}}),new Ge({name:"pointermove",callback:i=>{if(!this._currentModeCallbacks||!i.isPrimary)return;i.preventDefault();const t=this.getDrawEventFromEvent(i);if(t)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const n={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},r={x:t.containerX,y:t.containerY},s=this._currentModeCallbacks.getState(),a=df(n,r);let l=!1;if(l=s==="drawing"?a<this._minPixelDragDistanceDrawing:s==="selecting"?a<this._minPixelDragDistanceSelecting:a<this._minPixelDragDistance,l)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,u=>{this.setDraggability.bind(this)(u)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(t,n=>{this.setDraggability.bind(this)(n)})},register:i=>{this.getMapEventElement().addEventListener("pointermove",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointermove",i)}}),new Ge({name:"contextmenu",callback:i=>{this._currentModeCallbacks&&i.preventDefault()},register:i=>{this.getMapEventElement().addEventListener("contextmenu",i)},unregister:i=>{this.getMapEventElement().removeEventListener("contextmenu",i)}}),new Ge({name:"pointerup",callback:i=>{if(!this._currentModeCallbacks||i.target!==this.getMapEventElement()||!i.isPrimary)return;const t=this.getDrawEventFromEvent(i);t&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(t,n=>{this.setDraggability.bind(this)(n)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(t),this._dragState="not-dragging",this.setDraggability(!0))},register:i=>{this.getMapEventElement().addEventListener("pointerup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("pointerup",i)}}),new Ge({name:"keyup",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.delete(i.key),this._currentModeCallbacks.onKeyUp({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keyup",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keyup",i)}}),new Ge({name:"keydown",callback:i=>{this._currentModeCallbacks&&(this._heldKeys.add(i.key),this._currentModeCallbacks.onKeyDown({key:i.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>i.preventDefault()}))},register:i=>{this.getMapEventElement().addEventListener("keydown",i)},unregister:i=>{this.getMapEventElement().removeEventListener("keydown",i)}})]}unregister(){this._listeners.forEach(i=>{i.unregister()}),this.clear()}},getDefaultStyling:()=>({polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0}),SELECT_PROPERTIES:uf};const xf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],bf=1,Li=8;class Mf{constructor(t,n=64,r=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=t,this.nodeSize=Math.min(Math.max(n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=xf.indexOf(this.ArrayType),l=t*2*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,Li,t),this.coords=new this.ArrayType(this.data,Li+u+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Li+l+u+c),this.ids=new this.IndexArrayType(this.data,Li,t),this.coords=new this.ArrayType(this.data,Li+u+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(bf<<4)+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return oo(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function oo(i,t,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;Th(i,t,l,r,s,a),oo(i,t,n,r,l-1,1-a),oo(i,t,n,l+1,s,1-a)}function Th(i,t,n,r,s,a){for(;s>r;){if(s-r>600){const d=s-r+1,p=n-r+1,_=Math.log(d),w=.5*Math.exp(2*_/3),M=.5*Math.sqrt(_*w*(d-w)/d)*(p-d/2<0?-1:1),P=Math.max(r,Math.floor(n-p*w/d+M)),k=Math.min(s,Math.floor(n+(d-p)*w/d+M));Th(i,t,n,P,k,a)}const l=t[2*n+a];let u=r,c=s;for(Ei(i,t,r,n),t[2*s+a]>l&&Ei(i,t,r,s);u<c;){for(Ei(i,t,u,c),u++,c--;t[2*u+a]<l;)u++;for(;t[2*c+a]>l;)c--}t[2*r+a]===l?Ei(i,t,r,c):(c++,Ei(i,t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function Ei(i,t,n,r){Zr(i,n,r),Zr(t,2*n,2*r),Zr(t,2*n+1,2*r+1)}function Zr(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}let Pf=class{constructor(t=[],n=(r,s)=>r<s?-1:r>s?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=(t<<1)+1;const u=l+1;if(u<this.length&&r(n[u],n[l])<0&&(l=u),r(n[l],a)>=0)break;n[t]=n[l],t=l}n[t]=a}};const Lf=6371,se=Math.PI/180;function Ef(i,t,n,r=1/0,s=1/0){let a=1;const l=[];r===void 0&&(r=1/0),s!==void 0&&(a=Ae(s/Lf));const u=new Pf([],Sf);let c={left:0,right:i.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const d=Math.cos(n*se);for(;c;){const p=c.right,_=c.left;if(p-_<=i.nodeSize)for(let w=_;w<=p;w++){const M=i.ids[w],P=oa(t,n,i.coords[2*w],i.coords[2*w+1],d);u.push({id:M,dist:P})}else{const w=_+p>>1,M=i.coords[2*w],P=i.coords[2*w+1],k=i.ids[w],A=oa(t,n,M,P,d);u.push({id:k,dist:A});const O=(c.axis+1)%2,g={left:_,right:w-1,axis:O,minLng:c.minLng,minLat:c.minLat,maxLng:c.axis===0?M:c.maxLng,maxLat:c.axis===1?P:c.maxLat,dist:0},v={left:w+1,right:p,axis:O,minLng:c.axis===0?M:c.minLng,minLat:c.axis===1?P:c.minLat,maxLng:c.maxLng,maxLat:c.maxLat,dist:0};g.dist=ra(t,n,d,g),v.dist=ra(t,n,d,v),u.push(g),u.push(v)}for(;u.length&&u.peek().id!=null;){const w=u.pop();if(w.dist>a||(l.push(w.id),l.length===r))return l}c=u.pop()}return l}function ra(i,t,n,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(i>=s&&i<=a)return t<l?Ae((t-l)*se):t>u?Ae((t-u)*se):0;const c=Math.min(Ae((i-s)*se),Ae((i-a)*se)),d=Cf(t,c);return d>l&&d<u?Nn(c,n,t,d):Math.min(Nn(c,n,t,l),Nn(c,n,t,u))}function Sf(i,t){return i.dist-t.dist}function Ae(i){const t=Math.sin(i/2);return t*t}function Nn(i,t,n,r){return t*Math.cos(r*se)*i+Ae((n-r)*se)}function oa(i,t,n,r,s){const a=Ae((i-n)*se);return Nn(a,s,t,r)}function Cf(i,t){const n=1-2*t;return n<=0?i>0?90:-90:Math.atan(Math.tan(i*se)/n)/se}class kf{constructor(t){this.useCache=!0,this.points=[],this.routeCache={},this.useCache=t.useCache||!0,this.network=t.network,this.routeFinder=t.routeFinder,this.initialise()}initialise(){this.network.features.forEach(t=>{t.geometry.coordinates.forEach(n=>{this.points.push(n)})}),this.indexedNetworkPoints=new Mf(this.points.length),this.points.forEach(t=>{this.indexedNetworkPoints.add(t[0],t[1])}),this.indexedNetworkPoints.finish(),this.routeCache={}}getClosestNetworkCoordinate(t){const n=Ef(this.indexedNetworkPoints,t[0],t[1],1),r=this.points[n[0]];return r||null}setRouteFinder(t){this.routeFinder=t}setNetwork(t){this.network=t,this.routeFinder.setNetwork(t),this.initialise()}getRoute(t,n){if(this.useCache){const l=`${t}-${n}`;if(this.routeCache[l])return this.routeCache[l]}const r={type:"Feature",geometry:{type:"Point",coordinates:t},properties:{}},s={type:"Feature",geometry:{type:"Point",coordinates:n},properties:{}},a=this.routeFinder.getRoute(r,s);if(this.useCache){const l=`${t}-${n}`;return this.routeCache[l]=a,a}return a}}const Tf={cancel:"Escape",finish:"Enter"},Df={draw:"crosshair",close:"pointer"},{TerraDrawBaseDrawMode:Af}=kh;class Of extends Af{constructor(t){super(t,!0),this.mode="routesnap",this.currentCoordinate=0,this.keyEvents=Tf,this.cursors=Df,this.maxPoints=1,this.currentPointIds=[],this.routeId=0,this.pixelDistance=(n,r)=>{const{x:s,y:a}=n,{x:l,y:u}=r,c=l-s,d=u-a;return Math.sqrt(d*d+c*c)},this.latestEvent=null,this.updateOptions(t)}updateOptions(t){super.updateOptions(t),t?.routing&&t.routing!==this.routing&&(this.cleanUp(),this.routing=t.routing),t?.maxPoints!==void 0&&t.maxPoints!==this.maxPoints&&t.maxPoints>0&&(this.maxPoints=t.maxPoints),t?.cursors&&(this.cursors={...this.cursors,...t.cursors}),t?.keyEvents===null?this.keyEvents={cancel:null,finish:null}:t?.keyEvents&&(this.keyEvents={...this.keyEvents,...t.keyEvents})}measure(t,n){const{x:r,y:s}=this.project(n[0],n[1]);return this.pixelDistance({x:r,y:s},{x:t.containerX,y:t.containerY})}close(){this.currentId&&(this.currentCoordinate=0,this.currentId=void 0,this.currentPointIds=[],this.state==="drawing"&&this.setStarted())}registerBehaviors(t){}start(){this.setStarted(),this.setCursor(this.cursors.draw)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(t){this.latestEvent=t,requestAnimationFrame(()=>{const n=this.latestEvent;n&&(this.processMouseMove(n),this.latestEvent=null)})}processMouseMove(t){if(this.setCursor(this.cursors.draw),this.moveLineId&&!this.store.has(this.moveLineId)&&(this.moveLineId=void 0),!this.currentId||this.currentCoordinate===0)return;const n=this.store.getGeometryCopy(this.currentId);if(!n)return;if(this.measure(t,n.coordinates[n.coordinates.length-1])<this.pointerDistance){if(this.setCursor(this.cursors.close),!this.moveLineId)return;this.store.has(this.moveLineId)&&this.store.delete([this.moveLineId]),this.moveLineId=void 0;return}const r=this.store.getGeometryCopy(this.currentId);if(!r)return;const s=[t.lng,t.lat],a=this.routing.getClosestNetworkCoordinate(s);if(!a)return;const l=r.coordinates.length-1,u=this.routing.getRoute(r.coordinates[l],a);if(u)if(this.moveLineId)this.store.updateGeometry([{id:this.moveLineId,geometry:u.geometry}]);else{const[c]=this.store.create([{geometry:u.geometry,properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.moveLineId=c}}onClick(t){if(t.button==="right")return;const n=[t.lng,t.lat];if(this.currentId&&!this.store.has(this.currentId)&&(this.currentId=void 0,this.currentCoordinate=0,this.currentPointIds=[]),this.currentId){const s=this.store.getGeometryCopy(this.currentId);if(this.measure(t,s.coordinates[s.coordinates.length-1])<this.pointerDistance){this.currentCoordinate===1&&this.store.delete(this.currentPointIds),this.close();return}}else this.routeId++;let r=this.routing.getClosestNetworkCoordinate(n);if(this.currentCoordinate===0){if(r){const[s,a]=this.store.create([{geometry:{type:"LineString",coordinates:[r]},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}},{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentId=s,this.currentPointIds.push(a),this.currentCoordinate++,this.state==="started"&&this.setDrawing()}}else if(this.currentCoordinate===1&&this.currentId&&r){const s=this.store.getGeometryCopy(this.currentId),a=this.routing.getRoute(s.coordinates[0],r);if(a){this.store.updateGeometry([{id:this.currentId,geometry:a?.geometry}]);const[l]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.currentCoordinate=2,this.currentPointIds.push(l)}if(this.maxPoints===1){this.close();return}}else if(this.currentCoordinate>1&&this.currentId&&r&&this.currentCoordinate<=this.maxPoints){const s=this.store.getGeometryCopy(this.currentId),a=s.coordinates.length-1,l=this.routing.getRoute(s.coordinates[a],r);if(l){const u={...s,coordinates:[...s.coordinates,...l.geometry.coordinates]};this.store.updateGeometry([{id:this.currentId,geometry:u}]);const[c]=this.store.create([{geometry:{type:"Point",coordinates:r},properties:{mode:this.mode,isDrawnRoute:!0,routeId:this.routeId}}]);this.maxPoints===this.currentCoordinate?this.close():(this.currentCoordinate++,this.currentPointIds.push(c))}}}onKeyDown(){}onKeyUp(t){t.key===this.keyEvents.cancel&&this.cleanUp(),t.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){try{this.currentId&&this.store.delete([this.currentId,...this.currentPointIds])}catch{}this.currentId=void 0,this.moveLineId=void 0,this.currentCoordinate=0,this.state==="drawing"&&this.setStarted()}styleFeature(t){const n=kh.getDefaultStyling();return t.type==="Feature"&&t.geometry.type==="LineString"&&t.properties.mode===this.mode?(n.lineStringColor=this.getHexColorStylingValue(this.styles.lineStringColor,"#B90E0A",t),n.lineStringWidth=this.getNumericStylingValue(this.styles.lineStringWidth,4,t),n.zIndex=10,n):(t.type==="Feature"&&t.geometry.type==="Point"&&t.properties.mode===this.mode&&(n.pointColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",t),n.pointOutlineColor=this.getHexColorStylingValue(this.styles.routePointColor,"#B90E0A",t),n.pointOutlineWidth=this.getNumericStylingValue(this.styles.routePointOutlineWidth,1,t)),n)}validateFeature(t){return super.validateFeature(t)}afterFeatureAdded(t){}}function sa(){const i=[[30,60],[190,250],[260,290]],[t,n]=i[Math.floor(Math.random()*i.length)],r=Math.floor(Math.random()*(n-t+1))+t,s=60+Math.random()*20,a=50+Math.random()*10;return If(r,s,a)}function If(i,t,n){t/=100,n/=100;const r=l=>(l+i/30)%12,s=t*Math.min(n,1-n),a=l=>Math.round(255*(n-s*Math.max(-1,Math.min(r(l)-3,Math.min(9-r(l),1)))));return`#${[a(0),a(8),a(4)].map(l=>l.toString(16).padStart(2,"0")).join("")}`}function Bf(i,t,n){const r={};return new hf({adapter:new lf({lib:t,map:i,coordinatePrecision:9}),modes:[new $c({modeName:"networkOutline",styles:{polygonOutlineColor:"#d1cfcf",polygonFillColor:"#eeeeee",polygonFillOpacity:.19,polygonOutlineWidth:2}}),new Of({routing:n,maxPoints:5,styles:{lineStringColor:a=>{const l=a.properties.routeId;return l||(r[l]=sa()),r[l]},routePointColor:a=>{const l=a.properties.routeId;return r[l]||(r[l]=sa()),r[l]}}})]})}var zf=Object.create,nr=Object.defineProperty,Ff=Object.getOwnPropertyDescriptor,Nf=Object.getOwnPropertyNames,aa=Object.getOwnPropertySymbols,Rf=Object.getPrototypeOf,Dh=Object.prototype.hasOwnProperty,Zf=Object.prototype.propertyIsEnumerable,ha=(i,t,n)=>t in i?nr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,Yf=(i,t)=>{for(var n in t||(t={}))Dh.call(t,n)&&ha(i,n,t[n]);if(aa)for(var n of aa(t))Zf.call(t,n)&&ha(i,n,t[n]);return i},Xf=i=>nr(i,"__esModule",{value:!0}),Qt=(i,t)=>function(){return t||(0,i[Object.keys(i)[0]])((t={exports:{}}).exports,t),t.exports},Uf=(i,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Nf(t))!Dh.call(i,r)&&r!=="default"&&nr(i,r,{get:()=>t[r],enumerable:!(n=Ff(t,r))||n.enumerable});return i},Xt=i=>Uf(Xf(nr(i!=null?zf(Rf(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),ai=(i,t,n)=>new Promise((r,s)=>{var a=c=>{try{u(n.next(c))}catch(d){s(d)}},l=c=>{try{u(n.throw(c))}catch(d){s(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((n=n.apply(i,t)).next())}),ve=Qt({"node_modules/@mapbox/point-geometry/index.js"(i,t){t.exports=n;function n(r,s){this.x=r,this.y=s}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,a=r.y-this.y;return s*s+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=s,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),a=Math.sin(r),l=s*this.x-a*this.y,u=a*this.x+s*this.y;return this.x=l,this.y=u,this},_rotateAround:function(r,s){var a=Math.cos(r),l=Math.sin(r),u=s.x+a*(this.x-s.x)-l*(this.y-s.y),c=s.y+l*(this.x-s.x)+a*(this.y-s.y);return this.x=u,this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(r){return r instanceof n?r:Array.isArray(r)?new n(r[0],r[1]):r}}}),Ah=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(i,t){var n=ve();t.exports=r;function r(c,d,p,_,w){this.properties={},this.extent=p,this.type=0,this._pbf=c,this._geometry=-1,this._keys=_,this._values=w,c.readFields(s,this,d)}function s(c,d,p){c==1?d.id=p.readVarint():c==2?a(p,d):c==3?d.type=p.readVarint():c==4&&(d._geometry=p.pos)}function a(c,d){for(var p=c.readVarint()+c.pos;c.pos<p;){var _=d._keys[c.readVarint()],w=d._values[c.readVarint()];d.properties[_]=w}}r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,_=0,w=0,M=0,P=[],k;c.pos<d;){if(_<=0){var A=c.readVarint();p=A&7,_=A>>3}if(_--,p===1||p===2)w+=c.readSVarint(),M+=c.readSVarint(),p===1&&(k&&P.push(k),k=[]),k.push(new n(w,M));else if(p===7)k&&k.push(k[0].clone());else throw new Error("unknown command "+p)}return k&&P.push(k),P},r.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,_=0,w=0,M=0,P=1/0,k=-1/0,A=1/0,O=-1/0;c.pos<d;){if(_<=0){var g=c.readVarint();p=g&7,_=g>>3}if(_--,p===1||p===2)w+=c.readSVarint(),M+=c.readSVarint(),w<P&&(P=w),w>k&&(k=w),M<A&&(A=M),M>O&&(O=M);else if(p!==7)throw new Error("unknown command "+p)}return[P,A,k,O]},r.prototype.toGeoJSON=function(c,d,p){var _=this.extent*Math.pow(2,p),w=this.extent*c,M=this.extent*d,P=this.loadGeometry(),k=r.types[this.type],A,O;function g(E){for(var S=0;S<E.length;S++){var C=E[S],T=180-(C.y+M)*360/_;E[S]=[(C.x+w)*360/_-180,360/Math.PI*Math.atan(Math.exp(T*Math.PI/180))-90]}}switch(this.type){case 1:var v=[];for(A=0;A<P.length;A++)v[A]=P[A][0];P=v,g(P);break;case 2:for(A=0;A<P.length;A++)g(P[A]);break;case 3:for(P=l(P),A=0;A<P.length;A++)for(O=0;O<P[A].length;O++)g(P[A][O]);break}P.length===1?P=P[0]:k="Multi"+k;var y={type:"Feature",geometry:{type:k,coordinates:P},properties:this.properties};return"id"in this&&(y.id=this.id),y};function l(c){var d=c.length;if(d<=1)return[c];for(var p=[],_,w,M=0;M<d;M++){var P=u(c[M]);P!==0&&(w===void 0&&(w=P<0),w===P<0?(_&&p.push(_),_=[c[M]]):_.push(c[M]))}return _&&p.push(_),p}function u(c){for(var d=0,p=0,_=c.length,w=_-1,M,P;p<_;w=p++)M=c[p],P=c[w],d+=(P.x-M.x)*(M.y+P.y);return d}}}),Oh=Qt({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(i,t){var n=Ah();t.exports=r;function r(l,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,u),this.length=this._features.length}function s(l,u,c){l===15?u.version=c.readVarint():l===1?u.name=c.readString():l===5?u.extent=c.readVarint():l===2?u._features.push(c.pos):l===3?u._keys.push(c.readString()):l===4&&u._values.push(a(c))}function a(l){for(var u=null,c=l.readVarint()+l.pos;l.pos<c;){var d=l.readVarint()>>3;u=d===1?l.readString():d===2?l.readFloat():d===3?l.readDouble():d===4?l.readVarint64():d===5?l.readVarint():d===6?l.readSVarint():d===7?l.readBoolean():null}return u}r.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var u=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,u,this.extent,this._keys,this._values)}}}),jf=Qt({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(i,t){var n=Oh();t.exports=r;function r(a,l){this.layers=a.readFields(s,{},l)}function s(a,l,u){if(a===3){var c=new n(u,u.readVarint()+u.pos);c.length&&(l[c.name]=c)}}}}),Wf=Qt({"node_modules/@mapbox/vector-tile/index.js"(i,t){t.exports.VectorTile=jf(),t.exports.VectorTileFeature=Ah(),t.exports.VectorTileLayer=Oh()}}),Vf=Qt({"node_modules/ieee754/index.js"(i){i.read=function(t,n,r,s,a){var l,u,c=a*8-s-1,d=(1<<c)-1,p=d>>1,_=-7,w=r?a-1:0,M=r?-1:1,P=t[n+w];for(w+=M,l=P&(1<<-_)-1,P>>=-_,_+=c;_>0;l=l*256+t[n+w],w+=M,_-=8);for(u=l&(1<<-_)-1,l>>=-_,_+=s;_>0;u=u*256+t[n+w],w+=M,_-=8);if(l===0)l=1-p;else{if(l===d)return u?NaN:(P?-1:1)*(1/0);u=u+Math.pow(2,s),l=l-p}return(P?-1:1)*u*Math.pow(2,l-s)},i.write=function(t,n,r,s,a,l){var u,c,d,p=l*8-a-1,_=(1<<p)-1,w=_>>1,M=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=s?0:l-1,k=s?1:-1,A=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(c=isNaN(n)?1:0,u=_):(u=Math.floor(Math.log(n)/Math.LN2),n*(d=Math.pow(2,-u))<1&&(u--,d*=2),u+w>=1?n+=M/d:n+=M*Math.pow(2,1-w),n*d>=2&&(u++,d/=2),u+w>=_?(c=0,u=_):u+w>=1?(c=(n*d-1)*Math.pow(2,a),u=u+w):(c=n*Math.pow(2,w-1)*Math.pow(2,a),u=0));a>=8;t[r+P]=c&255,P+=k,c/=256,a-=8);for(u=u<<a|c,p+=a;p>0;t[r+P]=u&255,P+=k,u/=256,p-=8);t[r+P-k]|=A*128}}}),Hf=Qt({"node_modules/pbf/index.js"(i,t){t.exports=r;var n=Vf();function r(x){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(x)?x:new Uint8Array(x||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=65536*65536,a=1/s,l=12,u=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(x,I,B){for(B=B||this.length;this.pos<B;){var V=this.readVarint(),X=V>>3,G=this.pos;this.type=V&7,x(X,I,this),this.pos===G&&this.skip(V)}return I},readMessage:function(x,I){return this.readFields(x,I,this.readVarint()+this.pos)},readFixed32:function(){var x=T(this.buf,this.pos);return this.pos+=4,x},readSFixed32:function(){var x=N(this.buf,this.pos);return this.pos+=4,x},readFixed64:function(){var x=T(this.buf,this.pos)+T(this.buf,this.pos+4)*s;return this.pos+=8,x},readSFixed64:function(){var x=T(this.buf,this.pos)+N(this.buf,this.pos+4)*s;return this.pos+=8,x},readFloat:function(){var x=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,x},readDouble:function(){var x=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,x},readVarint:function(x){var I=this.buf,B,V;return V=I[this.pos++],B=V&127,V<128||(V=I[this.pos++],B|=(V&127)<<7,V<128)||(V=I[this.pos++],B|=(V&127)<<14,V<128)||(V=I[this.pos++],B|=(V&127)<<21,V<128)?B:(V=I[this.pos],B|=(V&15)<<28,c(B,x,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var x=this.readVarint();return x%2===1?(x+1)/-2:x/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var x=this.readVarint()+this.pos,I=this.pos;return this.pos=x,x-I>=l&&u?j(this.buf,I,x):Z(this.buf,I,x)},readBytes:function(){var x=this.readVarint()+this.pos,I=this.buf.subarray(this.pos,x);return this.pos=x,I},readPackedVarint:function(x,I){if(this.type!==r.Bytes)return x.push(this.readVarint(I));var B=d(this);for(x=x||[];this.pos<B;)x.push(this.readVarint(I));return x},readPackedSVarint:function(x){if(this.type!==r.Bytes)return x.push(this.readSVarint());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readSVarint());return x},readPackedBoolean:function(x){if(this.type!==r.Bytes)return x.push(this.readBoolean());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readBoolean());return x},readPackedFloat:function(x){if(this.type!==r.Bytes)return x.push(this.readFloat());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readFloat());return x},readPackedDouble:function(x){if(this.type!==r.Bytes)return x.push(this.readDouble());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readDouble());return x},readPackedFixed32:function(x){if(this.type!==r.Bytes)return x.push(this.readFixed32());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readFixed32());return x},readPackedSFixed32:function(x){if(this.type!==r.Bytes)return x.push(this.readSFixed32());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readSFixed32());return x},readPackedFixed64:function(x){if(this.type!==r.Bytes)return x.push(this.readFixed64());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readFixed64());return x},readPackedSFixed64:function(x){if(this.type!==r.Bytes)return x.push(this.readSFixed64());var I=d(this);for(x=x||[];this.pos<I;)x.push(this.readSFixed64());return x},skip:function(x){var I=x&7;if(I===r.Varint)for(;this.buf[this.pos++]>127;);else if(I===r.Bytes)this.pos=this.readVarint()+this.pos;else if(I===r.Fixed32)this.pos+=4;else if(I===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+I)},writeTag:function(x,I){this.writeVarint(x<<3|I)},realloc:function(x){for(var I=this.length||16;I<this.pos+x;)I*=2;if(I!==this.length){var B=new Uint8Array(I);B.set(this.buf),this.buf=B,this.length=I}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(x){this.realloc(4),z(this.buf,x,this.pos),this.pos+=4},writeSFixed32:function(x){this.realloc(4),z(this.buf,x,this.pos),this.pos+=4},writeFixed64:function(x){this.realloc(8),z(this.buf,x&-1,this.pos),z(this.buf,Math.floor(x*a),this.pos+4),this.pos+=8},writeSFixed64:function(x){this.realloc(8),z(this.buf,x&-1,this.pos),z(this.buf,Math.floor(x*a),this.pos+4),this.pos+=8},writeVarint:function(x){if(x=+x||0,x>268435455||x<0){_(x,this);return}this.realloc(4),this.buf[this.pos++]=x&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=(x>>>=7)&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=(x>>>=7)&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=x>>>7&127)))},writeSVarint:function(x){this.writeVarint(x<0?-x*2-1:x*2)},writeBoolean:function(x){this.writeVarint(!!x)},writeString:function(x){x=String(x),this.realloc(x.length*4),this.pos++;var I=this.pos;this.pos=U(this.buf,x,this.pos);var B=this.pos-I;B>=128&&P(I,B,this),this.pos=I-1,this.writeVarint(B),this.pos+=B},writeFloat:function(x){this.realloc(4),n.write(this.buf,x,this.pos,!0,23,4),this.pos+=4},writeDouble:function(x){this.realloc(8),n.write(this.buf,x,this.pos,!0,52,8),this.pos+=8},writeBytes:function(x){var I=x.length;this.writeVarint(I),this.realloc(I);for(var B=0;B<I;B++)this.buf[this.pos++]=x[B]},writeRawMessage:function(x,I){this.pos++;var B=this.pos;x(I,this);var V=this.pos-B;V>=128&&P(B,V,this),this.pos=B-1,this.writeVarint(V),this.pos+=V},writeMessage:function(x,I,B){this.writeTag(x,r.Bytes),this.writeRawMessage(I,B)},writePackedVarint:function(x,I){I.length&&this.writeMessage(x,k,I)},writePackedSVarint:function(x,I){I.length&&this.writeMessage(x,A,I)},writePackedBoolean:function(x,I){I.length&&this.writeMessage(x,v,I)},writePackedFloat:function(x,I){I.length&&this.writeMessage(x,O,I)},writePackedDouble:function(x,I){I.length&&this.writeMessage(x,g,I)},writePackedFixed32:function(x,I){I.length&&this.writeMessage(x,y,I)},writePackedSFixed32:function(x,I){I.length&&this.writeMessage(x,E,I)},writePackedFixed64:function(x,I){I.length&&this.writeMessage(x,S,I)},writePackedSFixed64:function(x,I){I.length&&this.writeMessage(x,C,I)},writeBytesField:function(x,I){this.writeTag(x,r.Bytes),this.writeBytes(I)},writeFixed32Field:function(x,I){this.writeTag(x,r.Fixed32),this.writeFixed32(I)},writeSFixed32Field:function(x,I){this.writeTag(x,r.Fixed32),this.writeSFixed32(I)},writeFixed64Field:function(x,I){this.writeTag(x,r.Fixed64),this.writeFixed64(I)},writeSFixed64Field:function(x,I){this.writeTag(x,r.Fixed64),this.writeSFixed64(I)},writeVarintField:function(x,I){this.writeTag(x,r.Varint),this.writeVarint(I)},writeSVarintField:function(x,I){this.writeTag(x,r.Varint),this.writeSVarint(I)},writeStringField:function(x,I){this.writeTag(x,r.Bytes),this.writeString(I)},writeFloatField:function(x,I){this.writeTag(x,r.Fixed32),this.writeFloat(I)},writeDoubleField:function(x,I){this.writeTag(x,r.Fixed64),this.writeDouble(I)},writeBooleanField:function(x,I){this.writeVarintField(x,!!I)}};function c(x,I,B){var V=B.buf,X,G;if(G=V[B.pos++],X=(G&112)>>4,G<128||(G=V[B.pos++],X|=(G&127)<<3,G<128)||(G=V[B.pos++],X|=(G&127)<<10,G<128)||(G=V[B.pos++],X|=(G&127)<<17,G<128)||(G=V[B.pos++],X|=(G&127)<<24,G<128)||(G=V[B.pos++],X|=(G&1)<<31,G<128))return p(x,X,I);throw new Error("Expected varint not more than 10 bytes")}function d(x){return x.type===r.Bytes?x.readVarint()+x.pos:x.pos+1}function p(x,I,B){return B?I*4294967296+(x>>>0):(I>>>0)*4294967296+(x>>>0)}function _(x,I){var B,V;if(x>=0?(B=x%4294967296|0,V=x/4294967296|0):(B=~(-x%4294967296),V=~(-x/4294967296),B^4294967295?B=B+1|0:(B=0,V=V+1|0)),x>=18446744073709552e3||x<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");I.realloc(10),w(B,V,I),M(V,I)}function w(x,I,B){B.buf[B.pos++]=x&127|128,x>>>=7,B.buf[B.pos++]=x&127|128,x>>>=7,B.buf[B.pos++]=x&127|128,x>>>=7,B.buf[B.pos++]=x&127|128,x>>>=7,B.buf[B.pos]=x&127}function M(x,I){var B=(x&7)<<4;I.buf[I.pos++]|=B|((x>>>=3)?128:0),x&&(I.buf[I.pos++]=x&127|((x>>>=7)?128:0),x&&(I.buf[I.pos++]=x&127|((x>>>=7)?128:0),x&&(I.buf[I.pos++]=x&127|((x>>>=7)?128:0),x&&(I.buf[I.pos++]=x&127|((x>>>=7)?128:0),x&&(I.buf[I.pos++]=x&127)))))}function P(x,I,B){var V=I<=16383?1:I<=2097151?2:I<=268435455?3:Math.floor(Math.log(I)/(Math.LN2*7));B.realloc(V);for(var X=B.pos-1;X>=x;X--)B.buf[X+V]=B.buf[X]}function k(x,I){for(var B=0;B<x.length;B++)I.writeVarint(x[B])}function A(x,I){for(var B=0;B<x.length;B++)I.writeSVarint(x[B])}function O(x,I){for(var B=0;B<x.length;B++)I.writeFloat(x[B])}function g(x,I){for(var B=0;B<x.length;B++)I.writeDouble(x[B])}function v(x,I){for(var B=0;B<x.length;B++)I.writeBoolean(x[B])}function y(x,I){for(var B=0;B<x.length;B++)I.writeFixed32(x[B])}function E(x,I){for(var B=0;B<x.length;B++)I.writeSFixed32(x[B])}function S(x,I){for(var B=0;B<x.length;B++)I.writeFixed64(x[B])}function C(x,I){for(var B=0;B<x.length;B++)I.writeSFixed64(x[B])}function T(x,I){return(x[I]|x[I+1]<<8|x[I+2]<<16)+x[I+3]*16777216}function z(x,I,B){x[B]=I,x[B+1]=I>>>8,x[B+2]=I>>>16,x[B+3]=I>>>24}function N(x,I){return(x[I]|x[I+1]<<8|x[I+2]<<16)+(x[I+3]<<24)}function Z(x,I,B){for(var V="",X=I;X<B;){var G=x[X],R=null,$=G>239?4:G>223?3:G>191?2:1;if(X+$>B)break;var H,et,Q;$===1?G<128&&(R=G):$===2?(H=x[X+1],(H&192)===128&&(R=(G&31)<<6|H&63,R<=127&&(R=null))):$===3?(H=x[X+1],et=x[X+2],(H&192)===128&&(et&192)===128&&(R=(G&15)<<12|(H&63)<<6|et&63,(R<=2047||R>=55296&&R<=57343)&&(R=null))):$===4&&(H=x[X+1],et=x[X+2],Q=x[X+3],(H&192)===128&&(et&192)===128&&(Q&192)===128&&(R=(G&15)<<18|(H&63)<<12|(et&63)<<6|Q&63,(R<=65535||R>=1114112)&&(R=null))),R===null?(R=65533,$=1):R>65535&&(R-=65536,V+=String.fromCharCode(R>>>10&1023|55296),R=56320|R&1023),V+=String.fromCharCode(R),X+=$}return V}function j(x,I,B){return u.decode(x.subarray(I,B))}function U(x,I,B){for(var V=0,X,G;V<I.length;V++){if(X=I.charCodeAt(V),X>55295&&X<57344)if(G)if(X<56320){x[B++]=239,x[B++]=191,x[B++]=189,G=X;continue}else X=G-55296<<10|X-56320|65536,G=null;else{X>56319||V+1===I.length?(x[B++]=239,x[B++]=191,x[B++]=189):G=X;continue}else G&&(x[B++]=239,x[B++]=191,x[B++]=189,G=null);X<128?x[B++]=X:(X<2048?x[B++]=X>>6|192:(X<65536?x[B++]=X>>12|224:(x[B++]=X>>18|240,x[B++]=X>>12&63|128),x[B++]=X>>6&63|128),x[B++]=X&63|128)}return B}}}),$f=Qt({"node_modules/rbush/rbush.min.js"(i,t){(function(n,r){typeof i=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self).RBush=r()})(i,function(){function n(g,v,y,E,S){(function C(T,z,N,Z,j){for(;Z>N;){if(Z-N>600){var U=Z-N+1,x=z-N+1,I=Math.log(U),B=.5*Math.exp(2*I/3),V=.5*Math.sqrt(I*B*(U-B)/U)*(x-U/2<0?-1:1),X=Math.max(N,Math.floor(z-x*B/U+V)),G=Math.min(Z,Math.floor(z+(U-x)*B/U+V));C(T,z,X,G,j)}var R=T[z],$=N,H=Z;for(r(T,N,z),j(T[Z],R)>0&&r(T,N,Z);$<H;){for(r(T,$,H),$++,H--;j(T[$],R)<0;)$++;for(;j(T[H],R)>0;)H--}j(T[N],R)===0?r(T,N,H):r(T,++H,Z),H<=z&&(N=H+1),z<=H&&(Z=H-1)}})(g,v,y||0,E||g.length-1,S||s)}function r(g,v,y){var E=g[v];g[v]=g[y],g[y]=E}function s(g,v){return g<v?-1:g>v?1:0}var a=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(g,v,y){if(!y)return v.indexOf(g);for(var E=0;E<v.length;E++)if(y(g,v[E]))return E;return-1}function u(g,v){c(g,0,g.children.length,v,g)}function c(g,v,y,E,S){S||(S=A(null)),S.minX=1/0,S.minY=1/0,S.maxX=-1/0,S.maxY=-1/0;for(var C=v;C<y;C++){var T=g.children[C];d(S,g.leaf?E(T):T)}return S}function d(g,v){return g.minX=Math.min(g.minX,v.minX),g.minY=Math.min(g.minY,v.minY),g.maxX=Math.max(g.maxX,v.maxX),g.maxY=Math.max(g.maxY,v.maxY),g}function p(g,v){return g.minX-v.minX}function _(g,v){return g.minY-v.minY}function w(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function M(g){return g.maxX-g.minX+(g.maxY-g.minY)}function P(g,v){return g.minX<=v.minX&&g.minY<=v.minY&&v.maxX<=g.maxX&&v.maxY<=g.maxY}function k(g,v){return v.minX<=g.maxX&&v.minY<=g.maxY&&v.maxX>=g.minX&&v.maxY>=g.minY}function A(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function O(g,v,y,E,S){for(var C=[v,y];C.length;)if(!((y=C.pop())-(v=C.pop())<=E)){var T=v+Math.ceil((y-v)/E/2)*E;n(g,T,v,y,S),C.push(v,T,T,y)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(g){var v=this.data,y=[];if(!k(g,v))return y;for(var E=this.toBBox,S=[];v;){for(var C=0;C<v.children.length;C++){var T=v.children[C],z=v.leaf?E(T):T;k(g,z)&&(v.leaf?y.push(T):P(g,z)?this._all(T,y):S.push(T))}v=S.pop()}return y},a.prototype.collides=function(g){var v=this.data;if(!k(g,v))return!1;for(var y=[];v;){for(var E=0;E<v.children.length;E++){var S=v.children[E],C=v.leaf?this.toBBox(S):S;if(k(g,C)){if(v.leaf||P(g,C))return!0;y.push(S)}}v=y.pop()}return!1},a.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var v=0;v<g.length;v++)this.insert(g[v]);return this}var y=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===y.height)this._splitRoot(this.data,y);else{if(this.data.height<y.height){var E=this.data;this.data=y,y=E}this._insert(y,this.data.height-y.height-1,!0)}else this.data=y;return this},a.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},a.prototype.clear=function(){return this.data=A([]),this},a.prototype.remove=function(g,v){if(!g)return this;for(var y,E,S,C=this.data,T=this.toBBox(g),z=[],N=[];C||z.length;){if(C||(C=z.pop(),E=z[z.length-1],y=N.pop(),S=!0),C.leaf){var Z=l(g,C.children,v);if(Z!==-1)return C.children.splice(Z,1),z.push(C),this._condense(z),this}S||C.leaf||!P(C,T)?E?(y++,C=E.children[y],S=!1):C=null:(z.push(C),N.push(y),y=0,E=C,C=C.children[0])}return this},a.prototype.toBBox=function(g){return g},a.prototype.compareMinX=function(g,v){return g.minX-v.minX},a.prototype.compareMinY=function(g,v){return g.minY-v.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(g){return this.data=g,this},a.prototype._all=function(g,v){for(var y=[];g;)g.leaf?v.push.apply(v,g.children):y.push.apply(y,g.children),g=y.pop();return v},a.prototype._build=function(g,v,y,E){var S,C=y-v+1,T=this._maxEntries;if(C<=T)return u(S=A(g.slice(v,y+1)),this.toBBox),S;E||(E=Math.ceil(Math.log(C)/Math.log(T)),T=Math.ceil(C/Math.pow(T,E-1))),(S=A([])).leaf=!1,S.height=E;var z=Math.ceil(C/T),N=z*Math.ceil(Math.sqrt(T));O(g,v,y,N,this.compareMinX);for(var Z=v;Z<=y;Z+=N){var j=Math.min(Z+N-1,y);O(g,Z,j,z,this.compareMinY);for(var U=Z;U<=j;U+=z){var x=Math.min(U+z-1,j);S.children.push(this._build(g,U,x,E-1))}}return u(S,this.toBBox),S},a.prototype._chooseSubtree=function(g,v,y,E){for(;E.push(v),!v.leaf&&E.length-1!==y;){for(var S=1/0,C=1/0,T=void 0,z=0;z<v.children.length;z++){var N=v.children[z],Z=w(N),j=(U=g,x=N,(Math.max(x.maxX,U.maxX)-Math.min(x.minX,U.minX))*(Math.max(x.maxY,U.maxY)-Math.min(x.minY,U.minY))-Z);j<C?(C=j,S=Z<S?Z:S,T=N):j===C&&Z<S&&(S=Z,T=N)}v=T||v.children[0]}var U,x;return v},a.prototype._insert=function(g,v,y){var E=y?g:this.toBBox(g),S=[],C=this._chooseSubtree(E,this.data,v,S);for(C.children.push(g),d(C,E);v>=0&&S[v].children.length>this._maxEntries;)this._split(S,v),v--;this._adjustParentBBoxes(E,S,v)},a.prototype._split=function(g,v){var y=g[v],E=y.children.length,S=this._minEntries;this._chooseSplitAxis(y,S,E);var C=this._chooseSplitIndex(y,S,E),T=A(y.children.splice(C,y.children.length-C));T.height=y.height,T.leaf=y.leaf,u(y,this.toBBox),u(T,this.toBBox),v?g[v-1].children.push(T):this._splitRoot(y,T)},a.prototype._splitRoot=function(g,v){this.data=A([g,v]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(g,v,y){for(var E,S,C,T,z,N,Z,j=1/0,U=1/0,x=v;x<=y-v;x++){var I=c(g,0,x,this.toBBox),B=c(g,x,y,this.toBBox),V=(S=I,C=B,T=void 0,z=void 0,N=void 0,Z=void 0,T=Math.max(S.minX,C.minX),z=Math.max(S.minY,C.minY),N=Math.min(S.maxX,C.maxX),Z=Math.min(S.maxY,C.maxY),Math.max(0,N-T)*Math.max(0,Z-z)),X=w(I)+w(B);V<j?(j=V,E=x,U=X<U?X:U):V===j&&X<U&&(U=X,E=x)}return E||y-v},a.prototype._chooseSplitAxis=function(g,v,y){var E=g.leaf?this.compareMinX:p,S=g.leaf?this.compareMinY:_;this._allDistMargin(g,v,y,E)<this._allDistMargin(g,v,y,S)&&g.children.sort(E)},a.prototype._allDistMargin=function(g,v,y,E){g.children.sort(E);for(var S=this.toBBox,C=c(g,0,v,S),T=c(g,y-v,y,S),z=M(C)+M(T),N=v;N<y-v;N++){var Z=g.children[N];d(C,g.leaf?S(Z):Z),z+=M(C)}for(var j=y-v-1;j>=v;j--){var U=g.children[j];d(T,g.leaf?S(U):U),z+=M(T)}return z},a.prototype._adjustParentBBoxes=function(g,v,y){for(var E=y;E>=0;E--)d(v[E],g)},a.prototype._condense=function(g){for(var v=g.length-1,y=void 0;v>=0;v--)g[v].children.length===0?v>0?(y=g[v-1].children).splice(y.indexOf(g[v]),1):this.clear():u(g[v],this.toBBox)},a})}}),Gf=Qt({"src/types/unitbezier.d.ts"(){}}),qf=Qt({"node_modules/tinyqueue/tinyqueue.js"(i,t){(function(n,r){typeof i=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=n||self,n.TinyQueue=r())})(i,function(){var n=function(a,l){if(a===void 0&&(a=[]),l===void 0&&(l=r),this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};n.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var a=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),a}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(a){for(var l=this,u=l.data,c=l.compare,d=u[a];a>0;){var p=a-1>>1,_=u[p];if(c(d,_)>=0)break;u[a]=_,a=p}u[a]=d},n.prototype._down=function(a){for(var l=this,u=l.data,c=l.compare,d=this.length>>1,p=u[a];a<d;){var _=(a<<1)+1,w=u[_],M=_+1;if(M<this.length&&c(u[M],w)<0&&(_=M,w=u[M]),c(w,p)>=0)break;u[a]=w,a=_}u[a]=p};function r(s,a){return s<a?-1:s>a?1:0}return n})}}),Jf=Qt({"node_modules/polylabel/polylabel.js"(i,t){var n=qf();n.default&&(n=n.default),t.exports=r,t.exports.default=r;function r(d,p,_){p=p||1;for(var w,M,P,k,A=0;A<d[0].length;A++){var O=d[0][A];(!A||O[0]<w)&&(w=O[0]),(!A||O[1]<M)&&(M=O[1]),(!A||O[0]>P)&&(P=O[0]),(!A||O[1]>k)&&(k=O[1])}var g=P-w,v=k-M,y=Math.min(g,v),E=y/2;if(y===0){var S=[w,M];return S.distance=0,S}for(var C=new n(void 0,s),T=w;T<P;T+=y)for(var z=M;z<k;z+=y)C.push(new a(T+E,z+E,E,d));var N=u(d),Z=new a(w+g/2,M+v/2,0,d);Z.d>N.d&&(N=Z);for(var j=C.length;C.length;){var U=C.pop();U.d>N.d&&(N=U,_&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,j)),!(U.max-N.d<=p)&&(E=U.h/2,C.push(new a(U.x-E,U.y-E,E,d)),C.push(new a(U.x+E,U.y-E,E,d)),C.push(new a(U.x-E,U.y+E,E,d)),C.push(new a(U.x+E,U.y+E,E,d)),j+=4)}_&&(console.log("num probes: "+j),console.log("best distance: "+N.d));var x=[N.x,N.y];return x.distance=N.d,x}function s(d,p){return p.max-d.max}function a(d,p,_,w){this.x=d,this.y=p,this.h=_,this.d=l(d,p,w),this.max=this.d+this.h*Math.SQRT2}function l(d,p,_){for(var w=!1,M=1/0,P=0;P<_.length;P++)for(var k=_[P],A=0,O=k.length,g=O-1;A<O;g=A++){var v=k[A],y=k[g];v[1]>p!=y[1]>p&&d<(y[0]-v[0])*(p-v[1])/(y[1]-v[1])+v[0]&&(w=!w),M=Math.min(M,c(d,p,v,y))}return M===0?0:(w?1:-1)*Math.sqrt(M)}function u(d){for(var p=0,_=0,w=0,M=d[0],P=0,k=M.length,A=k-1;P<k;A=P++){var O=M[P],g=M[A],v=O[0]*g[1]-g[0]*O[1];_+=(O[0]+g[0])*v,w+=(O[1]+g[1])*v,p+=v*3}return p===0?new a(M[0][0],M[0][1],0,d):new a(_/p,w/p,0,d)}function c(d,p,_,w){var M=_[0],P=_[1],k=w[0]-M,A=w[1]-P;if(k!==0||A!==0){var O=((d-M)*k+(p-P)*A)/(k*k+A*A);O>1?(M=w[0],P=w[1]):O>0&&(M+=k*O,P+=A*O)}return k=d-M,A=p-P,k*k+A*A}}});Xt(ve());var qe=Xt(ve()),Gi=Xt(ve()),Kf=Xt(Wf()),Qf=Xt(Hf()),At=(i,t,n)=>new Promise((r,s)=>{var a=c=>{try{u(n.next(c))}catch(d){s(d)}},l=c=>{try{u(n.throw(c))}catch(d){s(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((n=n.apply(i,t)).next())}),Yt=Uint8Array,ni=Uint16Array,Ih=Uint32Array,Bh=new Yt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zh=new Yt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),td=new Yt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fh=function(i,t){for(var n=new ni(31),r=0;r<31;++r)n[r]=t+=1<<i[r-1];for(var s=new Ih(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)s[a]=a-n[r]<<5|r;return[n,s]},Nh=Fh(Bh,2),Rh=Nh[0],ed=Nh[1];Rh[28]=258,ed[258]=28;var id=Fh(zh,0),nd=id[0],Zh=new ni(32768);for(ft=0;ft<32768;++ft)_e=(ft&43690)>>>1|(ft&21845)<<1,_e=(_e&52428)>>>2|(_e&13107)<<2,_e=(_e&61680)>>>4|(_e&3855)<<4,Zh[ft]=((_e&65280)>>>8|(_e&255)<<8)>>>1;var _e,ft,Xi=function(i,t,n){for(var r=i.length,s=0,a=new ni(t);s<r;++s)i[s]&&++a[i[s]-1];var l=new ni(t);for(s=0;s<t;++s)l[s]=l[s-1]+a[s-1]<<1;var u;{u=new ni(1<<t);var c=15-t;for(s=0;s<r;++s)if(i[s])for(var d=s<<4|i[s],p=t-i[s],_=l[i[s]-1]++<<p,w=_|(1<<p)-1;_<=w;++_)u[Zh[_]>>>c]=d}return u},tn=new Yt(288);for(ft=0;ft<144;++ft)tn[ft]=8;var ft;for(ft=144;ft<256;++ft)tn[ft]=9;var ft;for(ft=256;ft<280;++ft)tn[ft]=7;var ft;for(ft=280;ft<288;++ft)tn[ft]=8;var ft,Yh=new Yt(32);for(ft=0;ft<32;++ft)Yh[ft]=5;var ft,rd=Xi(tn,9),od=Xi(Yh,5),Yr=function(i){for(var t=i[0],n=1;n<i.length;++n)i[n]>t&&(t=i[n]);return t},$t=function(i,t,n){var r=t/8|0;return(i[r]|i[r+1]<<8)>>(t&7)&n},Xr=function(i,t){var n=t/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(t&7)},sd=function(i){return(i+7)/8|0},ad=function(i,t,n){(n==null||n>i.length)&&(n=i.length);var r=new(i.BYTES_PER_ELEMENT==2?ni:i.BYTES_PER_ELEMENT==4?Ih:Yt)(n-t);return r.set(i.subarray(t,n)),r},hd=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],qt=function(i,t,n){var r=new Error(t||hd[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,qt),!n)throw r;return r},Mo=function(i,t,n){var r=i.length;if(!r||n&&n.f&&!n.l)return t||new Yt(0);var s=!t||n,a=!n||n.i;n||(n={}),t||(t=new Yt(r*3));var l=function(q){var ot=t.length;if(q>ot){var ut=new Yt(Math.max(ot*2,q));ut.set(t),t=ut}},u=n.f||0,c=n.p||0,d=n.b||0,p=n.l,_=n.d,w=n.m,M=n.n,P=r*8;do{if(!p){u=$t(i,c,1);var k=$t(i,c+1,3);if(c+=3,k)if(k==1)p=rd,_=od,w=9,M=5;else if(k==2){var v=$t(i,c,31)+257,y=$t(i,c+10,15)+4,E=v+$t(i,c+5,31)+1;c+=14;for(var S=new Yt(E),C=new Yt(19),T=0;T<y;++T)C[td[T]]=$t(i,c+T*3,7);c+=y*3;for(var z=Yr(C),N=(1<<z)-1,Z=Xi(C,z),T=0;T<E;){var j=Z[$t(i,c,N)];c+=j&15;var A=j>>>4;if(A<16)S[T++]=A;else{var U=0,x=0;for(A==16?(x=3+$t(i,c,3),c+=2,U=S[T-1]):A==17?(x=3+$t(i,c,7),c+=3):A==18&&(x=11+$t(i,c,127),c+=7);x--;)S[T++]=U}}var I=S.subarray(0,v),B=S.subarray(v);w=Yr(I),M=Yr(B),p=Xi(I,w),_=Xi(B,M)}else qt(1);else{var A=sd(c)+4,O=i[A-4]|i[A-3]<<8,g=A+O;if(g>r){a&&qt(0);break}s&&l(d+O),t.set(i.subarray(A,g),d),n.b=d+=O,n.p=c=g*8,n.f=u;continue}if(c>P){a&&qt(0);break}}s&&l(d+131072);for(var V=(1<<w)-1,X=(1<<M)-1,G=c;;G=c){var U=p[Xr(i,c)&V],R=U>>>4;if(c+=U&15,c>P){a&&qt(0);break}if(U||qt(2),R<256)t[d++]=R;else if(R==256){G=c,p=null;break}else{var $=R-254;if(R>264){var T=R-257,H=Bh[T];$=$t(i,c,(1<<H)-1)+Rh[T],c+=H}var et=_[Xr(i,c)&X],Q=et>>>4;et||qt(3),c+=et&15;var B=nd[Q];if(Q>3){var H=zh[Q];B+=Xr(i,c)&(1<<H)-1,c+=H}if(c>P){a&&qt(0);break}s&&l(d+131072);for(var K=d+$;d<K;d+=4)t[d]=t[d-B],t[d+1]=t[d+1-B],t[d+2]=t[d+2-B],t[d+3]=t[d+3-B];d=K}}n.l=p,n.p=G,n.b=d,n.f=u,p&&(u=1,n.m=w,n.d=_,n.n=M)}while(!u);return d==t.length?t:ad(t,0,d)},ld=new Yt(0),ud=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&qt(6,"invalid gzip data");var t=i[3],n=10;t&4&&(n+=i[10]|(i[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!i[n++]);return n+(t&2)},cd=function(i){var t=i.length;return(i[t-4]|i[t-3]<<8|i[t-2]<<16|i[t-1]<<24)>>>0},fd=function(i){((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)&&qt(6,"invalid zlib data"),i[1]&32&&qt(6,"invalid zlib data: preset dictionaries not supported")};function dd(i,t){return Mo(i,t)}function pd(i,t){return Mo(i.subarray(ud(i),-8),new Yt(cd(i)))}function md(i,t){return Mo((fd(i),i.subarray(2,-4)),t)}function so(i,t){return i[0]==31&&i[1]==139&&i[2]==8?pd(i):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?dd(i,t):md(i,t)}var _d=typeof TextDecoder<"u"&&new TextDecoder,gd=0;try{_d.decode(ld,{stream:!0}),gd=1}catch{}var Xh=(i,t)=>i*Math.pow(2,t),Si=(i,t)=>Math.floor(i/Math.pow(2,t)),Kn=(i,t)=>Xh(i.getUint16(t+1,!0),8)+i.getUint8(t),Uh=(i,t)=>Xh(i.getUint32(t+2,!0),16)+i.getUint16(t,!0),vd=(i,t,n,r,s)=>{if(i!=r.getUint8(s))return i-r.getUint8(s);const a=Kn(r,s+1);if(t!=a)return t-a;const l=Kn(r,s+4);return n!=l?n-l:0},yd=(i,t,n,r)=>{const s=jh(i,t|128,n,r);return s?{z:t,x:n,y:r,offset:s[0],length:s[1],is_dir:!0}:null},la=(i,t,n,r)=>{const s=jh(i,t,n,r);return s?{z:t,x:n,y:r,offset:s[0],length:s[1],is_dir:!1}:null},jh=(i,t,n,r)=>{let s=0,a=i.byteLength/17-1;for(;s<=a;){const l=a+s>>1,u=vd(t,n,r,i,l*17);if(u>0)s=l+1;else if(u<0)a=l-1;else return[Uh(i,l*17+7),i.getUint32(l*17+13,!0)]}return null},wd=(i,t)=>i.is_dir&&!t.is_dir?1:!i.is_dir&&t.is_dir?-1:i.z!==t.z?i.z-t.z:i.x!==t.x?i.x-t.x:i.y-t.y,Wh=(i,t)=>{const n=i.getUint8(t*17);return{z:n&127,x:Kn(i,t*17+1),y:Kn(i,t*17+4),offset:Uh(i,t*17+7),length:i.getUint32(t*17+13,!0),is_dir:n>>7===1}},ua=i=>{const t=[],n=new DataView(i);for(let r=0;r<n.byteLength/17;r++)t.push(Wh(n,r));return xd(t)},xd=i=>{i.sort(wd);const t=new ArrayBuffer(17*i.length),n=new Uint8Array(t);for(let r=0;r<i.length;r++){const s=i[r];let a=s.z;s.is_dir&&(a=a|128),n[r*17]=a,n[r*17+1]=s.x&255,n[r*17+2]=s.x>>8&255,n[r*17+3]=s.x>>16&255,n[r*17+4]=s.y&255,n[r*17+5]=s.y>>8&255,n[r*17+6]=s.y>>16&255,n[r*17+7]=s.offset&255,n[r*17+8]=Si(s.offset,8)&255,n[r*17+9]=Si(s.offset,16)&255,n[r*17+10]=Si(s.offset,24)&255,n[r*17+11]=Si(s.offset,32)&255,n[r*17+12]=Si(s.offset,48)&255,n[r*17+13]=s.length&255,n[r*17+14]=s.length>>8&255,n[r*17+15]=s.length>>16&255,n[r*17+16]=s.length>>24&255}return t},bd=(i,t)=>{if(i.byteLength<17)return null;const n=i.byteLength/17,r=Wh(i,n-1);if(r.is_dir){const s=r.z,a=t.z-s,l=Math.trunc(t.x/(1<<a)),u=Math.trunc(t.y/(1<<a));return{z:s,x:l,y:u}}return null};function Md(i){return At(this,null,function*(){const t=yield i.getBytes(0,512e3),n=new DataView(t.data),r=n.getUint32(4,!0),s=n.getUint16(8,!0),a=new TextDecoder("utf-8"),l=JSON.parse(a.decode(new DataView(t.data,10,r)));let u=0;l.compression==="gzip"&&(u=2);let c=0;"minzoom"in l&&(c=+l.minzoom);let d=0;"maxzoom"in l&&(d=+l.maxzoom);let p=0,_=0,w=0,M=-180,P=-85,k=180,A=85;if(l.bounds){const g=l.bounds.split(",");M=+g[0],P=+g[1],k=+g[2],A=+g[3]}if(l.center){const g=l.center.split(",");p=+g[0],_=+g[1],w=+g[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:c,maxZoom:d,minLon:M,minLat:P,maxLon:k,maxLat:A,centerZoom:w,centerLon:p,centerLat:_,etag:t.etag}})}function Pd(i,t,n,r,s,a,l){return At(this,null,function*(){let u=yield n.getArrayBuffer(t,i.rootDirectoryOffset,i.rootDirectoryLength,i);i.specVersion===1&&(u=ua(u));const c=la(new DataView(u),r,s,a);if(c){let _=(yield t.getBytes(c.offset,c.length,l)).data;const w=new DataView(_);return w.getUint8(0)==31&&w.getUint8(1)==139&&(_=so(new Uint8Array(_))),{data:_}}const d=bd(new DataView(u),{z:r,x:s,y:a});if(d){const p=yd(new DataView(u),d.z,d.x,d.y);if(p){let _=yield n.getArrayBuffer(t,p.offset,p.length,i);i.specVersion===1&&(_=ua(_));const w=la(new DataView(_),r,s,a);if(w){let P=(yield t.getBytes(w.offset,w.length,l)).data;const k=new DataView(P);return k.getUint8(0)==31&&k.getUint8(1)==139&&(P=so(new Uint8Array(P))),{data:P}}}}})}var Vh={getHeader:Md,getZxy:Pd};function Je(i,t){return(t>>>0)*4294967296+(i>>>0)}function Ld(i,t){const n=t.buf;let r,s;if(s=n[t.pos++],r=(s&112)>>4,s<128||(s=n[t.pos++],r|=(s&127)<<3,s<128)||(s=n[t.pos++],r|=(s&127)<<10,s<128)||(s=n[t.pos++],r|=(s&127)<<17,s<128)||(s=n[t.pos++],r|=(s&127)<<24,s<128)||(s=n[t.pos++],r|=(s&1)<<31,s<128))return Je(i,r);throw new Error("Expected varint not more than 10 bytes")}function Ci(i){const t=i.buf;let n,r;return r=t[i.pos++],n=r&127,r<128||(r=t[i.pos++],n|=(r&127)<<7,r<128)||(r=t[i.pos++],n|=(r&127)<<14,r<128)||(r=t[i.pos++],n|=(r&127)<<21,r<128)?n:(r=t[i.pos],n|=(r&15)<<28,Ld(n,i))}function Ed(i,t,n,r){if(r==0){n==1&&(t[0]=i-1-t[0],t[1]=i-1-t[1]);const s=t[0];t[0]=t[1],t[1]=s}}function Sd(i,t,n){if(i>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Math.pow(2,i)-1||n>Math.pow(2,i)-1)throw Error("tile x/y outside zoom level bounds");let r=0,s=0;for(;s<i;)r+=Math.pow(2,s)*Math.pow(2,s),s++;const a=Math.pow(2,i);let l=0,u=0,c=0;const d=[t,n];let p=a/2;for(;p>0;)l=(d[0]&p)>0?1:0,u=(d[1]&p)>0?1:0,c+=p*p*(3*l^u),Ed(p,d,l,u),p=p/2;return r+c}function Hh(i,t){return At(this,null,function*(){if(t===1||t===0)return i;if(t===2)return so(new Uint8Array(i));throw Error("Compression method not supported")})}var Cd=127;function kd(i,t){let n=0,r=i.length-1;for(;n<=r;){const s=r+n>>1,a=t-i[s].tileId;if(a>0)n=s+1;else if(a<0)r=s-1;else return i[s]}return r>=0&&(i[r].runLength===0||t-i[r].tileId<i[r].runLength)?i[r]:null}var Td=class{constructor(i){this.url=i}getKey(){return this.url}getBytes(i,t,n){return At(this,null,function*(){let r;n||(r=new AbortController,n=r.signal);let s=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+i+"-"+(i+t-1)}});if(s.status===416&&i===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const c=+u.substr(8);s=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(c-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const a=s.headers.get("Content-Length");if(s.status===200&&(!a||+a>t))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function Gt(i,t){const n=i.getUint32(t+4,!0),r=i.getUint32(t+0,!0);return n*Math.pow(2,32)+r}function Dd(i,t){const n=new DataView(i),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:Gt(n,8),rootDirectoryLength:Gt(n,16),jsonMetadataOffset:Gt(n,24),jsonMetadataLength:Gt(n,32),leafDirectoryOffset:Gt(n,40),leafDirectoryLength:Gt(n,48),tileDataOffset:Gt(n,56),tileDataLength:Gt(n,64),numAddressedTiles:Gt(n,72),numTileEntries:Gt(n,80),numTileContents:Gt(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:t}}function $h(i){const t={buf:new Uint8Array(i),pos:0},n=Ci(t),r=[];let s=0;for(let a=0;a<n;a++){const l=Ci(t);r.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let a=0;a<n;a++)r[a].runLength=Ci(t);for(let a=0;a<n;a++)r[a].length=Ci(t);for(let a=0;a<n;a++){const l=Ci(t);l===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=l-1}return r}function Ad(i){const t=new DataView(i);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ei=class extends Error{};function Od(i,t,n,r){return At(this,null,function*(){const s=yield i.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ad(s.data)<3)return[yield Vh.getHeader(i)];const l=s.data.slice(0,Cd);let u=s.etag;r&&s.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+i.getKey()),u=void 0);const c=Dd(l,u);if(n){const d=s.data.slice(c.rootDirectoryOffset,c.rootDirectoryOffset+c.rootDirectoryLength),p=i.getKey()+"|"+(c.etag||"")+"|"+c.rootDirectoryOffset+"|"+c.rootDirectoryLength,_=$h(yield t(d,c.internalCompression));return[c,[p,_.length,_]]}return[c,void 0]})}function Id(i,t,n,r,s){return At(this,null,function*(){const a=yield i.getBytes(n,r);if(s.etag&&s.etag!==a.etag)throw new ei(a.etag);const l=yield t(a.data,s.internalCompression),u=$h(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Bd=class{constructor(i=100,t=!0,n=Hh){this.cache=new Map,this.maxCacheEntries=i,this.counter=1,this.prefetch=t,this.decompress=n}getHeader(i,t){return At(this,null,function*(){const n=i.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const r=new Promise((s,a)=>{Od(i,this.decompress,this.prefetch,t).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{a(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:r}),r})}getDirectory(i,t,n,r){return At(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{Id(i,this.decompress,t,n,r).then(c=>{l(c),this.prune()}).catch(c=>{u(c)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}getArrayBuffer(i,t,n,r){return At(this,null,function*(){const s=i.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const a=new Promise((l,u)=>{i.getBytes(t,n).then(c=>{if(r.etag&&r.etag!==c.etag)throw new ei(c.etag);l(c.data),this.cache.has(s),this.prune()}).catch(c=>{u(c)})});return this.cache.set(s,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let i=1/0,t;this.cache.forEach((n,r)=>{n.lastUsed<i&&(i=n.lastUsed,t=r)}),t&&this.cache.delete(t)}}invalidate(i,t){return At(this,null,function*(){this.cache.delete(i.getKey()),yield this.getHeader(i,t)})}},zd=class{constructor(i,t,n){typeof i=="string"?this.source=new Td(i):this.source=i,n?this.decompress=n:this.decompress=Hh,t?this.cache=t:this.cache=new Bd}getHeader(){return At(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(i,t,n,r){return At(this,null,function*(){const s=Sd(i,t,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return Vh.getZxy(a,this.source,this.cache,i,t,n,r);if(i<a.minZoom||i>a.maxZoom)return;let l=a.rootDirectoryOffset,u=a.rootDirectoryLength;for(let c=0;c<=3;c++){const d=yield this.cache.getDirectory(this.source,l,u,a),p=kd(d,s);if(p)if(p.runLength>0){const _=yield this.source.getBytes(a.tileDataOffset+p.offset,p.length,r);if(a.etag&&a.etag!==_.etag)throw new ei(_.etag);return{data:yield this.decompress(_.data,a.tileCompression),cacheControl:_.cacheControl,expires:_.expires}}else l=a.leafDirectoryOffset+p.offset,u=p.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(i,t,n,r){return At(this,null,function*(){try{return yield this.getZxyAttempt(i,t,n,r)}catch(s){if(s instanceof ei)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(i,t,n,r);throw s}})}getMetadataAttempt(){return At(this,null,function*(){const i=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(i.jsonMetadataOffset,i.jsonMetadataLength);if(i.etag&&i.etag!==t.etag)throw new ei(t.etag);const n=yield this.decompress(t.data,i.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return At(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(i){if(i instanceof ei)return this.cache.invalidate(this.source,i.message),yield this.getMetadataAttempt();throw i}})}},ri;(function(i){i[i.Point=1]="Point",i[i.Line=2]="Line",i[i.Polygon=3]="Polygon"})(ri||(ri={}));function Be(i){return i.x+":"+i.y+":"+i.z}var Fd=(i,t,n)=>{i.pos=t;for(var r=i.readVarint()+i.pos,s=1,a=0,l=0,u=0,c=1/0,d=-1/0,p=1/0,_=-1/0,w=[],M=[];i.pos<r;){if(a<=0){var P=i.readVarint();s=P&7,a=P>>3}if(a--,s===1||s===2)l+=i.readSVarint()*n,u+=i.readSVarint()*n,l<c&&(c=l),l>d&&(d=l),u<p&&(p=u),u>_&&(_=u),s===1&&(M.length>0&&w.push(M),M=[]),M.push(new Gi.default(l,u));else if(s===7)M&&M.push(M[0].clone());else throw new Error("unknown command "+s)}return M&&w.push(M),{geom:w,bbox:{minX:c,minY:p,maxX:d,maxY:_}}};function Gh(i,t){let n=new Kf.VectorTile(new Qf.default(i)),r=new Map;for(let[s,a]of Object.entries(n.layers)){let l=[],u=a;for(let c=0;c<u.length;c++){let d=Fd(u.feature(c)._pbf,u.feature(c)._geometry,t/u.extent),p=0;for(let _ of d.geom)p+=_.length;l.push({id:u.feature(c).id,geomType:u.feature(c).type,geom:d.geom,numVertices:p,bbox:d.bbox,props:u.feature(c).properties})}r.set(s,l)}return r}var ca=class{constructor(i,t){typeof i=="string"?this.p=new zd(i):this.p=i,this.controllers=[],this.shouldCancelZooms=t}get(i,t){return ai(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));const n=new AbortController;this.controllers.push([i.z,n]);const r=n.signal;let s=yield this.p.getZxy(i.z,i.x,i.y,r);return s?Gh(s.data,t):new Map})}},Nd=class{constructor(i,t){this.url=i,this.controllers=[],this.shouldCancelZooms=t}get(i,t){return ai(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(a=>a[0]!=i.z?(a[1].abort(),!1):!0));let n=this.url.replace("{z}",i.z.toString()).replace("{x}",i.x.toString()).replace("{y}",i.y.toString());const r=new AbortController;this.controllers.push([i.z,r]);const s=r.signal;return new Promise((a,l)=>{fetch(n,{signal:s}).then(u=>u.arrayBuffer()).then(u=>{let c=Gh(u,t);a(c)}).catch(u=>{l(u)})})})}},ao=6378137,fa=85.0511287798,kn=ao*Math.PI,Rd=i=>{let t=Math.PI/180,n=Math.max(Math.min(fa,i[0]),-fa),r=Math.sin(n*t);return new Gi.default(ao*i[1]*t,ao*Math.log((1+r)/(1-r))/2)};function da(i){return i*i}function Rn(i,t){return da(i.x-t.x)+da(i.y-t.y)}function Zd(i,t,n){var r=Rn(t,n);if(r===0)return Rn(i,t);var s=((i.x-t.x)*(n.x-t.x)+(i.y-t.y)*(n.y-t.y))/r;return s=Math.max(0,Math.min(1,s)),Rn(i,new Gi.default(t.x+s*(n.x-t.x),t.y+s*(n.y-t.y)))}function pa(i,t){for(var n=!1,r=0,s=t.length-1;r<t.length;s=r++){var a=t[r].x,l=t[r].y,u=t[s].x,c=t[s].y,d=l>i.y!=c>i.y&&i.x<(u-a)*(i.y-l)/(c-l)+a;d&&(n=!n)}return n}function Yd(i){for(var t=0,n=0;n<i.length;n++){let r=(n+1)%i.length;t+=i[n].x*i[r].y,t-=i[r].x*i[n].y}return t<0}function Xd(i,t){var n=!1;for(let r of t)if(Yd(r))pa(i,r)&&(n=!1);else{if(n)return!0;pa(i,r)&&(n=!0)}return n}function Ud(i,t){let n=1/0;for(let r of t){let s=Math.sqrt(Rn(i,r[0]));s<n&&(n=s)}return n}function jd(i,t){let n=1/0;for(let s of t)for(var r=0;r<s.length-1;r++){let a=Math.sqrt(Zd(i,s[r],s[r+1]));a<n&&(n=a)}return n}var Wd=class{constructor(i,t){this.source=i,this.cache=new Map,this.inflight=new Map,this.tileSize=t}queryFeatures(i,t,n,r){let s=Rd([t,i]);var a=new Gi.default((s.x+kn)/(kn*2),1-(s.y+kn)/(kn*2));a.x>1&&(a.x=a.x-Math.floor(a.x));let l=a.mult(1<<n),u=Math.floor(l.x),c=Math.floor(l.y);const d=Be({z:n,x:u,y:c});let p=[],_=this.cache.get(d);if(_){const w=new Gi.default((l.x-u)*this.tileSize,(l.y-c)*this.tileSize);for(let[M,P]of _.data.entries())for(let k of P)k.geomType==1?Ud(w,k.geom)<r&&p.push({feature:k,layerName:M}):k.geomType==2?jd(w,k.geom)<r&&p.push({feature:k,layerName:M}):Xd(w,k.geom)&&p.push({feature:k,layerName:M})}return p}get(i){return ai(this,null,function*(){const t=Be(i);return new Promise((n,r)=>{let s=this.cache.get(t);if(s)s.used=performance.now(),n(s.data);else{let a=this.inflight.get(t);a?a.push([n,r]):(this.inflight.set(t,[]),this.source.get(i,this.tileSize).then(l=>{this.cache.set(t,{used:performance.now(),data:l});let u=this.inflight.get(t);if(u&&u.forEach(c=>c[0](l)),this.inflight.delete(t),n(l),this.cache.size>=64){let c=1/0,d;this.cache.forEach((p,_)=>{p.used<c&&(c=p.used,d=_)}),d&&this.cache.delete(d)}}).catch(l=>{let u=this.inflight.get(t);u&&u.forEach(c=>c[1](l)),this.inflight.delete(t),r(l)}))}})})}},qh=(i,t,n)=>{let r=[];for(let s of i){let a=[];for(let l of s)a.push(l.clone().mult(t).add(n));r.push(a)}return r},Tn=(i,t)=>{let n=1<<t;return i<0&&(i=n+i),i>=n&&(i=i%n),i},Vd=class{constructor(i,t,n){this.tileCache=i,this.maxDataLevel=t,this.levelDiff=n}dataTilesForBounds(i,t){let n=Math.pow(2,i)/Math.pow(2,Math.ceil(i)),r=[];var s=1,a=this.tileCache.tileSize;if(i<this.levelDiff)s=1/(1<<this.levelDiff-i)*n,r.push({data_tile:{z:0,x:0,y:0},origin:new qe.default(0,0),scale:s,dim:a*s});else if(i<=this.levelDiff+this.maxDataLevel){let c=1<<this.levelDiff,d=256*n,p=Math.ceil(i)-this.levelDiff,_=Math.floor(t.minX/c/d),w=Math.floor(t.minY/c/d),M=Math.floor(t.maxX/c/d),P=Math.floor(t.maxY/c/d);for(var l=_;l<=M;l++)for(var u=w;u<=P;u++){let k=new qe.default(l*c*d,u*c*d);r.push({data_tile:{z:p,x:Tn(l,p),y:Tn(u,p)},origin:k,scale:n,dim:a*n})}}else{let c=1<<this.levelDiff;s=(1<<Math.ceil(i)-this.maxDataLevel-this.levelDiff)*n;let d=Math.floor(t.minX/c/256/s),p=Math.floor(t.minY/c/256/s),_=Math.floor(t.maxX/c/256/s),w=Math.floor(t.maxY/c/256/s);for(var l=d;l<=_;l++)for(var u=p;u<=w;u++){let k=new qe.default(l*c*256*s,u*c*256*s);r.push({data_tile:{z:this.maxDataLevel,x:Tn(l,this.maxDataLevel),y:Tn(u,this.maxDataLevel)},origin:k,scale:s,dim:a*s})}}return r}dataTileForDisplayTile(i){var t,n=1,r=this.tileCache.tileSize,s;if(i.z<this.levelDiff)t={z:0,x:0,y:0},n=1/(1<<this.levelDiff-i.z),s=new qe.default(0,0),r=r*n;else if(i.z<=this.levelDiff+this.maxDataLevel){let a=1<<this.levelDiff;t={z:i.z-this.levelDiff,x:Math.floor(i.x/a),y:Math.floor(i.y/a)},s=new qe.default(t.x*a*256,t.y*a*256)}else{n=1<<i.z-this.maxDataLevel-this.levelDiff;let a=1<<this.levelDiff;t={z:this.maxDataLevel,x:Math.floor(i.x/a/n),y:Math.floor(i.y/a/n)},s=new qe.default(t.x*a*n*256,t.y*a*n*256),r=r*n}return{data_tile:t,scale:n,origin:s,dim:r}}getBbox(i,t){return ai(this,null,function*(){let n=this.dataTilesForBounds(i,t);return(yield Promise.all(n.map(s=>this.tileCache.get(s.data_tile)))).map((s,a)=>{let l=n[a];return{data:s,z:i,data_tile:l.data_tile,scale:l.scale,dim:l.dim,origin:l.origin}})})}getDisplayTile(i){return ai(this,null,function*(){let t=this.dataTileForDisplayTile(i);return{data:yield this.tileCache.get(t.data_tile),z:i.z,data_tile:t.data_tile,scale:t.scale,origin:t.origin,dim:t.dim}})}queryFeatures(i,t,n){let r=Math.round(n),s=Math.min(r-this.levelDiff,this.maxDataLevel),a=16/(1<<r-s);return this.tileCache.queryFeatures(i,t,s,a)}},Hd=i=>{let t=r=>{let s=r.levelDiff===void 0?2:r.levelDiff,a=r.maxDataZoom||14,l;typeof r.url=="string"?r.url.endsWith(".pmtiles")?l=new ca(r.url,!0):l=new Nd(r.url,!0):l=new ca(r.url,!0);let u=new Wd(l,256*1<<s);return new Vd(u,a,s)},n=new Map;if(i.sources)for(const r in i.sources)n.set(r,t(i.sources[r]));else n.set("",t(i));return n},$d=Xt(ve());function Gd(i,t,n,r,s,a,l,u,c){let d=performance.now();i.save(),i.miterLimit=2;for(var p of s){if(p.minzoom&&t<p.minzoom||p.maxzoom&&t>p.maxzoom)continue;let P=n.get(p.dataSource||"");if(P)for(let k of P){var _=k.data.get(p.dataLayer);if(_===void 0)continue;p.symbolizer.before&&p.symbolizer.before(i,k.z);let A=k.origin;k.dim;let O=k.scale;i.save(),i.translate(A.x-l.x,A.y-l.y);for(var w of _){let g=w.geom,v=w.bbox;v.maxX*O+A.x<a.minX||v.minX*O+A.x>a.maxX||v.minY*O+A.y>a.maxY||v.maxY*O+A.y<a.minY||p.filter&&!p.filter(k.z,w)||(O!=1&&(g=qh(g,O,new $d.default(0,0))),p.symbolizer.draw(i,g,k.z,w))}i.restore()}}if(r){let P=r.searchBbox(a,1/0);for(var M of P)if(i.save(),i.translate(M.anchor.x-l.x,M.anchor.y-l.y),M.draw(i),i.restore(),c){i.lineWidth=.5,i.strokeStyle=c,i.fillStyle=c,i.globalAlpha=1,i.fillRect(M.anchor.x-l.x-2,M.anchor.y-l.y-2,4,4);for(let k of M.bboxes)i.strokeRect(k.minX-l.x,k.minY-l.y,k.maxX-k.minX,k.maxY-k.minY)}}return i.restore(),performance.now()-d}var qd=Xt(ve()),Jd=Xt($f()),Kd=(i,t,n)=>{let r=256,s=t/r,a=Math.floor(n.minX/r),l=Math.floor(n.minY/r),u=Math.floor(n.maxX/r),c=Math.floor(n.maxY/r),d=Math.log2(s),p=[];for(let _=a;_<=u;_++){let w=_%(1<<i);for(let M=l;M<=c;M++)p.push({display:Be({z:i,x:w,y:M}),key:Be({z:i-d,x:Math.floor(w/s),y:Math.floor(M/s)})})}return p},Qd=class{constructor(i,t){this.tree=new Jd.default,this.current=new Map,this.dim=i,this.maxLabeledTiles=t}hasPrefix(i){for(let t of this.current.keys())if(t.startsWith(i))return!0;return!1}has(i){return this.current.has(i)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(i,t){let n=new Set;for(let r of this.tree.search(i))r.indexed_label.order<=t&&n.add(r.indexed_label);return n}searchLabel(i,t){let n=new Set;for(let r of i.bboxes)for(let s of this.tree.search(r))s.indexed_label.order<=t&&n.add(s.indexed_label);return n}bboxCollides(i,t){for(let n of this.tree.search(i))if(n.indexed_label.order<=t)return!0;return!1}labelCollides(i,t){for(let n of i.bboxes)for(let r of this.tree.search(n))if(r.indexed_label.order<=t)return!0;return!1}deduplicationCollides(i){if(!i.deduplicationKey||!i.deduplicationDistance)return!1;let t=i.deduplicationDistance,n={minX:i.anchor.x-t,minY:i.anchor.y-t,maxX:i.anchor.x+t,maxY:i.anchor.y+t};for(let r of this.tree.search(n))if(r.indexed_label.deduplicationKey===i.deduplicationKey&&r.indexed_label.anchor.dist(i.anchor)<t)return!0;return!1}makeEntry(i){this.current.get(i)&&console.log("consistency error 1");let t=new Set;this.current.set(i,t)}insert(i,t,n){let r={anchor:i.anchor,bboxes:i.bboxes,draw:i.draw,order:t,tileKey:n,deduplicationKey:i.deduplicationKey,deduplicationDistance:i.deduplicationDistance},s=this.current.get(n);if(!s){let p=new Set;this.current.set(n,p),s=p}s.add(r);var a=!1,l=!1;for(let p of i.bboxes){var u=p;u.indexed_label=r,this.tree.insert(u),p.minX<0&&(a=!0),p.maxX>this.dim&&(l=!0)}if(a||l){var c=a?this.dim:-this.dim,d=[];for(let w of i.bboxes)d.push({minX:w.minX+c,minY:w.minY,maxX:w.maxX+c,maxY:w.maxY});let p={anchor:new qd.default(i.anchor.x+c,i.anchor.y),bboxes:d,draw:i.draw,order:t,tileKey:n},_=this.current.get(n);_&&_.add(p);for(let w of d){var u=w;u.indexed_label=p,this.tree.insert(u)}}}pruneOrNoop(i){let t=i.split(":"),n,r=0,s=0;for(var a of this.current.keys()){let l=a.split(":");if(l[3]===t[3]){s++;let u=Math.sqrt(Math.pow(+l[0]-+t[0],2)+Math.pow(+l[1]-+t[1],2));u>r&&(r=u,n=a)}n&&s>this.maxLabeledTiles&&this.pruneKey(n)}}pruneKey(i){let t=this.current.get(i);if(!t)return;let n=[];for(let r of this.tree.all())t.has(r.indexed_label)&&n.push(r);n.forEach(r=>{this.tree.remove(r)}),this.current.delete(i)}removeLabel(i){let t=[];for(let r of this.tree.all())i==r.indexed_label&&t.push(r);t.forEach(r=>{this.tree.remove(r)});let n=this.current.get(i.tileKey);n&&n.delete(i)}},tp=class{constructor(i,t,n,r,s){this.index=new Qd(256*1<<i,r),this.z=i,this.scratch=t,this.labelRules=n,this.callback=s}layout(i){let t=performance.now(),n=new Set;for(let[l,u]of i)for(let c of u){let d=Be(c.data_tile)+":"+l;this.index.has(d)||(this.index.makeEntry(d),n.add(d))}let r=new Set;for(let[l,u]of this.labelRules.entries()){if(u.visible==!1||u.minzoom&&this.z<u.minzoom||u.maxzoom&&this.z>u.maxzoom)continue;let c=u.dataSource||"",d=i.get(c);if(d)for(let p of d){let _=Be(p.data_tile)+":"+c;if(!n.has(_))continue;let w=p.data.get(u.dataLayer);if(w===void 0)continue;let M=w;u.sort&&M.sort((k,A)=>u.sort?u.sort(k.props,A.props):0);let P={index:this.index,zoom:this.z,scratch:this.scratch,order:l,overzoom:this.z-p.data_tile.z};for(let k of M){if(u.filter&&!u.filter(this.z,k))continue;let A=qh(k.geom,p.scale,p.origin),O=u.symbolizer.place(P,A,k);if(O)for(let g of O){var s=!1;if(!(g.deduplicationKey&&this.index.deduplicationCollides(g))){if(this.index.labelCollides(g,1/0)){if(!this.index.labelCollides(g,l)){let v=this.index.searchLabel(g,1/0);for(let y of v){this.index.removeLabel(y);for(let E of y.bboxes)this.findInvalidatedTiles(r,p.dim,E,_)}this.index.insert(g,l,_),s=!0}}else this.index.insert(g,l,_),s=!0;if(s)for(let v of g.bboxes)(v.maxX>p.origin.x+p.dim||v.minX<p.origin.x||v.minY<p.origin.y||v.maxY>p.origin.y+p.dim)&&this.findInvalidatedTiles(r,p.dim,v,_)}}}}}for(var a of n)this.index.pruneOrNoop(a);return r.size>0&&this.callback&&this.callback(r),performance.now()-t}findInvalidatedTiles(i,t,n,r){let s=Kd(this.z,t,n);for(let a of s)a.key!=r&&this.index.hasPrefix(a.key)&&i.add(a.display)}add(i){var t=!0;for(let[n,r]of i)for(let s of r)this.index.has(Be(s.data_tile)+":"+n)||(t=!1);return t?0:this.layout(i)}},ma=class{constructor(i,t,n,r){this.labelers=new Map,this.scratch=i,this.labelRules=t,this.maxLabeledTiles=n,this.callback=r}add(i,t){var n=this.labelers.get(i);return n||(n=new tp(i,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(i,n)),n.add(t)}getIndex(i){let t=this.labelers.get(i);if(t)return t.index}},_a={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"},ga={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function Ui(i,t,n){return Math.min(Math.max(i,n),t)}var ki=class extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}};function ep(i){if(typeof i!="string")throw new ki(i);if(i.trim().toLowerCase()==="transparent")return[0,0,0,0];let t=i.trim();t=ap.test(i)?(function(l){const u=l.toLowerCase().trim(),c=ip[(function(d){let p=5381,_=d.length;for(;_;)p=33*p^d.charCodeAt(--_);return(p>>>0)%2341})(u)];if(!c)throw new ki(l);return`#${c}`})(i):i;const n=np.exec(t);if(n){const l=Array.from(n).slice(1);return[...l.slice(0,3).map(u=>parseInt(qi(u,2),16)),parseInt(qi(l[3]||"f",2),16)/255]}const r=rp.exec(t);if(r){const l=Array.from(r).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,16)),parseInt(l[3]||"ff",16)/255]}const s=op.exec(t);if(s){const l=Array.from(s).slice(1);return[...l.slice(0,3).map(u=>parseInt(u,10)),parseFloat(l[3]||"1")]}const a=sp.exec(t);if(a){const[l,u,c,d]=Array.from(a).slice(1).map(parseFloat);if(Ui(0,100,u)!==u)throw new ki(i);if(Ui(0,100,c)!==c)throw new ki(i);return[...hp(l,u,c),d||1]}throw new ki(i)}var va=i=>parseInt(i.replace(/_/g,""),36),ip="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((i,t)=>{const n=va(t.substring(0,3)),r=va(t.substring(3)).toString(16);let s="";for(let a=0;a<6-r.length;a++)s+="0";return i[n]=`${s}${r}`,i},{}),qi=(i,t)=>Array.from(Array(t)).map(()=>i).join(""),np=new RegExp(`^#${qi("([a-f0-9])",3)}([a-f0-9])?$`,"i"),rp=new RegExp(`^#${qi("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),op=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${qi(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),sp=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ap=/^[a-z]+$/i,ya=i=>Math.round(255*i),hp=(i,t,n)=>{let r=n/100;if(t===0)return[r,r,r].map(ya);const s=(i%360+360)%360/60,a=(1-Math.abs(2*r-1))*(t/100),l=a*(1-Math.abs(s%2-1));let u=0,c=0,d=0;s>=0&&s<1?(u=a,c=l):s>=1&&s<2?(u=l,c=a):s>=2&&s<3?(c=a,d=l):s>=3&&s<4?(c=l,d=a):s>=4&&s<5?(u=l,d=a):s>=5&&s<6&&(u=a,d=l);const p=r-a/2;return[u+p,c+p,d+p].map(ya)};function wa(i){const[t,n,r,s]=ep(i).map((d,p)=>p===3?d:d/255),a=Math.max(t,n,r),l=Math.min(t,n,r),u=(a+l)/2;if(a===l)return[0,0,u,s];const c=a-l;return[60*(t===a?(n-r)/c+(n<r?6:0):n===a?(r-t)/c+2:(t-n)/c+4),u>.5?c/(2-a-l):c/(a+l),u,s]}function lp(i,t,n,r){return`hsla(${(i%360).toFixed()}, ${Ui(0,100,100*t).toFixed()}%, ${Ui(0,100,100*n).toFixed()}%, ${parseFloat(Ui(0,1,r).toFixed(3))})`}var Kt=Xt(ve());Xt(Gf());var up=Xt(Jf()),Nt=class{constructor(i,t){this.str=i??t,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(i,t){return typeof this.str=="function"?this.str(i,t):this.str}},gt=class{constructor(i,t=1){this.value=i??t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,t){return typeof this.value=="function"?this.value(i,t):this.value}},Po=class{constructor(i){var t;this.label_props=(t=i?.label_props)!=null?t:["name"],this.textTransform=i?.textTransform}get(i,t){let n,r;typeof this.label_props=="function"?r=this.label_props(i,t):r=this.label_props;for(let a of r)if(t.props.hasOwnProperty(a)&&typeof t.props[a]=="string"){n=t.props[a];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(i,t):s=this.textTransform,n&&s==="uppercase"?n=n.toUpperCase():n&&s==="lowercase"?n=n.toLowerCase():n&&s==="capitalize"&&(n=n.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),n}},Lo=class{constructor(i){var t,n;i?.font?this.font=i.font:(this.family=(t=i?.fontFamily)!=null?t:"sans-serif",this.size=(n=i?.fontSize)!=null?n:12,this.weight=i?.fontWeight,this.style=i?.fontStyle)}get(i,t){if(this.font)return typeof this.font=="function"?this.font(i,t):this.font;var n="";this.style&&(typeof this.style=="function"?n=this.style(i,t)+" ":n=this.style+" ");var r="";this.weight&&(typeof this.weight=="function"?r=this.weight(i,t)+" ":r=this.weight+" ");var s;typeof this.size=="function"?s=this.size(i,t):s=this.size;var a;return typeof this.family=="function"?a=this.family(i,t):a=this.family,`${n}${r}${s}px ${a}`}},cp=class{constructor(i,t=[]){this.value=i??t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(i,t){return typeof this.value=="function"?this.value(i,t):this.value}},xa=Xt(ve()),fp=(i,t,n)=>{var r=[],s,a,l,u=0,c=0,d=0,p=0,_=0,w=0,M=0,P=0,k=0,A=0,O=0,g=0;if(i.length<2)return[];if(i.length===2)return d=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),[{length:d,beginIndex:0,beginDistance:0,endIndex:2,endDistance:d}];for(p=Math.sqrt(Math.pow(i[1].x-i[0].x,2)+Math.pow(i[1].y-i[0].y,2)),u=1,c=i.length-1;u<c;u++)s=i[u-1],a=i[u],l=i[u+1],w=a.x-s.x,M=a.y-s.y,P=l.x-a.x,k=l.y-a.y,_=Math.sqrt(P*P+k*k),d+=p,A=Math.acos((w*P+M*k)/(p*_)),(A>t||d-g>n)&&(r.push({length:d-g,beginDistance:g,beginIndex:O,endIndex:u+1,endDistance:d}),O=u,g=d),p=_;return u-O>0&&r.push({length:d-g+_,beginIndex:O,beginDistance:g,endIndex:u+1,endDistance:d+_}),r};function dp(i,t,n,r){let s=[];for(let l of i){let u=fp(l,Math.PI/45,t);for(let c of u)if(c.length>=t+r){let d=new xa.default(l[c.beginIndex].x,l[c.beginIndex].y),p=l[c.endIndex-1],_=new xa.default((p.x-d.x)/c.length,(p.y-d.y)/c.length);for(var a=r;a<c.length-t;a+=n)s.push({start:d.add(_.mult(a)),end:d.add(_.mult(a+t))})}}return s}function pp(i,t,n,r){let s=t.x-i.x,a=t.y-i.y,l=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),u=[];for(var c=0;c<n+r;c+=2*r){let d=c*1/l;u.push({x:i.x+d*s,y:i.y+d*a})}return u}function Jh(i,t){if(i.length<=t)return[i];let n=t-1,r=i.lastIndexOf(" ",n),s=i.indexOf(" ",n);if(r==-1&&s==-1)return[i];let a,l;return s==-1||r>=0&&n-r<s-n?(a=i.substring(0,r),l=i.substring(r+1,i.length)):(a=i.substring(0,s),l=i.substring(s+1,i.length)),[a,...Jh(l,t)]}var Kh=5400,ba;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(ba||(ba={}));var Ma;(function(i){i[i.N=1]="N",i[i.NE=2]="NE",i[i.E=3]="E",i[i.SE=4]="SE",i[i.S=5]="S",i[i.SW=6]="SW",i[i.W=7]="W",i[i.NW=8]="NW"})(Ma||(Ma={}));var Dt=class{constructor(i){var t;this.pattern=i.pattern,this.fill=new Nt(i.fill,"black"),this.opacity=new gt(i.opacity,1),this.stroke=new Nt(i.stroke,"black"),this.width=new gt(i.width,0),this.per_feature=(t=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||i.per_feature)!=null?t:!1,this.do_stroke=!1}before(i,t){if(!this.per_feature){i.globalAlpha=this.opacity.get(t),i.fillStyle=this.fill.get(t),i.strokeStyle=this.stroke.get(t);let n=this.width.get(t);n>0&&(this.do_stroke=!0),i.lineWidth=n}if(this.pattern){const n=i.createPattern(this.pattern,"repeat");n&&(i.fillStyle=n)}}draw(i,t,n,r){var s=!1;if(this.per_feature){i.globalAlpha=this.opacity.get(n,r),i.fillStyle=this.fill.get(n,r);var a=this.width.get(n,r);a&&(s=!0,i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a)}let l=()=>{i.fill(),(s||this.do_stroke)&&i.stroke()};var u=0;i.beginPath();for(var c of t){u+c.length>Kh&&(l(),u=0,i.beginPath());for(var d=0;d<c.length;d++){let p=c[d];d==0?i.moveTo(p.x,p.y):i.lineTo(p.x,p.y)}u+=c.length}u>0&&l()}};function mp(i,t){let n=0;for(;t[n+1][0]<i;)n++;return n}function _p(i,t,n){return i*(n-t)+t}function gp(i,t,n,r){const s=r[t+1][0]-r[t][0],a=i-r[t][0];return s===0?0:(Math.pow(n,a)-1)/(Math.pow(n,s)-1)}function be(i,t){return n=>{if(t.length<1)return 0;if(n<=t[0][0])return t[0][1];if(n>=t[t.length-1][0])return t[t.length-1][1];const r=mp(n,t),s=gp(n,r,i,t);return _p(s,t[r][1],t[r+1][1])}}var re=class{constructor(i){var t;this.color=new Nt(i.color,"black"),this.width=new gt(i.width),this.opacity=new gt(i.opacity),this.dash=i.dash?new cp(i.dash):null,this.dashColor=new Nt(i.dashColor,"black"),this.dashWidth=new gt(i.dashWidth,1),this.lineCap=new Nt(i.lineCap,"butt"),this.lineJoin=new Nt(i.lineJoin,"miter"),this.skip=!1,this.per_feature=!!((t=this.dash)!=null&&t.per_feature||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||i.per_feature)}before(i,t){this.per_feature||(i.strokeStyle=this.color.get(t),i.lineWidth=this.width.get(t),i.globalAlpha=this.opacity.get(t),i.lineCap=this.lineCap.get(t),i.lineJoin=this.lineJoin.get(t))}draw(i,t,n,r){if(this.skip)return;let s=()=>{this.per_feature&&(i.globalAlpha=this.opacity.get(n,r),i.lineCap=this.lineCap.get(n,r),i.lineJoin=this.lineJoin.get(n,r)),this.dash?(i.save(),this.per_feature?(i.lineWidth=this.dashWidth.get(n,r),i.strokeStyle=this.dashColor.get(n,r),i.setLineDash(this.dash.get(n,r))):i.setLineDash(this.dash.get(n)),i.stroke(),i.restore()):(i.save(),this.per_feature&&(i.lineWidth=this.width.get(n,r),i.strokeStyle=this.color.get(n,r)),i.stroke(),i.restore())};var a=0;i.beginPath();for(var l of t){a+l.length>Kh&&(s(),a=0,i.beginPath());for(var u=0;u<l.length;u++){let c=l[u];u==0?i.moveTo(c.x,c.y):i.lineTo(c.x,c.y)}a+=l.length}a>0&&s()}},ho=class{constructor(i){this.radius=new gt(i.radius,3),this.fill=new Nt(i.fill,"black"),this.stroke=new Nt(i.stroke,"white"),this.width=new gt(i.width,0),this.opacity=new gt(i.opacity)}draw(i,t,n,r){i.globalAlpha=this.opacity.get(n,r);let s=this.radius.get(n,r),a=this.width.get(n,r);a>0&&(i.strokeStyle=this.stroke.get(n,r),i.lineWidth=a,i.beginPath(),i.arc(t[0][0].x,t[0][0].y,s+a/2,0,2*Math.PI),i.stroke()),i.fillStyle=this.fill.get(n,r),i.beginPath(),i.arc(t[0][0].x,t[0][0].y,s,0,2*Math.PI),i.fill()}place(i,t,n){t[0];let r=new Kt.default(t[0][0].x,t[0][0].y),s=this.radius.get(i.zoom,n),a={minX:r.x-s,minY:r.y-s,maxX:r.x+s,maxY:r.y+s};return[{anchor:r,bboxes:[a],draw:u=>{this.draw(u,[[new Kt.default(0,0)]],i.zoom,n)}}]}},vp=class{constructor(i){this.font=new Lo(i),this.text=new Po(i),this.fill=new Nt(i.fill,"black"),this.background=new Nt(i.background,"white"),this.padding=new gt(i.padding,0)}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=i.scratch.measureText(r),l=a.width,u=a.actualBoundingBoxAscent,c=a.actualBoundingBoxDescent;t[0];let d=new Kt.default(t[0][0].x,t[0][0].y),p=this.padding.get(i.zoom,n),_={minX:d.x-l/2-p,minY:d.y-u-p,maxX:d.x+l/2+p,maxY:d.y+c+p};return[{anchor:d,bboxes:[_],draw:M=>{M.globalAlpha=1,M.fillStyle=this.background.get(i.zoom,n),M.fillRect(-l/2-p,-u-p,l+2*p,u+c+2*p),M.fillStyle=this.fill.get(i.zoom,n),M.font=s,M.fillText(r,-l/2,0)}}]}},Pa=class{constructor(i){this.list=i}place(i,t,n){var r=this.list[0].place(i,t,n);if(!r)return;var s=r[0];let a=s.anchor,l=s.bboxes[0],u=l.maxY-l.minY,c=[{draw:s.draw,translate:{x:0,y:0}}],d=[[new Kt.default(t[0][0].x,t[0][0].y+u)]];for(let _=1;_<this.list.length;_++)r=this.list[_].place(i,d,n),r&&(s=r[0],l=Qh(l,s.bboxes[0]),c.push({draw:s.draw,translate:{x:0,y:u}}));return[{anchor:a,bboxes:[l],draw:_=>{for(let w of c)_.save(),_.translate(w.translate.x,w.translate.y),w.draw(_),_.restore()}}]}},Qh=(i,t)=>({minX:Math.min(i.minX,t.minX),minY:Math.min(i.minY,t.minY),maxX:Math.max(i.maxX,t.maxX),maxY:Math.max(i.maxY,t.maxY)}),La=class{constructor(i){this.list=i}place(i,t,n){let r=this.list[0];if(!r)return;var s=r.place(i,t,n);if(!s)return;var a=s[0];let l=a.anchor,u=a.bboxes[0],c=[a.draw];for(let p=1;p<this.list.length;p++){if(s=this.list[p].place(i,t,n),!s)return;a=s[0],u=Qh(u,a.bboxes[0]),c.push(a.draw)}return[{anchor:l,bboxes:[u],draw:p=>{c.forEach(_=>_(p))}}]}},yp=class{constructor(i){this.symbolizer=i}place(i,t,n){let r=t[0][0],s=this.symbolizer.place(i,[[new Kt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=l.maxX-l.minX,c=l.maxY-l.minY,d={minX:r.x-u/2,maxX:r.x+u/2,minY:r.y-c/2,maxY:r.y+c/2};return[{anchor:r,bboxes:[d],draw:_=>{_.translate(-u/2,c/2-l.maxY),a.draw(_,{justify:2})}}]}},Eo=class{constructor(i){this.font=new Lo(i),this.text=new Po(i),this.fill=new Nt(i.fill,"black"),this.stroke=new Nt(i.stroke,"black"),this.width=new gt(i.width,0),this.lineHeight=new gt(i.lineHeight,1),this.letterSpacing=new gt(i.letterSpacing,0),this.maxLineCodeUnits=new gt(i.maxLineChars,15),this.justify=i.justify}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r)return;let s=this.font.get(i.zoom,n);i.scratch.font=s;let a=this.letterSpacing.get(i.zoom,n),l=Jh(r,this.maxLineCodeUnits.get(i.zoom,n));var u="",c=0;for(let O of l)O.length>c&&(c=O.length,u=O);let d=i.scratch.measureText(u),p=d.width+a*(c-1),_=d.actualBoundingBoxAscent,w=d.actualBoundingBoxDescent,M=(_+w)*this.lineHeight.get(i.zoom,n),P=new Kt.default(t[0][0].x,t[0][0].y),k={minX:P.x,minY:P.y-_,maxX:P.x+p,maxY:P.y+w+(l.length-1)*M};return[{anchor:P,bboxes:[k],draw:(O,g)=>{O.globalAlpha=1,O.font=s,O.fillStyle=this.fill.get(i.zoom,n);let v=this.width.get(i.zoom,n);var y=0;for(let T of l){var E=0;if(this.justify==2||g&&g.justify==2?E=(p-O.measureText(T).width)/2:(this.justify==3||g&&g.justify==3)&&(E=p-O.measureText(T).width),v)if(O.lineWidth=v*2,O.strokeStyle=this.stroke.get(i.zoom,n),a>0){var S=E;for(var C of T)O.strokeText(C,S,y),S+=O.measureText(C).width+a}else O.strokeText(T,E,y);if(a>0){var S=E;for(var C of T)O.fillText(C,S,y),S+=O.measureText(C).width+a}else O.fillText(T,E,y);y+=M}}}]}},Ti=class{constructor(i){this.centered=new yp(new Eo(i))}place(i,t,n){return this.centered.place(i,t,n)}},wp=class{constructor(i,t){var n,r,s;this.symbolizer=i,this.offsetX=new gt(t.offsetX,0),this.offsetY=new gt(t.offsetY,0),this.justify=(n=t.justify)!=null?n:void 0,this.placements=(r=t.placements)!=null?r:[2,6,8,4,1,3,5,7],this.ddValues=(s=t.ddValues)!=null?s:()=>({})}place(i,t,n){if(n.geomType!==ri.Point)return;let r=t[0][0],s=this.symbolizer.place(i,[[new Kt.default(0,0)]],n);if(!s||s.length==0)return;let a=s[0],l=a.bboxes[0],u=this.offsetX,c=this.offsetY,d=this.justify,p=this.placements;const{offsetX:_,offsetY:w,justify:M,placements:P}=this.ddValues(i.zoom,n)||{};_&&(u=new gt(_,0)),w&&(c=new gt(w,0)),M&&(d=M),P&&(p=P);const k=u.get(i.zoom,n),A=c.get(i.zoom,n);let O=(S,C)=>({minX:S.x+C.x+l.minX,minY:S.y+C.y+l.minY,maxX:S.x+C.x+l.maxX,maxY:S.y+C.y+l.maxY});var g=new Kt.default(k,A),v;let y=S=>{S.translate(g.x,g.y),a.draw(S,{justify:v})};const E=(S,C)=>{const T=O(S,C);if(!i.index.bboxCollides(T,i.order))return[{anchor:r,bboxes:[T],draw:y}]};for(let S of p){const C=this.computeXAxisOffset(k,l,S),T=this.computeYAxisOffset(A,l,S);return v=this.computeJustify(d,S),g=new Kt.default(C,T),E(r,g)}}computeXAxisOffset(i,t,n){const r=t.maxX,s=r/2;return[1,5].includes(n)?i-s:[8,7,6].includes(n)?i-r:i}computeYAxisOffset(i,t,n){const r=Math.abs(t.minY),s=t.maxY,a=(t.minY+t.maxY)/2;return[3,7].includes(n)?i-a:[8,2,1].includes(n)?i-s:[6,4,5].includes(n)?i+r:i}computeJustify(i,t){return i||([1,5].includes(t)?2:[2,3,4].includes(t)?1:3)}},Dn=class{constructor(i){this.symbolizer=new wp(new Eo(i),i)}place(i,t,n){return this.symbolizer.place(i,t,n)}},Ea;(function(i){i[i.Above=1]="Above",i[i.Center=2]="Center",i[i.Below=3]="Below"})(Ea||(Ea={}));var xp=class{constructor(i){var t;this.font=new Lo(i),this.text=new Po(i),this.fill=new Nt(i.fill,"black"),this.stroke=new Nt(i.stroke,"black"),this.width=new gt(i.width,0),this.offset=new gt(i.offset,0),this.position=(t=i.position)!=null?t:1,this.maxLabelCodeUnits=new gt(i.maxLabelChars,40),this.repeatDistance=new gt(i.repeatDistance,250)}place(i,t,n){let r=this.text.get(i.zoom,n);if(!r||r.length>this.maxLabelCodeUnits.get(i.zoom,n))return;let s=20,a=n.bbox;if(a.maxY-a.minY<s&&a.maxX-a.minX<s)return;let l=this.font.get(i.zoom,n);i.scratch.font=l;let u=i.scratch.measureText(r),c=u.width,d=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent;var p=this.repeatDistance.get(i.zoom,n);i.overzoom>4&&(p*=1<<i.overzoom-4);let _=d*2,w=dp(t,c,p,_);if(w.length==0)return;let M=[];for(let P of w){let k=P.end.x-P.start.x,A=P.end.y-P.start.y,g=pp(P.start,P.end,c,_/2).map(y=>({minX:y.x-_/2,minY:y.y-_/2,maxX:y.x+_/2,maxY:y.y+_/2})),v=y=>{y.globalAlpha=1,y.rotate(Math.atan2(A,k)),k<0&&(y.scale(-1,-1),y.translate(-c,0));let E=0;this.position===3?E+=d:this.position===2&&(E+=d/2),y.translate(0,E-this.offset.get(i.zoom,n)),y.font=l;let S=this.width.get(i.zoom,n);S&&(y.lineWidth=S,y.strokeStyle=this.stroke.get(i.zoom,n),y.strokeText(r,0,0)),y.fillStyle=this.fill.get(i.zoom,n),y.fillText(r,0,0)};M.push({anchor:P.start,bboxes:g,draw:v,deduplicationKey:r,deduplicationDistance:p})}return M}},Ur=class{constructor(i){this.symbolizer=new Eo(i)}place(i,t,n){let r=n.bbox;if((r.maxY-r.minY)*(r.maxX-r.minX)<2e4)return;let a=this.symbolizer.place(i,[[new Kt.default(0,0)]],n);if(!a||a.length==0)return;let l=a[0],u=l.bboxes[0],c=t[0],d=(0,up.default)([c.map(M=>[M.x,M.y])]),p=new Kt.default(d[0],d[1]),_={minX:p.x-(u.maxX-u.minX)/2,minY:p.y-(u.maxY-u.minY)/2,maxX:p.x+(u.maxX-u.minX)/2,maxY:p.y+(u.maxY-u.minY)/2};return[{anchor:p,bboxes:[_],draw:M=>{M.translate(l.anchor.x-(u.maxX-u.minX)/2,l.anchor.y),l.draw(M)}}]}},tl=(i,t)=>{let n=wa(t),r=Yf({},i);for(const[s,a]of Object.entries(i)){let l=wa(a);r[s]=lp(n[0],n[1],l[2],l[3])}return r},Sa=(i,t)=>(t&&(i=tl(i,t)),[{dataLayer:"earth",symbolizer:new Dt({fill:i.earth})},{dataLayer:"natural",symbolizer:new Dt({fill:i.glacier}),filter:(n,r)=>r.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.residential}),filter:(n,r)=>r.props.landuse=="residential"||r.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.hospital}),filter:(n,r)=>r.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.cemetery}),filter:(n,r)=>r.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.school}),filter:(n,r)=>r.props.amenity=="school"||r.props.amenity=="kindergarten"||r.props.amenity=="university"||r.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.industrial}),filter:(n,r)=>r.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new Dt({fill:i.wood}),filter:(n,r)=>r.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.grass}),filter:(n,r)=>r.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new Dt({fill:i.park}),filter:(n,r)=>r.props.leisure=="park"},{dataLayer:"water",symbolizer:new Dt({fill:i.water})},{dataLayer:"natural",symbolizer:new Dt({fill:i.sand}),filter:(n,r)=>r.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new Dt({fill:i.buildings})},{dataLayer:"roads",symbolizer:new re({color:i.highwayCasing,width:be(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new re({color:i.majorRoadCasing,width:be(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:i.mediumRoadCasing,width:be(1.4,[[13,3],[17,6],[20,18]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:i.minorRoadCasing,width:be(1.4,[[14,2],[17,5],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:i.minorRoad,width:be(1.4,[[14,1],[17,3],[20,13]])}),filter:(n,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new re({color:i.mediumRoad,width:be(1.4,[[13,2],[17,4],[20,15]])}),filter:(n,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new re({color:i.majorRoad,width:be(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(n,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new re({color:i.highway,width:be(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(n,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new re({color:i.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new Dt({fill:i.mask})}]),Ca=(i,t,n,r)=>{t&&(i=tl(i,t));var s=["name"];n&&(s=n);let a=(l,u)=>r?l instanceof Dn?new Pa([l,new Dn({fill:u,label_props:r})]):new Pa([l,new Ti({fill:u,label_props:r})]):l;return[{dataLayer:"places",symbolizer:a(new Ti({label_props:s,fill:i.countryLabel,lineHeight:1.5,font:(l,u)=>l<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),i.countryLabel),filter:(l,u)=>u.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:a(new Ti({label_props:s,fill:i.stateLabel,font:"300 16px sans-serif"}),i.stateLabel),filter:(l,u)=>u.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",minzoom:7,symbolizer:a(new Ti({label_props:s,fill:i.cityLabel,font:(l,u)=>u?.props["pmap:rank"]===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(l,u)=>u.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new La([new ho({radius:2,fill:i.cityLabel}),a(new Dn({label_props:s,fill:i.cityLabel,offsetX:2,offsetY:2,font:(l,u)=>u?.props["pmap:rank"]===1?l>8?"600 20px sans-serif":"600 12px sans-serif":l>8?"600 16px sans-serif":"600 10px sans-serif"}),i.cityLabel)]),sort:(l,u)=>l["pmap:rank"]-u["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new Ti({label_props:s,fill:i.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),i.neighbourhoodLabel),filter:(l,u)=>u.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new Ur({label_props:s,fill:i.landuseLabel,font:"300 12px sans-serif"}),i.landuseLabel)},{dataLayer:"water",symbolizer:a(new Ur({label_props:s,fill:i.waterLabel,font:"italic 600 12px sans-serif"}),i.waterLabel)},{dataLayer:"natural",symbolizer:a(new Ur({label_props:s,fill:i.naturalLabel,font:"italic 300 12px sans-serif"}),i.naturalLabel)},{dataLayer:"roads",symbolizer:a(new xp({label_props:s,fill:i.roadsLabel,font:"500 12px sans-serif"}),i.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new vp({label_props:["ref"],font:"600 9px sans-serif",background:i.highway,padding:2,fill:i.neighbourhoodLabel}),filter:(l,u)=>u.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new La([new ho({radius:2,fill:i.poisLabel}),a(new Dn({label_props:s,fill:i.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),i.poisLabel)])}]},ka=(i,t,n)=>[{dataSource:i,dataLayer:t,symbolizer:new ho({opacity:.2,fill:n,radius:4}),filter:(r,s)=>s.geomType==ri.Point},{dataSource:i,dataLayer:t,symbolizer:new re({opacity:.2,color:n,width:2}),filter:(r,s)=>s.geomType==ri.Line},{dataSource:i,dataLayer:t,symbolizer:new Dt({opacity:.2,fill:n,stroke:n,width:1}),filter:(r,s)=>s.geomType==ri.Polygon}],bp=(i,t)=>{var n=[];for(var[r,s]of i)for(var a of s)for(var l of a.data.keys())r===t.dataSource&&l===t.dataLayer||(n=n.concat(ka(r,l,"steelblue")));return n=n.concat(ka(t.dataSource||"",t.dataLayer,"red")),n},Mp=Xt(ve()),Pp=i=>new Promise((t,n)=>{setTimeout(()=>{t()},i)}),Lp=i=>i.then(t=>({status:"fulfilled",value:t}),t=>({status:"rejected",reason:t})),Ep=(i={})=>{class t extends L.GridLayer{constructor(r={}){r.noWrap&&!r.bounds&&(r.bounds=[[-90,-180],[90,180]]),r.attribution==null&&(r.attribution='<a href="https://protomaps.com">Protomaps</a>  <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(r);let s=r.dark?ga:_a;this.paint_rules=r.paint_rules||Sa(s,r.shade),this.label_rules=r.label_rules||Ca(s,r.shade,r.language1,r.language2),this.backgroundColor=r.backgroundColor,this.lastRequestedZ=void 0,this.xray=r.xray,this.tasks=r.tasks||[],this.views=Hd(r),this.debug=r.debug;let a=document.createElement("canvas").getContext("2d");this.scratch=a,this.onTilesInvalidated=l=>{l.forEach(u=>{this.rerenderTile(u)})},this.labelers=new ma(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=r.tileDelay||3,this.lang=r.lang,this.inspector=this.inspect(this)}setDefaultStyle(r,s,a,l){let u=r?ga:_a;this.paint_rules=Sa(u,s),this.label_rules=Ca(u,s,a,l)}renderTile(r,s,a,l=()=>{}){return ai(this,null,function*(){this.lastRequestedZ=r.z;let u=[];for(const[C,T]of this.views){let z=T.getDisplayTile(r);u.push({key:C,promise:z})}let c=yield Promise.all(u.map(C=>C.promise.then(T=>({status:"fulfilled",value:T,key:C.key}),T=>({status:"rejected",reason:T,key:C.key})))),d=new Map;for(const C of c)C.status==="fulfilled"?d.set(C.key,[C.value]):C.reason.name==="AbortError"||console.error(C.reason);if(s.key!=a||this.lastRequestedZ!==r.z||(yield Promise.all(this.tasks.map(Lp)),s.key!=a)||this.lastRequestedZ!==r.z)return;let p=this.labelers.add(r.z,d);if(s.key!=a||this.lastRequestedZ!==r.z)return;let _=this.labelers.getIndex(r.z);if(!this._map)return;let w=this._map.getCenter().wrap(),M=this._getTiledPixelBounds(w),P=this._pxBoundsToTileRange(M),k=P.getCenter(),A=r.distanceTo(k)*this.tileDelay;if(yield Pp(A),s.key!=a||this.lastRequestedZ!==r.z)return;let O=16,g={minX:256*r.x-O,minY:256*r.y-O,maxX:256*(r.x+1)+O,maxY:256*(r.y+1)+O},v=new Mp.default(256*r.x,256*r.y);s.width=this.tile_size,s.height=this.tile_size;let y=s.getContext("2d");y.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),y.clearRect(0,0,256,256),this.backgroundColor&&(y.save(),y.fillStyle=this.backgroundColor,y.fillRect(0,0,256,256),y.restore());var E=0;let S=this.paint_rules;if(this.xray&&(S=bp(d,this.xray)),E=Gd(y,r.z,d,this.xray?null:_,S,g,v,!1,this.debug),this.debug){y.save(),y.fillStyle=this.debug,y.font="600 12px sans-serif",y.fillText(r.z+" "+r.x+" "+r.y,4,14),y.font="12px sans-serif";let C=28;for(let[T,z]of d){let N=z[0].data_tile;y.fillText(T+(T?" ":"")+N.z+" "+N.x+" "+N.y,4,C),C+=14}y.font="600 10px sans-serif",E>8&&(y.fillText(E.toFixed()+" ms paint",4,C),C+=14),p>8&&y.fillText(p.toFixed()+" ms layout",4,C),y.strokeStyle=this.debug,y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(0,256),y.stroke(),y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(256,0),y.stroke(),y.restore()}l()})}rerenderTile(r){for(let s in this._tiles){let a=this._wrapCoords(this._keyToTileCoords(s));r===this._tileCoordsToKey(a)&&this.renderTile(a,this._tiles[s].el,r)}}clearLayout(){this.labelers=new ma(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let r in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(r)),a=this._tileCoordsToKey(s);this.renderTile(s,this._tiles[r].el,a)}}createTile(r,s){let a=L.DomUtil.create("canvas","leaflet-tile");a.lang=this.lang;let l=this._tileCoordsToKey(r);return a.key=l,this.renderTile(r,a,l,()=>{s(null,a)}),a}_removeTile(r){let s=this._tiles[r];s&&(s.el.removed=!0,s.el.key=void 0,L.DomUtil.removeClass(s.el,"leaflet-tile-loaded"),s.el.width=s.el.height=0,L.DomUtil.remove(s.el),delete this._tiles[r],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(r)}))}queryFeatures(r,s){let a=new Map;for(var[l,u]of this.views)a.set(l,u.queryFeatures(r,s,this._map.getZoom()));return a}inspect(r){return s=>{let a=["","",""],l=r._map.wrapLatLng(s.latlng),u=r.queryFeatures(l.lng,l.lat);var c="";let d=!0;for(var[p,_]of u)for(var w of _)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===p&&this.xray.dataLayer===w.layerName))){c=c+`<div style="margin-top:${d?0:.5}em">${a[w.feature.geomType-1]} <b>${p} ${p?"/":""} ${w.layerName}</b> ${w.feature.id||""}</div>`;for(const M in w.feature.props)c=c+`<div style="font-size:0.9em">${M} = ${w.feature.props[M]}</div>`;d=!1}d&&(c="No features."),L.popup().setLatLng(s.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+c+"</div>").openOn(r._map)}}addInspector(r){return r.on("click",this.inspector)}removeInspector(r){return r.off("click",this.inspector)}}return new t(i)};function Sp({L:i,id:t,lat:n,lng:r,zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:c}){const d=i.map(t,{center:[n,r],zoom:s,minZoom:a,maxZoom:l,tapTolerance:u,maxBounds:c});return Ep({url:"https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf?key=d23c43b7c56e123d"}).addTo(d),d}var Fi={exports:{}};var Cp=Fi.exports,Ta;function kp(){return Ta||(Ta=1,(function(i,t){(function(n,r){r(t)})(Cp,(function(n){var r="1.9.4";function s(e){var o,h,f,m;for(h=1,f=arguments.length;h<f;h++){m=arguments[h];for(o in m)e[o]=m[o]}return e}var a=Object.create||(function(){function e(){}return function(o){return e.prototype=o,new e}})();function l(e,o){var h=Array.prototype.slice;if(e.bind)return e.bind.apply(e,h.call(arguments,1));var f=h.call(arguments,2);return function(){return e.apply(o,f.length?f.concat(h.call(arguments)):arguments)}}var u=0;function c(e){return"_leaflet_id"in e||(e._leaflet_id=++u),e._leaflet_id}function d(e,o,h){var f,m,b,D;return D=function(){f=!1,m&&(b.apply(h,m),m=!1)},b=function(){f?m=arguments:(e.apply(h,arguments),setTimeout(D,o),f=!0)},b}function p(e,o,h){var f=o[1],m=o[0],b=f-m;return e===f&&h?e:((e-m)%b+b)%b+m}function _(){return!1}function w(e,o){if(o===!1)return e;var h=Math.pow(10,o===void 0?6:o);return Math.round(e*h)/h}function M(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function P(e){return M(e).split(/\s+/)}function k(e,o){Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?a(e.options):{});for(var h in o)e.options[h]=o[h];return e.options}function A(e,o,h){var f=[];for(var m in e)f.push(encodeURIComponent(h?m.toUpperCase():m)+"="+encodeURIComponent(e[m]));return(!o||o.indexOf("?")===-1?"?":"&")+f.join("&")}var O=/\{ *([\w_ -]+) *\}/g;function g(e,o){return e.replace(O,function(h,f){var m=o[f];if(m===void 0)throw new Error("No value provided for variable "+h);return typeof m=="function"&&(m=m(o)),m})}var v=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function y(e,o){for(var h=0;h<e.length;h++)if(e[h]===o)return h;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function S(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var C=0;function T(e){var o=+new Date,h=Math.max(0,16-(o-C));return C=o+h,window.setTimeout(e,h)}var z=window.requestAnimationFrame||S("RequestAnimationFrame")||T,N=window.cancelAnimationFrame||S("CancelAnimationFrame")||S("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function Z(e,o,h){if(h&&z===T)e.call(o);else return z.call(window,l(e,o))}function j(e){e&&N.call(window,e)}var U={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:c,throttle:d,wrapNum:p,falseFn:_,formatNum:w,trim:M,splitWords:P,setOptions:k,getParamString:A,template:g,isArray:v,indexOf:y,emptyImageUrl:E,requestFn:z,cancelFn:N,requestAnimFrame:Z,cancelAnimFrame:j};function x(){}x.extend=function(e){var o=function(){k(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=o.__super__=this.prototype,f=a(h);f.constructor=o,o.prototype=f;for(var m in this)Object.prototype.hasOwnProperty.call(this,m)&&m!=="prototype"&&m!=="__super__"&&(o[m]=this[m]);return e.statics&&s(o,e.statics),e.includes&&(I(e.includes),s.apply(null,[f].concat(e.includes))),s(f,e),delete f.statics,delete f.includes,f.options&&(f.options=h.options?a(h.options):{},s(f.options,e.options)),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var b=0,D=f._initHooks.length;b<D;b++)f._initHooks[b].call(this)}},o},x.include=function(e){var o=this.prototype.options;return s(this.prototype,e),e.options&&(this.prototype.options=o,this.mergeOptions(e.options)),this},x.mergeOptions=function(e){return s(this.prototype.options,e),this},x.addInitHook=function(e){var o=Array.prototype.slice.call(arguments,1),h=typeof e=="function"?e:function(){this[e].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function I(e){if(!(typeof L>"u"||!L||!L.Mixin)){e=v(e)?e:[e];for(var o=0;o<e.length;o++)e[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var B={on:function(e,o,h){if(typeof e=="object")for(var f in e)this._on(f,e[f],o);else{e=P(e);for(var m=0,b=e.length;m<b;m++)this._on(e[m],o,h)}return this},off:function(e,o,h){if(!arguments.length)delete this._events;else if(typeof e=="object")for(var f in e)this._off(f,e[f],o);else{e=P(e);for(var m=arguments.length===1,b=0,D=e.length;b<D;b++)m?this._off(e[b]):this._off(e[b],o,h)}return this},_on:function(e,o,h,f){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(e,o,h)===!1){h===this&&(h=void 0);var m={fn:o,ctx:h};f&&(m.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(m)}},_off:function(e,o,h){var f,m,b;if(this._events&&(f=this._events[e],!!f)){if(arguments.length===1){if(this._firingCount)for(m=0,b=f.length;m<b;m++)f[m].fn=_;delete this._events[e];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var D=this._listens(e,o,h);if(D!==!1){var F=f[D];this._firingCount&&(F.fn=_,this._events[e]=f=f.slice()),f.splice(D,1)}}},fire:function(e,o,h){if(!this.listens(e,h))return this;var f=s({},o,{type:e,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var m=this._events[e];if(m){this._firingCount=this._firingCount+1||1;for(var b=0,D=m.length;b<D;b++){var F=m[b],Y=F.fn;F.once&&this.off(e,Y,F.ctx),Y.call(F.ctx||this,f)}this._firingCount--}}return h&&this._propagateEvent(f),this},listens:function(e,o,h,f){typeof e!="string"&&console.warn('"string" type argument expected');var m=o;typeof o!="function"&&(f=!!o,m=void 0,h=void 0);var b=this._events&&this._events[e];if(b&&b.length&&this._listens(e,m,h)!==!1)return!0;if(f){for(var D in this._eventParents)if(this._eventParents[D].listens(e,o,h,f))return!0}return!1},_listens:function(e,o,h){if(!this._events)return!1;var f=this._events[e]||[];if(!o)return!!f.length;h===this&&(h=void 0);for(var m=0,b=f.length;m<b;m++)if(f[m].fn===o&&f[m].ctx===h)return m;return!1},once:function(e,o,h){if(typeof e=="object")for(var f in e)this._on(f,e[f],o,!0);else{e=P(e);for(var m=0,b=e.length;m<b;m++)this._on(e[m],o,h,!0)}return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[c(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[c(e)],this},_propagateEvent:function(e){for(var o in this._eventParents)this._eventParents[o].fire(e.type,s({layer:e.target,propagatedFrom:e.target},e),!0)}};B.addEventListener=B.on,B.removeEventListener=B.clearAllEventListeners=B.off,B.addOneTimeEventListener=B.once,B.fireEvent=B.fire,B.hasEventListeners=B.listens;var V=x.extend(B);function X(e,o,h){this.x=h?Math.round(e):e,this.y=h?Math.round(o):o}var G=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(e){return this.clone()._add(R(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(R(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new X(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new X(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=G(this.x),this.y=G(this.y),this},distanceTo:function(e){e=R(e);var o=e.x-this.x,h=e.y-this.y;return Math.sqrt(o*o+h*h)},equals:function(e){return e=R(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=R(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function R(e,o,h){return e instanceof X?e:v(e)?new X(e[0],e[1]):e==null?e:typeof e=="object"&&"x"in e&&"y"in e?new X(e.x,e.y):new X(e,o,h)}function $(e,o){if(e)for(var h=o?[e,o]:e,f=0,m=h.length;f<m;f++)this.extend(h[f])}$.prototype={extend:function(e){var o,h;if(!e)return this;if(e instanceof X||typeof e[0]=="number"||"x"in e)o=h=R(e);else if(e=H(e),o=e.min,h=e.max,!o||!h)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=h.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(e){return R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return R(this.min.x,this.max.y)},getTopRight:function(){return R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var o,h;return typeof e[0]=="number"||e instanceof X?e=R(e):e=H(e),e instanceof $?(o=e.min,h=e.max):o=h=e,o.x>=this.min.x&&h.x<=this.max.x&&o.y>=this.min.y&&h.y<=this.max.y},intersects:function(e){e=H(e);var o=this.min,h=this.max,f=e.min,m=e.max,b=m.x>=o.x&&f.x<=h.x,D=m.y>=o.y&&f.y<=h.y;return b&&D},overlaps:function(e){e=H(e);var o=this.min,h=this.max,f=e.min,m=e.max,b=m.x>o.x&&f.x<h.x,D=m.y>o.y&&f.y<h.y;return b&&D},isValid:function(){return!!(this.min&&this.max)},pad:function(e){var o=this.min,h=this.max,f=Math.abs(o.x-h.x)*e,m=Math.abs(o.y-h.y)*e;return H(R(o.x-f,o.y-m),R(h.x+f,h.y+m))},equals:function(e){return e?(e=H(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight())):!1}};function H(e,o){return!e||e instanceof $?e:new $(e,o)}function et(e,o){if(e)for(var h=o?[e,o]:e,f=0,m=h.length;f<m;f++)this.extend(h[f])}et.prototype={extend:function(e){var o=this._southWest,h=this._northEast,f,m;if(e instanceof K)f=e,m=e;else if(e instanceof et){if(f=e._southWest,m=e._northEast,!f||!m)return this}else return e?this.extend(q(e)||Q(e)):this;return!o&&!h?(this._southWest=new K(f.lat,f.lng),this._northEast=new K(m.lat,m.lng)):(o.lat=Math.min(f.lat,o.lat),o.lng=Math.min(f.lng,o.lng),h.lat=Math.max(m.lat,h.lat),h.lng=Math.max(m.lng,h.lng)),this},pad:function(e){var o=this._southWest,h=this._northEast,f=Math.abs(o.lat-h.lat)*e,m=Math.abs(o.lng-h.lng)*e;return new et(new K(o.lat-f,o.lng-m),new K(h.lat+f,h.lng+m))},getCenter:function(){return new K((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new K(this.getNorth(),this.getWest())},getSouthEast:function(){return new K(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof K||"lat"in e?e=q(e):e=Q(e);var o=this._southWest,h=this._northEast,f,m;return e instanceof et?(f=e.getSouthWest(),m=e.getNorthEast()):f=m=e,f.lat>=o.lat&&m.lat<=h.lat&&f.lng>=o.lng&&m.lng<=h.lng},intersects:function(e){e=Q(e);var o=this._southWest,h=this._northEast,f=e.getSouthWest(),m=e.getNorthEast(),b=m.lat>=o.lat&&f.lat<=h.lat,D=m.lng>=o.lng&&f.lng<=h.lng;return b&&D},overlaps:function(e){e=Q(e);var o=this._southWest,h=this._northEast,f=e.getSouthWest(),m=e.getNorthEast(),b=m.lat>o.lat&&f.lat<h.lat,D=m.lng>o.lng&&f.lng<h.lng;return b&&D},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,o){return e?(e=Q(e),this._southWest.equals(e.getSouthWest(),o)&&this._northEast.equals(e.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(e,o){return e instanceof et?e:new et(e,o)}function K(e,o,h){if(isNaN(e)||isNaN(o))throw new Error("Invalid LatLng object: ("+e+", "+o+")");this.lat=+e,this.lng=+o,h!==void 0&&(this.alt=+h)}K.prototype={equals:function(e,o){if(!e)return!1;e=q(e);var h=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return h<=(o===void 0?1e-9:o)},toString:function(e){return"LatLng("+w(this.lat,e)+", "+w(this.lng,e)+")"},distanceTo:function(e){return ut.distance(this,q(e))},wrap:function(){return ut.wrapLatLng(this)},toBounds:function(e){var o=180*e/40075017,h=o/Math.cos(Math.PI/180*this.lat);return Q([this.lat-o,this.lng-h],[this.lat+o,this.lng+h])},clone:function(){return new K(this.lat,this.lng,this.alt)}};function q(e,o,h){return e instanceof K?e:v(e)&&typeof e[0]!="object"?e.length===3?new K(e[0],e[1],e[2]):e.length===2?new K(e[0],e[1]):null:e==null?e:typeof e=="object"&&"lat"in e?new K(e.lat,"lng"in e?e.lng:e.lon,e.alt):o===void 0?null:new K(e,o,h)}var ot={latLngToPoint:function(e,o){var h=this.projection.project(e),f=this.scale(o);return this.transformation._transform(h,f)},pointToLatLng:function(e,o){var h=this.scale(o),f=this.transformation.untransform(e,h);return this.projection.unproject(f)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var o=this.projection.bounds,h=this.scale(e),f=this.transformation.transform(o.min,h),m=this.transformation.transform(o.max,h);return new $(f,m)},infinite:!1,wrapLatLng:function(e){var o=this.wrapLng?p(e.lng,this.wrapLng,!0):e.lng,h=this.wrapLat?p(e.lat,this.wrapLat,!0):e.lat,f=e.alt;return new K(h,o,f)},wrapLatLngBounds:function(e){var o=e.getCenter(),h=this.wrapLatLng(o),f=o.lat-h.lat,m=o.lng-h.lng;if(f===0&&m===0)return e;var b=e.getSouthWest(),D=e.getNorthEast(),F=new K(b.lat-f,b.lng-m),Y=new K(D.lat-f,D.lng-m);return new et(F,Y)}},ut=s({},ot,{wrapLng:[-180,180],R:6371e3,distance:function(e,o){var h=Math.PI/180,f=e.lat*h,m=o.lat*h,b=Math.sin((o.lat-e.lat)*h/2),D=Math.sin((o.lng-e.lng)*h/2),F=b*b+Math.cos(f)*Math.cos(m)*D*D,Y=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return this.R*Y}}),dt=6378137,xt={R:dt,MAX_LATITUDE:85.0511287798,project:function(e){var o=Math.PI/180,h=this.MAX_LATITUDE,f=Math.max(Math.min(h,e.lat),-h),m=Math.sin(f*o);return new X(this.R*e.lng*o,this.R*Math.log((1+m)/(1-m))/2)},unproject:function(e){var o=180/Math.PI;return new K((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*o,e.x*o/this.R)},bounds:(function(){var e=dt*Math.PI;return new $([-e,-e],[e,e])})()};function bt(e,o,h,f){if(v(e)){this._a=e[0],this._b=e[1],this._c=e[2],this._d=e[3];return}this._a=e,this._b=o,this._c=h,this._d=f}bt.prototype={transform:function(e,o){return this._transform(e.clone(),o)},_transform:function(e,o){return o=o||1,e.x=o*(this._a*e.x+this._b),e.y=o*(this._c*e.y+this._d),e},untransform:function(e,o){return o=o||1,new X((e.x/o-this._b)/this._a,(e.y/o-this._d)/this._c)}};function St(e,o,h,f){return new bt(e,o,h,f)}var Mt=s({},ut,{code:"EPSG:3857",projection:xt,transformation:(function(){var e=.5/(Math.PI*xt.R);return St(e,.5,-e,.5)})()}),Ct=s({},Mt,{code:"EPSG:900913"});function Lt(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Ot(e,o){var h="",f,m,b,D,F,Y;for(f=0,b=e.length;f<b;f++){for(F=e[f],m=0,D=F.length;m<D;m++)Y=F[m],h+=(m?"L":"M")+Y.x+" "+Y.y;h+=o?tt.svg?"z":"x":""}return h||"M0 0"}var kt=document.documentElement.style,Rt="ActiveXObject"in window,Pe=Rt&&!document.addEventListener,en="msLaunchUri"in navigator&&!("documentMode"in document),hi=te("webkit"),nn=te("android"),rn=te("android 2")||te("android 3"),on=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),sn=nn&&te("Google")&&on<537&&!("AudioNode"in window),Le=!!window.opera,Co=!en&&te("chrome"),ko=te("gecko")&&!hi&&!Le&&!Rt,bl=!Co&&te("safari"),To=te("phantom"),Do="OTransition"in kt,Ml=navigator.platform.indexOf("Win")===0,Ao=Rt&&"transition"in kt,rr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rn,Oo="MozPerspective"in kt,Pl=!window.L_DISABLE_3D&&(Ao||rr||Oo)&&!Do&&!To,li=typeof orientation<"u"||te("mobile"),Ll=li&&hi,El=li&&rr,Io=!window.PointerEvent&&window.MSPointerEvent,Bo=!!(window.PointerEvent||Io),zo="ontouchstart"in window||!!window.TouchEvent,Sl=!window.L_NO_TOUCH&&(zo||Bo),Cl=li&&Le,kl=li&&ko,Tl=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Dl=(function(){var e=!1;try{var o=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",_,o),window.removeEventListener("testPassiveEventSupport",_,o)}catch{}return e})(),Al=(function(){return!!document.createElement("canvas").getContext})(),or=!!(document.createElementNS&&Lt("svg").createSVGRect),Ol=!!or&&(function(){var e=document.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Il=!or&&(function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var o=e.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}})(),Bl=navigator.platform.indexOf("Mac")===0,zl=navigator.platform.indexOf("Linux")===0;function te(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var tt={ie:Rt,ielt9:Pe,edge:en,webkit:hi,android:nn,android23:rn,androidStock:sn,opera:Le,chrome:Co,gecko:ko,safari:bl,phantom:To,opera12:Do,win:Ml,ie3d:Ao,webkit3d:rr,gecko3d:Oo,any3d:Pl,mobile:li,mobileWebkit:Ll,mobileWebkit3d:El,msPointer:Io,pointer:Bo,touch:Sl,touchNative:zo,mobileOpera:Cl,mobileGecko:kl,retina:Tl,passiveEvents:Dl,canvas:Al,svg:or,vml:Il,inlineSvg:Ol,mac:Bl,linux:zl},Fo=tt.msPointer?"MSPointerDown":"pointerdown",No=tt.msPointer?"MSPointerMove":"pointermove",Ro=tt.msPointer?"MSPointerUp":"pointerup",Zo=tt.msPointer?"MSPointerCancel":"pointercancel",sr={touchstart:Fo,touchmove:No,touchend:Ro,touchcancel:Zo},Yo={touchstart:Xl,touchmove:an,touchend:an,touchcancel:an},ze={},Xo=!1;function Fl(e,o,h){return o==="touchstart"&&Yl(),Yo[o]?(h=Yo[o].bind(this,h),e.addEventListener(sr[o],h,!1),h):(console.warn("wrong event specified:",o),_)}function Nl(e,o,h){if(!sr[o]){console.warn("wrong event specified:",o);return}e.removeEventListener(sr[o],h,!1)}function Rl(e){ze[e.pointerId]=e}function Zl(e){ze[e.pointerId]&&(ze[e.pointerId]=e)}function Uo(e){delete ze[e.pointerId]}function Yl(){Xo||(document.addEventListener(Fo,Rl,!0),document.addEventListener(No,Zl,!0),document.addEventListener(Ro,Uo,!0),document.addEventListener(Zo,Uo,!0),Xo=!0)}function an(e,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var h in ze)o.touches.push(ze[h]);o.changedTouches=[o],e(o)}}function Xl(e,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&Et(o),an(e,o)}function Ul(e){var o={},h,f;for(f in e)h=e[f],o[f]=h&&h.bind?h.bind(e):h;return e=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var jl=200;function Wl(e,o){e.addEventListener("dblclick",o);var h=0,f;function m(b){if(b.detail!==1){f=b.detail;return}if(!(b.pointerType==="mouse"||b.sourceCapabilities&&!b.sourceCapabilities.firesTouchEvents)){var D=$o(b);if(!(D.some(function(Y){return Y instanceof HTMLLabelElement&&Y.attributes.for})&&!D.some(function(Y){return Y instanceof HTMLInputElement||Y instanceof HTMLSelectElement}))){var F=Date.now();F-h<=jl?(f++,f===2&&o(Ul(b))):f=1,h=F}}}return e.addEventListener("click",m),{dblclick:o,simDblclick:m}}function Vl(e,o){e.removeEventListener("dblclick",o.dblclick),e.removeEventListener("click",o.simDblclick)}var ar=un(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ui=un(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),jo=ui==="webkitTransition"||ui==="OTransition"?ui+"End":"transitionend";function Wo(e){return typeof e=="string"?document.getElementById(e):e}function ci(e,o){var h=e.style[o]||e.currentStyle&&e.currentStyle[o];if((!h||h==="auto")&&document.defaultView){var f=document.defaultView.getComputedStyle(e,null);h=f?f[o]:null}return h==="auto"?null:h}function ct(e,o,h){var f=document.createElement(e);return f.className=o||"",h&&h.appendChild(f),f}function mt(e){var o=e.parentNode;o&&o.removeChild(e)}function hn(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Fe(e){var o=e.parentNode;o&&o.lastChild!==e&&o.appendChild(e)}function Ne(e){var o=e.parentNode;o&&o.firstChild!==e&&o.insertBefore(e,o.firstChild)}function hr(e,o){if(e.classList!==void 0)return e.classList.contains(o);var h=ln(e);return h.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(h)}function at(e,o){if(e.classList!==void 0)for(var h=P(o),f=0,m=h.length;f<m;f++)e.classList.add(h[f]);else if(!hr(e,o)){var b=ln(e);lr(e,(b?b+" ":"")+o)}}function _t(e,o){e.classList!==void 0?e.classList.remove(o):lr(e,M((" "+ln(e)+" ").replace(" "+o+" "," ")))}function lr(e,o){e.className.baseVal===void 0?e.className=o:e.className.baseVal=o}function ln(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Ut(e,o){"opacity"in e.style?e.style.opacity=o:"filter"in e.style&&Hl(e,o)}function Hl(e,o){var h=!1,f="DXImageTransform.Microsoft.Alpha";try{h=e.filters.item(f)}catch{if(o===1)return}o=Math.round(o*100),h?(h.Enabled=o!==100,h.Opacity=o):e.style.filter+=" progid:"+f+"(opacity="+o+")"}function un(e){for(var o=document.documentElement.style,h=0;h<e.length;h++)if(e[h]in o)return e[h];return!1}function Ee(e,o,h){var f=o||new X(0,0);e.style[ar]=(tt.ie3d?"translate("+f.x+"px,"+f.y+"px)":"translate3d("+f.x+"px,"+f.y+"px,0)")+(h?" scale("+h+")":"")}function vt(e,o){e._leaflet_pos=o,tt.any3d?Ee(e,o):(e.style.left=o.x+"px",e.style.top=o.y+"px")}function Se(e){return e._leaflet_pos||new X(0,0)}var fi,di,ur;if("onselectstart"in document)fi=function(){st(window,"selectstart",Et)},di=function(){pt(window,"selectstart",Et)};else{var pi=un(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);fi=function(){if(pi){var e=document.documentElement.style;ur=e[pi],e[pi]="none"}},di=function(){pi&&(document.documentElement.style[pi]=ur,ur=void 0)}}function cr(){st(window,"dragstart",Et)}function fr(){pt(window,"dragstart",Et)}var cn,dr;function pr(e){for(;e.tabIndex===-1;)e=e.parentNode;e.style&&(fn(),cn=e,dr=e.style.outlineStyle,e.style.outlineStyle="none",st(window,"keydown",fn))}function fn(){cn&&(cn.style.outlineStyle=dr,cn=void 0,dr=void 0,pt(window,"keydown",fn))}function Vo(e){do e=e.parentNode;while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function mr(e){var o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}var $l={__proto__:null,TRANSFORM:ar,TRANSITION:ui,TRANSITION_END:jo,get:Wo,getStyle:ci,create:ct,remove:mt,empty:hn,toFront:Fe,toBack:Ne,hasClass:hr,addClass:at,removeClass:_t,setClass:lr,getClass:ln,setOpacity:Ut,testProp:un,setTransform:Ee,setPosition:vt,getPosition:Se,get disableTextSelection(){return fi},get enableTextSelection(){return di},disableImageDrag:cr,enableImageDrag:fr,preventOutline:pr,restoreOutline:fn,getSizedParentNode:Vo,getScale:mr};function st(e,o,h,f){if(o&&typeof o=="object")for(var m in o)gr(e,m,o[m],h);else{o=P(o);for(var b=0,D=o.length;b<D;b++)gr(e,o[b],h,f)}return this}var ee="_leaflet_events";function pt(e,o,h,f){if(arguments.length===1)Ho(e),delete e[ee];else if(o&&typeof o=="object")for(var m in o)vr(e,m,o[m],h);else if(o=P(o),arguments.length===2)Ho(e,function(F){return y(o,F)!==-1});else for(var b=0,D=o.length;b<D;b++)vr(e,o[b],h,f);return this}function Ho(e,o){for(var h in e[ee]){var f=h.split(/\d/)[0];(!o||o(f))&&vr(e,f,null,null,h)}}var _r={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function gr(e,o,h,f){var m=o+c(h)+(f?"_"+c(f):"");if(e[ee]&&e[ee][m])return this;var b=function(F){return h.call(f||e,F||window.event)},D=b;!tt.touchNative&&tt.pointer&&o.indexOf("touch")===0?b=Fl(e,o,b):tt.touch&&o==="dblclick"?b=Wl(e,b):"addEventListener"in e?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?e.addEventListener(_r[o]||o,b,tt.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(b=function(F){F=F||window.event,wr(e,F)&&D(F)},e.addEventListener(_r[o],b,!1)):e.addEventListener(o,D,!1):e.attachEvent("on"+o,b),e[ee]=e[ee]||{},e[ee][m]=b}function vr(e,o,h,f,m){m=m||o+c(h)+(f?"_"+c(f):"");var b=e[ee]&&e[ee][m];if(!b)return this;!tt.touchNative&&tt.pointer&&o.indexOf("touch")===0?Nl(e,o,b):tt.touch&&o==="dblclick"?Vl(e,b):"removeEventListener"in e?e.removeEventListener(_r[o]||o,b,!1):e.detachEvent("on"+o,b),e[ee][m]=null}function Ce(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function yr(e){return gr(e,"wheel",Ce),this}function mi(e){return st(e,"mousedown touchstart dblclick contextmenu",Ce),e._leaflet_disable_click=!0,this}function Et(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function ke(e){return Et(e),Ce(e),this}function $o(e){if(e.composedPath)return e.composedPath();for(var o=[],h=e.target;h;)o.push(h),h=h.parentNode;return o}function Go(e,o){if(!o)return new X(e.clientX,e.clientY);var h=mr(o),f=h.boundingClientRect;return new X((e.clientX-f.left)/h.x-o.clientLeft,(e.clientY-f.top)/h.y-o.clientTop)}var Gl=tt.linux&&tt.chrome?window.devicePixelRatio:tt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function qo(e){return tt.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/Gl:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}function wr(e,o){var h=o.relatedTarget;if(!h)return!0;try{for(;h&&h!==e;)h=h.parentNode}catch{return!1}return h!==e}var ql={__proto__:null,on:st,off:pt,stopPropagation:Ce,disableScrollPropagation:yr,disableClickPropagation:mi,preventDefault:Et,stop:ke,getPropagationPath:$o,getMousePosition:Go,getWheelDelta:qo,isExternalTarget:wr,addListener:st,removeListener:pt},Jo=V.extend({run:function(e,o,h,f){this.stop(),this._el=e,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(f||.5,.2),this._startPos=Se(e),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Z(this._animate,this),this._step()},_step:function(e){var o=+new Date-this._startTime,h=this._duration*1e3;o<h?this._runFrame(this._easeOut(o/h),e):(this._runFrame(1),this._complete())},_runFrame:function(e,o){var h=this._startPos.add(this._offset.multiplyBy(e));o&&h._round(),vt(this._el,h),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),lt=V.extend({options:{crs:Mt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,o){o=k(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(q(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ui&&tt.any3d&&!tt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),st(this._proxy,jo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,o,h){if(o=o===void 0?this._zoom:this._limitZoom(o),e=this._limitCenter(q(e),o,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var f=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,o,h.zoom):this._tryAnimatedPan(e,h.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(e,o,h.pan&&h.pan.noMoveStart),this},setZoom:function(e,o){return this._loaded?this.setView(this.getCenter(),e,{zoom:o}):(this._zoom=e,this)},zoomIn:function(e,o){return e=e||(tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,o)},zoomOut:function(e,o){return e=e||(tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,o)},setZoomAround:function(e,o,h){var f=this.getZoomScale(o),m=this.getSize().divideBy(2),b=e instanceof X?e:this.latLngToContainerPoint(e),D=b.subtract(m).multiplyBy(1-1/f),F=this.containerPointToLatLng(m.add(D));return this.setView(F,o,{zoom:h})},_getBoundsCenterZoom:function(e,o){o=o||{},e=e.getBounds?e.getBounds():Q(e);var h=R(o.paddingTopLeft||o.padding||[0,0]),f=R(o.paddingBottomRight||o.padding||[0,0]),m=this.getBoundsZoom(e,!1,h.add(f));if(m=typeof o.maxZoom=="number"?Math.min(o.maxZoom,m):m,m===1/0)return{center:e.getCenter(),zoom:m};var b=f.subtract(h).divideBy(2),D=this.project(e.getSouthWest(),m),F=this.project(e.getNorthEast(),m),Y=this.unproject(D.add(F).divideBy(2).add(b),m);return{center:Y,zoom:m}},fitBounds:function(e,o){if(e=Q(e),!e.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(e,o);return this.setView(h.center,h.zoom,o)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,o){return this.setView(e,this._zoom,{pan:o})},panBy:function(e,o){if(e=R(e).round(),o=o||{},!e.x&&!e.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Jo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){at(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,h,o.duration||.25,o.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,o,h){if(h=h||{},h.animate===!1||!tt.any3d)return this.setView(e,o,h);this._stop();var f=this.project(this.getCenter()),m=this.project(e),b=this.getSize(),D=this._zoom;e=q(e),o=o===void 0?D:o;var F=Math.max(b.x,b.y),Y=F*this.getZoomScale(D,o),W=m.distanceTo(f)||1,J=1.42,it=J*J;function ht(yt){var Pn=yt?-1:1,Nu=yt?Y:F,Ru=Y*Y-F*F+Pn*it*it*W*W,Zu=2*Nu*it*W,Dr=Ru/Zu,Ds=Math.sqrt(Dr*Dr+1)-Dr,Yu=Ds<1e-9?-18:Math.log(Ds);return Yu}function Tt(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function Pt(yt){return(Math.exp(yt)+Math.exp(-yt))/2}function Wt(yt){return Tt(yt)/Pt(yt)}var It=ht(0);function je(yt){return F*(Pt(It)/Pt(It+J*yt))}function Iu(yt){return F*(Pt(It)*Wt(It+J*yt)-Tt(It))/it}function Bu(yt){return 1-Math.pow(1-yt,1.5)}var zu=Date.now(),ks=(ht(1)-It)/J,Fu=h.duration?1e3*h.duration:1e3*ks*.8;function Ts(){var yt=(Date.now()-zu)/Fu,Pn=Bu(yt)*ks;yt<=1?(this._flyToFrame=Z(Ts,this),this._move(this.unproject(f.add(m.subtract(f).multiplyBy(Iu(Pn)/W)),D),this.getScaleZoom(F/je(Pn),D),{flyTo:!0})):this._move(e,o)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Ts.call(this),this},flyToBounds:function(e,o){var h=this._getBoundsCenterZoom(e,o);return this.flyTo(h.center,h.zoom,o)},setMaxBounds:function(e){return e=Q(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var o=this.options.minZoom;return this.options.minZoom=e,this._loaded&&o!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var o=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&o!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,o){this._enforcingBounds=!0;var h=this.getCenter(),f=this._limitCenter(h,this._zoom,Q(e));return h.equals(f)||this.panTo(f,o),this._enforcingBounds=!1,this},panInside:function(e,o){o=o||{};var h=R(o.paddingTopLeft||o.padding||[0,0]),f=R(o.paddingBottomRight||o.padding||[0,0]),m=this.project(this.getCenter()),b=this.project(e),D=this.getPixelBounds(),F=H([D.min.add(h),D.max.subtract(f)]),Y=F.getSize();if(!F.contains(b)){this._enforcingBounds=!0;var W=b.subtract(F.getCenter()),J=F.extend(b).getSize().subtract(Y);m.x+=W.x<0?-J.x:J.x,m.y+=W.y<0?-J.y:J.y,this.panTo(this.unproject(m),o),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=s({animate:!1,pan:!0},e===!0?{animate:!0}:e);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),f=o.divideBy(2).round(),m=h.divideBy(2).round(),b=f.subtract(m);return!b.x&&!b.y?this:(e.animate&&e.pan?this.panBy(b):(e.pan&&this._rawPanBy(b),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=s({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,h,e):navigator.geolocation.getCurrentPosition(o,h,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var o=e.code,h=e.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var o=e.coords.latitude,h=e.coords.longitude,f=new K(o,h),m=f.toBounds(e.coords.accuracy*2),b=this._locateOptions;if(b.setView){var D=this.getBoundsZoom(m);this.setView(f,b.maxZoom?Math.min(D,b.maxZoom):D)}var F={latlng:f,bounds:m,timestamp:e.timestamp};for(var Y in e.coords)typeof e.coords[Y]=="number"&&(F[Y]=e.coords[Y]);this.fire("locationfound",F)}},addHandler:function(e,o){if(!o)return this;var h=this[e]=new o(this);return this._handlers.push(h),this.options[e]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var e;for(e in this._layers)this._layers[e].remove();for(e in this._panes)mt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,o){var h="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),f=ct("div",h,o||this._mapPane);return e&&(this._panes[e]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),o=this.unproject(e.getBottomLeft()),h=this.unproject(e.getTopRight());return new et(o,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,o,h){e=Q(e),h=R(h||[0,0]);var f=this.getZoom()||0,m=this.getMinZoom(),b=this.getMaxZoom(),D=e.getNorthWest(),F=e.getSouthEast(),Y=this.getSize().subtract(h),W=H(this.project(F,f),this.project(D,f)).getSize(),J=tt.any3d?this.options.zoomSnap:1,it=Y.x/W.x,ht=Y.y/W.y,Tt=o?Math.max(it,ht):Math.min(it,ht);return f=this.getScaleZoom(Tt,f),J&&(f=Math.round(f/(J/100))*(J/100),f=o?Math.ceil(f/J)*J:Math.floor(f/J)*J),Math.max(m,Math.min(b,f))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,o){var h=this._getTopLeftPoint(e,o);return new $(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===void 0?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,o){var h=this.options.crs;return o=o===void 0?this._zoom:o,h.scale(e)/h.scale(o)},getScaleZoom:function(e,o){var h=this.options.crs;o=o===void 0?this._zoom:o;var f=h.zoom(e*h.scale(o));return isNaN(f)?1/0:f},project:function(e,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(q(e),o)},unproject:function(e,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(R(e),o)},layerPointToLatLng:function(e){var o=R(e).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(e){var o=this.project(q(e))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(q(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(Q(e))},distance:function(e,o){return this.options.crs.distance(q(e),q(o))},containerPointToLayerPoint:function(e){return R(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return R(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var o=this.containerPointToLayerPoint(R(e));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(e)))},mouseEventToContainerPoint:function(e){return Go(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var o=this._container=Wo(e);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");st(o,"scroll",this._onScroll,this),this._containerId=c(o)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&tt.any3d,at(e,"leaflet-container"+(tt.touch?" leaflet-touch":"")+(tt.retina?" leaflet-retina":"")+(tt.ielt9?" leaflet-oldie":"")+(tt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=ci(e,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),vt(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(at(e.markerPane,"leaflet-zoom-hide"),at(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,o,h){vt(this._mapPane,new X(0,0));var f=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var m=this._zoom!==o;this._moveStart(m,h)._move(e,o)._moveEnd(m),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(e,o){return e&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(e,o,h,f){o===void 0&&(o=this._zoom);var m=this._zoom!==o;return this._zoom=o,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),f?h&&h.pinch&&this.fire("zoom",h):((m||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){vt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[c(this._container)]=this;var o=e?pt:st;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),tt.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=Z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,o){for(var h=[],f,m=o==="mouseout"||o==="mouseover",b=e.target||e.srcElement,D=!1;b;){if(f=this._targets[c(b)],f&&(o==="click"||o==="preclick")&&this._draggableMoved(f)){D=!0;break}if(f&&f.listens(o,!0)&&(m&&!wr(b,e)||(h.push(f),m))||b===this._container)break;b=b.parentNode}return!h.length&&!D&&!m&&this.listens(o,!0)&&(h=[this]),h},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var o=e.target||e.srcElement;if(!(!this._loaded||o._leaflet_disable_events||e.type==="click"&&this._isClickDisabled(o))){var h=e.type;h==="mousedown"&&pr(o),this._fireDOMEvent(e,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,o,h){if(e.type==="click"){var f=s({},e);f.type="preclick",this._fireDOMEvent(f,f.type,h)}var m=this._findEventTargets(e,o);if(h){for(var b=[],D=0;D<h.length;D++)h[D].listens(o,!0)&&b.push(h[D]);m=b.concat(m)}if(m.length){o==="contextmenu"&&Et(e);var F=m[0],Y={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var W=F.getLatLng&&(!F._radius||F._radius<=10);Y.containerPoint=W?this.latLngToContainerPoint(F.getLatLng()):this.mouseEventToContainerPoint(e),Y.layerPoint=this.containerPointToLayerPoint(Y.containerPoint),Y.latlng=W?F.getLatLng():this.layerPointToLatLng(Y.layerPoint)}for(D=0;D<m.length;D++)if(m[D].fire(o,Y,!0),Y.originalEvent._stopped||m[D].options.bubblingMouseEvents===!1&&y(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,o=this._handlers.length;e<o;e++)this._handlers[e].disable()},whenReady:function(e,o){return this._loaded?e.call(o||this,{target:this}):this.on("load",e,o),this},_getMapPanePos:function(){return Se(this._mapPane)||new X(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,o){var h=e&&o!==void 0?this._getNewPixelOrigin(e,o):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,o){var h=this.getSize()._divideBy(2);return this.project(e,o)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,o,h){var f=this._getNewPixelOrigin(h,o);return this.project(e,o)._subtract(f)},_latLngBoundsToNewLayerBounds:function(e,o,h){var f=this._getNewPixelOrigin(h,o);return H([this.project(e.getSouthWest(),o)._subtract(f),this.project(e.getNorthWest(),o)._subtract(f),this.project(e.getSouthEast(),o)._subtract(f),this.project(e.getNorthEast(),o)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,o,h){if(!h)return e;var f=this.project(e,o),m=this.getSize().divideBy(2),b=new $(f.subtract(m),f.add(m)),D=this._getBoundsOffset(b,h,o);return Math.abs(D.x)<=1&&Math.abs(D.y)<=1?e:this.unproject(f.add(D),o)},_limitOffset:function(e,o){if(!o)return e;var h=this.getPixelBounds(),f=new $(h.min.add(e),h.max.add(e));return e.add(this._getBoundsOffset(f,o))},_getBoundsOffset:function(e,o,h){var f=H(this.project(o.getNorthEast(),h),this.project(o.getSouthWest(),h)),m=f.min.subtract(e.min),b=f.max.subtract(e.max),D=this._rebound(m.x,-b.x),F=this._rebound(m.y,-b.y);return new X(D,F)},_rebound:function(e,o){return e+o>0?Math.round(e-o)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(o))},_limitZoom:function(e){var o=this.getMinZoom(),h=this.getMaxZoom(),f=tt.any3d?this.options.zoomSnap:1;return f&&(e=Math.round(e/f)*f),Math.max(o,Math.min(h,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_t(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,o){var h=this._getCenterOffset(e)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,o),!0)},_createAnimProxy:function(){var e=this._proxy=ct("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(o){var h=ar,f=this._proxy.style[h];Ee(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),f===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){mt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),o=this.getZoom();Ee(this._proxy,this.project(e,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,o,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(o),m=this._getCenterOffset(e)._divideBy(1-1/f);return h.animate!==!0&&!this.getSize().contains(m)?!1:(Z(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(e,o,!0)},this),!0)},_animateZoom:function(e,o,h,f){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=o,at(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:o,noUpdate:f}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&_t(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Jl(e,o){return new lt(e,o)}var Vt=x.extend({options:{position:"topright"},initialize:function(e){k(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var o=this._map;return o&&o.removeControl(this),this.options.position=e,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var o=this._container=this.onAdd(e),h=this.getPosition(),f=e._controlCorners[h];return at(o,"leaflet-control"),h.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(mt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),_i=function(e){return new Vt(e)};lt.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},o="leaflet-",h=this._controlContainer=ct("div",o+"control-container",this._container);function f(m,b){var D=o+m+" "+o+b;e[m+b]=ct("div",D,h)}f("top","left"),f("top","right"),f("bottom","left"),f("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)mt(this._controlCorners[e]);mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ko=Vt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,o,h,f){return h<f?-1:f<h?1:0}},initialize:function(e,o,h){k(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var f in e)this._addLayer(e[f],f);for(f in o)this._addLayer(o[f],f,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return Vt.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,o){return this._addLayer(e,o),this._map?this._update():this},addOverlay:function(e,o){return this._addLayer(e,o,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var o=this._getLayer(c(e));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){at(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(at(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):_t(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return _t(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",o=this._container=ct("div",e),h=this.options.collapsed;o.setAttribute("aria-haspopup",!0),mi(o),yr(o);var f=this._section=ct("section",e+"-list");h&&(this._map.on("click",this.collapse,this),st(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var m=this._layersLink=ct("a",e+"-toggle",o);m.href="#",m.title="Layers",m.setAttribute("role","button"),st(m,{keydown:function(b){b.keyCode===13&&this._expandSafely()},click:function(b){Et(b),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=ct("div",e+"-base",f),this._separator=ct("div",e+"-separator",f),this._overlaysList=ct("div",e+"-overlays",f),o.appendChild(f)},_getLayer:function(e){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&c(this._layers[o].layer)===e)return this._layers[o]},_addLayer:function(e,o,h){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:o,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(f,m){return this.options.sortFunction(f.layer,m.layer,f.name,m.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;hn(this._baseLayersList),hn(this._overlaysList),this._layerControlInputs=[];var e,o,h,f,m=0;for(h=0;h<this._layers.length;h++)f=this._layers[h],this._addItem(f),o=o||f.overlay,e=e||!f.overlay,m+=f.overlay?0:1;return this.options.hideSingleBase&&(e=e&&m>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=o&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var o=this._getLayer(c(e.target)),h=o.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;h&&this._map.fire(h,o)},_createRadioElement:function(e,o){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(o?' checked="checked"':"")+"/>",f=document.createElement("div");return f.innerHTML=h,f.firstChild},_addItem:function(e){var o=document.createElement("label"),h=this._map.hasLayer(e.layer),f;e.overlay?(f=document.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=h):f=this._createRadioElement("leaflet-base-layers_"+c(this),h),this._layerControlInputs.push(f),f.layerId=c(e.layer),st(f,"click",this._onInputClick,this);var m=document.createElement("span");m.innerHTML=" "+e.name;var b=document.createElement("span");o.appendChild(b),b.appendChild(f),b.appendChild(m);var D=e.overlay?this._overlaysList:this._baseLayersList;return D.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var e=this._layerControlInputs,o,h,f=[],m=[];this._handlingClick=!0;for(var b=e.length-1;b>=0;b--)o=e[b],h=this._getLayer(o.layerId).layer,o.checked?f.push(h):o.checked||m.push(h);for(b=0;b<m.length;b++)this._map.hasLayer(m[b])&&this._map.removeLayer(m[b]);for(b=0;b<f.length;b++)this._map.hasLayer(f[b])||this._map.addLayer(f[b]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e=this._layerControlInputs,o,h,f=this._map.getZoom(),m=e.length-1;m>=0;m--)o=e[m],h=this._getLayer(o.layerId).layer,o.disabled=h.options.minZoom!==void 0&&f<h.options.minZoom||h.options.maxZoom!==void 0&&f>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,st(e,"click",Et),this.expand();var o=this;setTimeout(function(){pt(e,"click",Et),o._preventClick=!1})}}),Kl=function(e,o,h){return new Ko(e,o,h)},xr=Vt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var o="leaflet-control-zoom",h=ct("div",o+" leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,o+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,o+"-out",h,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,o,h,f,m){var b=ct("a",h,f);return b.innerHTML=e,b.href="#",b.title=o,b.setAttribute("role","button"),b.setAttribute("aria-label",o),mi(b),st(b,"click",ke),st(b,"click",m,this),st(b,"click",this._refocusOnMap,this),b},_updateDisabled:function(){var e=this._map,o="leaflet-disabled";_t(this._zoomInButton,o),_t(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(at(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(at(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});lt.mergeOptions({zoomControl:!0}),lt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xr,this.addControl(this.zoomControl))});var Ql=function(e){return new xr(e)},Qo=Vt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var o="leaflet-control-scale",h=ct("div",o),f=this.options;return this._addScales(f,o+"-line",h),e.on(f.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),h},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,o,h){e.metric&&(this._mScale=ct("div",o,h)),e.imperial&&(this._iScale=ct("div",o,h))},_update:function(){var e=this._map,o=e.getSize().y/2,h=e.distance(e.containerPointToLatLng([0,o]),e.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(h)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var o=this._getRoundNum(e),h=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,h,o/e)},_updateImperial:function(e){var o=e*3.2808399,h,f,m;o>5280?(h=o/5280,f=this._getRoundNum(h),this._updateScale(this._iScale,f+" mi",f/h)):(m=this._getRoundNum(o),this._updateScale(this._iScale,m+" ft",m/o))},_updateScale:function(e,o,h){e.style.width=Math.round(this.options.maxWidth*h)+"px",e.innerHTML=o},_getRoundNum:function(e){var o=Math.pow(10,(Math.floor(e)+"").length-1),h=e/o;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,o*h}}),tu=function(e){return new Qo(e)},eu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',br=Vt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(tt.inlineSvg?eu+" ":"")+"Leaflet</a>"},initialize:function(e){k(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=ct("div","leaflet-control-attribution"),mi(this._container);for(var o in e._layers)e._layers[o].getAttribution&&this.addAttribution(e._layers[o].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var o in this._attributions)this._attributions[o]&&e.push(o);var h=[];this.options.prefix&&h.push(this.options.prefix),e.length&&h.push(e.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});lt.mergeOptions({attributionControl:!0}),lt.addInitHook(function(){this.options.attributionControl&&new br().addTo(this)});var iu=function(e){return new br(e)};Vt.Layers=Ko,Vt.Zoom=xr,Vt.Scale=Qo,Vt.Attribution=br,_i.layers=Kl,_i.zoom=Ql,_i.scale=tu,_i.attribution=iu;var ie=x.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ie.addTo=function(e,o){return e.addHandler(o,this),this};var nu={Events:B},ts=tt.touch?"touchstart mousedown":"mousedown",ye=V.extend({options:{clickTolerance:3},initialize:function(e,o,h,f){k(this,f),this._element=e,this._dragStartTarget=o||e,this._preventOutline=h},enable:function(){this._enabled||(st(this._dragStartTarget,ts,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ye._dragging===this&&this.finishDrag(!0),pt(this._dragStartTarget,ts,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!hr(this._element,"leaflet-zoom-anim"))){if(e.touches&&e.touches.length!==1){ye._dragging===this&&this.finishDrag();return}if(!(ye._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(ye._dragging=this,this._preventOutline&&pr(this._element),cr(),fi(),!this._moving)){this.fire("down");var o=e.touches?e.touches[0]:e,h=Vo(this._element);this._startPoint=new X(o.clientX,o.clientY),this._startPos=Se(this._element),this._parentScale=mr(h);var f=e.type==="mousedown";st(document,f?"mousemove":"touchmove",this._onMove,this),st(document,f?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(e){if(this._enabled){if(e.touches&&e.touches.length>1){this._moved=!0;return}var o=e.touches&&e.touches.length===1?e.touches[0]:e,h=new X(o.clientX,o.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Et(e),this._moved||(this.fire("dragstart"),this._moved=!0,at(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),at(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=e,this._updatePosition())}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),vt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){_t(document.body,"leaflet-dragging"),this._lastTarget&&(_t(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),pt(document,"mousemove touchmove",this._onMove,this),pt(document,"mouseup touchend touchcancel",this._onUp,this),fr(),di();var o=this._moved&&this._moving;this._moving=!1,ye._dragging=!1,o&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function es(e,o,h){var f,m=[1,4,2,8],b,D,F,Y,W,J,it,ht;for(b=0,J=e.length;b<J;b++)e[b]._code=Te(e[b],o);for(F=0;F<4;F++){for(it=m[F],f=[],b=0,J=e.length,D=J-1;b<J;D=b++)Y=e[b],W=e[D],Y._code&it?W._code&it||(ht=dn(W,Y,it,o,h),ht._code=Te(ht,o),f.push(ht)):(W._code&it&&(ht=dn(W,Y,it,o,h),ht._code=Te(ht,o),f.push(ht)),f.push(Y));e=f}return e}function is(e,o){var h,f,m,b,D,F,Y,W,J;if(!e||e.length===0)throw new Error("latlngs not passed");jt(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var it=q([0,0]),ht=Q(e),Tt=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Tt<1700&&(it=Mr(e));var Pt=e.length,Wt=[];for(h=0;h<Pt;h++){var It=q(e[h]);Wt.push(o.project(q([It.lat-it.lat,It.lng-it.lng])))}for(F=Y=W=0,h=0,f=Pt-1;h<Pt;f=h++)m=Wt[h],b=Wt[f],D=m.y*b.x-b.y*m.x,Y+=(m.x+b.x)*D,W+=(m.y+b.y)*D,F+=D*3;F===0?J=Wt[0]:J=[Y/F,W/F];var je=o.unproject(R(J));return q([je.lat+it.lat,je.lng+it.lng])}function Mr(e){for(var o=0,h=0,f=0,m=0;m<e.length;m++){var b=q(e[m]);o+=b.lat,h+=b.lng,f++}return q([o/f,h/f])}var ru={__proto__:null,clipPolygon:es,polygonCenter:is,centroid:Mr};function ns(e,o){if(!o||!e.length)return e.slice();var h=o*o;return e=au(e,h),e=su(e,h),e}function rs(e,o,h){return Math.sqrt(gi(e,o,h,!0))}function ou(e,o,h){return gi(e,o,h)}function su(e,o){var h=e.length,f=typeof Uint8Array<"u"?Uint8Array:Array,m=new f(h);m[0]=m[h-1]=1,Pr(e,m,o,0,h-1);var b,D=[];for(b=0;b<h;b++)m[b]&&D.push(e[b]);return D}function Pr(e,o,h,f,m){var b=0,D,F,Y;for(F=f+1;F<=m-1;F++)Y=gi(e[F],e[f],e[m],!0),Y>b&&(D=F,b=Y);b>h&&(o[D]=1,Pr(e,o,h,f,D),Pr(e,o,h,D,m))}function au(e,o){for(var h=[e[0]],f=1,m=0,b=e.length;f<b;f++)hu(e[f],e[m])>o&&(h.push(e[f]),m=f);return m<b-1&&h.push(e[b-1]),h}var os;function ss(e,o,h,f,m){var b=f?os:Te(e,h),D=Te(o,h),F,Y,W;for(os=D;;){if(!(b|D))return[e,o];if(b&D)return!1;F=b||D,Y=dn(e,o,F,h,m),W=Te(Y,h),F===b?(e=Y,b=W):(o=Y,D=W)}}function dn(e,o,h,f,m){var b=o.x-e.x,D=o.y-e.y,F=f.min,Y=f.max,W,J;return h&8?(W=e.x+b*(Y.y-e.y)/D,J=Y.y):h&4?(W=e.x+b*(F.y-e.y)/D,J=F.y):h&2?(W=Y.x,J=e.y+D*(Y.x-e.x)/b):h&1&&(W=F.x,J=e.y+D*(F.x-e.x)/b),new X(W,J,m)}function Te(e,o){var h=0;return e.x<o.min.x?h|=1:e.x>o.max.x&&(h|=2),e.y<o.min.y?h|=4:e.y>o.max.y&&(h|=8),h}function hu(e,o){var h=o.x-e.x,f=o.y-e.y;return h*h+f*f}function gi(e,o,h,f){var m=o.x,b=o.y,D=h.x-m,F=h.y-b,Y=D*D+F*F,W;return Y>0&&(W=((e.x-m)*D+(e.y-b)*F)/Y,W>1?(m=h.x,b=h.y):W>0&&(m+=D*W,b+=F*W)),D=e.x-m,F=e.y-b,f?D*D+F*F:new X(m,b)}function jt(e){return!v(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]<"u"}function as(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),jt(e)}function hs(e,o){var h,f,m,b,D,F,Y,W;if(!e||e.length===0)throw new Error("latlngs not passed");jt(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var J=q([0,0]),it=Q(e),ht=it.getNorthWest().distanceTo(it.getSouthWest())*it.getNorthEast().distanceTo(it.getNorthWest());ht<1700&&(J=Mr(e));var Tt=e.length,Pt=[];for(h=0;h<Tt;h++){var Wt=q(e[h]);Pt.push(o.project(q([Wt.lat-J.lat,Wt.lng-J.lng])))}for(h=0,f=0;h<Tt-1;h++)f+=Pt[h].distanceTo(Pt[h+1])/2;if(f===0)W=Pt[0];else for(h=0,b=0;h<Tt-1;h++)if(D=Pt[h],F=Pt[h+1],m=D.distanceTo(F),b+=m,b>f){Y=(b-f)/m,W=[F.x-Y*(F.x-D.x),F.y-Y*(F.y-D.y)];break}var It=o.unproject(R(W));return q([It.lat+J.lat,It.lng+J.lng])}var lu={__proto__:null,simplify:ns,pointToSegmentDistance:rs,closestPointOnSegment:ou,clipSegment:ss,_getEdgeIntersection:dn,_getBitCode:Te,_sqClosestPointOnSegment:gi,isFlat:jt,_flat:as,polylineCenter:hs},Lr={project:function(e){return new X(e.lng,e.lat)},unproject:function(e){return new K(e.y,e.x)},bounds:new $([-180,-90],[180,90])},Er={R:6378137,R_MINOR:6356752314245179e-9,bounds:new $([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(e){var o=Math.PI/180,h=this.R,f=e.lat*o,m=this.R_MINOR/h,b=Math.sqrt(1-m*m),D=b*Math.sin(f),F=Math.tan(Math.PI/4-f/2)/Math.pow((1-D)/(1+D),b/2);return f=-h*Math.log(Math.max(F,1e-10)),new X(e.lng*o*h,f)},unproject:function(e){for(var o=180/Math.PI,h=this.R,f=this.R_MINOR/h,m=Math.sqrt(1-f*f),b=Math.exp(-e.y/h),D=Math.PI/2-2*Math.atan(b),F=0,Y=.1,W;F<15&&Math.abs(Y)>1e-7;F++)W=m*Math.sin(D),W=Math.pow((1-W)/(1+W),m/2),Y=Math.PI/2-2*Math.atan(b*W)-D,D+=Y;return new K(D*o,e.x*o/h)}},uu={__proto__:null,LonLat:Lr,Mercator:Er,SphericalMercator:xt},cu=s({},ut,{code:"EPSG:3395",projection:Er,transformation:(function(){var e=.5/(Math.PI*Er.R);return St(e,.5,-e,.5)})()}),ls=s({},ut,{code:"EPSG:4326",projection:Lr,transformation:St(1/180,1,-1/180,.5)}),fu=s({},ot,{projection:Lr,transformation:St(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,o){var h=o.lng-e.lng,f=o.lat-e.lat;return Math.sqrt(h*h+f*f)},infinite:!0});ot.Earth=ut,ot.EPSG3395=cu,ot.EPSG3857=Mt,ot.EPSG900913=Ct,ot.EPSG4326=ls,ot.Simple=fu;var Ht=V.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[c(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[c(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var o=e.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var h=this.getEvents();o.on(h,this),this.once("remove",function(){o.off(h,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});lt.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var o=c(e);return this._layers[o]?this:(this._layers[o]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var o=c(e);return this._layers[o]?(this._loaded&&e.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return c(e)in this._layers},eachLayer:function(e,o){for(var h in this._layers)e.call(o,this._layers[h]);return this},_addLayers:function(e){e=e?v(e)?e:[e]:[];for(var o=0,h=e.length;o<h;o++)this.addLayer(e[o])},_addZoomLimit:function(e){(!isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[c(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var o=c(e);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,o=-1/0,h=this._getZoomSpan();for(var f in this._zoomBoundLayers){var m=this._zoomBoundLayers[f].options;e=m.minZoom===void 0?e:Math.min(e,m.minZoom),o=m.maxZoom===void 0?o:Math.max(o,m.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=e===1/0?void 0:e,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Re=Ht.extend({initialize:function(e,o){k(this,o),this._layers={};var h,f;if(e)for(h=0,f=e.length;h<f;h++)this.addLayer(e[h])},addLayer:function(e){var o=this.getLayerId(e);return this._layers[o]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var o=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(e){var o=typeof e=="number"?e:this.getLayerId(e);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var o=Array.prototype.slice.call(arguments,1),h,f;for(h in this._layers)f=this._layers[h],f[e]&&f[e].apply(f,o);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,o){for(var h in this._layers)e.call(o,this._layers[h]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return c(e)}}),du=function(e,o){return new Re(e,o)},le=Re.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Re.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Re.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new et;for(var o in this._layers){var h=this._layers[o];e.extend(h.getBounds?h.getBounds():h.getLatLng())}return e}}),pu=function(e,o){return new le(e,o)},Ze=x.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){k(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,o){var h=this._getIconUrl(e);if(!h){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var f=this._createImg(h,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(f,e),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f},_setIconStyles:function(e,o){var h=this.options,f=h[o+"Size"];typeof f=="number"&&(f=[f,f]);var m=R(f),b=R(o==="shadow"&&h.shadowAnchor||h.iconAnchor||m&&m.divideBy(2,!0));e.className="leaflet-marker-"+o+" "+(h.className||""),b&&(e.style.marginLeft=-b.x+"px",e.style.marginTop=-b.y+"px"),m&&(e.style.width=m.x+"px",e.style.height=m.y+"px")},_createImg:function(e,o){return o=o||document.createElement("img"),o.src=e,o},_getIconUrl:function(e){return tt.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function mu(e){return new Ze(e)}var vi=Ze.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return typeof vi.imagePath!="string"&&(vi.imagePath=this._detectIconPath()),(this.options.imagePath||vi.imagePath)+Ze.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var o=function(h,f,m){var b=f.exec(h);return b&&b[m]};return e=o(e,/^url\((['"])?(.+)\1\)$/,2),e&&o(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=ct("div","leaflet-default-icon-path",document.body),o=ci(e,"background-image")||ci(e,"backgroundImage");if(document.body.removeChild(e),o=this._stripUrl(o),o)return o;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),us=ie.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new ye(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),at(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&_t(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var o=this._marker,h=o._map,f=this._marker.options.autoPanSpeed,m=this._marker.options.autoPanPadding,b=Se(o._icon),D=h.getPixelBounds(),F=h.getPixelOrigin(),Y=H(D.min._subtract(F).add(m),D.max._subtract(F).subtract(m));if(!Y.contains(b)){var W=R((Math.max(Y.max.x,b.x)-Y.max.x)/(D.max.x-Y.max.x)-(Math.min(Y.min.x,b.x)-Y.min.x)/(D.min.x-Y.min.x),(Math.max(Y.max.y,b.y)-Y.max.y)/(D.max.y-Y.max.y)-(Math.min(Y.min.y,b.y)-Y.min.y)/(D.min.y-Y.min.y)).multiplyBy(f);h.panBy(W,{animate:!1}),this._draggable._newPos._add(W),this._draggable._startPos._add(W),vt(o._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=Z(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=Z(this._adjustPan.bind(this,e)))},_onDrag:function(e){var o=this._marker,h=o._shadow,f=Se(o._icon),m=o._map.layerPointToLatLng(f);h&&vt(h,f),o._latlng=m,e.latlng=m,e.oldLatLng=this._oldLatLng,o.fire("move",e).fire("drag",e)},_onDragEnd:function(e){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),pn=Ht.extend({options:{icon:new vi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,o){k(this,o),this._latlng=q(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var o=this._latlng;return this._latlng=q(e),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=e.icon.createIcon(this._icon),f=!1;h!==this._icon&&(this._icon&&this._removeIcon(),f=!0,e.title&&(h.title=e.title),h.tagName==="IMG"&&(h.alt=e.alt||"")),at(h,o),e.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(h,"focus",this._panOnFocus,this);var m=e.icon.createShadow(this._shadow),b=!1;m!==this._shadow&&(this._removeShadow(),b=!0),m&&(at(m,o),m.alt=""),this._shadow=m,e.opacity<1&&this._updateOpacity(),f&&this.getPane().appendChild(this._icon),this._initInteraction(),m&&b&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pt(this._icon,"focus",this._panOnFocus,this),mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&mt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&vt(this._icon,e),this._shadow&&vt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(at(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),us)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new us(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Ut(this._icon,e),this._shadow&&Ut(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var o=this.options.icon.options,h=o.iconSize?R(o.iconSize):R(0,0),f=o.iconAnchor?R(o.iconAnchor):R(0,0);e.panInside(this._latlng,{paddingTopLeft:f,paddingBottomRight:h.subtract(f)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _u(e,o){return new pn(e,o)}var we=Ht.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return k(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),mn=we.extend({options:{fill:!0,radius:10},initialize:function(e,o){k(this,o),this._latlng=q(e),this._radius=this.options.radius},setLatLng:function(e){var o=this._latlng;return this._latlng=q(e),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var o=e&&e.radius||this._radius;return we.prototype.setStyle.call(this,e),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,o=this._radiusY||e,h=this._clickTolerance(),f=[e+h,o+h];this._pxBounds=new $(this._point.subtract(f),this._point.add(f))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function gu(e,o){return new mn(e,o)}var Sr=mn.extend({initialize:function(e,o,h){if(typeof o=="number"&&(o=s({},h,{radius:o})),k(this,o),this._latlng=q(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new et(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:we.prototype.setStyle,_project:function(){var e=this._latlng.lng,o=this._latlng.lat,h=this._map,f=h.options.crs;if(f.distance===ut.distance){var m=Math.PI/180,b=this._mRadius/ut.R/m,D=h.project([o+b,e]),F=h.project([o-b,e]),Y=D.add(F).divideBy(2),W=h.unproject(Y).lat,J=Math.acos((Math.cos(b*m)-Math.sin(o*m)*Math.sin(W*m))/(Math.cos(o*m)*Math.cos(W*m)))/m;(isNaN(J)||J===0)&&(J=b/Math.cos(Math.PI/180*o)),this._point=Y.subtract(h.getPixelOrigin()),this._radius=isNaN(J)?0:Y.x-h.project([W,e-J]).x,this._radiusY=Y.y-D.y}else{var it=f.unproject(f.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(it).x}this._updateBounds()}});function vu(e,o,h){return new Sr(e,o,h)}var ue=we.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,o){k(this,o),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var o=1/0,h=null,f=gi,m,b,D=0,F=this._parts.length;D<F;D++)for(var Y=this._parts[D],W=1,J=Y.length;W<J;W++){m=Y[W-1],b=Y[W];var it=f(e,m,b,!0);it<o&&(o=it,h=f(e,m,b))}return h&&(h.distance=Math.sqrt(o)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return hs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,o){return o=o||this._defaultShape(),e=q(e),o.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new et,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return jt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var o=[],h=jt(e),f=0,m=e.length;f<m;f++)h?(o[f]=q(e[f]),this._bounds.extend(o[f])):o[f]=this._convertLatLngs(e[f]);return o},_project:function(){var e=new $;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),o=new X(e,e);this._rawPxBounds&&(this._pxBounds=new $([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(e,o,h){var f=e[0]instanceof K,m=e.length,b,D;if(f){for(D=[],b=0;b<m;b++)D[b]=this._map.latLngToLayerPoint(e[b]),h.extend(D[b]);o.push(D)}else for(b=0;b<m;b++)this._projectLatlngs(e[b],o,h)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,h,f,m,b,D,F,Y;for(h=0,m=0,b=this._rings.length;h<b;h++)for(Y=this._rings[h],f=0,D=Y.length;f<D-1;f++)F=ss(Y[f],Y[f+1],e,f,!0),F&&(o[m]=o[m]||[],o[m].push(F[0]),(F[1]!==Y[f+1]||f===D-2)&&(o[m].push(F[1]),m++))}},_simplifyPoints:function(){for(var e=this._parts,o=this.options.smoothFactor,h=0,f=e.length;h<f;h++)e[h]=ns(e[h],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,o){var h,f,m,b,D,F,Y=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(h=0,b=this._parts.length;h<b;h++)for(F=this._parts[h],f=0,D=F.length,m=D-1;f<D;m=f++)if(!(!o&&f===0)&&rs(e,F[m],F[f])<=Y)return!0;return!1}});function yu(e,o){return new ue(e,o)}ue._flat=as;var Ye=ue.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return is(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var o=ue.prototype._convertLatLngs.call(this,e),h=o.length;return h>=2&&o[0]instanceof K&&o[0].equals(o[h-1])&&o.pop(),o},_setLatLngs:function(e){ue.prototype._setLatLngs.call(this,e),jt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return jt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,o=this.options.weight,h=new X(o,o);if(e=new $(e.min.subtract(h),e.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}for(var f=0,m=this._rings.length,b;f<m;f++)b=es(this._rings[f],e,!0),b.length&&this._parts.push(b)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var o=!1,h,f,m,b,D,F,Y,W;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(b=0,Y=this._parts.length;b<Y;b++)for(h=this._parts[b],D=0,W=h.length,F=W-1;D<W;F=D++)f=h[D],m=h[F],f.y>e.y!=m.y>e.y&&e.x<(m.x-f.x)*(e.y-f.y)/(m.y-f.y)+f.x&&(o=!o);return o||ue.prototype._containsPoint.call(this,e,!0)}});function wu(e,o){return new Ye(e,o)}var ce=le.extend({initialize:function(e,o){k(this,o),this._layers={},e&&this.addData(e)},addData:function(e){var o=v(e)?e:e.features,h,f,m;if(o){for(h=0,f=o.length;h<f;h++)m=o[h],(m.geometries||m.geometry||m.features||m.coordinates)&&this.addData(m);return this}var b=this.options;if(b.filter&&!b.filter(e))return this;var D=_n(e,b);return D?(D.feature=yn(e),D.defaultOptions=D.options,this.resetStyle(D),b.onEachFeature&&b.onEachFeature(e,D),this.addLayer(D)):this},resetStyle:function(e){return e===void 0?this.eachLayer(this.resetStyle,this):(e.options=s({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(o){this._setLayerStyle(o,e)},this)},_setLayerStyle:function(e,o){e.setStyle&&(typeof o=="function"&&(o=o(e.feature)),e.setStyle(o))}});function _n(e,o){var h=e.type==="Feature"?e.geometry:e,f=h?h.coordinates:null,m=[],b=o&&o.pointToLayer,D=o&&o.coordsToLatLng||Cr,F,Y,W,J;if(!f&&!h)return null;switch(h.type){case"Point":return F=D(f),cs(b,e,F,o);case"MultiPoint":for(W=0,J=f.length;W<J;W++)F=D(f[W]),m.push(cs(b,e,F,o));return new le(m);case"LineString":case"MultiLineString":return Y=gn(f,h.type==="LineString"?0:1,D),new ue(Y,o);case"Polygon":case"MultiPolygon":return Y=gn(f,h.type==="Polygon"?1:2,D),new Ye(Y,o);case"GeometryCollection":for(W=0,J=h.geometries.length;W<J;W++){var it=_n({geometry:h.geometries[W],type:"Feature",properties:e.properties},o);it&&m.push(it)}return new le(m);case"FeatureCollection":for(W=0,J=h.features.length;W<J;W++){var ht=_n(h.features[W],o);ht&&m.push(ht)}return new le(m);default:throw new Error("Invalid GeoJSON object.")}}function cs(e,o,h,f){return e?e(o,h):new pn(h,f&&f.markersInheritOptions&&f)}function Cr(e){return new K(e[1],e[0],e[2])}function gn(e,o,h){for(var f=[],m=0,b=e.length,D;m<b;m++)D=o?gn(e[m],o-1,h):(h||Cr)(e[m]),f.push(D);return f}function kr(e,o){return e=q(e),e.alt!==void 0?[w(e.lng,o),w(e.lat,o),w(e.alt,o)]:[w(e.lng,o),w(e.lat,o)]}function vn(e,o,h,f){for(var m=[],b=0,D=e.length;b<D;b++)m.push(o?vn(e[b],jt(e[b])?0:o-1,h,f):kr(e[b],f));return!o&&h&&m.length>0&&m.push(m[0].slice()),m}function Xe(e,o){return e.feature?s({},e.feature,{geometry:o}):yn(o)}function yn(e){return e.type==="Feature"||e.type==="FeatureCollection"?e:{type:"Feature",properties:{},geometry:e}}var Tr={toGeoJSON:function(e){return Xe(this,{type:"Point",coordinates:kr(this.getLatLng(),e)})}};pn.include(Tr),Sr.include(Tr),mn.include(Tr),ue.include({toGeoJSON:function(e){var o=!jt(this._latlngs),h=vn(this._latlngs,o?1:0,!1,e);return Xe(this,{type:(o?"Multi":"")+"LineString",coordinates:h})}}),Ye.include({toGeoJSON:function(e){var o=!jt(this._latlngs),h=o&&!jt(this._latlngs[0]),f=vn(this._latlngs,h?2:o?1:0,!0,e);return o||(f=[f]),Xe(this,{type:(h?"Multi":"")+"Polygon",coordinates:f})}}),Re.include({toMultiPoint:function(e){var o=[];return this.eachLayer(function(h){o.push(h.toGeoJSON(e).geometry.coordinates)}),Xe(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(e){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(e);var h=o==="GeometryCollection",f=[];return this.eachLayer(function(m){if(m.toGeoJSON){var b=m.toGeoJSON(e);if(h)f.push(b.geometry);else{var D=yn(b);D.type==="FeatureCollection"?f.push.apply(f,D.features):f.push(D)}}}),h?Xe(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});function fs(e,o){return new ce(e,o)}var xu=fs,wn=Ht.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,o,h){this._url=e,this._bounds=Q(o),k(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(at(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&Fe(this._image),this},bringToBack:function(){return this._map&&Ne(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=Q(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._url.tagName==="IMG",o=this._image=e?this._url:ct("img");if(at(o,"leaflet-image-layer"),this._zoomAnimated&&at(o,"leaflet-zoom-animated"),this.options.className&&at(o,this.options.className),o.onselectstart=_,o.onmousemove=_,o.onload=l(this.fire,this,"load"),o.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(e){var o=this._map.getZoomScale(e.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Ee(this._image,h,o)},_reset:function(){var e=this._image,o=new $(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=o.getSize();vt(e,o.min),e.style.width=h.x+"px",e.style.height=h.y+"px"},_updateOpacity:function(){Ut(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),bu=function(e,o,h){return new wn(e,o,h)},ds=wn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e=this._url.tagName==="VIDEO",o=this._image=e?this._url:ct("video");if(at(o,"leaflet-image-layer"),this._zoomAnimated&&at(o,"leaflet-zoom-animated"),this.options.className&&at(o,this.options.className),o.onselectstart=_,o.onmousemove=_,o.onloadeddata=l(this.fire,this,"load"),e){for(var h=o.getElementsByTagName("source"),f=[],m=0;m<h.length;m++)f.push(h[m].src);this._url=h.length>0?f:[o.src];return}v(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var b=0;b<this._url.length;b++){var D=ct("source");D.src=this._url[b],o.appendChild(D)}}});function Mu(e,o,h){return new ds(e,o,h)}var ps=wn.extend({_initImage:function(){var e=this._image=this._url;at(e,"leaflet-image-layer"),this._zoomAnimated&&at(e,"leaflet-zoom-animated"),this.options.className&&at(e,this.options.className),e.onselectstart=_,e.onmousemove=_}});function Pu(e,o,h){return new ps(e,o,h)}var ne=Ht.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,o){e&&(e instanceof K||v(e))?(this._latlng=q(e),k(this,o)):(k(this,e),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(e){return e=arguments.length?e:this._source._map,e.hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Ut(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Ut(this._container,1),this.bringToFront(),this.options.interactive&&(at(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(Ut(this._container,0),this._removeTimeout=setTimeout(l(mt,void 0,this._container),200)):mt(this._container),this.options.interactive&&(_t(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=q(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fe(this._container),this},bringToBack:function(){return this._map&&Ne(this._container),this},_prepareOpen:function(e){var o=this._source;if(!o._map)return!1;if(o instanceof le){o=null;var h=this._source._layers;for(var f in h)if(h[f]._map){o=h[f];break}if(!o)return!1;this._source=o}if(!e)if(o.getCenter)e=o.getCenter();else if(o.getLatLng)e=o.getLatLng();else if(o.getBounds)e=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")e.innerHTML=o;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),o=R(this.options.offset),h=this._getAnchor();this._zoomAnimated?vt(this._container,e.add(h)):o=o.add(e).add(h);var f=this._containerBottom=-o.y,m=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=f+"px",this._container.style.left=m+"px"}},_getAnchor:function(){return[0,0]}});lt.include({_initOverlay:function(e,o,h,f){var m=o;return m instanceof e||(m=new e(f).setContent(o)),h&&m.setLatLng(h),m}}),Ht.include({_initOverlay:function(e,o,h,f){var m=h;return m instanceof e?(k(m,f),m._source=this):(m=o&&!f?o:new e(f,this),m.setContent(h)),m}});var xn=ne.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return e=arguments.length?e:this._source._map,!e.hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,ne.prototype.openOn.call(this,e)},onAdd:function(e){ne.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof we||this._source.on("preclick",Ce))},onRemove:function(e){ne.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof we||this._source.off("preclick",Ce))},getEvents:function(){var e=ne.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",o=this._container=ct("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=ct("div",e+"-content-wrapper",o);if(this._contentNode=ct("div",e+"-content",h),mi(o),yr(this._contentNode),st(o,"contextmenu",Ce),this._tipContainer=ct("div",e+"-tip-container",o),this._tip=ct("div",e+"-tip",this._tipContainer),this.options.closeButton){var f=this._closeButton=ct("a",e+"-close-button",o);f.setAttribute("role","button"),f.setAttribute("aria-label","Close popup"),f.href="#close",f.innerHTML='<span aria-hidden="true">&#215;</span>',st(f,"click",function(m){Et(m),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,o=e.style;o.width="",o.whiteSpace="nowrap";var h=e.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),o.width=h+1+"px",o.whiteSpace="",o.height="";var f=e.offsetHeight,m=this.options.maxHeight,b="leaflet-popup-scrolled";m&&f>m?(o.height=m+"px",at(e,b)):_t(e,b),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),h=this._getAnchor();vt(this._container,o.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var e=this._map,o=parseInt(ci(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+o,f=this._containerWidth,m=new X(this._containerLeft,-h-this._containerBottom);m._add(Se(this._container));var b=e.layerPointToContainerPoint(m),D=R(this.options.autoPanPadding),F=R(this.options.autoPanPaddingTopLeft||D),Y=R(this.options.autoPanPaddingBottomRight||D),W=e.getSize(),J=0,it=0;b.x+f+Y.x>W.x&&(J=b.x+f-W.x+Y.x),b.x-J-F.x<0&&(J=b.x-F.x),b.y+h+Y.y>W.y&&(it=b.y+h-W.y+Y.y),b.y-it-F.y<0&&(it=b.y-F.y),(J||it)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([J,it]))}},_getAnchor:function(){return R(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lu=function(e,o){return new xn(e,o)};lt.mergeOptions({closePopupOnClick:!0}),lt.include({openPopup:function(e,o,h){return this._initOverlay(xn,e,o,h).openOn(this),this},closePopup:function(e){return e=arguments.length?e:this._popup,e&&e.close(),this}}),Ht.include({bindPopup:function(e,o){return this._popup=this._initOverlay(xn,this._popup,e,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof le||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(!(!this._popup||!this._map)){ke(e);var o=e.layer||e.target;if(this._popup._source===o&&!(o instanceof we)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng);return}this._popup._source=o,this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){e.originalEvent.keyCode===13&&this._openPopup(e)}});var bn=ne.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){ne.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){ne.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=ne.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip",o=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ct("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var o,h,f=this._map,m=this._container,b=f.latLngToContainerPoint(f.getCenter()),D=f.layerPointToContainerPoint(e),F=this.options.direction,Y=m.offsetWidth,W=m.offsetHeight,J=R(this.options.offset),it=this._getAnchor();F==="top"?(o=Y/2,h=W):F==="bottom"?(o=Y/2,h=0):F==="center"?(o=Y/2,h=W/2):F==="right"?(o=0,h=W/2):F==="left"?(o=Y,h=W/2):D.x<b.x?(F="right",o=0,h=W/2):(F="left",o=Y+(J.x+it.x)*2,h=W/2),e=e.subtract(R(o,h,!0)).add(J).add(it),_t(m,"leaflet-tooltip-right"),_t(m,"leaflet-tooltip-left"),_t(m,"leaflet-tooltip-top"),_t(m,"leaflet-tooltip-bottom"),at(m,"leaflet-tooltip-"+F),vt(m,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Ut(this._container,e)},_animateZoom:function(e){var o=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(o)},_getAnchor:function(){return R(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Eu=function(e,o){return new bn(e,o)};lt.include({openTooltip:function(e,o,h){return this._initOverlay(bn,e,o,h).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Ht.include({bindTooltip:function(e,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(bn,this._tooltip,e,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!(!e&&this._tooltipHandlersAdded)){var o=e?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[o](h),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof le||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var o=typeof e.getElement=="function"&&e.getElement();o&&(st(o,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),st(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var o=typeof e.getElement=="function"&&e.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(e)});return}this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)}},_moveTooltip:function(e){var o=e.latlng,h,f;this._tooltip.options.sticky&&e.originalEvent&&(h=this._map.mouseEventToContainerPoint(e.originalEvent),f=this._map.containerPointToLayerPoint(h),o=this._map.layerPointToLatLng(f)),this._tooltip.setLatLng(o)}});var ms=Ze.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var o=e&&e.tagName==="DIV"?e:document.createElement("div"),h=this.options;if(h.html instanceof Element?(hn(o),o.appendChild(h.html)):o.innerHTML=h.html!==!1?h.html:"",h.bgPos){var f=R(h.bgPos);o.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Su(e){return new ms(e)}Ze.Default=vi;var yi=Ht.extend({options:{tileSize:256,opacity:1,updateWhenIdle:tt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){k(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),mt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fe(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ne(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof X?e:new X(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var o=this.getPane().children,h=-e(-1/0,1/0),f=0,m=o.length,b;f<m;f++)b=o[f].style.zIndex,o[f]!==this._container&&b&&(h=e(h,+b));isFinite(h)&&(this.options.zIndex=h+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tt.ielt9){Ut(this._container,this.options.opacity);var e=+new Date,o=!1,h=!1;for(var f in this._tiles){var m=this._tiles[f];if(!(!m.current||!m.loaded)){var b=Math.min(1,(e-m.loaded)/200);Ut(m.el,b),b<1?o=!0:(m.active?h=!0:this._onOpaqueTile(m),m.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),o&&(j(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this))}},_onOpaqueTile:_,_initContainer:function(){this._container||(this._container=ct("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,o=this.options.maxZoom;if(e!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===e?(this._levels[h].el.style.zIndex=o-Math.abs(e-h),this._onUpdateLevel(h)):(mt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var f=this._levels[e],m=this._map;return f||(f=this._levels[e]={},f.el=ct("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=o,f.origin=m.project(m.unproject(m.getPixelOrigin()),e).round(),f.zoom=e,this._setZoomTransform(f,m.getCenter(),m.getZoom()),_(f.el.offsetWidth),this._onCreateLevel(f)),this._level=f,f}},_onUpdateLevel:_,_onRemoveLevel:_,_onCreateLevel:_,_pruneTiles:function(){if(this._map){var e,o,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)o=this._tiles[e],o.retain=o.current;for(e in this._tiles)if(o=this._tiles[e],o.current&&!o.active){var f=o.coords;this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(e){for(var o in this._tiles)this._tiles[o].coords.z===e&&this._removeTile(o)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)mt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,o,h,f){var m=Math.floor(e/2),b=Math.floor(o/2),D=h-1,F=new X(+m,+b);F.z=+D;var Y=this._tileCoordsToKey(F),W=this._tiles[Y];return W&&W.active?(W.retain=!0,!0):(W&&W.loaded&&(W.retain=!0),D>f?this._retainParent(m,b,D,f):!1)},_retainChildren:function(e,o,h,f){for(var m=2*e;m<2*e+2;m++)for(var b=2*o;b<2*o+2;b++){var D=new X(m,b);D.z=h+1;var F=this._tileCoordsToKey(D),Y=this._tiles[F];if(Y&&Y.active){Y.retain=!0;continue}else Y&&Y.loaded&&(Y.retain=!0);h+1<f&&this._retainChildren(m,b,h+1,f)}},_resetView:function(e){var o=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var o=this.options;return o.minNativeZoom!==void 0&&e<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<e?o.maxNativeZoom:e},_setView:function(e,o,h,f){var m=Math.round(o);this.options.maxZoom!==void 0&&m>this.options.maxZoom||this.options.minZoom!==void 0&&m<this.options.minZoom?m=void 0:m=this._clampZoom(m);var b=this.options.updateWhenZooming&&m!==this._tileZoom;(!f||b)&&(this._tileZoom=m,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),m!==void 0&&this._update(e),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(e,o)},_setZoomTransforms:function(e,o){for(var h in this._levels)this._setZoomTransform(this._levels[h],e,o)},_setZoomTransform:function(e,o,h){var f=this._map.getZoomScale(h,e.zoom),m=e.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(o,h)).round();tt.any3d?Ee(e.el,m,f):vt(e.el,m)},_resetGrid:function(){var e=this._map,o=e.options.crs,h=this._tileSize=this.getTileSize(),f=this._tileZoom,m=this._map.getPixelWorldBounds(this._tileZoom);m&&(this._globalTileRange=this._pxBoundsToTileRange(m)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,o.wrapLng[0]],f).x/h.x),Math.ceil(e.project([0,o.wrapLng[1]],f).x/h.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([o.wrapLat[0],0],f).y/h.x),Math.ceil(e.project([o.wrapLat[1],0],f).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(e){var o=this._map,h=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),f=o.getZoomScale(h,this._tileZoom),m=o.project(e,this._tileZoom).floor(),b=o.getSize().divideBy(f*2);return new $(m.subtract(b),m.add(b))},_update:function(e){var o=this._map;if(o){var h=this._clampZoom(o.getZoom());if(e===void 0&&(e=o.getCenter()),this._tileZoom!==void 0){var f=this._getTiledPixelBounds(e),m=this._pxBoundsToTileRange(f),b=m.getCenter(),D=[],F=this.options.keepBuffer,Y=new $(m.getBottomLeft().subtract([F,-F]),m.getTopRight().add([F,-F]));if(!(isFinite(m.min.x)&&isFinite(m.min.y)&&isFinite(m.max.x)&&isFinite(m.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var W in this._tiles){var J=this._tiles[W].coords;(J.z!==this._tileZoom||!Y.contains(new X(J.x,J.y)))&&(this._tiles[W].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(e,h);return}for(var it=m.min.y;it<=m.max.y;it++)for(var ht=m.min.x;ht<=m.max.x;ht++){var Tt=new X(ht,it);if(Tt.z=this._tileZoom,!!this._isValidTile(Tt)){var Pt=this._tiles[this._tileCoordsToKey(Tt)];Pt?Pt.current=!0:D.push(Tt)}}if(D.sort(function(It,je){return It.distanceTo(b)-je.distanceTo(b)}),D.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Wt=document.createDocumentFragment();for(ht=0;ht<D.length;ht++)this._addTile(D[ht],Wt);this._level.el.appendChild(Wt)}}}},_isValidTile:function(e){var o=this._map.options.crs;if(!o.infinite){var h=this._globalTileRange;if(!o.wrapLng&&(e.x<h.min.x||e.x>h.max.x)||!o.wrapLat&&(e.y<h.min.y||e.y>h.max.y))return!1}if(!this.options.bounds)return!0;var f=this._tileCoordsToBounds(e);return Q(this.options.bounds).overlaps(f)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var o=this._map,h=this.getTileSize(),f=e.scaleBy(h),m=f.add(h),b=o.unproject(f,e.z),D=o.unproject(m,e.z);return[b,D]},_tileCoordsToBounds:function(e){var o=this._tileCoordsToNwSe(e),h=new et(o[0],o[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var o=e.split(":"),h=new X(+o[0],+o[1]);return h.z=+o[2],h},_removeTile:function(e){var o=this._tiles[e];o&&(mt(o.el),delete this._tiles[e],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){at(e,"leaflet-tile");var o=this.getTileSize();e.style.width=o.x+"px",e.style.height=o.y+"px",e.onselectstart=_,e.onmousemove=_,tt.ielt9&&this.options.opacity<1&&Ut(e,this.options.opacity)},_addTile:function(e,o){var h=this._getTilePos(e),f=this._tileCoordsToKey(e),m=this.createTile(this._wrapCoords(e),l(this._tileReady,this,e));this._initTile(m),this.createTile.length<2&&Z(l(this._tileReady,this,e,null,m)),vt(m,h),this._tiles[f]={el:m,coords:e,current:!0},o.appendChild(m),this.fire("tileloadstart",{tile:m,coords:e})},_tileReady:function(e,o,h){o&&this.fire("tileerror",{error:o,tile:h,coords:e});var f=this._tileCoordsToKey(e);h=this._tiles[f],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Ut(h.el,0),j(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),o||(at(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tt.ielt9||!this._map._fadeAnimated?Z(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var o=new X(this._wrapX?p(e.x,this._wrapX):e.x,this._wrapY?p(e.y,this._wrapY):e.y);return o.z=e.z,o},_pxBoundsToTileRange:function(e){var o=this.getTileSize();return new $(e.min.unscaleBy(o).floor(),e.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Cu(e){return new yi(e)}var Ue=yi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,o){this._url=e,o=k(this,o),o.detectRetina&&tt.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,o){return this._url===e&&o===void 0&&(o=!0),this._url=e,o||this.redraw(),this},createTile:function(e,o){var h=document.createElement("img");return st(h,"load",l(this._tileOnLoad,this,o,h)),st(h,"error",l(this._tileOnError,this,o,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(e),h},getTileUrl:function(e){var o={r:tt.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-e.y;this.options.tms&&(o.y=h),o["-y"]=h}return g(this._url,s(o,this.options))},_tileOnLoad:function(e,o){tt.ielt9?setTimeout(l(e,this,null,o),0):e(null,o)},_tileOnError:function(e,o,h){var f=this.options.errorTileUrl;f&&o.getAttribute("src")!==f&&(o.src=f),e(h,o)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,o=this.options.maxZoom,h=this.options.zoomReverse,f=this.options.zoomOffset;return h&&(e=o-e),e+f},_getSubdomain:function(e){var o=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var e,o;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&(o=this._tiles[e].el,o.onload=_,o.onerror=_,!o.complete)){o.src=E;var h=this._tiles[e].coords;mt(o),delete this._tiles[e],this.fire("tileabort",{tile:o,coords:h})}},_removeTile:function(e){var o=this._tiles[e];if(o)return o.el.setAttribute("src",E),yi.prototype._removeTile.call(this,e)},_tileReady:function(e,o,h){if(!(!this._map||h&&h.getAttribute("src")===E))return yi.prototype._tileReady.call(this,e,o,h)}});function _s(e,o){return new Ue(e,o)}var gs=Ue.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,o){this._url=e;var h=s({},this.defaultWmsParams);for(var f in o)f in this.options||(h[f]=o[f]);o=k(this,o);var m=o.detectRetina&&tt.retina?2:1,b=this.getTileSize();h.width=b.x*m,h.height=b.y*m,this.wmsParams=h},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Ue.prototype.onAdd.call(this,e)},getTileUrl:function(e){var o=this._tileCoordsToNwSe(e),h=this._crs,f=H(h.project(o[0]),h.project(o[1])),m=f.min,b=f.max,D=(this._wmsVersion>=1.3&&this._crs===ls?[m.y,m.x,b.y,b.x]:[m.x,m.y,b.x,b.y]).join(","),F=Ue.prototype.getTileUrl.call(this,e);return F+A(this.wmsParams,F,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+D},setParams:function(e,o){return s(this.wmsParams,e),o||this.redraw(),this}});function ku(e,o){return new gs(e,o)}Ue.WMS=gs,_s.wms=ku;var fe=Ht.extend({options:{padding:.1},initialize:function(e){k(this,e),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),at(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,o){var h=this._map.getZoomScale(o,this._zoom),f=this._map.getSize().multiplyBy(.5+this.options.padding),m=this._map.project(this._center,o),b=f.multiplyBy(-h).add(m).subtract(this._map._getNewPixelOrigin(e,o));tt.any3d?Ee(this._container,b,h):vt(this._container,b)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var e in this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,o=this._map.getSize(),h=this._map.containerPointToLayerPoint(o.multiplyBy(-e)).round();this._bounds=new $(h,h.add(o.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),vs=fe.extend({options:{tolerance:0},getEvents:function(){var e=fe.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){fe.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");st(e,"mousemove",this._onMouseMove,this),st(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),st(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,mt(this._container),pt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var e;this._redrawBounds=null;for(var o in this._layers)e=this._layers[o],e._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fe.prototype._update.call(this);var e=this._bounds,o=this._container,h=e.getSize(),f=tt.retina?2:1;vt(o,e.min),o.width=f*h.x,o.height=f*h.y,o.style.width=h.x+"px",o.style.height=h.y+"px",tt.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){fe.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[c(e)]=e;var o=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var o=e._order,h=o.next,f=o.prev;h?h.prev=f:this._drawLast=f,f?f.next=h:this._drawFirst=h,delete e._order,delete this._layers[c(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(typeof e.options.dashArray=="string"){var o=e.options.dashArray.split(/[, ]+/),h=[],f,m;for(m=0;m<o.length;m++){if(f=Number(o[m]),isNaN(f))return;h.push(f)}e.options._dashArray=h}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||Z(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var o=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new $,this._redrawBounds.extend(e._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(e._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var o=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,o=this._redrawBounds;if(this._ctx.save(),o){var h=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)e=f.layer,(!o||e._pxBounds&&e._pxBounds.intersects(o))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,o){if(this._drawing){var h,f,m,b,D=e._parts,F=D.length,Y=this._ctx;if(F){for(Y.beginPath(),h=0;h<F;h++){for(f=0,m=D[h].length;f<m;f++)b=D[h][f],Y[f?"lineTo":"moveTo"](b.x,b.y);o&&Y.closePath()}this._fillStroke(Y,e)}}},_updateCircle:function(e){if(!(!this._drawing||e._empty())){var o=e._point,h=this._ctx,f=Math.max(Math.round(e._radius),1),m=(Math.max(Math.round(e._radiusY),1)||f)/f;m!==1&&(h.save(),h.scale(1,m)),h.beginPath(),h.arc(o.x,o.y/m,f,0,Math.PI*2,!1),m!==1&&h.restore(),this._fillStroke(h,e)}},_fillStroke:function(e,o){var h=o.options;h.fill&&(e.globalAlpha=h.fillOpacity,e.fillStyle=h.fillColor||h.color,e.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(e.setLineDash&&e.setLineDash(o.options&&o.options._dashArray||[]),e.globalAlpha=h.opacity,e.lineWidth=h.weight,e.strokeStyle=h.color,e.lineCap=h.lineCap,e.lineJoin=h.lineJoin,e.stroke())},_onClick:function(e){for(var o=this._map.mouseEventToLayerPoint(e),h,f,m=this._drawFirst;m;m=m.next)h=m.layer,h.options.interactive&&h._containsPoint(o)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(h))&&(f=h);this._fireEvent(f?[f]:!1,e)},_onMouseMove:function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,o)}},_handleMouseOut:function(e){var o=this._hoveredLayer;o&&(_t(this._container,"leaflet-interactive"),this._fireEvent([o],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,o){if(!this._mouseHoverThrottled){for(var h,f,m=this._drawFirst;m;m=m.next)h=m.layer,h.options.interactive&&h._containsPoint(o)&&(f=h);f!==this._hoveredLayer&&(this._handleMouseOut(e),f&&(at(this._container,"leaflet-interactive"),this._fireEvent([f],e,"mouseover"),this._hoveredLayer=f)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,e),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,o,h){this._map._fireDOMEvent(o,h||o.type,e)},_bringToFront:function(e){var o=e._order;if(o){var h=o.next,f=o.prev;if(h)h.prev=f;else return;f?f.next=h:h&&(this._drawFirst=h),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(e)}},_bringToBack:function(e){var o=e._order;if(o){var h=o.next,f=o.prev;if(f)f.next=h;else return;h?h.prev=f:f&&(this._drawLast=f),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(e)}}});function ys(e){return tt.canvas?new vs(e):null}var wi=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch{}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Tu={_initContainer:function(){this._container=ct("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(fe.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var o=e._container=wi("shape");at(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",e._path=wi("path"),o.appendChild(e._path),this._updateStyle(e),this._layers[c(e)]=e},_addPath:function(e){var o=e._container;this._container.appendChild(o),e.options.interactive&&e.addInteractiveTarget(o)},_removePath:function(e){var o=e._container;mt(o),e.removeInteractiveTarget(o),delete this._layers[c(e)]},_updateStyle:function(e){var o=e._stroke,h=e._fill,f=e.options,m=e._container;m.stroked=!!f.stroke,m.filled=!!f.fill,f.stroke?(o||(o=e._stroke=wi("stroke")),m.appendChild(o),o.weight=f.weight+"px",o.color=f.color,o.opacity=f.opacity,f.dashArray?o.dashStyle=v(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=f.lineCap.replace("butt","flat"),o.joinstyle=f.lineJoin):o&&(m.removeChild(o),e._stroke=null),f.fill?(h||(h=e._fill=wi("fill")),m.appendChild(h),h.color=f.fillColor||f.color,h.opacity=f.fillOpacity):h&&(m.removeChild(h),e._fill=null)},_updateCircle:function(e){var o=e._point.round(),h=Math.round(e._radius),f=Math.round(e._radiusY||h);this._setPath(e,e._empty()?"M0 0":"AL "+o.x+","+o.y+" "+h+","+f+" 0,"+65535*360)},_setPath:function(e,o){e._path.v=o},_bringToFront:function(e){Fe(e._container)},_bringToBack:function(e){Ne(e._container)}},Mn=tt.vml?wi:Lt,xi=fe.extend({_initContainer:function(){this._container=Mn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Mn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){mt(this._container),pt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fe.prototype._update.call(this);var e=this._bounds,o=e.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,h.setAttribute("width",o.x),h.setAttribute("height",o.y)),vt(h,e.min),h.setAttribute("viewBox",[e.min.x,e.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(e){var o=e._path=Mn("path");e.options.className&&at(o,e.options.className),e.options.interactive&&at(o,"leaflet-interactive"),this._updateStyle(e),this._layers[c(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){mt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[c(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var o=e._path,h=e.options;o&&(h.stroke?(o.setAttribute("stroke",h.color),o.setAttribute("stroke-opacity",h.opacity),o.setAttribute("stroke-width",h.weight),o.setAttribute("stroke-linecap",h.lineCap),o.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?o.setAttribute("stroke-dasharray",h.dashArray):o.removeAttribute("stroke-dasharray"),h.dashOffset?o.setAttribute("stroke-dashoffset",h.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),h.fill?(o.setAttribute("fill",h.fillColor||h.color),o.setAttribute("fill-opacity",h.fillOpacity),o.setAttribute("fill-rule",h.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(e,o){this._setPath(e,Ot(e._parts,o))},_updateCircle:function(e){var o=e._point,h=Math.max(Math.round(e._radius),1),f=Math.max(Math.round(e._radiusY),1)||h,m="a"+h+","+f+" 0 1,0 ",b=e._empty()?"M0 0":"M"+(o.x-h)+","+o.y+m+h*2+",0 "+m+-h*2+",0 ";this._setPath(e,b)},_setPath:function(e,o){e._path.setAttribute("d",o)},_bringToFront:function(e){Fe(e._path)},_bringToBack:function(e){Ne(e._path)}});tt.vml&&xi.include(Tu);function ws(e){return tt.svg||tt.vml?new xi(e):null}lt.include({getRenderer:function(e){var o=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(e){if(e==="overlayPane"||e===void 0)return!1;var o=this._paneRenderers[e];return o===void 0&&(o=this._createRenderer({pane:e}),this._paneRenderers[e]=o),o},_createRenderer:function(e){return this.options.preferCanvas&&ys(e)||ws(e)}});var xs=Ye.extend({initialize:function(e,o){Ye.prototype.initialize.call(this,this._boundsToLatLngs(e),o)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=Q(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Du(e,o){return new xs(e,o)}xi.create=Mn,xi.pointsToPath=Ot,ce.geometryToLayer=_n,ce.coordsToLatLng=Cr,ce.coordsToLatLngs=gn,ce.latLngToCoords=kr,ce.latLngsToCoords=vn,ce.getFeature=Xe,ce.asFeature=yn,lt.mergeOptions({boxZoom:!0});var bs=ie.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){pt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),fi(),cr(),this._startPoint=this._map.mouseEventToContainerPoint(e),st(document,{contextmenu:ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=ct("div","leaflet-zoom-box",this._container),at(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var o=new $(this._point,this._startPoint),h=o.getSize();vt(this._box,o.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(mt(this._box),_t(this._container,"leaflet-crosshair")),di(),fr(),pt(document,{contextmenu:ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var o=new et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(e){e.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});lt.addInitHook("addHandler","boxZoom",bs),lt.mergeOptions({doubleClickZoom:!0});var Ms=ie.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var o=this._map,h=o.getZoom(),f=o.options.zoomDelta,m=e.originalEvent.shiftKey?h-f:h+f;o.options.doubleClickZoom==="center"?o.setZoom(m):o.setZoomAround(e.containerPoint,m)}});lt.addInitHook("addHandler","doubleClickZoom",Ms),lt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ps=ie.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new ye(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}at(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){_t(this._map._container,"leaflet-grab"),_t(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=Q(this._map.options.maxBounds);this._offsetLimit=H(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var o=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(o),this._prunePositions(o)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,o){return e-(e-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var e=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;e.x<o.min.x&&(e.x=this._viscousLimit(e.x,o.min.x)),e.y<o.min.y&&(e.y=this._viscousLimit(e.y,o.min.y)),e.x>o.max.x&&(e.x=this._viscousLimit(e.x,o.max.x)),e.y>o.max.y&&(e.y=this._viscousLimit(e.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,o=Math.round(e/2),h=this._initialWorldOffset,f=this._draggable._newPos.x,m=(f-o+h)%e+o-h,b=(f+o+h)%e-o-h,D=Math.abs(m+h)<Math.abs(b+h)?m:b;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=D},_onDragEnd:function(e){var o=this._map,h=o.options,f=!h.inertia||e.noInertia||this._times.length<2;if(o.fire("dragend",e),f)o.fire("moveend");else{this._prunePositions(+new Date);var m=this._lastPos.subtract(this._positions[0]),b=(this._lastTime-this._times[0])/1e3,D=h.easeLinearity,F=m.multiplyBy(D/b),Y=F.distanceTo([0,0]),W=Math.min(h.inertiaMaxSpeed,Y),J=F.multiplyBy(W/Y),it=W/(h.inertiaDeceleration*D),ht=J.multiplyBy(-it/2).round();!ht.x&&!ht.y?o.fire("moveend"):(ht=o._limitOffset(ht,o.options.maxBounds),Z(function(){o.panBy(ht,{duration:it,easeLinearity:D,noMoveStart:!0,animate:!0})}))}}});lt.addInitHook("addHandler","dragging",Ps),lt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ls=ie.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),st(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),pt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,o=document.documentElement,h=e.scrollTop||o.scrollTop,f=e.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(f,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var o=this._panKeys={},h=this.keyCodes,f,m;for(f=0,m=h.left.length;f<m;f++)o[h.left[f]]=[-1*e,0];for(f=0,m=h.right.length;f<m;f++)o[h.right[f]]=[e,0];for(f=0,m=h.down.length;f<m;f++)o[h.down[f]]=[0,e];for(f=0,m=h.up.length;f<m;f++)o[h.up[f]]=[0,-1*e]},_setZoomDelta:function(e){var o=this._zoomKeys={},h=this.keyCodes,f,m;for(f=0,m=h.zoomIn.length;f<m;f++)o[h.zoomIn[f]]=e;for(f=0,m=h.zoomOut.length;f<m;f++)o[h.zoomOut[f]]=-e},_addHooks:function(){st(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){pt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var o=e.keyCode,h=this._map,f;if(o in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(f=this._panKeys[o],e.shiftKey&&(f=R(f).multiplyBy(3)),h.options.maxBounds&&(f=h._limitOffset(R(f),h.options.maxBounds)),h.options.worldCopyJump){var m=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(f)));h.panTo(m)}else h.panBy(f)}else if(o in this._zoomKeys)h.setZoom(h.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;ke(e)}}});lt.addInitHook("addHandler","keyboard",Ls),lt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Es=ie.extend({addHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){pt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var o=qo(e),h=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var f=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),f),ke(e)},_performZoom:function(){var e=this._map,o=e.getZoom(),h=this._map.options.zoomSnap||0;e._stop();var f=this._delta/(this._map.options.wheelPxPerZoomLevel*4),m=4*Math.log(2/(1+Math.exp(-Math.abs(f))))/Math.LN2,b=h?Math.ceil(m/h)*h:m,D=e._limitZoom(o+(this._delta>0?b:-b))-o;this._delta=0,this._startTime=null,D&&(e.options.scrollWheelZoom==="center"?e.setZoom(o+D):e.setZoomAround(this._lastMousePos,o+D))}});lt.addInitHook("addHandler","scrollWheelZoom",Es);var Au=600;lt.mergeOptions({tapHold:tt.touchNative&&tt.safari&&tt.mobile,tapTolerance:15});var Ss=ie.extend({addHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){pt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),e.touches.length===1){var o=e.touches[0];this._startPos=this._newPos=new X(o.clientX,o.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(st(document,"touchend",Et),st(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Au),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){pt(document,"touchend",Et),pt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),pt(document,"touchend touchcancel contextmenu",this._cancel,this),pt(document,"touchmove",this._onMove,this)},_onMove:function(e){var o=e.touches[0];this._newPos=new X(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,o){var h=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});h._simulated=!0,o.target.dispatchEvent(h)}});lt.addInitHook("addHandler","tapHold",Ss),lt.mergeOptions({touchZoom:tt.touch,bounceAtZoomLimits:!0});var Cs=ie.extend({addHooks:function(){at(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_t(this._map._container,"leaflet-touch-zoom"),pt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var o=this._map;if(!(!e.touches||e.touches.length!==2||o._animatingZoom||this._zooming)){var h=o.mouseEventToContainerPoint(e.touches[0]),f=o.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(h.add(f)._divideBy(2))),this._startDist=h.distanceTo(f),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),Et(e)}},_onTouchMove:function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var o=this._map,h=o.mouseEventToContainerPoint(e.touches[0]),f=o.mouseEventToContainerPoint(e.touches[1]),m=h.distanceTo(f)/this._startDist;if(this._zoom=o.getScaleZoom(m,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&m<1||this._zoom>o.getMaxZoom()&&m>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,m===1)return}else{var b=h._add(f)._divideBy(2)._subtract(this._centerPoint);if(m===1&&b.x===0&&b.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(b),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var D=l(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Z(D,this,!0),Et(e)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),pt(document,"touchmove",this._onTouchMove,this),pt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});lt.addInitHook("addHandler","touchZoom",Cs),lt.BoxZoom=bs,lt.DoubleClickZoom=Ms,lt.Drag=Ps,lt.Keyboard=Ls,lt.ScrollWheelZoom=Es,lt.TapHold=Ss,lt.TouchZoom=Cs,n.Bounds=$,n.Browser=tt,n.CRS=ot,n.Canvas=vs,n.Circle=Sr,n.CircleMarker=mn,n.Class=x,n.Control=Vt,n.DivIcon=ms,n.DivOverlay=ne,n.DomEvent=ql,n.DomUtil=$l,n.Draggable=ye,n.Evented=V,n.FeatureGroup=le,n.GeoJSON=ce,n.GridLayer=yi,n.Handler=ie,n.Icon=Ze,n.ImageOverlay=wn,n.LatLng=K,n.LatLngBounds=et,n.Layer=Ht,n.LayerGroup=Re,n.LineUtil=lu,n.Map=lt,n.Marker=pn,n.Mixin=nu,n.Path=we,n.Point=X,n.PolyUtil=ru,n.Polygon=Ye,n.Polyline=ue,n.Popup=xn,n.PosAnimation=Jo,n.Projection=uu,n.Rectangle=xs,n.Renderer=fe,n.SVG=xi,n.SVGOverlay=ps,n.TileLayer=Ue,n.Tooltip=bn,n.Transformation=bt,n.Util=U,n.VideoOverlay=ds,n.bind=l,n.bounds=H,n.canvas=ys,n.circle=vu,n.circleMarker=gu,n.control=_i,n.divIcon=Su,n.extend=s,n.featureGroup=pu,n.geoJSON=fs,n.geoJson=xu,n.gridLayer=Cu,n.icon=mu,n.imageOverlay=bu,n.latLng=q,n.latLngBounds=Q,n.layerGroup=du,n.map=Jl,n.marker=_u,n.point=R,n.polygon=wu,n.polyline=yu,n.popup=Lu,n.rectangle=Du,n.setOptions=k,n.stamp=c,n.svg=ws,n.svgOverlay=Pu,n.tileLayer=_s,n.tooltip=Eu,n.transformation=St,n.version=r,n.videoOverlay=Mu;var Ou=window.L;n.noConflict=function(){return window.L=Ou,this},window.L=n}))})(Fi,Fi.exports)),Fi.exports}var el=kp();const Tp=mh(el),il=Xu({__proto__:null,default:Tp},[el]),Dp="_button_bm3j1_1",Ap="_active_bm3j1_20",Op="_hiddenOnMobile_bm3j1_25",Zn={button:Dp,active:Ap,hiddenOnMobile:Op};function Ip(i){return i.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}const Bp=({mode:i,currentMode:t,changeMode:n,label:r,hiddenOnTouch:s})=>{let a=Zn.button;return s&&(a=`${Zn.hiddenOnMobile} ${a}`),t===i&&(a=`${Zn.active} ${a}`),rt("button",{id:i,class:a,onClick:()=>{n(i)},children:r||Ip(i)})},zp=({label:i,onClick:t})=>rt("button",{id:"clear",class:Zn.button,onClick:()=>{t()},children:i}),Fp="_controls_p8l60_5",Np="_primaryRow_p8l60_19",Rp="_primaryControl_p8l60_23",Zp="_button_p8l60_27",Yp="_routingSelect_p8l60_28",Ke={controls:Fp,primaryRow:Np,primaryControl:Rp,button:Zp,routingSelect:Yp},Xp=(i,t)=>{const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3};function Up(i){const t=.0033528106647474805,n=t*(2-t),r=Math.PI/180,s=Math.cos(i*r),a=1/(1-n*(1-s*s)),l=Math.sqrt(a),u=6378.137*r,c=u*l*s,d=u*l*a*(1-n);return function(p,_){let w=p[0]-_[0];for(;w<-180;)w+=360;for(;w>180;)w-=360;const M=w*c,P=(p[1]-_[1])*d;return Math.sqrt(M*M+P*P)}}let jp=class{constructor(){this.keys=[],this.values=[],this.idxs=[],this.length=0,this.insertCounter=0}insert(t,n){let r=this.length;this.length=r+1;let s=t,a=n,l=this.insertCounter++;for(;r>0;){const u=r-1>>>2,c=this.keys[u],d=this.idxs[u];if(s>c||s===c&&l>d)break;this.keys[r]=c,this.values[r]=this.values[u],this.idxs[r]=d,r=u}this.keys[r]=s,this.values[r]=a,this.idxs[r]=l}extractMin(){const t=this.length;if(t===0)return null;const n=this.values[0],r=t-1;return this.length=r,r>0&&(this.keys[0]=this.keys[r],this.values[0]=this.values[r],this.idxs[0]=this.idxs[r],this.bubbleDown(0)),n}size(){return this.length}bubbleDown(t){const n=this.length,r=this.keys,s=this.values,a=this.idxs,l=r[t],u=s[t],c=a[t];for(;;){const d=1+(t<<2);if(d>=n)break;let p=d,_=r[d],w=a[d],M=s[d];const P=d+1;if(P<n){const O=r[P],g=a[P];(O<_||O===_&&g<w)&&(p=P,_=O,w=g,M=s[P])}const k=d+2;if(k<n){const O=r[k],g=a[k];(O<_||O===_&&g<w)&&(p=k,_=O,w=g,M=s[k])}const A=d+3;if(A<n){const O=r[A],g=a[A];(O<_||O===_&&g<w)&&(p=A,_=O,w=g,M=s[A])}if(!(_<l||_===l&&w<c))break;r[t]=_,s[t]=M,a[t]=w,t=p}r[t]=l,s[t]=u,a[t]=c}},Wp=class{constructor(t){var n,r;this.network=null,this.distanceMeasurement=void 0,this.heapConstructor=void 0,this.coordinateIndexMap=new Map,this.coordinates=[],this.adjacencyList=[],this.csrOffsets=null,this.csrIndices=null,this.csrDistances=null,this.csrNodeCount=0,this.gScoreScratch=null,this.cameFromScratch=null,this.visitedScratch=null,this.hScratch=null,this.scratchCapacity=0,this.distanceMeasurement=(n=t?.distanceMeasurement)!=null?n:Xp,this.heapConstructor=(r=t?.heap)!=null?r:jp}buildRouteGraph(t){this.network=t,this.coordinateIndexMap=new Map,this.coordinates=[],this.adjacencyList=[],this.csrOffsets=null,this.csrIndices=null,this.csrDistances=null,this.csrNodeCount=0;const n=this.coordinateIndexMap,r=this.coordinates,s=this.distanceMeasurement,a=t.features,l=[];for(let A=0,O=a.length;A<O;A++){const g=a[A].geometry.coordinates;for(let v=0,y=g.length-1;v<y;v++){var u,c;const E=g[v],S=g[v+1],C=E[0],T=E[1],z=S[0],N=S[1];let Z=n.get(C);Z===void 0&&(Z=new Map,n.set(C,Z));let j=Z.get(T);j===void 0&&(j=r.length,r.push(E),Z.set(T,j));let U=n.get(z);U===void 0&&(U=new Map,n.set(z,U));let x=U.get(N);x===void 0&&(x=r.length,r.push(S),U.set(N,x)),l[j]=((u=l[j])!=null?u:0)+1,l[x]=((c=l[x])!=null?c:0)+1}}const d=this.coordinates.length;this.csrNodeCount=d;const p=new Int32Array(d+1);for(let A=0;A<d;A++){var _;const O=(_=l[A])!=null?_:0;p[A+1]=p[A]+O}const w=p[d],M=new Int32Array(w),P=new Float64Array(w),k=p.slice();for(let A=0,O=a.length;A<O;A++){const g=a[A].geometry.coordinates;for(let v=0,y=g.length-1;v<y;v++){const E=g[v],S=g[v+1],C=E[1],T=S[0],z=S[1],N=this.coordinateIndexMap.get(E[0]).get(C),Z=this.coordinateIndexMap.get(T).get(z),j=s(E,S);let U=k[N]++;M[U]=Z,P[U]=j,U=k[Z]++,M[U]=N,P[U]=j}}this.csrOffsets=p,this.csrIndices=M,this.csrDistances=P,this.adjacencyList=new Array(d)}getRoute(t,n){if(this.network===null)throw new Error("Network not built. Please call buildRouteGraph(network) first.");const r=this.getOrCreateIndex(t.geometry.coordinates),s=this.getOrCreateIndex(n.geometry.coordinates);if(r===s)return null;const a=this.coordinates,l=this.adjacencyList,u=this.distanceMeasurement,c=a.length;this.ensureScratch(c);const d=this.gScoreScratch,p=this.cameFromScratch,_=this.visitedScratch,w=this.hScratch;d.fill(Number.POSITIVE_INFINITY,0,c),p.fill(-1,0,c),_.fill(0,0,c),w.fill(-1,0,c);const M=new this.heapConstructor,P=a[s];let k=w[r];for(k<0&&(k=u(a[r],P),w[r]=k),M.insert(k,r),d[r]=0;M.size()>0;){const g=M.extractMin();if(_[g]===0){if(g===s)break;if(_[g]=1,this.csrOffsets&&g<this.csrNodeCount){const v=this.csrOffsets,y=this.csrIndices,E=this.csrDistances,S=v[g+1];for(let C=v[g];C<S;C++){const T=y[C],z=d[g]+E[C];if(z<d[T]){d[T]=z,p[T]=g;let N=w[T];N<0&&(N=u(a[T],P),w[T]=N),M.insert(z+N,T)}}}else{const v=l[g];if(!v||v.length===0)continue;for(let y=0,E=v.length;y<E;y++){const S=v[y],C=S.node,T=d[g]+S.distance;if(T<d[C]){d[C]=T,p[C]=g;let z=w[C];z<0&&(z=u(a[C],P),w[C]=z),M.insert(T+z,C)}}}}}if(p[s]<0)return null;const A=[];let O=s;for(;O!==r;)A.push(a[O]),O=p[O];return A.push(a[r]),A.reverse(),{type:"Feature",geometry:{type:"LineString",coordinates:A},properties:{}}}getOrCreateIndex(t){const n=t[0],r=t[1];let s=this.coordinateIndexMap.get(n);s===void 0&&(s=new Map,this.coordinateIndexMap.set(n,s));let a=s.get(r);if(a===void 0&&(a=this.coordinates.length,this.coordinates.push(t),s.set(r,a),this.adjacencyList[a]=[],this.csrOffsets)){const l=this.csrNodeCount;if(a===l){const u=new Int32Array(l+2);u.set(this.csrOffsets,0),u[l+1]=u[l],this.csrOffsets=u,this.csrNodeCount=l+1}}return a}ensureScratch(t){if(this.scratchCapacity>=t&&this.gScoreScratch&&this.cameFromScratch&&this.visitedScratch&&this.hScratch)return;const n=0|t;this.gScoreScratch=new Float64Array(n),this.cameFromScratch=new Int32Array(n),this.visitedScratch=new Uint8Array(n),this.hScratch=new Float64Array(n),this.scratchCapacity=n}};var Bt=63710088e-1,Vp={centimeters:Bt*100,centimetres:Bt*100,degrees:Bt/111325,feet:Bt*3.28084,inches:Bt*39.37,kilometers:Bt/1e3,kilometres:Bt/1e3,meters:Bt,metres:Bt,miles:Bt/1609.344,millimeters:Bt*1e3,millimetres:Bt*1e3,nauticalmiles:Bt/1852,radians:1,yards:Bt*1.0936};function nl(i,t,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Qn(i,t,n){if(n===void 0&&(n={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Da(i[0])||!Da(i[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:i};return nl(r,t,n)}function Hp(i,t,n){if(n===void 0&&(n={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:i};return nl(r,t,n)}function rl(i,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=i,n}function $p(i,t){t===void 0&&(t="kilometers");var n=Vp[t];if(!n)throw new Error(t+" units is invalid");return i*n}function An(i){var t=i%360;return t*Math.PI/180}function Da(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Gp(i,t,n,r={}){const s={vertices:Object.keys(i).reduce((_,w)=>(_[w]={...i[w]},_),{}),coordinates:Object.keys(i).reduce((_,w)=>{_[w]={};for(const M of Object.keys(i[w]))_[w][M]=[t[w]];return _},{}),edgeData:"edgeDataReducer"in r?Object.keys(i).reduce((_,w)=>(_[w]=Object.keys(i[w]).reduce((M,P)=>(M[P]=n[w][P],M),{}),_),{}):{}},{vertices:a,coordinates:l,edgeData:u}=s,c="edgeDataReducer"in r&&u,d=Object.keys(i).filter(_=>Kp(i,_));for(const _ of d){const w=a[_],M=Object.keys(w);if(M.length!==0){for(const P of M)for(const k of M)P!==k&&(p(_,P,k),p(_,k,P));for(const P of M){if(!a[P])throw new Error(`Missing neighbor vertex for ${P}`);delete a[P][_],delete l[P][_]}delete a[_],delete l[_]}}return s;function p(_,w,M){const P=a[_],k=a[w],A=k[_];if(!k[M]&&A){k[M]=A+P[M],l[w][M]=[...l[w][_],...l[_][M]];let O=c?u[w][_]:void 0;const g=c?u[_][M]:void 0;c&&O&&g&&(u[w][M]=r.edgeDataReducer(O,g))}}}function qp(i,t,n,r,s,a,l={}){const u=t[i];return Object.keys(u).reduce(c,{edges:{},incomingEdges:{},coordinates:{},incomingCoordinates:{},reducedEdges:{}});function c(d,p){const _=Jp(i,p,t,n,r,s,a,l),w=_.weight,M=_.reverseWeight;if(_.vertexKey!==i&&((!d.edges[_.vertexKey]||d.edges[_.vertexKey]>w)&&(d.edges[_.vertexKey]=w,d.coordinates[_.vertexKey]=[r[i]].concat(_.coordinates),d.reducedEdges[_.vertexKey]=_.reducedEdge),!isNaN(M)&&(!d.incomingEdges[_.vertexKey]||d.incomingEdges[_.vertexKey]>M))){d.incomingEdges[_.vertexKey]=M;var P=[r[i]].concat(_.coordinates);P.reverse(),d.incomingCoordinates[_.vertexKey]=P}return d}}function Jp(i,t,n,r,s,a,l,u={}){let c=n[i][t],d=n[t][i];const p=[],_=[];let w="edgeDataReducer"in u?a[t][i]:void 0;for(;!r[t];){var M=n[t];if(!M)break;var P=Object.keys(M).filter(function(O){return O!==i})[0];c+=M[P];{if(d+=n[P]?.[t]||1/0,_.indexOf(t)>=0){r[t]=n[t];break}_.push(t)}const k=a[t]&&a[t][P];"edgeDataReducer"in u&&w&&k&&(w=u.edgeDataReducer(w,k)),p.push(s[t]),i=t,t=P}return{vertexKey:t,weight:c,reverseWeight:d,coordinates:p,reducedEdge:w}}function Kp(i,t){const n=i[t],r=Object.keys(n);switch(r.length){case 1:return!i[r[0]][t];case 2:return r.every(a=>i[a][t]);default:return!1}}class ol{constructor(t=[],n=Qp){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=(t<<1)+1,u=n[l];const c=l+1;if(c<this.length&&r(n[c],u)<0&&(l=c,u=n[c]),r(u,a)>=0)break;n[t]=u,t=l}n[t]=a}}function Qp(i,t){return i<t?-1:i>t?1:0}const tm=Object.freeze(Object.defineProperty({__proto__:null,default:ol},Symbol.toStringTag,{value:"Module"}));function em(i,t,n){const r={[t]:0},s=[0,[t],t],a=new ol([s],(l,u)=>l[0]-u[0]);for(;;){const l=a.pop();if(!l)return;const u=l[0],c=l[2];if(c===n)return[l[0],l[1]];const d=i[c];Object.keys(d).forEach(function(p){var _=u+d[p];if(_<1/0&&(!(p in r)||_<r[p])){r[p]=_;const w=[_,l[1].concat([p]),p];a.push(w)}})}}function Aa(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function im(i,t,n){n===void 0&&(n={});var r=Aa(i),s=Aa(t),a=An(s[1]-r[1]),l=An(s[0]-r[0]),u=An(r[1]),c=An(s[1]),d=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(c);return $p(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),n.units)}function lo(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,w,M=i.type,P=M==="FeatureCollection",k=M==="Feature",A=P?i.features.length:1,O=0;O<A;O++){d=P?i.features[O].geometry:k?i.geometry:i,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var g=0;g<u;g++){var v=0,y=0;if(l=w?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,O,v,y)===!1)return!1;_++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,O,v,y)===!1)return!1;_++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,O,v,y)===!1)return!1;_++}E==="MultiLineString"&&v++,E==="Polygon"&&y++}E==="Polygon"&&v++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,O,v,y)===!1)return!1;_++}y++}v++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(lo(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function nm(i,t){if(i.type==="Feature")t(i,0);else if(i.type==="FeatureCollection")for(var n=0;n<i.features.length&&t(i.features[n],n)!==!1;n++);}function rm(i){var t=[];return i.type==="FeatureCollection"?nm(i,function(n){lo(n,function(r){t.push(Qn(r,n.properties))})}):lo(i,function(n){t.push(Qn(n,i.properties))}),rl(t)}function ji(i,t){return[Math.round(i[0]/t)*t,Math.round(i[1]/t)*t]}function om(i,t={}){const{key:n=al}=t,{tolerance:r=1e-5}=t,s=rl(i.features.filter(d=>d.geometry.type==="LineString")),l=rm(s).features.reduce(function(p,_,w,M){var P=ji(_.geometry.coordinates,r);return p[n(P)]=_.geometry.coordinates,w%1e3===0&&t.progress&&t.progress("topo:vertices",w,M.length),p},{}),u=sl(s,c,[]);return{vertices:l,edges:u};function c(d,p){return p.geometry.coordinates.forEach(function(w,M,P){if(M>0){var k=n(ji(P[M-1],r)),A=n(ji(w,r));d.push([k,A,p.properties])}}),d}}function sl(i,t,n){return i.type==="FeatureCollection"?i.features.reduce(function(s,a){return sl(a,t,s)},n):t(n,i)}function al(i){return i.join(",")}function sm(i,t={}){const n=om(i,t),{weight:r=am}=t,s=n.edges.reduce(c,{edgeData:{},vertices:{}}),{vertices:a,coordinates:l,edgeData:u}=Gp(s.vertices,n.vertices,s.edgeData,t);return{vertices:s.vertices,edgeData:s.edgeData,sourceCoordinates:n.vertices,compactedVertices:a,compactedCoordinates:l,compactedEdges:u};function c(d,p,_,w){const[M,P,k]=p,A=r(n.vertices[M],n.vertices[P],k);return A&&(O(M),O(P),A instanceof Object?(g(M,P,A.forward||1/0),g(P,M,A.backward||1/0)):(g(M,P,A||1/0),g(P,M,A||1/0))),_%1e3===0&&t.progress&&t.progress("edgeweights",_,w.length),d;function O(v){d.vertices[v]||(d.vertices[v]={},d.edgeData[v]={})}function g(v,y,E){var S=d.vertices[v];S[y]=E,d.edgeData[v][y]="edgeDataReducer"in t?t.edgeDataSeed(k):void 0}}}function am(i,t){return im(Qn(i),Qn(t))}class Oa{constructor(t,n={}){this.graph=sm(t,n),this.options=n}findPath(t,n){const{key:r=al,tolerance:s=1e-5}=this.options,a=r(ji(t.geometry.coordinates,s)),l=r(ji(n.geometry.coordinates,s));if(!this.graph.vertices[a]||!this.graph.vertices[l])return;const u=this._createPhantom(a),c=this._createPhantom(l);try{const d=em(this.graph.compactedVertices,a,l);if(d){const[p,_]=d;return{path:_.reduce((w,M,P,k)=>(P>0&&(w=w.concat(this.graph.compactedCoordinates[k[P-1]][M])),w),[]).concat([this.graph.sourceCoordinates[l]]),weight:p,edgeDatas:"edgeDataReducer"in this.options?_.reduce((w,M,P,k)=>(P>0&&w.push(this.graph.compactedEdges[k[P-1]][M]),w),[]):void 0}}else return}finally{this._removePhantom(u),this._removePhantom(c)}}_createPhantom(t){if(this.graph.compactedVertices[t])return;const n=qp(t,this.graph.vertices,this.graph.compactedVertices,this.graph.sourceCoordinates,this.graph.edgeData,!0,this.options);return this.graph.compactedVertices[t]=n.edges,this.graph.compactedCoordinates[t]=n.coordinates,"edgeDataReducer"in this.options&&(this.graph.compactedEdges[t]=n.reducedEdges),Object.keys(n.incomingEdges).forEach(r=>{this.graph.compactedVertices[r][t]=n.incomingEdges[r],this.graph.compactedCoordinates[r]||(this.graph.compactedCoordinates[r]={}),this.graph.compactedCoordinates[r][t]=[this.graph.sourceCoordinates[r],...n.incomingCoordinates[r].slice(0,-1)],this.graph.compactedEdges&&(this.graph.compactedEdges[r]||(this.graph.compactedEdges[r]={}),this.graph.compactedEdges[r][t]=n.reducedEdges[r])}),t}_removePhantom(t){t&&(Object.keys(this.graph.compactedVertices[t]).forEach(n=>{delete this.graph.compactedVertices[n][t]}),Object.keys(this.graph.compactedCoordinates[t]).forEach(n=>{delete this.graph.compactedCoordinates[n][t]}),"edgeDataReducer"in this.options&&Object.keys(this.graph.compactedEdges[t]).forEach(n=>{delete this.graph.compactedEdges[n][t]}),delete this.graph.compactedVertices[t],delete this.graph.compactedCoordinates[t],this.graph.compactedEdges&&delete this.graph.compactedEdges[t])}}function hm(i){if(i){const{weight:t,edgeDatas:n}=i;return Hp(i.path,{weight:t,edgeDatas:n})}}function lm(i){let t=new Oa(i);return{getRoute:(r,s)=>{const a=t.findPath(r,s);return a&&a.path.length>1?hm(a):null},setNetwork:r=>{t=new Oa(r)}}}function um(i){const t=Up(i.features[0].geometry.coordinates[0][1]),n=new Wp({distanceMeasurement:t});return n.buildRouteGraph(i),{getRoute:n.getRoute.bind(n),setNetwork:r=>{n.buildRouteGraph(r)}}}const Jt={TerraRoute:"terra-route",GeoJSONPathFinder:"geojson-path-finder"};function Ia(i,t=Jt.TerraRoute){let n;if(t===Jt.GeoJSONPathFinder)n=lm(i);else if(t===Jt.TerraRoute)n=um(i);else throw new Error(`Unknown routing option: ${t}`);return n}const cm=({mode:i,onClear:t,changeMode:n,onPrune:r,routingOption:s,routingDisabled:a,onRoutingChange:l})=>rt("div",{class:Ke.controls,children:[rt("div",{class:Ke.primaryRow,children:[rt("div",{class:Ke.primaryControl,children:rt(Bp,{label:"Route Snap",mode:"routesnap",currentMode:i,changeMode:n})}),rt("div",{class:Ke.primaryControl,children:rt(zp,{onClick:t,label:"Clear"})})]}),rt("button",{class:Ke.button,onClick:r,children:"Prune"}),rt("select",{value:s,disabled:a,onChange:u=>{const c=u.target,d=c.options[c.selectedIndex].value;l(d)},class:Ke.routingSelect,children:[rt("option",{value:Jt.TerraRoute,children:"Terra Route"}),rt("option",{value:Jt.GeoJSONPathFinder,children:"GeoJSON Path Finder"})]})]});function fm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function dm(i,t,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return fm({type:"Polygon",coordinates:i},t,n)}function hl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,w,M=i.type,P=M==="FeatureCollection",k=M==="Feature",A=P?i.features.length:1,O=0;O<A;O++){d=P?i.features[O].geometry:k?i.geometry:i,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var g=0;g<u;g++){var v=0,y=0;if(l=w?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,O,v,y)===!1)return!1;_++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,O,v,y)===!1)return!1;_++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,O,v,y)===!1)return!1;_++}E==="MultiLineString"&&v++,E==="Polygon"&&y++}E==="Polygon"&&v++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,O,v,y)===!1)return!1;_++}y++}v++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(hl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var On={exports:{}},Yn={exports:{}},pm=Yn.exports,Ba;function mm(){return Ba||(Ba=1,(function(i,t){(function(n,r){i.exports=r()})(pm,function(){function n(g,v,y,E,S){(function C(T,z,N,Z,j){for(;Z>N;){if(Z-N>600){var U=Z-N+1,x=z-N+1,I=Math.log(U),B=.5*Math.exp(2*I/3),V=.5*Math.sqrt(I*B*(U-B)/U)*(x-U/2<0?-1:1),X=Math.max(N,Math.floor(z-x*B/U+V)),G=Math.min(Z,Math.floor(z+(U-x)*B/U+V));C(T,z,X,G,j)}var R=T[z],$=N,H=Z;for(r(T,N,z),j(T[Z],R)>0&&r(T,N,Z);$<H;){for(r(T,$,H),$++,H--;j(T[$],R)<0;)$++;for(;j(T[H],R)>0;)H--}j(T[N],R)===0?r(T,N,H):r(T,++H,Z),H<=z&&(N=H+1),z<=H&&(Z=H-1)}})(g,v,y||0,E||g.length-1,S||s)}function r(g,v,y){var E=g[v];g[v]=g[y],g[y]=E}function s(g,v){return g<v?-1:g>v?1:0}var a=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(g,v,y){if(!y)return v.indexOf(g);for(var E=0;E<v.length;E++)if(y(g,v[E]))return E;return-1}function u(g,v){c(g,0,g.children.length,v,g)}function c(g,v,y,E,S){S||(S=A(null)),S.minX=1/0,S.minY=1/0,S.maxX=-1/0,S.maxY=-1/0;for(var C=v;C<y;C++){var T=g.children[C];d(S,g.leaf?E(T):T)}return S}function d(g,v){return g.minX=Math.min(g.minX,v.minX),g.minY=Math.min(g.minY,v.minY),g.maxX=Math.max(g.maxX,v.maxX),g.maxY=Math.max(g.maxY,v.maxY),g}function p(g,v){return g.minX-v.minX}function _(g,v){return g.minY-v.minY}function w(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function M(g){return g.maxX-g.minX+(g.maxY-g.minY)}function P(g,v){return g.minX<=v.minX&&g.minY<=v.minY&&v.maxX<=g.maxX&&v.maxY<=g.maxY}function k(g,v){return v.minX<=g.maxX&&v.minY<=g.maxY&&v.maxX>=g.minX&&v.maxY>=g.minY}function A(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function O(g,v,y,E,S){for(var C=[v,y];C.length;)if(!((y=C.pop())-(v=C.pop())<=E)){var T=v+Math.ceil((y-v)/E/2)*E;n(g,T,v,y,S),C.push(v,T,T,y)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(g){var v=this.data,y=[];if(!k(g,v))return y;for(var E=this.toBBox,S=[];v;){for(var C=0;C<v.children.length;C++){var T=v.children[C],z=v.leaf?E(T):T;k(g,z)&&(v.leaf?y.push(T):P(g,z)?this._all(T,y):S.push(T))}v=S.pop()}return y},a.prototype.collides=function(g){var v=this.data;if(!k(g,v))return!1;for(var y=[];v;){for(var E=0;E<v.children.length;E++){var S=v.children[E],C=v.leaf?this.toBBox(S):S;if(k(g,C)){if(v.leaf||P(g,C))return!0;y.push(S)}}v=y.pop()}return!1},a.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var v=0;v<g.length;v++)this.insert(g[v]);return this}var y=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===y.height)this._splitRoot(this.data,y);else{if(this.data.height<y.height){var E=this.data;this.data=y,y=E}this._insert(y,this.data.height-y.height-1,!0)}else this.data=y;return this},a.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},a.prototype.clear=function(){return this.data=A([]),this},a.prototype.remove=function(g,v){if(!g)return this;for(var y,E,S,C=this.data,T=this.toBBox(g),z=[],N=[];C||z.length;){if(C||(C=z.pop(),E=z[z.length-1],y=N.pop(),S=!0),C.leaf){var Z=l(g,C.children,v);if(Z!==-1)return C.children.splice(Z,1),z.push(C),this._condense(z),this}S||C.leaf||!P(C,T)?E?(y++,C=E.children[y],S=!1):C=null:(z.push(C),N.push(y),y=0,E=C,C=C.children[0])}return this},a.prototype.toBBox=function(g){return g},a.prototype.compareMinX=function(g,v){return g.minX-v.minX},a.prototype.compareMinY=function(g,v){return g.minY-v.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(g){return this.data=g,this},a.prototype._all=function(g,v){for(var y=[];g;)g.leaf?v.push.apply(v,g.children):y.push.apply(y,g.children),g=y.pop();return v},a.prototype._build=function(g,v,y,E){var S,C=y-v+1,T=this._maxEntries;if(C<=T)return u(S=A(g.slice(v,y+1)),this.toBBox),S;E||(E=Math.ceil(Math.log(C)/Math.log(T)),T=Math.ceil(C/Math.pow(T,E-1))),(S=A([])).leaf=!1,S.height=E;var z=Math.ceil(C/T),N=z*Math.ceil(Math.sqrt(T));O(g,v,y,N,this.compareMinX);for(var Z=v;Z<=y;Z+=N){var j=Math.min(Z+N-1,y);O(g,Z,j,z,this.compareMinY);for(var U=Z;U<=j;U+=z){var x=Math.min(U+z-1,j);S.children.push(this._build(g,U,x,E-1))}}return u(S,this.toBBox),S},a.prototype._chooseSubtree=function(g,v,y,E){for(;E.push(v),!v.leaf&&E.length-1!==y;){for(var S=1/0,C=1/0,T=void 0,z=0;z<v.children.length;z++){var N=v.children[z],Z=w(N),j=(U=g,x=N,(Math.max(x.maxX,U.maxX)-Math.min(x.minX,U.minX))*(Math.max(x.maxY,U.maxY)-Math.min(x.minY,U.minY))-Z);j<C?(C=j,S=Z<S?Z:S,T=N):j===C&&Z<S&&(S=Z,T=N)}v=T||v.children[0]}var U,x;return v},a.prototype._insert=function(g,v,y){var E=y?g:this.toBBox(g),S=[],C=this._chooseSubtree(E,this.data,v,S);for(C.children.push(g),d(C,E);v>=0&&S[v].children.length>this._maxEntries;)this._split(S,v),v--;this._adjustParentBBoxes(E,S,v)},a.prototype._split=function(g,v){var y=g[v],E=y.children.length,S=this._minEntries;this._chooseSplitAxis(y,S,E);var C=this._chooseSplitIndex(y,S,E),T=A(y.children.splice(C,y.children.length-C));T.height=y.height,T.leaf=y.leaf,u(y,this.toBBox),u(T,this.toBBox),v?g[v-1].children.push(T):this._splitRoot(y,T)},a.prototype._splitRoot=function(g,v){this.data=A([g,v]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(g,v,y){for(var E,S,C,T,z,N,Z,j=1/0,U=1/0,x=v;x<=y-v;x++){var I=c(g,0,x,this.toBBox),B=c(g,x,y,this.toBBox),V=(S=I,C=B,T=void 0,z=void 0,N=void 0,Z=void 0,T=Math.max(S.minX,C.minX),z=Math.max(S.minY,C.minY),N=Math.min(S.maxX,C.maxX),Z=Math.min(S.maxY,C.maxY),Math.max(0,N-T)*Math.max(0,Z-z)),X=w(I)+w(B);V<j?(j=V,E=x,U=X<U?X:U):V===j&&X<U&&(U=X,E=x)}return E||y-v},a.prototype._chooseSplitAxis=function(g,v,y){var E=g.leaf?this.compareMinX:p,S=g.leaf?this.compareMinY:_;this._allDistMargin(g,v,y,E)<this._allDistMargin(g,v,y,S)&&g.children.sort(E)},a.prototype._allDistMargin=function(g,v,y,E){g.children.sort(E);for(var S=this.toBBox,C=c(g,0,v,S),T=c(g,y-v,y,S),z=M(C)+M(T),N=v;N<y-v;N++){var Z=g.children[N];d(C,g.leaf?S(Z):Z),z+=M(C)}for(var j=y-v-1;j>=v;j--){var U=g.children[j];d(T,g.leaf?S(U):U),z+=M(T)}return z},a.prototype._adjustParentBBoxes=function(g,v,y){for(var E=y;E>=0;E--)d(v[E],g)},a.prototype._condense=function(g){for(var v=g.length-1,y=void 0;v>=0;v--)g[v].children.length===0?v>0?(y=g[v-1].children).splice(y.indexOf(g[v]),1):this.clear():u(g[v],this.toBBox)},a})})(Yn)),Yn.exports}const _m=_o(tm);var Di={exports:{}},jr,za;function gm(){return za||(za=1,jr=function(t,n,r,s){var a=t[0],l=t[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var c=(s-r)/2,d=0,p=c-1;d<c;p=d++){var _=n[r+d*2+0],w=n[r+d*2+1],M=n[r+p*2+0],P=n[r+p*2+1],k=w>l!=P>l&&a<(M-_)*(l-w)/(P-w)+_;k&&(u=!u)}return u}),jr}var Wr,Fa;function vm(){return Fa||(Fa=1,Wr=function(t,n,r,s){var a=t[0],l=t[1],u=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);for(var c=s-r,d=0,p=c-1;d<c;p=d++){var _=n[d+r][0],w=n[d+r][1],M=n[p+r][0],P=n[p+r][1],k=w>l!=P>l&&a<(M-_)*(l-w)/(P-w)+_;k&&(u=!u)}return u}),Wr}var Na;function ym(){if(Na)return Di.exports;Na=1;var i=gm(),t=vm();return Di.exports=function(r,s,a,l){return s.length>0&&Array.isArray(s[0])?t(r,s,a,l):i(r,s,a,l)},Di.exports.nested=t,Di.exports.flat=i,Di.exports}var Ni={exports:{}},wm=Ni.exports,Ra;function xm(){return Ra||(Ra=1,(function(i,t){(function(n,r){r(t)})(wm,function(n){const s=33306690738754706e-32;function a(k,A,O,g,v){let y,E,S,C,T=A[0],z=g[0],N=0,Z=0;z>T==z>-T?(y=T,T=A[++N]):(y=z,z=g[++Z]);let j=0;if(N<k&&Z<O)for(z>T==z>-T?(S=y-((E=T+y)-T),T=A[++N]):(S=y-((E=z+y)-z),z=g[++Z]),y=E,S!==0&&(v[j++]=S);N<k&&Z<O;)z>T==z>-T?(S=y-((E=y+T)-(C=E-y))+(T-C),T=A[++N]):(S=y-((E=y+z)-(C=E-y))+(z-C),z=g[++Z]),y=E,S!==0&&(v[j++]=S);for(;N<k;)S=y-((E=y+T)-(C=E-y))+(T-C),T=A[++N],y=E,S!==0&&(v[j++]=S);for(;Z<O;)S=y-((E=y+z)-(C=E-y))+(z-C),z=g[++Z],y=E,S!==0&&(v[j++]=S);return y===0&&j!==0||(v[j++]=y),j}function l(k){return new Float64Array(k)}const u=33306690738754716e-32,c=22204460492503146e-32,d=11093356479670487e-47,p=l(4),_=l(8),w=l(12),M=l(16),P=l(4);n.orient2d=function(k,A,O,g,v,y){const E=(A-y)*(O-v),S=(k-v)*(g-y),C=E-S;if(E===0||S===0||E>0!=S>0)return C;const T=Math.abs(E+S);return Math.abs(C)>=u*T?C:-(function(z,N,Z,j,U,x,I){let B,V,X,G,R,$,H,et,Q,K,q,ot,ut,dt,xt,bt,St,Mt;const Ct=z-U,Lt=Z-U,Ot=N-x,kt=j-x;R=(xt=(et=Ct-(H=($=134217729*Ct)-($-Ct)))*(K=kt-(Q=($=134217729*kt)-($-kt)))-((dt=Ct*kt)-H*Q-et*Q-H*K))-(q=xt-(St=(et=Ot-(H=($=134217729*Ot)-($-Ot)))*(K=Lt-(Q=($=134217729*Lt)-($-Lt)))-((bt=Ot*Lt)-H*Q-et*Q-H*K))),p[0]=xt-(q+R)+(R-St),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),p[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,p[2]=ot-(Mt-R)+(q-R),p[3]=Mt;let Rt=(function(rn,on){let sn=on[0];for(let Le=1;Le<rn;Le++)sn+=on[Le];return sn})(4,p),Pe=c*I;if(Rt>=Pe||-Rt>=Pe||(B=z-(Ct+(R=z-Ct))+(R-U),X=Z-(Lt+(R=Z-Lt))+(R-U),V=N-(Ot+(R=N-Ot))+(R-x),G=j-(kt+(R=j-kt))+(R-x),B===0&&V===0&&X===0&&G===0)||(Pe=d*I+s*Math.abs(Rt),(Rt+=Ct*G+kt*B-(Ot*X+Lt*V))>=Pe||-Rt>=Pe))return Rt;R=(xt=(et=B-(H=($=134217729*B)-($-B)))*(K=kt-(Q=($=134217729*kt)-($-kt)))-((dt=B*kt)-H*Q-et*Q-H*K))-(q=xt-(St=(et=V-(H=($=134217729*V)-($-V)))*(K=Lt-(Q=($=134217729*Lt)-($-Lt)))-((bt=V*Lt)-H*Q-et*Q-H*K))),P[0]=xt-(q+R)+(R-St),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),P[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,P[2]=ot-(Mt-R)+(q-R),P[3]=Mt;const en=a(4,p,4,P,_);R=(xt=(et=Ct-(H=($=134217729*Ct)-($-Ct)))*(K=G-(Q=($=134217729*G)-($-G)))-((dt=Ct*G)-H*Q-et*Q-H*K))-(q=xt-(St=(et=Ot-(H=($=134217729*Ot)-($-Ot)))*(K=X-(Q=($=134217729*X)-($-X)))-((bt=Ot*X)-H*Q-et*Q-H*K))),P[0]=xt-(q+R)+(R-St),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),P[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,P[2]=ot-(Mt-R)+(q-R),P[3]=Mt;const hi=a(en,_,4,P,w);R=(xt=(et=B-(H=($=134217729*B)-($-B)))*(K=G-(Q=($=134217729*G)-($-G)))-((dt=B*G)-H*Q-et*Q-H*K))-(q=xt-(St=(et=V-(H=($=134217729*V)-($-V)))*(K=X-(Q=($=134217729*X)-($-X)))-((bt=V*X)-H*Q-et*Q-H*K))),P[0]=xt-(q+R)+(R-St),R=(ut=dt-((ot=dt+q)-(R=ot-dt))+(q-R))-(q=ut-bt),P[1]=ut-(q+R)+(R-bt),R=(Mt=ot+q)-ot,P[2]=ot-(Mt-R)+(q-R),P[3]=Mt;const nn=a(hi,w,4,P,M);return M[nn-1]})(k,A,O,g,v,y,T)},n.orient2dfast=function(k,A,O,g,v,y){return(A-y)*(O-v)-(k-v)*(g-y)},Object.defineProperty(n,"__esModule",{value:!0})})})(Ni,Ni.exports)),Ni.exports}var Za;function bm(){if(Za)return On.exports;Za=1;var i=mm(),t=_m,n=ym(),r=xm().orient2d;t.default&&(t=t.default),On.exports=s,On.exports.default=s;function s(y,E,S){E=Math.max(0,E===void 0?2:E),S=S||0;var C=M(y),T=new i(16);T.toBBox=function(H){return{minX:H[0],minY:H[1],maxX:H[0],maxY:H[1]}},T.compareMinX=function(H,et){return H[0]-et[0]},T.compareMinY=function(H,et){return H[1]-et[1]},T.load(y);for(var z=[],N=0,Z;N<C.length;N++){var j=C[N];T.remove(j),Z=P(j,Z),z.push(Z)}var U=new i(16);for(N=0;N<z.length;N++)U.insert(w(z[N]));for(var x=E*E,I=S*S;z.length;){var B=z.shift(),V=B.p,X=B.next.p,G=k(V,X);if(!(G<I)){var R=G/x;j=a(T,B.prev.p,V,X,B.next.next.p,R,U),j&&Math.min(k(j,V),k(j,X))<=R&&(z.push(B),z.push(P(j,B)),T.remove(j),U.remove(B),U.insert(w(B)),U.insert(w(B.next)))}}B=Z;var $=[];do $.push(B.p),B=B.next;while(B!==Z);return $.push(B.p),$}function a(y,E,S,C,T,z,N){for(var Z=new t([],l),j=y.data;j;){for(var U=0;U<j.children.length;U++){var x=j.children[U],I=j.leaf?A(x,S,C):u(S,C,x);I>z||Z.push({node:x,dist:I})}for(;Z.length&&!Z.peek().node.children;){var B=Z.pop(),V=B.node,X=A(V,E,S),G=A(V,C,T);if(B.dist<X&&B.dist<G&&d(S,V,N)&&d(C,V,N))return V}j=Z.pop(),j&&(j=j.node)}return null}function l(y,E){return y.dist-E.dist}function u(y,E,S){if(c(y,S)||c(E,S))return 0;var C=O(y[0],y[1],E[0],E[1],S.minX,S.minY,S.maxX,S.minY);if(C===0)return 0;var T=O(y[0],y[1],E[0],E[1],S.minX,S.minY,S.minX,S.maxY);if(T===0)return 0;var z=O(y[0],y[1],E[0],E[1],S.maxX,S.minY,S.maxX,S.maxY);if(z===0)return 0;var N=O(y[0],y[1],E[0],E[1],S.minX,S.maxY,S.maxX,S.maxY);return N===0?0:Math.min(C,T,z,N)}function c(y,E){return y[0]>=E.minX&&y[0]<=E.maxX&&y[1]>=E.minY&&y[1]<=E.maxY}function d(y,E,S){for(var C=Math.min(y[0],E[0]),T=Math.min(y[1],E[1]),z=Math.max(y[0],E[0]),N=Math.max(y[1],E[1]),Z=S.search({minX:C,minY:T,maxX:z,maxY:N}),j=0;j<Z.length;j++)if(_(Z[j].p,Z[j].next.p,y,E))return!1;return!0}function p(y,E,S){return r(y[0],y[1],E[0],E[1],S[0],S[1])}function _(y,E,S,C){return y!==C&&E!==S&&p(y,E,S)>0!=p(y,E,C)>0&&p(S,C,y)>0!=p(S,C,E)>0}function w(y){var E=y.p,S=y.next.p;return y.minX=Math.min(E[0],S[0]),y.minY=Math.min(E[1],S[1]),y.maxX=Math.max(E[0],S[0]),y.maxY=Math.max(E[1],S[1]),y}function M(y){for(var E=y[0],S=y[0],C=y[0],T=y[0],z=0;z<y.length;z++){var N=y[z];N[0]<E[0]&&(E=N),N[0]>C[0]&&(C=N),N[1]<S[1]&&(S=N),N[1]>T[1]&&(T=N)}var Z=[E,S,C,T],j=Z.slice();for(z=0;z<y.length;z++)n(y[z],Z)||j.push(y[z]);return v(j)}function P(y,E){var S={p:y,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return E?(S.next=E.next,S.prev=E,E.next.prev=S,E.next=S):(S.prev=S,S.next=S),S}function k(y,E){var S=y[0]-E[0],C=y[1]-E[1];return S*S+C*C}function A(y,E,S){var C=E[0],T=E[1],z=S[0]-C,N=S[1]-T;if(z!==0||N!==0){var Z=((y[0]-C)*z+(y[1]-T)*N)/(z*z+N*N);Z>1?(C=S[0],T=S[1]):Z>0&&(C+=z*Z,T+=N*Z)}return z=y[0]-C,N=y[1]-T,z*z+N*N}function O(y,E,S,C,T,z,N,Z){var j=S-y,U=C-E,x=N-T,I=Z-z,B=y-T,V=E-z,X=j*j+U*U,G=j*x+U*I,R=x*x+I*I,$=j*B+U*V,H=x*B+I*V,et=X*R-G*G,Q,K,q,ot,ut=et,dt=et;et===0?(K=0,ut=1,ot=H,dt=R):(K=G*H-R*$,ot=X*H-G*$,K<0?(K=0,ot=H,dt=R):K>ut&&(K=ut,ot=H+G,dt=R)),ot<0?(ot=0,-$<0?K=0:-$>X?K=ut:(K=-$,ut=X)):ot>dt&&(ot=dt,-$+G<0?K=0:-$+G>X?K=ut:(K=-$+G,ut=X)),Q=K===0?0:K/ut,q=ot===0?0:ot/dt;var xt=(1-Q)*y+Q*S,bt=(1-Q)*E+Q*C,St=(1-q)*T+q*N,Mt=(1-q)*z+q*Z,Ct=St-xt,Lt=Mt-bt;return Ct*Ct+Lt*Lt}function g(y,E){return y[0]===E[0]?y[1]-E[1]:y[0]-E[0]}function v(y){y.sort(g);for(var E=[],S=0;S<y.length;S++){for(;E.length>=2&&p(E[E.length-2],E[E.length-1],y[S])<=0;)E.pop();E.push(y[S])}for(var C=[],T=y.length-1;T>=0;T--){for(;C.length>=2&&p(C[C.length-2],C[C.length-1],y[T])<=0;)C.pop();C.push(y[T])}return C.pop(),E.pop(),E.concat(C)}return On.exports}var Mm=bm();const Pm=mh(Mm);function Lm(i,t={}){t.concavity=t.concavity||1/0;const n=[];if(hl(i,s=>{n.push([s[0],s[1]])}),!n.length)return null;const r=Pm(n,t.concavity);return r.length>3?dm([r]):null}var Ya=Lm;function Em(i){if(!i)throw new Error("geojson is required");switch(i.type){case"Feature":return ll(i);case"FeatureCollection":return Sm(i);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return So(i);default:throw new Error("unknown GeoJSON type")}}function ll(i){const t={type:"Feature"};return Object.keys(i).forEach(n=>{switch(n){case"type":case"properties":case"geometry":return;default:t[n]=i[n]}}),t.properties=ul(i.properties),i.geometry==null?t.geometry=null:t.geometry=So(i.geometry),t}function ul(i){const t={};return i&&Object.keys(i).forEach(n=>{const r=i[n];typeof r=="object"?r===null?t[n]=null:Array.isArray(r)?t[n]=r.map(s=>s):t[n]=ul(r):t[n]=r}),t}function Sm(i){const t={type:"FeatureCollection"};return Object.keys(i).forEach(n=>{switch(n){case"type":case"features":return;default:t[n]=i[n]}}),t.features=i.features.map(n=>ll(n)),t}function So(i){const t={type:i.type};return i.bbox&&(t.bbox=i.bbox),i.type==="GeometryCollection"?(t.geometries=i.geometries.map(n=>So(n)),t):(t.coordinates=cl(i.coordinates),t)}function cl(i){const t=i;return typeof t[0]!="object"?t.slice():t.map(n=>cl(n))}function fl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,w,M=i.type,P=M==="FeatureCollection",k=M==="Feature",A=P?i.features.length:1,O=0;O<A;O++){d=P?i.features[O].geometry:k?i.geometry:i,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var g=0;g<u;g++){var v=0,y=0;if(l=w?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,O,v,y)===!1)return!1;_++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,O,v,y)===!1)return!1;_++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,O,v,y)===!1)return!1;_++}E==="MultiLineString"&&v++,E==="Polygon"&&y++}E==="Polygon"&&v++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,O,v,y)===!1)return!1;_++}y++}v++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(fl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function tr(i,t={}){if(i.bbox!=null&&t.recompute!==!0)return i.bbox;const n=[1/0,1/0,-1/0,-1/0];return fl(i,r=>{n[0]>r[0]&&(n[0]=r[0]),n[1]>r[1]&&(n[1]=r[1]),n[2]<r[0]&&(n[2]=r[0]),n[3]<r[1]&&(n[3]=r[1])}),n}function Cm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function km(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Xa(i[0])||!Xa(i[1]))throw new Error("coordinates must contain numbers");return Cm({type:"Point",coordinates:i},t,n)}function Xa(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Tm(i,t={}){const n=tr(i),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return km([r,s],t.properties,t)}function Dm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Am(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ua(i[0])||!Ua(i[1]))throw new Error("coordinates must contain numbers");return Dm({type:"Point",coordinates:i},t,n)}function Ua(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function dl(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,w,M=i.type,P=M==="FeatureCollection",k=M==="Feature",A=P?i.features.length:1,O=0;O<A;O++){d=P?i.features[O].geometry:k?i.geometry:i,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var g=0;g<u;g++){var v=0,y=0;if(l=w?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=E==="Polygon"||E==="MultiPolygon"?1:0,E){case null:break;case"Point":if(t(c,_,O,v,y)===!1)return!1;_++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,O,v,y)===!1)return!1;_++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,O,v,y)===!1)return!1;_++}E==="MultiLineString"&&v++,E==="Polygon"&&y++}E==="Polygon"&&v++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,O,v,y)===!1)return!1;_++}y++}v++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(dl(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Om(i,t={}){let n=0,r=0,s=0;return dl(i,function(a){n+=a[0],r+=a[1],s++}),Am([n/s,r/s],t.properties)}function Im(i){return i%(2*Math.PI)*180/Math.PI}function Vr(i){return i%360*Math.PI/180}function In(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Bm(i,t,n={}){let r;return n.final?r=ja(In(t),In(i)):r=ja(In(i),In(t)),r>180?-(360-r):r}function ja(i,t){const n=Vr(i[1]),r=Vr(t[1]);let s=Vr(t[0]-i[0]);s>Math.PI&&(s-=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI);const a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),l=Math.atan2(s,a);return(Im(l)+360)%360}var zt=63710088e-1,pl={centimeters:zt*100,centimetres:zt*100,degrees:360/(2*Math.PI),feet:zt*3.28084,inches:zt*39.37,kilometers:zt/1e3,kilometres:zt/1e3,meters:zt,metres:zt,miles:zt/1609.344,millimeters:zt*1e3,millimetres:zt*1e3,nauticalmiles:zt/1852,radians:1,yards:zt*1.0936};function zm(i,t="kilometers"){const n=pl[t];if(!n)throw new Error(t+" units is invalid");return i*n}function Fm(i,t="kilometers"){const n=pl[t];if(!n)throw new Error(t+" units is invalid");return i/n}function Nm(i,t="kilometers",n="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return zm(Fm(i,t),n)}function Wa(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Rm(i,t,n={}){const r=Wa(i),s=Wa(t);s[0]+=s[0]-r[0]>180?-360:r[0]-s[0]>180?360:0;const a=Zm(r,s);return Nm(a,"meters",n.units)}function Zm(i,t,n){n=n===void 0?zt:Number(n);const r=n,s=i[1]*Math.PI/180,a=t[1]*Math.PI/180,l=a-s;let u=Math.abs(t[0]-i[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);const c=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=Math.abs(c)>1e-11?l/c:Math.cos(s);return Math.sqrt(l*l+d*d*u*u)*r}var Ft=63710088e-1,ml={centimeters:Ft*100,centimetres:Ft*100,degrees:360/(2*Math.PI),feet:Ft*3.28084,inches:Ft*39.37,kilometers:Ft/1e3,kilometres:Ft/1e3,meters:Ft,metres:Ft,miles:Ft/1609.344,millimeters:Ft*1e3,millimetres:Ft*1e3,nauticalmiles:Ft/1852,radians:1,yards:Ft*1.0936};function Ym(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function Xm(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ha(i[0])||!Ha(i[1]))throw new Error("coordinates must contain numbers");return Ym({type:"Point",coordinates:i},t,n)}function Um(i,t="kilometers"){const n=ml[t];if(!n)throw new Error(t+" units is invalid");return i*n}function jm(i,t="kilometers"){const n=ml[t];if(!n)throw new Error(t+" units is invalid");return i/n}function Va(i){return i%360*Math.PI/180}function Wm(i,t="kilometers",n="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return Um(jm(i,t),n)}function Ha(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Vm(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Hm(i,t,n,r={}){const s=t<0;let a=Wm(Math.abs(t),r.units,"meters");s&&(a=-Math.abs(a));const l=Vm(i),u=$m(l,a,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,Xm(u,r.properties)}function $m(i,t,n,r){r=r===void 0?Ft:Number(r);const s=t/r,a=i[0]*Math.PI/180,l=Va(i[1]),u=Va(n),c=s*Math.cos(u);let d=l+c;Math.abs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d);const p=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),_=Math.abs(p)>1e-11?c/p:Math.cos(l),w=s*Math.sin(u)/_;return[((a+w)*180/Math.PI+540)%360-180,d*180/Math.PI]}function Gm(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties={},r.geometry=i,r}function Bn(i,t,n={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!$a(i[0])||!$a(i[1]))throw new Error("coordinates must contain numbers");return Gm({type:"Point",coordinates:i},t,n)}function $a(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function qm(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)}function _l(i,t,n){if(i!==null)for(var r,s,a,l,u,c,d,p=0,_=0,w,M=i.type,P=M==="FeatureCollection",k=M==="Feature",A=P?i.features.length:1,O=0;O<A;O++){d=P?i.features[O].geometry:k?i.geometry:i,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var g=0;g<u;g++){var v=0,y=0;if(l=w?d.geometries[g]:d,l!==null){c=l.coordinates;var E=l.type;switch(p=0,E){case null:break;case"Point":if(t(c,_,O,v,y)===!1)return!1;_++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(t(c[r],_,O,v,y)===!1)return!1;_++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-p;s++){if(t(c[r][s],_,O,v,y)===!1)return!1;_++}E==="MultiLineString"&&v++,E==="Polygon"&&y++}E==="Polygon"&&v++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(y=0,s=0;s<c[r].length;s++){for(a=0;a<c[r][s].length-p;a++){if(t(c[r][s][a],_,O,v,y)===!1)return!1;_++}y++}v++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(_l(l.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Jm(i,t){if(i.type==="Feature")t(i,0);else if(i.type==="FeatureCollection")for(var n=0;n<i.features.length&&t(i.features[n],n)!==!1;n++);}function Km(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Qm(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function t_(i,t){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}function e_(i,t,n){if(n=n||{},!qm(n))throw new Error("options is invalid");const r=n.origin||"centroid",s=n.mutate||!1;if(!i)throw new Error("geojson required");if(typeof t!="number"||t<=0)throw new Error("invalid factor");const a=Array.isArray(r)||typeof r=="object";return s!==!0&&(i=Em(i)),i.type==="FeatureCollection"&&!a?(Jm(i,function(l,u){i.features[u]=Ga(l,t,r)}),i):Ga(i,t,r)}function Ga(i,t,n){const r=t_(i)==="Point",s=i_(i,n);return t===1||r||(_l(i,function(a){const l=Rm(s,a),u=Bm(s,a),c=l*t,d=Qm(Hm(s,c,u));a[0]=d[0],a[1]=d[1],a.length===3&&(a[2]*=t)}),delete i.bbox),i}function i_(i,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return Km(t);const n=i.bbox?i.bbox:tr(i,{recompute:!0}),r=n[0],s=n[1],a=n[2],l=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return Bn([r,s]);case"se":case"southeast":case"eastsouth":case"bottomright":return Bn([a,s]);case"nw":case"northwest":case"westnorth":case"topleft":return Bn([r,l]);case"ne":case"northeast":case"eastnorth":case"topright":return Bn([a,l]);case"center":return Tm(i);case void 0:case null:case"centroid":return Om(i);default:throw new Error("invalid origin")}}function n_(i,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=i,r}function r_(i,t,n={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n_({type:"Polygon",coordinates:i},t,n)}function o_(i,t={}){const n=Number(i[0]),r=Number(i[1]),s=Number(i[2]),a=Number(i[3]);if(i.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const l=[n,r];return r_([[l,[s,r],[s,a],[n,a],l]],t.properties,{bbox:i,id:t.id})}function gl(i,t,n){n[i]=!0;for(const r of t[i])n[r]||gl(r,t,n)}function s_(i,t){const n=JSON.stringify(i),r=JSON.stringify(t);return n<r?`${n}|${r}`:`${r}|${n}`}function a_(i,t){const[n,r]=(function(s,a){const[l,u]=s,[c,d]=a;return l<c||l===c&&u<=d?[s,a]:[a,s]})(i,t);return JSON.stringify([n,r])}function vl(i){const t=new Map;for(const n of i.features){const r=n.geometry.coordinates;for(let s=0;s<r.length-1;s++){const a=r[s],l=r[s+1],u=a_(a,l);t.has(u)||t.set(u,{type:"Feature",geometry:{type:"LineString",coordinates:[a,l]},properties:{}})}}return{type:"FeatureCollection",features:Array.from(t.values())}}function h_(i,t){const n=i.length,r=t.length;if(n>r)return!1;for(let a=0;a<=r-n;a++){let l=!0;for(let u=0;u<n;u++)if(t[a+u][0]!==i[u][0]||t[a+u][1]!==i[u][1]){l=!1;break}if(l)return!0}const s=[...i].reverse();for(let a=0;a<=r-n;a++){let l=!0;for(let u=0;u<n;u++)if(t[a+u][0]!==s[u][0]||t[a+u][1]!==s[u][1]){l=!1;break}if(l)return!0}return!1}function Hr(i){const t=vl(i),n=new Map;function r(l){return l.join(",")}for(let l=0;l<t.features.length;l++){const u=t.features[l].geometry.coordinates;if(u.length<2)continue;const c=r(u[0]),d=r(u[u.length-1]);n.set(c,(n.get(c)||0)+1),n.set(d,(n.get(d)||0)+1)}const s=new Map,a=new Map;for(let l=0;l<t.features.length;l++){const u=t.features[l],c=u.geometry.coordinates;if(c.length<2)continue;const d=r(c[0]),p=r(c[c.length-1]),_=n.get(d)||0,w=n.get(p)||0,M=c.map(r).join(";");_===1||w===1?s.has(M)||s.set(M,u):a.has(M)||a.set(M,u)}return{leafEdges:{type:"FeatureCollection",features:Array.from(s.values())},nonLeafEdges:{type:"FeatureCollection",features:Array.from(a.values())}}}function l_(i,t,n,r,s){const a=i.geometry.coordinates;for(const l of a)if(!u_(l,t,n,r,s))return!1;return!0}function u_(i,t,n,r,s){const[a,l]=i;return a>=t&&a<=r&&l>=n&&l<=s}function Wi(){return Wi=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Wi.apply(null,arguments)}const yl=(i,t)=>{const n=d=>d*Math.PI/180,r=n(i[1]),s=n(i[0]),a=n(t[1]),l=a-r,u=n(t[0])-s,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3/1e3},c_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class f_{constructor(t,n=64,r=Float64Array,s){if(this.data=void 0,this.ids=void 0,this.coords=void 0,this._pos=void 0,this._finished=void 0,this.numItems=void 0,this.nodeSize=void 0,this.ArrayType=void 0,this.IndexArrayType=void 0,isNaN(t)||t<0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=t,this.nodeSize=Math.min(Math.max(n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=c_.indexOf(this.ArrayType),l=2*t*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);s?(this.data=s,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+c,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+l+u+c),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+c,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=this.nodeSize,new Uint32Array(this.data,4,1)[0]=this.numItems)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return uo(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}}function uo(i,t,n,r,s,a){if(s-r<=n)return;const l=r+s>>1;wl(i,t,l,r,s,a),uo(i,t,n,r,l-1,1-a),uo(i,t,n,l+1,s,1-a)}function wl(i,t,n,r,s,a){for(;s>r;){if(s-r>600){const d=s-r+1,p=n-r+1,_=Math.log(d),w=.5*Math.exp(2*_/3),M=.5*Math.sqrt(_*w*(d-w)/d)*(p-d/2<0?-1:1);wl(i,t,n,Math.max(r,Math.floor(n-p*w/d+M)),Math.min(s,Math.floor(n+(d-p)*w/d+M)),a)}const l=t[2*n+a];let u=r,c=s;for(Ai(i,t,r,n),t[2*s+a]>l&&Ai(i,t,r,s);u<c;){for(Ai(i,t,u,c),u++,c--;t[2*u+a]<l;)u++;for(;t[2*c+a]>l;)c--}t[2*r+a]===l?Ai(i,t,r,c):(c++,Ai(i,t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function Ai(i,t,n,r){$r(i,n,r),$r(t,2*n,2*r),$r(t,2*n+1,2*r+1)}function $r(i,t,n){const r=i[t];i[t]=i[n],i[n]=r}class d_{constructor(t=[],n=(r,s)=>r<s?-1:r>s?1:0){if(this.data=void 0,this.length=void 0,this.compare=void 0,this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,s=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(s,l)>=0)break;n[t]=l,t=a}n[t]=s}_down(t){const{data:n,compare:r}=this,s=this.length>>1,a=n[t];for(;t<s;){let l=1+(t<<1);const u=l+1;if(u<this.length&&r(n[u],n[l])<0&&(l=u),r(n[l],a)>=0)break;n[t]=n[l],t=l}n[t]=a}}const oe=Math.PI/180;function qa(i,t,n,r){const s=r.minLng,a=r.maxLng,l=r.minLat,u=r.maxLat;if(i>=s&&i<=a)return t<l?Oe((t-l)*oe):t>u?Oe((t-u)*oe):0;const c=Math.min(Oe((i-s)*oe),Oe((i-a)*oe)),d=(function(p,_){const w=1-2*_;return w<=0?p>0?90:-90:Math.atan(Math.tan(p*oe)/w)/oe})(t,c);return d>l&&d<u?Xn(c,n,t,d):Math.min(Xn(c,n,t,l),Xn(c,n,t,u))}function p_(i,t){return i.dist-t.dist}function Oe(i){const t=Math.sin(i/2);return t*t}function Xn(i,t,n,r){return t*Math.cos(r*oe)*i+Oe((n-r)*oe)}function Ja(i,t,n,r,s){return Xn(Oe((i-n)*oe),s,t,r)}function Me(i){const t=i.geometry.coordinates;let n=0;for(let r=0;r<t.length-1;r++)n+=yl(t[r],t[r+1]);return n}class m_{constructor(t){this.network=void 0,this.network=t}getRouteLength(t){return Me(t)}setNetwork(t){this.network=t}getNetwork(){return this.network}getNetworkInBoundingBox(t){return(function(n,r){const[s,a,l,u]=r;if(s>=l||a>=u)throw new Error("Invalid bounding box: min values must be less than max values");const c=[];for(const d of n.features)l_(d,s,a,l,u)&&c.push(d);return{type:"FeatureCollection",features:c}})(this.network,t)}getNetworkWithoutDuplicatesOrSubsections(){return(function(t){const n=t.features,r=new Set;for(let s=0;s<n.length;s++){const a=n[s].geometry.coordinates;for(let l=0;l<n.length;l++){if(s===l)continue;const u=n[l].geometry.coordinates;if(h_(a,u)&&(a.length<u.length||a.length===u.length&&s>l)){r.add(s);break}}}return{type:"FeatureCollection",features:n.filter((s,a)=>!r.has(a))}})(this.network)}getConnectedComponents(){return(function(t){const n=t.features,r=new Map,s=new Map;function a(d){return`${d[0]},${d[1]}`}for(let d=0;d<n.length;d++){const p=n[d].geometry.coordinates;for(const _ of p){const w=a(_);s.has(w)||s.set(w,new Set),s.get(w).add(d)}}for(let d=0;d<n.length;d++){r.set(d,new Set);const p=n[d].geometry.coordinates;for(const _ of p){const w=a(_),M=s.get(w);if(M)for(const P of M)P!==d&&r.get(d).add(P)}}const l=new Set,u=[];function c(d,p){const _=[d];for(;_.length>0;){const w=_.pop();if(l.has(w))continue;l.add(w),p.push(n[w]);const M=r.get(w);if(M)for(const P of M)l.has(P)||_.push(P)}}for(let d=0;d<n.length;d++)if(!l.has(d)){const p=[];c(d,p),u.push({type:"FeatureCollection",features:p})}return u.sort((d,p)=>d.features.length-p.features.length),u})(this.network)}getConnectedComponentCount(){return(function(t){const n=t.features,r=n.length,s=new Map;for(let d=0;d<r;d++){const p=n[d].geometry.coordinates;for(const _ of p){const w=`${(a=_)[0]},${a[1]}`;s.has(w)||s.set(w,[]),s.get(w).push(d)}}var a;const l=Array.from({length:r},()=>[]);for(const d of s.values())for(let p=0;p<d.length;p++)for(let _=p+1;_<d.length;_++){const w=d[p],M=d[_];l[w].push(M),l[M].push(w)}const u=new Array(r).fill(!1);let c=0;for(let d=0;d<r;d++)u[d]||(gl(d,l,u),c++);return c})(this.network)}getNodeAndEdgeCount(){return(function(t){const n=new Set,r=new Set;for(const s of t.features){const a=s.geometry.coordinates;for(const l of a)n.add(JSON.stringify(l));for(let l=0;l<a.length-1;l++){const u=s_(a[l],a[l+1]);r.add(u)}}return{nodeCount:n.size,edgeCount:r.size}})(this.network)}getNodes(){return{type:"FeatureCollection",features:(function(t){const n=new Set,r=[];for(const s of t.features)for(const a of s.geometry.coordinates){const l=a.join(",");n.has(l)||(n.add(l),r.push({type:"Feature",geometry:{type:"Point",coordinates:a},properties:{}}))}return r})(this.network)}}getNodeCount(){const{nodeCount:t}=this.getNodeAndEdgeCount();return t}getEdges(){return vl(this.network)}getLongestEdgeLength(){const t=this.getLongestEdge();return t?Me(t):-1}getAverageEdgeLength(){const t=this.getEdges().features;return t.length===0?-1:t.reduce((n,r)=>n+Me(r),0)/t.length}getNodeDegrees(){const t={},n=this.getEdges().features;for(const r of n){const[s,a]=r.geometry.coordinates,l=`${s[0]},${s[1]}`,u=`${a[0]},${a[1]}`;t[l]=(t[l]||0)+1,t[u]=(t[u]||0)+1}return t}getNodeDegreeStats(){const t=Object.values(this.getNodeDegrees());return t.length===0?{min:0,max:0,avg:0}:{min:Math.min(...t),max:Math.max(...t),avg:t.reduce((n,r)=>n+r,0)/t.length}}getShortestEdgeLength(){const t=this.getShortestEdge();return t?Me(t):-1}getLongestEdge(){const t=this.getEdges().features;if(t.length===0)return null;const n=t.sort((r,s)=>Me(r)-Me(s));return n[n.length-1]}getShortestEdge(){const t=this.getEdges().features;return t.length===0?null:t.sort((n,r)=>Me(n)-Me(r))[0]}getEdgeCount(){const{edgeCount:t}=this.getNodeAndEdgeCount();return t}getLeafEdges(){return Hr(this.network).leafEdges}getPrunedEdges(t){if(t&&t>0){let n=this.network;for(let r=0;r<t;r++)n=Hr(n).nonLeafEdges;return n}return Hr(this.network).nonLeafEdges}getUnifiedNetwork(t){return(function(n,r){if(n.features.length<2)return n;const s=new Set,a=new Map,l=[],u=new Map;for(const _ of n.features)for(const w of _.geometry.coordinates){const M=`${w[0]},${w[1]}`;u.has(M)||(u.set(M,l.length),l.push(w))}let c=new f_(l.length);for(const _ of l)c.add(_[0],_[1]);function d(_,w,M){let P=null,k=1/0;const A=(function(O,g,v,y=1/0,E=1/0){let S=1;const C=[];y===void 0&&(y=1/0),E!==void 0&&(S=Oe(E/6371));const T=new d_([],p_);let z={left:0,right:O.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90};const N=Math.cos(v*oe);for(;z;){const Z=z.right,j=z.left;if(Z-j<=O.nodeSize)for(let U=j;U<=Z;U++){const x=O.ids[U],I=Ja(g,v,O.coords[2*U],O.coords[2*U+1],N);T.push({id:x,dist:I})}else{const U=j+Z>>1,x=O.coords[2*U],I=O.coords[2*U+1],B=O.ids[U],V=Ja(g,v,x,I,N);T.push({id:B,dist:V});const X=(z.axis+1)%2,G={left:j,right:U-1,axis:X,minLng:z.minLng,minLat:z.minLat,maxLng:z.axis===0?x:z.maxLng,maxLat:z.axis===1?I:z.maxLat,dist:0},R={left:U+1,right:Z,axis:X,minLng:z.axis===0?x:z.minLng,minLat:z.axis===1?I:z.minLat,maxLng:z.maxLng,maxLat:z.maxLat,dist:0};G.dist=qa(g,v,N,G),R.dist=qa(g,v,N,R),T.push(G),T.push(R)}for(;T.length&&T.peek().id!=null;){const U=T.pop();if(U.dist>S||(C.push(U.id),C.length===y))return C}z=T.pop()}return C})(c,_[0],_[1],1/0,r/1e3);for(const O of A){const g=l[O],v=`${g[0]},${g[1]}`;if(!s.has(v)||w.includes(g)||M.has(v))continue;const y=1e3*yl(g,_);y<=r&&y<k&&(P=g,k=y)}return P!==null?P:(s.add(`${_[0]},${_[1]}`),_)}c.finish();const p=n.features.map(_=>{const w=[],M=[],P=new Set;for(const k of _.geometry.coordinates){const A=`${k[0]},${k[1]}`;if(!a.has(A)){const v=d(k,w,P);P.has(`${v[0]},${v[1]}`)?a.set(A,k):a.set(A,v)}const O=a.get(A),g=`${O[0]},${O[1]}`;P.has(g)||(M.push(O),P.add(g)),w.push(k)}return Wi({},_,{geometry:Wi({},_.geometry,{coordinates:M})})});return Wi({},n,{features:p})})(this.network,t)}}const Gr=51.539931,qr=-.078,Ka={L:il,id:"leaflet-map",lng:qr,lat:Gr,zoom:13,minZoom:10,maxZoom:20,tapTolerance:10,maxBounds:[[Gr-.05,qr-.05],[Gr+.05,qr+.05]]},__=()=>{const i=Dc(null),[t,n]=We(),[r,s]=We("static"),[a,l]=We(),[u,c]=We(),[d,p]=We(!0);js(()=>{const y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/public/network.json":"./network.json";fetch(y).then(E=>{E.json().then(S=>{l(S)})})},[]),js(()=>{t||n(Sp(Ka))},[t]);const[_,w]=We(Jt.TerraRoute),M=$i(()=>{if(a)return{[Jt.TerraRoute]:Ia(a,Jt.TerraRoute),[Jt.GeoJSONPathFinder]:Ia(a,Jt.GeoJSONPathFinder)}},[a]),{draw:P,routing:k}=$i(()=>{if(t&&a&&M){const v=new kf({network:a,useCache:!0,routeFinder:M[Jt.TerraRoute]}),y=Bf(t,il,v);y.start();const E=Ya(a);return E&&E.properties&&(E.properties.mode="networkOutline"),y.addFeatures([E]),{draw:y,routing:v}}return{draw:void 0,routing:void 0}},[t,a,M]),A=Or(v=>{P&&(s(v),P.setMode(v))},[P]),O=Or(()=>{if(!P)return;const v=P.getSnapshot().filter(({properties:y})=>y.mode!=="networkOutline").map(({id:y})=>y);P.removeFeatures(v)},[P]),g=Or(()=>{let v;if(!u&&a)v=a;else if(u)v=u;else return;const y=tr(v),E=o_(y),S=e_(E,.9),C=new m_(v),T=tr(S),z=C.getNetworkInBoundingBox(T);k?.setNetwork(z),c(z);const N=P?.getSnapshot().find(({properties:j})=>j.mode==="networkOutline");P?.removeFeatures([N.id]);const Z=Ya(z);Z&&Z.properties&&(Z.properties.mode="networkOutline"),P?.addFeatures([Z])},[P,a,u,k]);return rt("div",{class:de.home,children:rt("div",{ref:i,class:de.map,id:Ka.id,children:[d?rt("div",{class:de.helpOverlay,role:"note","aria-label":"Demo instructions",children:[rt("div",{class:de.helpHeader,children:[rt("div",{class:de.helpTitle,children:"Terra Draw Route Snap Mode demo"}),rt("button",{type:"button",class:de.helpClose,onClick:()=>p(!1),"aria-label":"Close instructions",children:""})]}),rt("div",{class:de.helpBody,children:[rt("p",{children:["This demo shows how ",rt("strong",{children:"Terra Draw Route Snap Mode"})," snaps the line you draw onto a routing network."]}),rt("ol",{children:[rt("li",{children:["Select ",rt("strong",{children:"Route Snap"})," from the mode buttons."]}),rt("li",{children:["Click on the map to add up to ",rt("strong",{children:"5"})," points."]}),rt("li",{children:"Double-click (or finish) to commit the route."}),rt("li",{children:["Use ",rt("strong",{children:"Clear"})," to remove drawn routes and ",rt("strong",{children:"Prune"})," to shrink the network."]})]}),rt("div",{class:de.helpHint,children:"Tip: you can reopen this panel by refreshing the page."})]})]}):null,P?rt(cm,{mode:r,changeMode:A,onClear:O,onPrune:g,routingOption:_,routingDisabled:!k||!M,onRoutingChange:v=>{!k||!M||(w(v),k.setRouteFinder(M[v]))}}):null,P?null:rt("div",{class:de.loading,children:"Loading..."})]})})};console.log("App.tsx");const g_=()=>rt("div",{id:"app",children:[rt(wc,{}),rt(__,{})]});let De,Ri;const v_=(i,t)=>{if(De=void 0,t&&t.type==="click"){if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button!==0)return i;const n=t.target.closest("a[href]"),r=n&&n.getAttribute("href");if(!n||n.origin!=location.origin||/^#/.test(r)||!/^(_?self)?$/i.test(n.target)||Ri&&(typeof Ri=="string"?!r.startsWith(Ri):!Ri.test(r)))return i;De=!0,t.preventDefault(),t=n.href.replace(location.origin,"")}else typeof t=="string"?De=!0:t&&t.url?(De=!t.replace,t=t.url):t=location.pathname+location.search;return De===!0?history.pushState(null,"",t):De===!1&&history.replaceState(null,"",t),t};function xl(i){const[t,n]=Mh(v_,i.url||location.pathname+location.search);i.scope&&(Ri=i.scope);const r=De===!0,s=$i(()=>{const a=new URL(t,location.origin),l=a.pathname.replace(/\/+$/g,"")||"/";return{url:t,path:l,query:Object.fromEntries(a.searchParams),route:(u,c)=>n({url:u,replace:c}),wasPush:r}},[t]);return Tc(()=>(addEventListener("click",n),addEventListener("popstate",n),()=>{removeEventListener("click",n),removeEventListener("popstate",n)}),[]),oi(xl.ctx.Provider,{value:s},i.children)}Promise.resolve();xl.ctx=mo({});mo({});const Qa=nt.__b;nt.__b=i=>{i.type&&i.type._forwarded&&i.ref&&(i.props.ref=i.ref,i.ref=null),Qa&&Qa(i)};const th=nt.__e;nt.__e=(i,t,n)=>{if(i&&i.then){let r=t;for(;r=r.__;)if(r.__c&&r.__c.__c)return t.__e==null&&(t.__c.__z=[n.__e],t.__e=n.__e,t.__k=n.__k),t.__k||(t.__k=[]),r.__c.__c(i,t)}th&&th(i,t,n)};let eh;function y_(i,t){if(typeof window>"u")return;let n=document.querySelector("script[type=isodata]");t=t||n&&n.parentNode||document.body,!eh&&n?po(i,t):fo(i,t),eh=!0}typeof window<"u"&&y_(rt(g_,{}),document.getElementById("app"));
